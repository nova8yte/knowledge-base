/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var BS=Object.create;var aa=Object.defineProperty;var NS=Object.getOwnPropertyDescriptor;var HS=Object.getOwnPropertyNames;var VS=Object.getPrototypeOf,qS=Object.prototype.hasOwnProperty;var WS=(o,e,t)=>e in o?aa(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var _i=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports),Wf=(o,e)=>{for(var t in e)aa(o,t,{get:e[t],enumerable:!0})},Fm=(o,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of HS(e))!qS.call(o,n)&&n!==t&&aa(o,n,{get:()=>e[n],enumerable:!(r=NS(e,n))||r.enumerable});return o};var jn=(o,e,t)=>(t=o!=null?BS(VS(o)):{},Fm(e||!o||!o.__esModule?aa(t,"default",{value:o,enumerable:!0}):t,o)),zS=o=>Fm(aa({},"__esModule",{value:!0}),o);var pt=(o,e,t)=>(WS(o,typeof e!="symbol"?e+"":e,t),t);var vi=_i((YE,Um)=>{"use strict";function Xr(o){if(typeof o!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(o))}function Om(o,e){for(var t="",r=0,n=-1,s=0,a,i=0;i<=o.length;++i){if(i<o.length)a=o.charCodeAt(i);else{if(a===47)break;a=47}if(a===47){if(!(n===i-1||s===1))if(n!==i-1&&s===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",r=0):(t=t.slice(0,l),r=t.length-1-t.lastIndexOf("/")),n=i,s=0;continue}}else if(t.length===2||t.length===1){t="",r=0,n=i,s=0;continue}}e&&(t.length>0?t+="/..":t="..",r=2)}else t.length>0?t+="/"+o.slice(n+1,i):t=o.slice(n+1,i),r=i-n-1;n=i,s=0}else a===46&&s!==-1?++s:s=-1}return t}function KS(o,e){var t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+r:t+o+r:r}var Yn={resolve:function(){for(var e="",t=!1,r,n=arguments.length-1;n>=-1&&!t;n--){var s;n>=0?s=arguments[n]:(r===void 0&&(r=process.cwd()),s=r),Xr(s),s.length!==0&&(e=s+"/"+e,t=s.charCodeAt(0)===47)}return e=Om(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Xr(e),e.length===0)return".";var t=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=Om(e,!t),e.length===0&&!t&&(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Xr(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];Xr(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":Yn.normalize(e)},relative:function(e,t){if(Xr(e),Xr(t),e===t||(e=Yn.resolve(e),t=Yn.resolve(t),e===t))return"";for(var r=1;r<e.length&&e.charCodeAt(r)===47;++r);for(var n=e.length,s=n-r,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var i=t.length,l=i-a,c=s<l?s:l,u=-1,d=0;d<=c;++d){if(d===c){if(l>c){if(t.charCodeAt(a+d)===47)return t.slice(a+d+1);if(d===0)return t.slice(a+d)}else s>c&&(e.charCodeAt(r+d)===47?u=d:d===0&&(u=0));break}var m=e.charCodeAt(r+d),x=t.charCodeAt(a+d);if(m!==x)break;m===47&&(u=d)}var h="";for(d=r+u+1;d<=n;++d)(d===n||e.charCodeAt(d)===47)&&(h.length===0?h+="..":h+="/..");return h.length>0?h+t.slice(a+u):(a+=u,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(Xr(e),e.length===0)return".";for(var t=e.charCodeAt(0),r=t===47,n=-1,s=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!s){n=a;break}}else s=!1;return n===-1?r?"/":".":r&&n===1?"//":e.slice(0,n)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Xr(e);var r=0,n=-1,s=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var i=t.length-1,l=-1;for(a=e.length-1;a>=0;--a){var c=e.charCodeAt(a);if(c===47){if(!s){r=a+1;break}}else l===-1&&(s=!1,l=a+1),i>=0&&(c===t.charCodeAt(i)?--i===-1&&(n=a):(i=-1,n=l))}return r===n?n=l:n===-1&&(n=e.length),e.slice(r,n)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!s){r=a+1;break}}else n===-1&&(s=!1,n=a+1);return n===-1?"":e.slice(r,n)}},extname:function(e){Xr(e);for(var t=-1,r=0,n=-1,s=!0,a=0,i=e.length-1;i>=0;--i){var l=e.charCodeAt(i);if(l===47){if(!s){r=i+1;break}continue}n===-1&&(s=!1,n=i+1),l===46?t===-1?t=i:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||n===-1||a===0||a===1&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return KS("/",e)},parse:function(e){Xr(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var r=e.charCodeAt(0),n=r===47,s;n?(t.root="/",s=1):s=0;for(var a=-1,i=0,l=-1,c=!0,u=e.length-1,d=0;u>=s;--u){if(r=e.charCodeAt(u),r===47){if(!c){i=u+1;break}continue}l===-1&&(c=!1,l=u+1),r===46?a===-1?a=u:d!==1&&(d=1):a!==-1&&(d=-1)}return a===-1||l===-1||d===0||d===1&&a===l-1&&a===i+1?l!==-1&&(i===0&&n?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(i,l)):(i===0&&n?(t.name=e.slice(1,a),t.base=e.slice(1,l)):(t.name=e.slice(i,a),t.base=e.slice(i,l)),t.ext=e.slice(a,l)),i>0?t.dir=e.slice(0,i-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Yn.posix=Yn;Um.exports=Yn});var rd=_i((u4,Us)=>{var ae=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},et=-1,rt=1,Ue=0;ae.Diff=function(o,e){return[o,e]};ae.prototype.diff_main=function(o,e,t,r){typeof r=="undefined"&&(this.Diff_Timeout<=0?r=Number.MAX_VALUE:r=new Date().getTime()+this.Diff_Timeout*1e3);var n=r;if(o==null||e==null)throw new Error("Null input. (diff_main)");if(o==e)return o?[new ae.Diff(Ue,o)]:[];typeof t=="undefined"&&(t=!0);var s=t,a=this.diff_commonPrefix(o,e),i=o.substring(0,a);o=o.substring(a),e=e.substring(a),a=this.diff_commonSuffix(o,e);var l=o.substring(o.length-a);o=o.substring(0,o.length-a),e=e.substring(0,e.length-a);var c=this.diff_compute_(o,e,s,n);return i&&c.unshift(new ae.Diff(Ue,i)),l&&c.push(new ae.Diff(Ue,l)),this.diff_cleanupMerge(c),c};ae.prototype.diff_compute_=function(o,e,t,r){var n;if(!o)return[new ae.Diff(rt,e)];if(!e)return[new ae.Diff(et,o)];var s=o.length>e.length?o:e,a=o.length>e.length?e:o,i=s.indexOf(a);if(i!=-1)return n=[new ae.Diff(rt,s.substring(0,i)),new ae.Diff(Ue,a),new ae.Diff(rt,s.substring(i+a.length))],o.length>e.length&&(n[0][0]=n[2][0]=et),n;if(a.length==1)return[new ae.Diff(et,o),new ae.Diff(rt,e)];var l=this.diff_halfMatch_(o,e);if(l){var c=l[0],u=l[1],d=l[2],m=l[3],x=l[4],h=this.diff_main(c,d,t,r),v=this.diff_main(u,m,t,r);return h.concat([new ae.Diff(Ue,x)],v)}return t&&o.length>100&&e.length>100?this.diff_lineMode_(o,e,r):this.diff_bisect_(o,e,r)};ae.prototype.diff_lineMode_=function(o,e,t){var r=this.diff_linesToChars_(o,e);o=r.chars1,e=r.chars2;var n=r.lineArray,s=this.diff_main(o,e,!1,t);this.diff_charsToLines_(s,n),this.diff_cleanupSemantic(s),s.push(new ae.Diff(Ue,""));for(var a=0,i=0,l=0,c="",u="";a<s.length;){switch(s[a][0]){case rt:l++,u+=s[a][1];break;case et:i++,c+=s[a][1];break;case Ue:if(i>=1&&l>=1){s.splice(a-i-l,i+l),a=a-i-l;for(var d=this.diff_main(c,u,!1,t),m=d.length-1;m>=0;m--)s.splice(a,0,d[m]);a=a+d.length}l=0,i=0,c="",u="";break}a++}return s.pop(),s};ae.prototype.diff_bisect_=function(o,e,t){for(var r=o.length,n=e.length,s=Math.ceil((r+n)/2),a=s,i=2*s,l=new Array(i),c=new Array(i),u=0;u<i;u++)l[u]=-1,c[u]=-1;l[a+1]=0,c[a+1]=0;for(var d=r-n,m=d%2!=0,x=0,h=0,v=0,w=0,_=0;_<s&&!(new Date().getTime()>t);_++){for(var A=-_+x;A<=_-h;A+=2){var U=a+A,L;A==-_||A!=_&&l[U-1]<l[U+1]?L=l[U+1]:L=l[U-1]+1;for(var R=L-A;L<r&&R<n&&o.charAt(L)==e.charAt(R);)L++,R++;if(l[U]=L,L>r)h+=2;else if(R>n)x+=2;else if(m){var O=a+d-A;if(O>=0&&O<i&&c[O]!=-1){var M=r-c[O];if(L>=M)return this.diff_bisectSplit_(o,e,L,R,t)}}}for(var E=-_+v;E<=_-w;E+=2){var O=a+E,M;E==-_||E!=_&&c[O-1]<c[O+1]?M=c[O+1]:M=c[O-1]+1;for(var F=M-E;M<r&&F<n&&o.charAt(r-M-1)==e.charAt(n-F-1);)M++,F++;if(c[O]=M,M>r)w+=2;else if(F>n)v+=2;else if(!m){var U=a+d-E;if(U>=0&&U<i&&l[U]!=-1){var L=l[U],R=a+L-U;if(M=r-M,L>=M)return this.diff_bisectSplit_(o,e,L,R,t)}}}}return[new ae.Diff(et,o),new ae.Diff(rt,e)]};ae.prototype.diff_bisectSplit_=function(o,e,t,r,n){var s=o.substring(0,t),a=e.substring(0,r),i=o.substring(t),l=e.substring(r),c=this.diff_main(s,a,!1,n),u=this.diff_main(i,l,!1,n);return c.concat(u)};ae.prototype.diff_linesToChars_=function(o,e){var t=[],r={};t[0]="";function n(l){for(var c="",u=0,d=-1,m=t.length;d<l.length-1;){d=l.indexOf(`
`,u),d==-1&&(d=l.length-1);var x=l.substring(u,d+1);(r.hasOwnProperty?r.hasOwnProperty(x):r[x]!==void 0)?c+=String.fromCharCode(r[x]):(m==s&&(x=l.substring(u),d=l.length),c+=String.fromCharCode(m),r[x]=m,t[m++]=x),u=d+1}return c}var s=4e4,a=n(o);s=65535;var i=n(e);return{chars1:a,chars2:i,lineArray:t}};ae.prototype.diff_charsToLines_=function(o,e){for(var t=0;t<o.length;t++){for(var r=o[t][1],n=[],s=0;s<r.length;s++)n[s]=e[r.charCodeAt(s)];o[t][1]=n.join("")}};ae.prototype.diff_commonPrefix=function(o,e){if(!o||!e||o.charAt(0)!=e.charAt(0))return 0;for(var t=0,r=Math.min(o.length,e.length),n=r,s=0;t<n;)o.substring(s,n)==e.substring(s,n)?(t=n,s=t):r=n,n=Math.floor((r-t)/2+t);return n};ae.prototype.diff_commonSuffix=function(o,e){if(!o||!e||o.charAt(o.length-1)!=e.charAt(e.length-1))return 0;for(var t=0,r=Math.min(o.length,e.length),n=r,s=0;t<n;)o.substring(o.length-n,o.length-s)==e.substring(e.length-n,e.length-s)?(t=n,s=t):r=n,n=Math.floor((r-t)/2+t);return n};ae.prototype.diff_commonOverlap_=function(o,e){var t=o.length,r=e.length;if(t==0||r==0)return 0;t>r?o=o.substring(t-r):t<r&&(e=e.substring(0,t));var n=Math.min(t,r);if(o==e)return n;for(var s=0,a=1;;){var i=o.substring(n-a),l=e.indexOf(i);if(l==-1)return s;a+=l,(l==0||o.substring(n-a)==e.substring(0,a))&&(s=a,a++)}};ae.prototype.diff_halfMatch_=function(o,e){if(this.Diff_Timeout<=0)return null;var t=o.length>e.length?o:e,r=o.length>e.length?e:o;if(t.length<4||r.length*2<t.length)return null;var n=this;function s(h,v,w){for(var _=h.substring(w,w+Math.floor(h.length/4)),A=-1,U="",L,R,O,M;(A=v.indexOf(_,A+1))!=-1;){var E=n.diff_commonPrefix(h.substring(w),v.substring(A)),F=n.diff_commonSuffix(h.substring(0,w),v.substring(0,A));U.length<F+E&&(U=v.substring(A-F,A)+v.substring(A,A+E),L=h.substring(0,w-F),R=h.substring(w+E),O=v.substring(0,A-F),M=v.substring(A+E))}return U.length*2>=h.length?[L,R,O,M,U]:null}var a=s(t,r,Math.ceil(t.length/4)),i=s(t,r,Math.ceil(t.length/2)),l;if(!a&&!i)return null;i?a?l=a[4].length>i[4].length?a:i:l=i:l=a;var c,u,d,m;o.length>e.length?(c=l[0],u=l[1],d=l[2],m=l[3]):(d=l[0],m=l[1],c=l[2],u=l[3]);var x=l[4];return[c,u,d,m,x]};ae.prototype.diff_cleanupSemantic=function(o){for(var e=!1,t=[],r=0,n=null,s=0,a=0,i=0,l=0,c=0;s<o.length;)o[s][0]==Ue?(t[r++]=s,a=l,i=c,l=0,c=0,n=o[s][1]):(o[s][0]==rt?l+=o[s][1].length:c+=o[s][1].length,n&&n.length<=Math.max(a,i)&&n.length<=Math.max(l,c)&&(o.splice(t[r-1],0,new ae.Diff(et,n)),o[t[r-1]+1][0]=rt,r--,r--,s=r>0?t[r-1]:-1,a=0,i=0,l=0,c=0,n=null,e=!0)),s++;for(e&&this.diff_cleanupMerge(o),this.diff_cleanupSemanticLossless(o),s=1;s<o.length;){if(o[s-1][0]==et&&o[s][0]==rt){var u=o[s-1][1],d=o[s][1],m=this.diff_commonOverlap_(u,d),x=this.diff_commonOverlap_(d,u);m>=x?(m>=u.length/2||m>=d.length/2)&&(o.splice(s,0,new ae.Diff(Ue,d.substring(0,m))),o[s-1][1]=u.substring(0,u.length-m),o[s+1][1]=d.substring(m),s++):(x>=u.length/2||x>=d.length/2)&&(o.splice(s,0,new ae.Diff(Ue,u.substring(0,x))),o[s-1][0]=rt,o[s-1][1]=d.substring(0,d.length-x),o[s+1][0]=et,o[s+1][1]=u.substring(x),s++),s++}s++}};ae.prototype.diff_cleanupSemanticLossless=function(o){function e(x,h){if(!x||!h)return 6;var v=x.charAt(x.length-1),w=h.charAt(0),_=v.match(ae.nonAlphaNumericRegex_),A=w.match(ae.nonAlphaNumericRegex_),U=_&&v.match(ae.whitespaceRegex_),L=A&&w.match(ae.whitespaceRegex_),R=U&&v.match(ae.linebreakRegex_),O=L&&w.match(ae.linebreakRegex_),M=R&&x.match(ae.blanklineEndRegex_),E=O&&h.match(ae.blanklineStartRegex_);return M||E?5:R||O?4:_&&!U&&L?3:U||L?2:_||A?1:0}for(var t=1;t<o.length-1;){if(o[t-1][0]==Ue&&o[t+1][0]==Ue){var r=o[t-1][1],n=o[t][1],s=o[t+1][1],a=this.diff_commonSuffix(r,n);if(a){var i=n.substring(n.length-a);r=r.substring(0,r.length-a),n=i+n.substring(0,n.length-a),s=i+s}for(var l=r,c=n,u=s,d=e(r,n)+e(n,s);n.charAt(0)===s.charAt(0);){r+=n.charAt(0),n=n.substring(1)+s.charAt(0),s=s.substring(1);var m=e(r,n)+e(n,s);m>=d&&(d=m,l=r,c=n,u=s)}o[t-1][1]!=l&&(l?o[t-1][1]=l:(o.splice(t-1,1),t--),o[t][1]=c,u?o[t+1][1]=u:(o.splice(t+1,1),t--))}t++}};ae.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;ae.whitespaceRegex_=/\s/;ae.linebreakRegex_=/[\r\n]/;ae.blanklineEndRegex_=/\n\r?\n$/;ae.blanklineStartRegex_=/^\r?\n\r?\n/;ae.prototype.diff_cleanupEfficiency=function(o){for(var e=!1,t=[],r=0,n=null,s=0,a=!1,i=!1,l=!1,c=!1;s<o.length;)o[s][0]==Ue?(o[s][1].length<this.Diff_EditCost&&(l||c)?(t[r++]=s,a=l,i=c,n=o[s][1]):(r=0,n=null),l=c=!1):(o[s][0]==et?c=!0:l=!0,n&&(a&&i&&l&&c||n.length<this.Diff_EditCost/2&&a+i+l+c==3)&&(o.splice(t[r-1],0,new ae.Diff(et,n)),o[t[r-1]+1][0]=rt,r--,n=null,a&&i?(l=c=!0,r=0):(r--,s=r>0?t[r-1]:-1,l=c=!1),e=!0)),s++;e&&this.diff_cleanupMerge(o)};ae.prototype.diff_cleanupMerge=function(o){o.push(new ae.Diff(Ue,""));for(var e=0,t=0,r=0,n="",s="",a;e<o.length;)switch(o[e][0]){case rt:r++,s+=o[e][1],e++;break;case et:t++,n+=o[e][1],e++;break;case Ue:t+r>1?(t!==0&&r!==0&&(a=this.diff_commonPrefix(s,n),a!==0&&(e-t-r>0&&o[e-t-r-1][0]==Ue?o[e-t-r-1][1]+=s.substring(0,a):(o.splice(0,0,new ae.Diff(Ue,s.substring(0,a))),e++),s=s.substring(a),n=n.substring(a)),a=this.diff_commonSuffix(s,n),a!==0&&(o[e][1]=s.substring(s.length-a)+o[e][1],s=s.substring(0,s.length-a),n=n.substring(0,n.length-a))),e-=t+r,o.splice(e,t+r),n.length&&(o.splice(e,0,new ae.Diff(et,n)),e++),s.length&&(o.splice(e,0,new ae.Diff(rt,s)),e++),e++):e!==0&&o[e-1][0]==Ue?(o[e-1][1]+=o[e][1],o.splice(e,1)):e++,r=0,t=0,n="",s="";break}o[o.length-1][1]===""&&o.pop();var i=!1;for(e=1;e<o.length-1;)o[e-1][0]==Ue&&o[e+1][0]==Ue&&(o[e][1].substring(o[e][1].length-o[e-1][1].length)==o[e-1][1]?(o[e][1]=o[e-1][1]+o[e][1].substring(0,o[e][1].length-o[e-1][1].length),o[e+1][1]=o[e-1][1]+o[e+1][1],o.splice(e-1,1),i=!0):o[e][1].substring(0,o[e+1][1].length)==o[e+1][1]&&(o[e-1][1]+=o[e+1][1],o[e][1]=o[e][1].substring(o[e+1][1].length)+o[e+1][1],o.splice(e+1,1),i=!0)),e++;i&&this.diff_cleanupMerge(o)};ae.prototype.diff_xIndex=function(o,e){var t=0,r=0,n=0,s=0,a;for(a=0;a<o.length&&(o[a][0]!==rt&&(t+=o[a][1].length),o[a][0]!==et&&(r+=o[a][1].length),!(t>e));a++)n=t,s=r;return o.length!=a&&o[a][0]===et?s:s+(e-n)};ae.prototype.diff_prettyHtml=function(o){for(var e=[],t=/&/g,r=/</g,n=/>/g,s=/\n/g,a=0;a<o.length;a++){var i=o[a][0],l=o[a][1],c=l.replace(t,"&amp;").replace(r,"&lt;").replace(n,"&gt;").replace(s,"&para;<br>");switch(i){case rt:e[a]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case et:e[a]='<del style="background:#ffe6e6;">'+c+"</del>";break;case Ue:e[a]="<span>"+c+"</span>";break}}return e.join("")};ae.prototype.diff_text1=function(o){for(var e=[],t=0;t<o.length;t++)o[t][0]!==rt&&(e[t]=o[t][1]);return e.join("")};ae.prototype.diff_text2=function(o){for(var e=[],t=0;t<o.length;t++)o[t][0]!==et&&(e[t]=o[t][1]);return e.join("")};ae.prototype.diff_levenshtein=function(o){for(var e=0,t=0,r=0,n=0;n<o.length;n++){var s=o[n][0],a=o[n][1];switch(s){case rt:t+=a.length;break;case et:r+=a.length;break;case Ue:e+=Math.max(t,r),t=0,r=0;break}}return e+=Math.max(t,r),e};ae.prototype.diff_toDelta=function(o){for(var e=[],t=0;t<o.length;t++)switch(o[t][0]){case rt:e[t]="+"+encodeURI(o[t][1]);break;case et:e[t]="-"+o[t][1].length;break;case Ue:e[t]="="+o[t][1].length;break}return e.join("	").replace(/%20/g," ")};ae.prototype.diff_fromDelta=function(o,e){for(var t=[],r=0,n=0,s=e.split(/\t/g),a=0;a<s.length;a++){var i=s[a].substring(1);switch(s[a].charAt(0)){case"+":try{t[r++]=new ae.Diff(rt,decodeURI(i))}catch(u){throw new Error("Illegal escape in diff_fromDelta: "+i)}break;case"-":case"=":var l=parseInt(i,10);if(isNaN(l)||l<0)throw new Error("Invalid number in diff_fromDelta: "+i);var c=o.substring(n,n+=l);s[a].charAt(0)=="="?t[r++]=new ae.Diff(Ue,c):t[r++]=new ae.Diff(et,c);break;default:if(s[a])throw new Error("Invalid diff operation in diff_fromDelta: "+s[a])}}if(n!=o.length)throw new Error("Delta length ("+n+") does not equal source text length ("+o.length+").");return t};ae.prototype.match_main=function(o,e,t){if(o==null||e==null||t==null)throw new Error("Null input. (match_main)");return t=Math.max(0,Math.min(t,o.length)),o==e?0:o.length?o.substring(t,t+e.length)==e?t:this.match_bitap_(o,e,t):-1};ae.prototype.match_bitap_=function(o,e,t){if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(e),n=this;function s(L,R){var O=L/e.length,M=Math.abs(t-R);return n.Match_Distance?O+M/n.Match_Distance:M?1:O}var a=this.Match_Threshold,i=o.indexOf(e,t);i!=-1&&(a=Math.min(s(0,i),a),i=o.lastIndexOf(e,t+e.length),i!=-1&&(a=Math.min(s(0,i),a)));var l=1<<e.length-1;i=-1;for(var c,u,d=e.length+o.length,m,x=0;x<e.length;x++){for(c=0,u=d;c<u;)s(x,t+u)<=a?c=u:d=u,u=Math.floor((d-c)/2+c);d=u;var h=Math.max(1,t-u+1),v=Math.min(t+u,o.length)+e.length,w=Array(v+2);w[v+1]=(1<<x)-1;for(var _=v;_>=h;_--){var A=r[o.charAt(_-1)];if(x===0?w[_]=(w[_+1]<<1|1)&A:w[_]=(w[_+1]<<1|1)&A|((m[_+1]|m[_])<<1|1)|m[_+1],w[_]&l){var U=s(x,_-1);if(U<=a)if(a=U,i=_-1,i>t)h=Math.max(1,2*t-i);else break}}if(s(x+1,t)>a)break;m=w}return i};ae.prototype.match_alphabet_=function(o){for(var e={},t=0;t<o.length;t++)e[o.charAt(t)]=0;for(var t=0;t<o.length;t++)e[o.charAt(t)]|=1<<o.length-t-1;return e};ae.prototype.patch_addContext_=function(o,e){if(e.length!=0){if(o.start2===null)throw Error("patch not initialized");for(var t=e.substring(o.start2,o.start2+o.length1),r=0;e.indexOf(t)!=e.lastIndexOf(t)&&t.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,t=e.substring(o.start2-r,o.start2+o.length1+r);r+=this.Patch_Margin;var n=e.substring(o.start2-r,o.start2);n&&o.diffs.unshift(new ae.Diff(Ue,n));var s=e.substring(o.start2+o.length1,o.start2+o.length1+r);s&&o.diffs.push(new ae.Diff(Ue,s)),o.start1-=n.length,o.start2-=n.length,o.length1+=n.length+s.length,o.length2+=n.length+s.length}};ae.prototype.patch_make=function(o,e,t){var r,n;if(typeof o=="string"&&typeof e=="string"&&typeof t=="undefined")r=o,n=this.diff_main(r,e,!0),n.length>2&&(this.diff_cleanupSemantic(n),this.diff_cleanupEfficiency(n));else if(o&&typeof o=="object"&&typeof e=="undefined"&&typeof t=="undefined")n=o,r=this.diff_text1(n);else if(typeof o=="string"&&e&&typeof e=="object"&&typeof t=="undefined")r=o,n=e;else if(typeof o=="string"&&typeof e=="string"&&t&&typeof t=="object")r=o,n=t;else throw new Error("Unknown call format to patch_make.");if(n.length===0)return[];for(var s=[],a=new ae.patch_obj,i=0,l=0,c=0,u=r,d=r,m=0;m<n.length;m++){var x=n[m][0],h=n[m][1];switch(!i&&x!==Ue&&(a.start1=l,a.start2=c),x){case rt:a.diffs[i++]=n[m],a.length2+=h.length,d=d.substring(0,c)+h+d.substring(c);break;case et:a.length1+=h.length,a.diffs[i++]=n[m],d=d.substring(0,c)+d.substring(c+h.length);break;case Ue:h.length<=2*this.Patch_Margin&&i&&n.length!=m+1?(a.diffs[i++]=n[m],a.length1+=h.length,a.length2+=h.length):h.length>=2*this.Patch_Margin&&i&&(this.patch_addContext_(a,u),s.push(a),a=new ae.patch_obj,i=0,u=d,l=c);break}x!==rt&&(l+=h.length),x!==et&&(c+=h.length)}return i&&(this.patch_addContext_(a,u),s.push(a)),s};ae.prototype.patch_deepCopy=function(o){for(var e=[],t=0;t<o.length;t++){var r=o[t],n=new ae.patch_obj;n.diffs=[];for(var s=0;s<r.diffs.length;s++)n.diffs[s]=new ae.Diff(r.diffs[s][0],r.diffs[s][1]);n.start1=r.start1,n.start2=r.start2,n.length1=r.length1,n.length2=r.length2,e[t]=n}return e};ae.prototype.patch_apply=function(o,e){if(o.length==0)return[e,[]];o=this.patch_deepCopy(o);var t=this.patch_addPadding(o);e=t+e+t,this.patch_splitMax(o);for(var r=0,n=[],s=0;s<o.length;s++){var a=o[s].start2+r,i=this.diff_text1(o[s].diffs),l,c=-1;if(i.length>this.Match_MaxBits?(l=this.match_main(e,i.substring(0,this.Match_MaxBits),a),l!=-1&&(c=this.match_main(e,i.substring(i.length-this.Match_MaxBits),a+i.length-this.Match_MaxBits),(c==-1||l>=c)&&(l=-1))):l=this.match_main(e,i,a),l==-1)n[s]=!1,r-=o[s].length2-o[s].length1;else{n[s]=!0,r=l-a;var u;if(c==-1?u=e.substring(l,l+i.length):u=e.substring(l,c+this.Match_MaxBits),i==u)e=e.substring(0,l)+this.diff_text2(o[s].diffs)+e.substring(l+i.length);else{var d=this.diff_main(i,u,!1);if(i.length>this.Match_MaxBits&&this.diff_levenshtein(d)/i.length>this.Patch_DeleteThreshold)n[s]=!1;else{this.diff_cleanupSemanticLossless(d);for(var m=0,x,h=0;h<o[s].diffs.length;h++){var v=o[s].diffs[h];v[0]!==Ue&&(x=this.diff_xIndex(d,m)),v[0]===rt?e=e.substring(0,l+x)+v[1]+e.substring(l+x):v[0]===et&&(e=e.substring(0,l+x)+e.substring(l+this.diff_xIndex(d,m+v[1].length))),v[0]!==et&&(m+=v[1].length)}}}}}return e=e.substring(t.length,e.length-t.length),[e,n]};ae.prototype.patch_addPadding=function(o){for(var e=this.Patch_Margin,t="",r=1;r<=e;r++)t+=String.fromCharCode(r);for(var r=0;r<o.length;r++)o[r].start1+=e,o[r].start2+=e;var n=o[0],s=n.diffs;if(s.length==0||s[0][0]!=Ue)s.unshift(new ae.Diff(Ue,t)),n.start1-=e,n.start2-=e,n.length1+=e,n.length2+=e;else if(e>s[0][1].length){var a=e-s[0][1].length;s[0][1]=t.substring(s[0][1].length)+s[0][1],n.start1-=a,n.start2-=a,n.length1+=a,n.length2+=a}if(n=o[o.length-1],s=n.diffs,s.length==0||s[s.length-1][0]!=Ue)s.push(new ae.Diff(Ue,t)),n.length1+=e,n.length2+=e;else if(e>s[s.length-1][1].length){var a=e-s[s.length-1][1].length;s[s.length-1][1]+=t.substring(0,a),n.length1+=a,n.length2+=a}return t};ae.prototype.patch_splitMax=function(o){for(var e=this.Match_MaxBits,t=0;t<o.length;t++)if(!(o[t].length1<=e)){var r=o[t];o.splice(t--,1);for(var n=r.start1,s=r.start2,a="";r.diffs.length!==0;){var i=new ae.patch_obj,l=!0;for(i.start1=n-a.length,i.start2=s-a.length,a!==""&&(i.length1=i.length2=a.length,i.diffs.push(new ae.Diff(Ue,a)));r.diffs.length!==0&&i.length1<e-this.Patch_Margin;){var c=r.diffs[0][0],u=r.diffs[0][1];c===rt?(i.length2+=u.length,s+=u.length,i.diffs.push(r.diffs.shift()),l=!1):c===et&&i.diffs.length==1&&i.diffs[0][0]==Ue&&u.length>2*e?(i.length1+=u.length,n+=u.length,l=!1,i.diffs.push(new ae.Diff(c,u)),r.diffs.shift()):(u=u.substring(0,e-i.length1-this.Patch_Margin),i.length1+=u.length,n+=u.length,c===Ue?(i.length2+=u.length,s+=u.length):l=!1,i.diffs.push(new ae.Diff(c,u)),u==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(u.length))}a=this.diff_text2(i.diffs),a=a.substring(a.length-this.Patch_Margin);var d=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);d!==""&&(i.length1+=d.length,i.length2+=d.length,i.diffs.length!==0&&i.diffs[i.diffs.length-1][0]===Ue?i.diffs[i.diffs.length-1][1]+=d:i.diffs.push(new ae.Diff(Ue,d))),l||o.splice(++t,0,i)}}};ae.prototype.patch_toText=function(o){for(var e=[],t=0;t<o.length;t++)e[t]=o[t];return e.join("")};ae.prototype.patch_fromText=function(o){var e=[];if(!o)return e;for(var t=o.split(`
`),r=0,n=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<t.length;){var s=t[r].match(n);if(!s)throw new Error("Invalid patch string: "+t[r]);var a=new ae.patch_obj;for(e.push(a),a.start1=parseInt(s[1],10),s[2]===""?(a.start1--,a.length1=1):s[2]=="0"?a.length1=0:(a.start1--,a.length1=parseInt(s[2],10)),a.start2=parseInt(s[3],10),s[4]===""?(a.start2--,a.length2=1):s[4]=="0"?a.length2=0:(a.start2--,a.length2=parseInt(s[4],10)),r++;r<t.length;){var i=t[r].charAt(0);try{var l=decodeURI(t[r].substring(1))}catch(c){throw new Error("Illegal escape in patch_fromText: "+l)}if(i=="-")a.diffs.push(new ae.Diff(et,l));else if(i=="+")a.diffs.push(new ae.Diff(rt,l));else if(i==" ")a.diffs.push(new ae.Diff(Ue,l));else{if(i=="@")break;if(i!=="")throw new Error('Invalid patch mode "'+i+'" in: '+l)}r++}}return e};ae.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0};ae.patch_obj.prototype.toString=function(){var o,e;this.length1===0?o=this.start1+",0":this.length1==1?o=this.start1+1:o=this.start1+1+","+this.length1,this.length2===0?e=this.start2+",0":this.length2==1?e=this.start2+1:e=this.start2+1+","+this.length2;for(var t=["@@ -"+o+" +"+e+` @@
`],r,n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case rt:r="+";break;case et:r="-";break;case Ue:r=" ";break}t[n+1]=r+encodeURI(this.diffs[n][1])+`
`}return t.join("").replace(/%20/g," ")};Us.exports=ae;Us.exports.diff_match_patch=ae;Us.exports.DIFF_DELETE=et;Us.exports.DIFF_INSERT=rt;Us.exports.DIFF_EQUAL=Ue});var my=_i((K6,py)=>{var fy=require("url").parse,aT=require("events"),iT=require("https"),lT=require("http"),fT=require("util"),cT=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],dy=[239,187,191],uT=58,dT=32,cy=10,pT=13,uy=1024*256,mT=/^(cookie|authorization)$/i;function hT(o){return dy.every(function(e,t){return o[t]===e})}function xt(o,e){var t=xt.CONNECTING,r=e&&e.headers,n=!1;Object.defineProperty(this,"readyState",{get:function(){return t}}),Object.defineProperty(this,"url",{get:function(){return o}});var s=this;s.reconnectInterval=1e3,s.connectionInProgress=!1;function a(w){t!==xt.CLOSED&&(t=xt.CONNECTING,h("error",new Wa("error",{message:w})),m&&(o=m,m=null,n=!1),setTimeout(function(){t!==xt.CONNECTING||s.connectionInProgress||(s.connectionInProgress=!0,x())},s.reconnectInterval))}var i,l="";r&&r["Last-Event-ID"]&&(l=r["Last-Event-ID"],delete r["Last-Event-ID"]);var c=!1,u="",d="",m=null;function x(){var w=fy(o),_=w.protocol==="https:";if(w.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},l&&(w.headers["Last-Event-ID"]=l),r){var A=n?xT(r):r;for(var U in A){var L=A[U];L&&(w.headers[U]=L)}}w.rejectUnauthorized=!(e&&!e.rejectUnauthorized),e&&e.createConnection!==void 0&&(w.createConnection=e.createConnection);var R=e&&e.proxy;if(R){var O=fy(e.proxy);_=O.protocol==="https:",w.protocol=_?"https:":"http:",w.path=o,w.headers.Host=w.host,w.hostname=O.hostname,w.host=O.host,w.port=O.port}if(e&&e.https){for(var M in e.https)if(cT.indexOf(M)!==-1){var E=e.https[M];E!==void 0&&(w[M]=E)}}e&&e.withCredentials!==void 0&&(w.withCredentials=e.withCredentials),i=(_?iT:lT).request(w,function(F){if(s.connectionInProgress=!1,F.statusCode===500||F.statusCode===502||F.statusCode===503||F.statusCode===504){h("error",new Wa("error",{status:F.statusCode,message:F.statusMessage})),a();return}if(F.statusCode===301||F.statusCode===302||F.statusCode===307){var q=F.headers.location;if(!q){h("error",new Wa("error",{status:F.statusCode,message:F.statusMessage}));return}var J=new URL(o).origin,G=new URL(q).origin;n=J!==G,F.statusCode===307&&(m=o),o=q,process.nextTick(x);return}if(F.statusCode!==200)return h("error",new Wa("error",{status:F.statusCode,message:F.statusMessage})),s.close();t=xt.OPEN,F.on("close",function(){F.removeAllListeners("close"),F.removeAllListeners("end"),a()}),F.on("end",function(){F.removeAllListeners("close"),F.removeAllListeners("end"),a()}),h("open",new Wa("open"));var z,W,oe=0,Ie=-1,Pe=0,Ee=0;F.on("data",function(Ye){z?(Ye.length>z.length-Ee&&(Pe=z.length*2+Ye.length,Pe>uy&&(Pe=z.length+Ye.length+uy),W=Buffer.alloc(Pe),z.copy(W,0,0,Ee),z=W),Ye.copy(z,Ee),Ee+=Ye.length):(z=Ye,hT(z)&&(z=z.slice(dy.length)),Ee=z.length);for(var Fe=0,de=Ee;Fe<de;){c&&(z[Fe]===cy&&++Fe,c=!1);for(var fe=-1,te=Ie,$e,Lt=oe;fe<0&&Lt<de;++Lt)$e=z[Lt],$e===uT?te<0&&(te=Lt-Fe):$e===pT?(c=!0,fe=Lt-Fe):$e===cy&&(fe=Lt-Fe);if(fe<0){oe=de-Fe,Ie=te;break}else oe=0,Ie=-1;v(z,Fe,te,fe),Fe+=fe+1}Fe===de?(z=void 0,Ee=0):Fe>0&&(z=z.slice(Fe,Ee),Ee=z.length)})}),i.on("error",function(F){s.connectionInProgress=!1,a(F.message)}),i.setNoDelay&&i.setNoDelay(!0),i.end()}x();function h(){s.listeners(arguments[0]).length>0&&s.emit.apply(s,arguments)}this._close=function(){t!==xt.CLOSED&&(t=xt.CLOSED,i.abort&&i.abort(),i.xhr&&i.xhr.abort&&i.xhr.abort())};function v(w,_,A,U){if(U===0){if(u.length>0){var L=d||"message";h(L,new gT(L,{data:u.slice(0,-1),lastEventId:l,origin:new URL(o).origin})),u=""}d=void 0}else if(A>0){var R=A<0,O=0,M=w.slice(_,_+(R?U:A)).toString();R?O=U:w[_+A+1]!==dT?O=A+1:O=A+2,_+=O;var E=U-O,F=w.slice(_,_+E).toString();if(M==="data")u+=F+`
`;else if(M==="event")d=F;else if(M==="id")l=F;else if(M==="retry"){var q=parseInt(F,10);Number.isNaN(q)||(s.reconnectInterval=q)}}}}py.exports=xt;fT.inherits(xt,aT.EventEmitter);xt.prototype.constructor=xt;["open","error","message"].forEach(function(o){Object.defineProperty(xt.prototype,"on"+o,{get:function(){var t=this.listeners(o)[0];return t?t._listener?t._listener:t:void 0},set:function(t){this.removeAllListeners(o),this.addEventListener(o,t)}})});Object.defineProperty(xt,"CONNECTING",{enumerable:!0,value:0});Object.defineProperty(xt,"OPEN",{enumerable:!0,value:1});Object.defineProperty(xt,"CLOSED",{enumerable:!0,value:2});xt.prototype.CONNECTING=0;xt.prototype.OPEN=1;xt.prototype.CLOSED=2;xt.prototype.close=function(){this._close()};xt.prototype.addEventListener=function(e,t){typeof t=="function"&&(t._listener=t,this.on(e,t))};xt.prototype.dispatchEvent=function(e){if(!e.type)throw new Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(e.type,e.detail)};xt.prototype.removeEventListener=function(e,t){typeof t=="function"&&(t._listener=void 0,this.removeListener(e,t))};function Wa(o,e){if(Object.defineProperty(this,"type",{writable:!1,value:o,enumerable:!0}),e)for(var t in e)e.hasOwnProperty(t)&&Object.defineProperty(this,t,{writable:!1,value:e[t],enumerable:!0})}function gT(o,e){Object.defineProperty(this,"type",{writable:!1,value:o,enumerable:!0});for(var t in e)e.hasOwnProperty(t)&&Object.defineProperty(this,t,{writable:!1,value:e[t],enumerable:!0})}function xT(o){var e={};for(var t in o)mT.test(t)||(e[t]=o[t]);return e}});var Hy=_i((ap,Ws)=>{(function(o,e){typeof ap=="object"&&typeof Ws!="undefined"?Ws.exports=e():typeof define=="function"&&define.amd?define(e):o.moment=e()})(ap,function(){"use strict";var o;function e(){return o.apply(null,arguments)}function t(f){o=f}function r(f){return f instanceof Array||Object.prototype.toString.call(f)==="[object Array]"}function n(f){return f!=null&&Object.prototype.toString.call(f)==="[object Object]"}function s(f,p){return Object.prototype.hasOwnProperty.call(f,p)}function a(f){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(f).length===0;var p;for(p in f)if(s(f,p))return!1;return!0}function i(f){return f===void 0}function l(f){return typeof f=="number"||Object.prototype.toString.call(f)==="[object Number]"}function c(f){return f instanceof Date||Object.prototype.toString.call(f)==="[object Date]"}function u(f,p){var g=[],y,S=f.length;for(y=0;y<S;++y)g.push(p(f[y],y));return g}function d(f,p){for(var g in p)s(p,g)&&(f[g]=p[g]);return s(p,"toString")&&(f.toString=p.toString),s(p,"valueOf")&&(f.valueOf=p.valueOf),f}function m(f,p,g,y){return pm(f,p,g,y,!0).utc()}function x(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function h(f){return f._pf==null&&(f._pf=x()),f._pf}var v;Array.prototype.some?v=Array.prototype.some:v=function(f){var p=Object(this),g=p.length>>>0,y;for(y=0;y<g;y++)if(y in p&&f.call(this,p[y],y,p))return!0;return!1};function w(f){if(f._isValid==null){var p=h(f),g=v.call(p.parsedDateParts,function(S){return S!=null}),y=!isNaN(f._d.getTime())&&p.overflow<0&&!p.empty&&!p.invalidEra&&!p.invalidMonth&&!p.invalidWeekday&&!p.weekdayMismatch&&!p.nullInput&&!p.invalidFormat&&!p.userInvalidated&&(!p.meridiem||p.meridiem&&g);if(f._strict&&(y=y&&p.charsLeftOver===0&&p.unusedTokens.length===0&&p.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(f))f._isValid=y;else return y}return f._isValid}function _(f){var p=m(NaN);return f!=null?d(h(p),f):h(p).userInvalidated=!0,p}var A=e.momentProperties=[],U=!1;function L(f,p){var g,y,S,$=A.length;if(i(p._isAMomentObject)||(f._isAMomentObject=p._isAMomentObject),i(p._i)||(f._i=p._i),i(p._f)||(f._f=p._f),i(p._l)||(f._l=p._l),i(p._strict)||(f._strict=p._strict),i(p._tzm)||(f._tzm=p._tzm),i(p._isUTC)||(f._isUTC=p._isUTC),i(p._offset)||(f._offset=p._offset),i(p._pf)||(f._pf=h(p)),i(p._locale)||(f._locale=p._locale),$>0)for(g=0;g<$;g++)y=A[g],S=p[y],i(S)||(f[y]=S);return f}function R(f){L(this,f),this._d=new Date(f._d!=null?f._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),U===!1&&(U=!0,e.updateOffset(this),U=!1)}function O(f){return f instanceof R||f!=null&&f._isAMomentObject!=null}function M(f){e.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+f)}function E(f,p){var g=!0;return d(function(){if(e.deprecationHandler!=null&&e.deprecationHandler(null,f),g){var y=[],S,$,j,Se=arguments.length;for($=0;$<Se;$++){if(S="",typeof arguments[$]=="object"){S+=`
[`+$+"] ";for(j in arguments[0])s(arguments[0],j)&&(S+=j+": "+arguments[0][j]+", ");S=S.slice(0,-2)}else S=arguments[$];y.push(S)}M(f+`
Arguments: `+Array.prototype.slice.call(y).join("")+`
`+new Error().stack),g=!1}return p.apply(this,arguments)},p)}var F={};function q(f,p){e.deprecationHandler!=null&&e.deprecationHandler(f,p),F[f]||(M(p),F[f]=!0)}e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;function J(f){return typeof Function!="undefined"&&f instanceof Function||Object.prototype.toString.call(f)==="[object Function]"}function G(f){var p,g;for(g in f)s(f,g)&&(p=f[g],J(p)?this[g]=p:this["_"+g]=p);this._config=f,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function z(f,p){var g=d({},f),y;for(y in p)s(p,y)&&(n(f[y])&&n(p[y])?(g[y]={},d(g[y],f[y]),d(g[y],p[y])):p[y]!=null?g[y]=p[y]:delete g[y]);for(y in f)s(f,y)&&!s(p,y)&&n(f[y])&&(g[y]=d({},g[y]));return g}function W(f){f!=null&&this.set(f)}var oe;Object.keys?oe=Object.keys:oe=function(f){var p,g=[];for(p in f)s(f,p)&&g.push(p);return g};var Ie={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Pe(f,p,g){var y=this._calendar[f]||this._calendar.sameElse;return J(y)?y.call(p,g):y}function Ee(f,p,g){var y=""+Math.abs(f),S=p-y.length,$=f>=0;return($?g?"+":"":"-")+Math.pow(10,Math.max(0,S)).toString().substr(1)+y}var Ye=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Fe=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,de={},fe={};function te(f,p,g,y){var S=y;typeof y=="string"&&(S=function(){return this[y]()}),f&&(fe[f]=S),p&&(fe[p[0]]=function(){return Ee(S.apply(this,arguments),p[1],p[2])}),g&&(fe[g]=function(){return this.localeData().ordinal(S.apply(this,arguments),f)})}function $e(f){return f.match(/\[[\s\S]/)?f.replace(/^\[|\]$/g,""):f.replace(/\\/g,"")}function Lt(f){var p=f.match(Ye),g,y;for(g=0,y=p.length;g<y;g++)fe[p[g]]?p[g]=fe[p[g]]:p[g]=$e(p[g]);return function(S){var $="",j;for(j=0;j<y;j++)$+=J(p[j])?p[j].call(S,f):p[j];return $}}function Mt(f,p){return f.isValid()?(p=Rt(p,f.localeData()),de[p]=de[p]||Lt(p),de[p](f)):f.localeData().invalidDate()}function Rt(f,p){var g=5;function y(S){return p.longDateFormat(S)||S}for(Fe.lastIndex=0;g>=0&&Fe.test(f);)f=f.replace(Fe,y),Fe.lastIndex=0,g-=1;return f}var ht={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function gt(f){var p=this._longDateFormat[f],g=this._longDateFormat[f.toUpperCase()];return p||!g?p:(this._longDateFormat[f]=g.match(Ye).map(function(y){return y==="MMMM"||y==="MM"||y==="DD"||y==="dddd"?y.slice(1):y}).join(""),this._longDateFormat[f])}var dt="Invalid date";function qt(){return this._invalidDate}var un="%d",Nn=/\d{1,2}/;function js(f){return this._ordinal.replace("%d",f)}var Ys={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Hn(f,p,g,y){var S=this._relativeTime[g];return J(S)?S(f,p,g,y):S.replace(/%d/i,f)}function Js(f,p){var g=this._relativeTime[f>0?"future":"past"];return J(g)?g(p):g.replace(/%s/i,p)}var _r={};function ot(f,p){var g=f.toLowerCase();_r[g]=_r[g+"s"]=_r[p]=f}function Nt(f){return typeof f=="string"?_r[f]||_r[f.toLowerCase()]:void 0}function po(f){var p={},g,y;for(y in f)s(f,y)&&(g=Nt(y),g&&(p[g]=f[y]));return p}var dn={};function ne(f,p){dn[f]=p}function We(f){var p=[],g;for(g in f)s(f,g)&&p.push({unit:g,priority:dn[g]});return p.sort(function(y,S){return y.priority-S.priority}),p}function nt(f){return f%4===0&&f%100!==0||f%400===0}function tt(f){return f<0?Math.ceil(f)||0:Math.floor(f)}function Ae(f){var p=+f,g=0;return p!==0&&isFinite(p)&&(g=tt(p)),g}function jr(f,p){return function(g){return g!=null?(ri(this,f,g),e.updateOffset(this,p),this):Yr(this,f)}}function Yr(f,p){return f.isValid()?f._d["get"+(f._isUTC?"UTC":"")+p]():NaN}function ri(f,p,g){f.isValid()&&!isNaN(g)&&(p==="FullYear"&&nt(f.year())&&f.month()===1&&f.date()===29?(g=Ae(g),f._d["set"+(f._isUTC?"UTC":"")+p](g,f.month(),fi(g,f.month()))):f._d["set"+(f._isUTC?"UTC":"")+p](g))}function Sf(f){return f=Nt(f),J(this[f])?this[f]():this}function kf(f,p){if(typeof f=="object"){f=po(f);var g=We(f),y,S=g.length;for(y=0;y<S;y++)this[g[y].unit](f[g[y].unit])}else if(f=Nt(f),J(this[f]))return this[f](p);return this}var oi=/\d/,Wt=/\d\d/,ni=/\d{3}/,Xs=/\d{4}/,Y=/[+-]?\d{6}/,ce=/\d\d?/,st=/\d\d\d\d?/,mo=/\d\d\d\d\d\d?/,nr=/\d{1,3}/,Lf=/\d{1,4}/,si=/[+-]?\d{1,6}/,Vn=/\d+/,ai=/[+-]?\d+/,s_=/Z|[+-]\d\d:?\d\d/gi,ii=/Z|[+-]\d\d(?::?\d\d)?/gi,a_=/[+-]?\d+(\.\d{1,3})?/,Qs=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,li;li={};function pe(f,p,g){li[f]=J(p)?p:function(y,S){return y&&g?g:p}}function i_(f,p){return s(li,f)?li[f](p._strict,p._locale):new RegExp(l_(f))}function l_(f){return dr(f.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(p,g,y,S,$){return g||y||S||$}))}function dr(f){return f.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var If={};function Xe(f,p){var g,y=p,S;for(typeof f=="string"&&(f=[f]),l(p)&&(y=function($,j){j[p]=Ae($)}),S=f.length,g=0;g<S;g++)If[f[g]]=y}function Zs(f,p){Xe(f,function(g,y,S,$){S._w=S._w||{},p(g,S._w,S,$)})}function f_(f,p,g){p!=null&&s(If,f)&&If[f](p,g._a,g,f)}var Ht=0,ho=1,Jr=2,vt=3,Er=4,go=5,pn=6,c_=7,u_=8;function d_(f,p){return(f%p+p)%p}var yt;Array.prototype.indexOf?yt=Array.prototype.indexOf:yt=function(f){var p;for(p=0;p<this.length;++p)if(this[p]===f)return p;return-1};function fi(f,p){if(isNaN(f)||isNaN(p))return NaN;var g=d_(p,12);return f+=(p-g)/12,g===1?nt(f)?29:28:31-g%7%2}te("M",["MM",2],"Mo",function(){return this.month()+1}),te("MMM",0,0,function(f){return this.localeData().monthsShort(this,f)}),te("MMMM",0,0,function(f){return this.localeData().months(this,f)}),ot("month","M"),ne("month",8),pe("M",ce),pe("MM",ce,Wt),pe("MMM",function(f,p){return p.monthsShortRegex(f)}),pe("MMMM",function(f,p){return p.monthsRegex(f)}),Xe(["M","MM"],function(f,p){p[ho]=Ae(f)-1}),Xe(["MMM","MMMM"],function(f,p,g,y){var S=g._locale.monthsParse(f,y,g._strict);S!=null?p[ho]=S:h(g).invalidMonth=f});var p_="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Qp="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Zp=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,m_=Qs,h_=Qs;function g_(f,p){return f?r(this._months)?this._months[f.month()]:this._months[(this._months.isFormat||Zp).test(p)?"format":"standalone"][f.month()]:r(this._months)?this._months:this._months.standalone}function x_(f,p){return f?r(this._monthsShort)?this._monthsShort[f.month()]:this._monthsShort[Zp.test(p)?"format":"standalone"][f.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function y_(f,p,g){var y,S,$,j=f.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],y=0;y<12;++y)$=m([2e3,y]),this._shortMonthsParse[y]=this.monthsShort($,"").toLocaleLowerCase(),this._longMonthsParse[y]=this.months($,"").toLocaleLowerCase();return g?p==="MMM"?(S=yt.call(this._shortMonthsParse,j),S!==-1?S:null):(S=yt.call(this._longMonthsParse,j),S!==-1?S:null):p==="MMM"?(S=yt.call(this._shortMonthsParse,j),S!==-1?S:(S=yt.call(this._longMonthsParse,j),S!==-1?S:null)):(S=yt.call(this._longMonthsParse,j),S!==-1?S:(S=yt.call(this._shortMonthsParse,j),S!==-1?S:null))}function b_(f,p,g){var y,S,$;if(this._monthsParseExact)return y_.call(this,f,p,g);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),y=0;y<12;y++){if(S=m([2e3,y]),g&&!this._longMonthsParse[y]&&(this._longMonthsParse[y]=new RegExp("^"+this.months(S,"").replace(".","")+"$","i"),this._shortMonthsParse[y]=new RegExp("^"+this.monthsShort(S,"").replace(".","")+"$","i")),!g&&!this._monthsParse[y]&&($="^"+this.months(S,"")+"|^"+this.monthsShort(S,""),this._monthsParse[y]=new RegExp($.replace(".",""),"i")),g&&p==="MMMM"&&this._longMonthsParse[y].test(f))return y;if(g&&p==="MMM"&&this._shortMonthsParse[y].test(f))return y;if(!g&&this._monthsParse[y].test(f))return y}}function em(f,p){var g;if(!f.isValid())return f;if(typeof p=="string"){if(/^\d+$/.test(p))p=Ae(p);else if(p=f.localeData().monthsParse(p),!l(p))return f}return g=Math.min(f.date(),fi(f.year(),p)),f._d["set"+(f._isUTC?"UTC":"")+"Month"](p,g),f}function tm(f){return f!=null?(em(this,f),e.updateOffset(this,!0),this):Yr(this,"Month")}function w_(){return fi(this.year(),this.month())}function __(f){return this._monthsParseExact?(s(this,"_monthsRegex")||rm.call(this),f?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=m_),this._monthsShortStrictRegex&&f?this._monthsShortStrictRegex:this._monthsShortRegex)}function v_(f){return this._monthsParseExact?(s(this,"_monthsRegex")||rm.call(this),f?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=h_),this._monthsStrictRegex&&f?this._monthsStrictRegex:this._monthsRegex)}function rm(){function f(j,Se){return Se.length-j.length}var p=[],g=[],y=[],S,$;for(S=0;S<12;S++)$=m([2e3,S]),p.push(this.monthsShort($,"")),g.push(this.months($,"")),y.push(this.months($,"")),y.push(this.monthsShort($,""));for(p.sort(f),g.sort(f),y.sort(f),S=0;S<12;S++)p[S]=dr(p[S]),g[S]=dr(g[S]);for(S=0;S<24;S++)y[S]=dr(y[S]);this._monthsRegex=new RegExp("^("+y.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+g.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+p.join("|")+")","i")}te("Y",0,0,function(){var f=this.year();return f<=9999?Ee(f,4):"+"+f}),te(0,["YY",2],0,function(){return this.year()%100}),te(0,["YYYY",4],0,"year"),te(0,["YYYYY",5],0,"year"),te(0,["YYYYYY",6,!0],0,"year"),ot("year","y"),ne("year",1),pe("Y",ai),pe("YY",ce,Wt),pe("YYYY",Lf,Xs),pe("YYYYY",si,Y),pe("YYYYYY",si,Y),Xe(["YYYYY","YYYYYY"],Ht),Xe("YYYY",function(f,p){p[Ht]=f.length===2?e.parseTwoDigitYear(f):Ae(f)}),Xe("YY",function(f,p){p[Ht]=e.parseTwoDigitYear(f)}),Xe("Y",function(f,p){p[Ht]=parseInt(f,10)});function ea(f){return nt(f)?366:365}e.parseTwoDigitYear=function(f){return Ae(f)+(Ae(f)>68?1900:2e3)};var om=jr("FullYear",!0);function S_(){return nt(this.year())}function k_(f,p,g,y,S,$,j){var Se;return f<100&&f>=0?(Se=new Date(f+400,p,g,y,S,$,j),isFinite(Se.getFullYear())&&Se.setFullYear(f)):Se=new Date(f,p,g,y,S,$,j),Se}function ta(f){var p,g;return f<100&&f>=0?(g=Array.prototype.slice.call(arguments),g[0]=f+400,p=new Date(Date.UTC.apply(null,g)),isFinite(p.getUTCFullYear())&&p.setUTCFullYear(f)):p=new Date(Date.UTC.apply(null,arguments)),p}function ci(f,p,g){var y=7+p-g,S=(7+ta(f,0,y).getUTCDay()-p)%7;return-S+y-1}function nm(f,p,g,y,S){var $=(7+g-y)%7,j=ci(f,y,S),Se=1+7*(p-1)+$+j,Be,Qe;return Se<=0?(Be=f-1,Qe=ea(Be)+Se):Se>ea(f)?(Be=f+1,Qe=Se-ea(f)):(Be=f,Qe=Se),{year:Be,dayOfYear:Qe}}function ra(f,p,g){var y=ci(f.year(),p,g),S=Math.floor((f.dayOfYear()-y-1)/7)+1,$,j;return S<1?(j=f.year()-1,$=S+xo(j,p,g)):S>xo(f.year(),p,g)?($=S-xo(f.year(),p,g),j=f.year()+1):(j=f.year(),$=S),{week:$,year:j}}function xo(f,p,g){var y=ci(f,p,g),S=ci(f+1,p,g);return(ea(f)-y+S)/7}te("w",["ww",2],"wo","week"),te("W",["WW",2],"Wo","isoWeek"),ot("week","w"),ot("isoWeek","W"),ne("week",5),ne("isoWeek",5),pe("w",ce),pe("ww",ce,Wt),pe("W",ce),pe("WW",ce,Wt),Zs(["w","ww","W","WW"],function(f,p,g,y){p[y.substr(0,1)]=Ae(f)});function L_(f){return ra(f,this._week.dow,this._week.doy).week}var I_={dow:0,doy:6};function C_(){return this._week.dow}function T_(){return this._week.doy}function D_(f){var p=this.localeData().week(this);return f==null?p:this.add((f-p)*7,"d")}function P_(f){var p=ra(this,1,4).week;return f==null?p:this.add((f-p)*7,"d")}te("d",0,"do","day"),te("dd",0,0,function(f){return this.localeData().weekdaysMin(this,f)}),te("ddd",0,0,function(f){return this.localeData().weekdaysShort(this,f)}),te("dddd",0,0,function(f){return this.localeData().weekdays(this,f)}),te("e",0,0,"weekday"),te("E",0,0,"isoWeekday"),ot("day","d"),ot("weekday","e"),ot("isoWeekday","E"),ne("day",11),ne("weekday",11),ne("isoWeekday",11),pe("d",ce),pe("e",ce),pe("E",ce),pe("dd",function(f,p){return p.weekdaysMinRegex(f)}),pe("ddd",function(f,p){return p.weekdaysShortRegex(f)}),pe("dddd",function(f,p){return p.weekdaysRegex(f)}),Zs(["dd","ddd","dddd"],function(f,p,g,y){var S=g._locale.weekdaysParse(f,y,g._strict);S!=null?p.d=S:h(g).invalidWeekday=f}),Zs(["d","e","E"],function(f,p,g,y){p[y]=Ae(f)});function A_(f,p){return typeof f!="string"?f:isNaN(f)?(f=p.weekdaysParse(f),typeof f=="number"?f:null):parseInt(f,10)}function E_(f,p){return typeof f=="string"?p.weekdaysParse(f)%7||7:isNaN(f)?null:f}function Cf(f,p){return f.slice(p,7).concat(f.slice(0,p))}var M_="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),sm="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),R_="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),F_=Qs,O_=Qs,U_=Qs;function $_(f,p){var g=r(this._weekdays)?this._weekdays:this._weekdays[f&&f!==!0&&this._weekdays.isFormat.test(p)?"format":"standalone"];return f===!0?Cf(g,this._week.dow):f?g[f.day()]:g}function B_(f){return f===!0?Cf(this._weekdaysShort,this._week.dow):f?this._weekdaysShort[f.day()]:this._weekdaysShort}function N_(f){return f===!0?Cf(this._weekdaysMin,this._week.dow):f?this._weekdaysMin[f.day()]:this._weekdaysMin}function H_(f,p,g){var y,S,$,j=f.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],y=0;y<7;++y)$=m([2e3,1]).day(y),this._minWeekdaysParse[y]=this.weekdaysMin($,"").toLocaleLowerCase(),this._shortWeekdaysParse[y]=this.weekdaysShort($,"").toLocaleLowerCase(),this._weekdaysParse[y]=this.weekdays($,"").toLocaleLowerCase();return g?p==="dddd"?(S=yt.call(this._weekdaysParse,j),S!==-1?S:null):p==="ddd"?(S=yt.call(this._shortWeekdaysParse,j),S!==-1?S:null):(S=yt.call(this._minWeekdaysParse,j),S!==-1?S:null):p==="dddd"?(S=yt.call(this._weekdaysParse,j),S!==-1||(S=yt.call(this._shortWeekdaysParse,j),S!==-1)?S:(S=yt.call(this._minWeekdaysParse,j),S!==-1?S:null)):p==="ddd"?(S=yt.call(this._shortWeekdaysParse,j),S!==-1||(S=yt.call(this._weekdaysParse,j),S!==-1)?S:(S=yt.call(this._minWeekdaysParse,j),S!==-1?S:null)):(S=yt.call(this._minWeekdaysParse,j),S!==-1||(S=yt.call(this._weekdaysParse,j),S!==-1)?S:(S=yt.call(this._shortWeekdaysParse,j),S!==-1?S:null))}function V_(f,p,g){var y,S,$;if(this._weekdaysParseExact)return H_.call(this,f,p,g);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),y=0;y<7;y++){if(S=m([2e3,1]).day(y),g&&!this._fullWeekdaysParse[y]&&(this._fullWeekdaysParse[y]=new RegExp("^"+this.weekdays(S,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[y]=new RegExp("^"+this.weekdaysShort(S,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[y]=new RegExp("^"+this.weekdaysMin(S,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[y]||($="^"+this.weekdays(S,"")+"|^"+this.weekdaysShort(S,"")+"|^"+this.weekdaysMin(S,""),this._weekdaysParse[y]=new RegExp($.replace(".",""),"i")),g&&p==="dddd"&&this._fullWeekdaysParse[y].test(f))return y;if(g&&p==="ddd"&&this._shortWeekdaysParse[y].test(f))return y;if(g&&p==="dd"&&this._minWeekdaysParse[y].test(f))return y;if(!g&&this._weekdaysParse[y].test(f))return y}}function q_(f){if(!this.isValid())return f!=null?this:NaN;var p=this._isUTC?this._d.getUTCDay():this._d.getDay();return f!=null?(f=A_(f,this.localeData()),this.add(f-p,"d")):p}function W_(f){if(!this.isValid())return f!=null?this:NaN;var p=(this.day()+7-this.localeData()._week.dow)%7;return f==null?p:this.add(f-p,"d")}function z_(f){if(!this.isValid())return f!=null?this:NaN;if(f!=null){var p=E_(f,this.localeData());return this.day(this.day()%7?p:p-7)}else return this.day()||7}function K_(f){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Tf.call(this),f?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=F_),this._weekdaysStrictRegex&&f?this._weekdaysStrictRegex:this._weekdaysRegex)}function G_(f){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Tf.call(this),f?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=O_),this._weekdaysShortStrictRegex&&f?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function j_(f){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Tf.call(this),f?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=U_),this._weekdaysMinStrictRegex&&f?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Tf(){function f(zt,vo){return vo.length-zt.length}var p=[],g=[],y=[],S=[],$,j,Se,Be,Qe;for($=0;$<7;$++)j=m([2e3,1]).day($),Se=dr(this.weekdaysMin(j,"")),Be=dr(this.weekdaysShort(j,"")),Qe=dr(this.weekdays(j,"")),p.push(Se),g.push(Be),y.push(Qe),S.push(Se),S.push(Be),S.push(Qe);p.sort(f),g.sort(f),y.sort(f),S.sort(f),this._weekdaysRegex=new RegExp("^("+S.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+y.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+g.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+p.join("|")+")","i")}function Df(){return this.hours()%12||12}function Y_(){return this.hours()||24}te("H",["HH",2],0,"hour"),te("h",["hh",2],0,Df),te("k",["kk",2],0,Y_),te("hmm",0,0,function(){return""+Df.apply(this)+Ee(this.minutes(),2)}),te("hmmss",0,0,function(){return""+Df.apply(this)+Ee(this.minutes(),2)+Ee(this.seconds(),2)}),te("Hmm",0,0,function(){return""+this.hours()+Ee(this.minutes(),2)}),te("Hmmss",0,0,function(){return""+this.hours()+Ee(this.minutes(),2)+Ee(this.seconds(),2)});function am(f,p){te(f,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),p)})}am("a",!0),am("A",!1),ot("hour","h"),ne("hour",13);function im(f,p){return p._meridiemParse}pe("a",im),pe("A",im),pe("H",ce),pe("h",ce),pe("k",ce),pe("HH",ce,Wt),pe("hh",ce,Wt),pe("kk",ce,Wt),pe("hmm",st),pe("hmmss",mo),pe("Hmm",st),pe("Hmmss",mo),Xe(["H","HH"],vt),Xe(["k","kk"],function(f,p,g){var y=Ae(f);p[vt]=y===24?0:y}),Xe(["a","A"],function(f,p,g){g._isPm=g._locale.isPM(f),g._meridiem=f}),Xe(["h","hh"],function(f,p,g){p[vt]=Ae(f),h(g).bigHour=!0}),Xe("hmm",function(f,p,g){var y=f.length-2;p[vt]=Ae(f.substr(0,y)),p[Er]=Ae(f.substr(y)),h(g).bigHour=!0}),Xe("hmmss",function(f,p,g){var y=f.length-4,S=f.length-2;p[vt]=Ae(f.substr(0,y)),p[Er]=Ae(f.substr(y,2)),p[go]=Ae(f.substr(S)),h(g).bigHour=!0}),Xe("Hmm",function(f,p,g){var y=f.length-2;p[vt]=Ae(f.substr(0,y)),p[Er]=Ae(f.substr(y))}),Xe("Hmmss",function(f,p,g){var y=f.length-4,S=f.length-2;p[vt]=Ae(f.substr(0,y)),p[Er]=Ae(f.substr(y,2)),p[go]=Ae(f.substr(S))});function J_(f){return(f+"").toLowerCase().charAt(0)==="p"}var X_=/[ap]\.?m?\.?/i,Q_=jr("Hours",!0);function Z_(f,p,g){return f>11?g?"pm":"PM":g?"am":"AM"}var lm={calendar:Ie,longDateFormat:ht,invalidDate:dt,ordinal:un,dayOfMonthOrdinalParse:Nn,relativeTime:Ys,months:p_,monthsShort:Qp,week:I_,weekdays:M_,weekdaysMin:R_,weekdaysShort:sm,meridiemParse:X_},lt={},oa={},na;function ev(f,p){var g,y=Math.min(f.length,p.length);for(g=0;g<y;g+=1)if(f[g]!==p[g])return g;return y}function fm(f){return f&&f.toLowerCase().replace("_","-")}function tv(f){for(var p=0,g,y,S,$;p<f.length;){for($=fm(f[p]).split("-"),g=$.length,y=fm(f[p+1]),y=y?y.split("-"):null;g>0;){if(S=ui($.slice(0,g).join("-")),S)return S;if(y&&y.length>=g&&ev($,y)>=g-1)break;g--}p++}return na}function rv(f){return f.match("^[^/\\\\]*$")!=null}function ui(f){var p=null,g;if(lt[f]===void 0&&typeof Ws!="undefined"&&Ws&&Ws.exports&&rv(f))try{p=na._abbr,g=require,g("./locale/"+f),Vo(p)}catch(y){lt[f]=null}return lt[f]}function Vo(f,p){var g;return f&&(i(p)?g=yo(f):g=Pf(f,p),g?na=g:typeof console!="undefined"&&console.warn&&console.warn("Locale "+f+" not found. Did you forget to load it?")),na._abbr}function Pf(f,p){if(p!==null){var g,y=lm;if(p.abbr=f,lt[f]!=null)q("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),y=lt[f]._config;else if(p.parentLocale!=null)if(lt[p.parentLocale]!=null)y=lt[p.parentLocale]._config;else if(g=ui(p.parentLocale),g!=null)y=g._config;else return oa[p.parentLocale]||(oa[p.parentLocale]=[]),oa[p.parentLocale].push({name:f,config:p}),null;return lt[f]=new W(z(y,p)),oa[f]&&oa[f].forEach(function(S){Pf(S.name,S.config)}),Vo(f),lt[f]}else return delete lt[f],null}function ov(f,p){if(p!=null){var g,y,S=lm;lt[f]!=null&&lt[f].parentLocale!=null?lt[f].set(z(lt[f]._config,p)):(y=ui(f),y!=null&&(S=y._config),p=z(S,p),y==null&&(p.abbr=f),g=new W(p),g.parentLocale=lt[f],lt[f]=g),Vo(f)}else lt[f]!=null&&(lt[f].parentLocale!=null?(lt[f]=lt[f].parentLocale,f===Vo()&&Vo(f)):lt[f]!=null&&delete lt[f]);return lt[f]}function yo(f){var p;if(f&&f._locale&&f._locale._abbr&&(f=f._locale._abbr),!f)return na;if(!r(f)){if(p=ui(f),p)return p;f=[f]}return tv(f)}function nv(){return oe(lt)}function Af(f){var p,g=f._a;return g&&h(f).overflow===-2&&(p=g[ho]<0||g[ho]>11?ho:g[Jr]<1||g[Jr]>fi(g[Ht],g[ho])?Jr:g[vt]<0||g[vt]>24||g[vt]===24&&(g[Er]!==0||g[go]!==0||g[pn]!==0)?vt:g[Er]<0||g[Er]>59?Er:g[go]<0||g[go]>59?go:g[pn]<0||g[pn]>999?pn:-1,h(f)._overflowDayOfYear&&(p<Ht||p>Jr)&&(p=Jr),h(f)._overflowWeeks&&p===-1&&(p=c_),h(f)._overflowWeekday&&p===-1&&(p=u_),h(f).overflow=p),f}var sv=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,av=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,iv=/Z|[+-]\d\d(?::?\d\d)?/,di=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ef=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],lv=/^\/?Date\((-?\d+)/i,fv=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,cv={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function cm(f){var p,g,y=f._i,S=sv.exec(y)||av.exec(y),$,j,Se,Be,Qe=di.length,zt=Ef.length;if(S){for(h(f).iso=!0,p=0,g=Qe;p<g;p++)if(di[p][1].exec(S[1])){j=di[p][0],$=di[p][2]!==!1;break}if(j==null){f._isValid=!1;return}if(S[3]){for(p=0,g=zt;p<g;p++)if(Ef[p][1].exec(S[3])){Se=(S[2]||" ")+Ef[p][0];break}if(Se==null){f._isValid=!1;return}}if(!$&&Se!=null){f._isValid=!1;return}if(S[4])if(iv.exec(S[4]))Be="Z";else{f._isValid=!1;return}f._f=j+(Se||"")+(Be||""),Rf(f)}else f._isValid=!1}function uv(f,p,g,y,S,$){var j=[dv(f),Qp.indexOf(p),parseInt(g,10),parseInt(y,10),parseInt(S,10)];return $&&j.push(parseInt($,10)),j}function dv(f){var p=parseInt(f,10);return p<=49?2e3+p:p<=999?1900+p:p}function pv(f){return f.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function mv(f,p,g){if(f){var y=sm.indexOf(f),S=new Date(p[0],p[1],p[2]).getDay();if(y!==S)return h(g).weekdayMismatch=!0,g._isValid=!1,!1}return!0}function hv(f,p,g){if(f)return cv[f];if(p)return 0;var y=parseInt(g,10),S=y%100,$=(y-S)/100;return $*60+S}function um(f){var p=fv.exec(pv(f._i)),g;if(p){if(g=uv(p[4],p[3],p[2],p[5],p[6],p[7]),!mv(p[1],g,f))return;f._a=g,f._tzm=hv(p[8],p[9],p[10]),f._d=ta.apply(null,f._a),f._d.setUTCMinutes(f._d.getUTCMinutes()-f._tzm),h(f).rfc2822=!0}else f._isValid=!1}function gv(f){var p=lv.exec(f._i);if(p!==null){f._d=new Date(+p[1]);return}if(cm(f),f._isValid===!1)delete f._isValid;else return;if(um(f),f._isValid===!1)delete f._isValid;else return;f._strict?f._isValid=!1:e.createFromInputFallback(f)}e.createFromInputFallback=E("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(f){f._d=new Date(f._i+(f._useUTC?" UTC":""))});function qn(f,p,g){return f!=null?f:p!=null?p:g}function xv(f){var p=new Date(e.now());return f._useUTC?[p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()]:[p.getFullYear(),p.getMonth(),p.getDate()]}function Mf(f){var p,g,y=[],S,$,j;if(!f._d){for(S=xv(f),f._w&&f._a[Jr]==null&&f._a[ho]==null&&yv(f),f._dayOfYear!=null&&(j=qn(f._a[Ht],S[Ht]),(f._dayOfYear>ea(j)||f._dayOfYear===0)&&(h(f)._overflowDayOfYear=!0),g=ta(j,0,f._dayOfYear),f._a[ho]=g.getUTCMonth(),f._a[Jr]=g.getUTCDate()),p=0;p<3&&f._a[p]==null;++p)f._a[p]=y[p]=S[p];for(;p<7;p++)f._a[p]=y[p]=f._a[p]==null?p===2?1:0:f._a[p];f._a[vt]===24&&f._a[Er]===0&&f._a[go]===0&&f._a[pn]===0&&(f._nextDay=!0,f._a[vt]=0),f._d=(f._useUTC?ta:k_).apply(null,y),$=f._useUTC?f._d.getUTCDay():f._d.getDay(),f._tzm!=null&&f._d.setUTCMinutes(f._d.getUTCMinutes()-f._tzm),f._nextDay&&(f._a[vt]=24),f._w&&typeof f._w.d!="undefined"&&f._w.d!==$&&(h(f).weekdayMismatch=!0)}}function yv(f){var p,g,y,S,$,j,Se,Be,Qe;p=f._w,p.GG!=null||p.W!=null||p.E!=null?($=1,j=4,g=qn(p.GG,f._a[Ht],ra(at(),1,4).year),y=qn(p.W,1),S=qn(p.E,1),(S<1||S>7)&&(Be=!0)):($=f._locale._week.dow,j=f._locale._week.doy,Qe=ra(at(),$,j),g=qn(p.gg,f._a[Ht],Qe.year),y=qn(p.w,Qe.week),p.d!=null?(S=p.d,(S<0||S>6)&&(Be=!0)):p.e!=null?(S=p.e+$,(p.e<0||p.e>6)&&(Be=!0)):S=$),y<1||y>xo(g,$,j)?h(f)._overflowWeeks=!0:Be!=null?h(f)._overflowWeekday=!0:(Se=nm(g,y,S,$,j),f._a[Ht]=Se.year,f._dayOfYear=Se.dayOfYear)}e.ISO_8601=function(){},e.RFC_2822=function(){};function Rf(f){if(f._f===e.ISO_8601){cm(f);return}if(f._f===e.RFC_2822){um(f);return}f._a=[],h(f).empty=!0;var p=""+f._i,g,y,S,$,j,Se=p.length,Be=0,Qe,zt;for(S=Rt(f._f,f._locale).match(Ye)||[],zt=S.length,g=0;g<zt;g++)$=S[g],y=(p.match(i_($,f))||[])[0],y&&(j=p.substr(0,p.indexOf(y)),j.length>0&&h(f).unusedInput.push(j),p=p.slice(p.indexOf(y)+y.length),Be+=y.length),fe[$]?(y?h(f).empty=!1:h(f).unusedTokens.push($),f_($,y,f)):f._strict&&!y&&h(f).unusedTokens.push($);h(f).charsLeftOver=Se-Be,p.length>0&&h(f).unusedInput.push(p),f._a[vt]<=12&&h(f).bigHour===!0&&f._a[vt]>0&&(h(f).bigHour=void 0),h(f).parsedDateParts=f._a.slice(0),h(f).meridiem=f._meridiem,f._a[vt]=bv(f._locale,f._a[vt],f._meridiem),Qe=h(f).era,Qe!==null&&(f._a[Ht]=f._locale.erasConvertYear(Qe,f._a[Ht])),Mf(f),Af(f)}function bv(f,p,g){var y;return g==null?p:f.meridiemHour!=null?f.meridiemHour(p,g):(f.isPM!=null&&(y=f.isPM(g),y&&p<12&&(p+=12),!y&&p===12&&(p=0)),p)}function wv(f){var p,g,y,S,$,j,Se=!1,Be=f._f.length;if(Be===0){h(f).invalidFormat=!0,f._d=new Date(NaN);return}for(S=0;S<Be;S++)$=0,j=!1,p=L({},f),f._useUTC!=null&&(p._useUTC=f._useUTC),p._f=f._f[S],Rf(p),w(p)&&(j=!0),$+=h(p).charsLeftOver,$+=h(p).unusedTokens.length*10,h(p).score=$,Se?$<y&&(y=$,g=p):(y==null||$<y||j)&&(y=$,g=p,j&&(Se=!0));d(f,g||p)}function _v(f){if(!f._d){var p=po(f._i),g=p.day===void 0?p.date:p.day;f._a=u([p.year,p.month,g,p.hour,p.minute,p.second,p.millisecond],function(y){return y&&parseInt(y,10)}),Mf(f)}}function vv(f){var p=new R(Af(dm(f)));return p._nextDay&&(p.add(1,"d"),p._nextDay=void 0),p}function dm(f){var p=f._i,g=f._f;return f._locale=f._locale||yo(f._l),p===null||g===void 0&&p===""?_({nullInput:!0}):(typeof p=="string"&&(f._i=p=f._locale.preparse(p)),O(p)?new R(Af(p)):(c(p)?f._d=p:r(g)?wv(f):g?Rf(f):Sv(f),w(f)||(f._d=null),f))}function Sv(f){var p=f._i;i(p)?f._d=new Date(e.now()):c(p)?f._d=new Date(p.valueOf()):typeof p=="string"?gv(f):r(p)?(f._a=u(p.slice(0),function(g){return parseInt(g,10)}),Mf(f)):n(p)?_v(f):l(p)?f._d=new Date(p):e.createFromInputFallback(f)}function pm(f,p,g,y,S){var $={};return(p===!0||p===!1)&&(y=p,p=void 0),(g===!0||g===!1)&&(y=g,g=void 0),(n(f)&&a(f)||r(f)&&f.length===0)&&(f=void 0),$._isAMomentObject=!0,$._useUTC=$._isUTC=S,$._l=g,$._i=f,$._f=p,$._strict=y,vv($)}function at(f,p,g,y){return pm(f,p,g,y,!1)}var kv=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var f=at.apply(null,arguments);return this.isValid()&&f.isValid()?f<this?this:f:_()}),Lv=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var f=at.apply(null,arguments);return this.isValid()&&f.isValid()?f>this?this:f:_()});function mm(f,p){var g,y;if(p.length===1&&r(p[0])&&(p=p[0]),!p.length)return at();for(g=p[0],y=1;y<p.length;++y)(!p[y].isValid()||p[y][f](g))&&(g=p[y]);return g}function Iv(){var f=[].slice.call(arguments,0);return mm("isBefore",f)}function Cv(){var f=[].slice.call(arguments,0);return mm("isAfter",f)}var Tv=function(){return Date.now?Date.now():+new Date},sa=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Dv(f){var p,g=!1,y,S=sa.length;for(p in f)if(s(f,p)&&!(yt.call(sa,p)!==-1&&(f[p]==null||!isNaN(f[p]))))return!1;for(y=0;y<S;++y)if(f[sa[y]]){if(g)return!1;parseFloat(f[sa[y]])!==Ae(f[sa[y]])&&(g=!0)}return!0}function Pv(){return this._isValid}function Av(){return Mr(NaN)}function pi(f){var p=po(f),g=p.year||0,y=p.quarter||0,S=p.month||0,$=p.week||p.isoWeek||0,j=p.day||0,Se=p.hour||0,Be=p.minute||0,Qe=p.second||0,zt=p.millisecond||0;this._isValid=Dv(p),this._milliseconds=+zt+Qe*1e3+Be*6e4+Se*1e3*60*60,this._days=+j+$*7,this._months=+S+y*3+g*12,this._data={},this._locale=yo(),this._bubble()}function mi(f){return f instanceof pi}function Ff(f){return f<0?Math.round(-1*f)*-1:Math.round(f)}function Ev(f,p,g){var y=Math.min(f.length,p.length),S=Math.abs(f.length-p.length),$=0,j;for(j=0;j<y;j++)(g&&f[j]!==p[j]||!g&&Ae(f[j])!==Ae(p[j]))&&$++;return $+S}function hm(f,p){te(f,0,0,function(){var g=this.utcOffset(),y="+";return g<0&&(g=-g,y="-"),y+Ee(~~(g/60),2)+p+Ee(~~g%60,2)})}hm("Z",":"),hm("ZZ",""),pe("Z",ii),pe("ZZ",ii),Xe(["Z","ZZ"],function(f,p,g){g._useUTC=!0,g._tzm=Of(ii,f)});var Mv=/([\+\-]|\d\d)/gi;function Of(f,p){var g=(p||"").match(f),y,S,$;return g===null?null:(y=g[g.length-1]||[],S=(y+"").match(Mv)||["-",0,0],$=+(S[1]*60)+Ae(S[2]),$===0?0:S[0]==="+"?$:-$)}function Uf(f,p){var g,y;return p._isUTC?(g=p.clone(),y=(O(f)||c(f)?f.valueOf():at(f).valueOf())-g.valueOf(),g._d.setTime(g._d.valueOf()+y),e.updateOffset(g,!1),g):at(f).local()}function $f(f){return-Math.round(f._d.getTimezoneOffset())}e.updateOffset=function(){};function Rv(f,p,g){var y=this._offset||0,S;if(!this.isValid())return f!=null?this:NaN;if(f!=null){if(typeof f=="string"){if(f=Of(ii,f),f===null)return this}else Math.abs(f)<16&&!g&&(f=f*60);return!this._isUTC&&p&&(S=$f(this)),this._offset=f,this._isUTC=!0,S!=null&&this.add(S,"m"),y!==f&&(!p||this._changeInProgress?bm(this,Mr(f-y,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?y:$f(this)}function Fv(f,p){return f!=null?(typeof f!="string"&&(f=-f),this.utcOffset(f,p),this):-this.utcOffset()}function Ov(f){return this.utcOffset(0,f)}function Uv(f){return this._isUTC&&(this.utcOffset(0,f),this._isUTC=!1,f&&this.subtract($f(this),"m")),this}function $v(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var f=Of(s_,this._i);f!=null?this.utcOffset(f):this.utcOffset(0,!0)}return this}function Bv(f){return this.isValid()?(f=f?at(f).utcOffset():0,(this.utcOffset()-f)%60===0):!1}function Nv(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Hv(){if(!i(this._isDSTShifted))return this._isDSTShifted;var f={},p;return L(f,this),f=dm(f),f._a?(p=f._isUTC?m(f._a):at(f._a),this._isDSTShifted=this.isValid()&&Ev(f._a,p.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Vv(){return this.isValid()?!this._isUTC:!1}function qv(){return this.isValid()?this._isUTC:!1}function gm(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Wv=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,zv=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Mr(f,p){var g=f,y=null,S,$,j;return mi(f)?g={ms:f._milliseconds,d:f._days,M:f._months}:l(f)||!isNaN(+f)?(g={},p?g[p]=+f:g.milliseconds=+f):(y=Wv.exec(f))?(S=y[1]==="-"?-1:1,g={y:0,d:Ae(y[Jr])*S,h:Ae(y[vt])*S,m:Ae(y[Er])*S,s:Ae(y[go])*S,ms:Ae(Ff(y[pn]*1e3))*S}):(y=zv.exec(f))?(S=y[1]==="-"?-1:1,g={y:mn(y[2],S),M:mn(y[3],S),w:mn(y[4],S),d:mn(y[5],S),h:mn(y[6],S),m:mn(y[7],S),s:mn(y[8],S)}):g==null?g={}:typeof g=="object"&&("from"in g||"to"in g)&&(j=Kv(at(g.from),at(g.to)),g={},g.ms=j.milliseconds,g.M=j.months),$=new pi(g),mi(f)&&s(f,"_locale")&&($._locale=f._locale),mi(f)&&s(f,"_isValid")&&($._isValid=f._isValid),$}Mr.fn=pi.prototype,Mr.invalid=Av;function mn(f,p){var g=f&&parseFloat(f.replace(",","."));return(isNaN(g)?0:g)*p}function xm(f,p){var g={};return g.months=p.month()-f.month()+(p.year()-f.year())*12,f.clone().add(g.months,"M").isAfter(p)&&--g.months,g.milliseconds=+p-+f.clone().add(g.months,"M"),g}function Kv(f,p){var g;return f.isValid()&&p.isValid()?(p=Uf(p,f),f.isBefore(p)?g=xm(f,p):(g=xm(p,f),g.milliseconds=-g.milliseconds,g.months=-g.months),g):{milliseconds:0,months:0}}function ym(f,p){return function(g,y){var S,$;return y!==null&&!isNaN(+y)&&(q(p,"moment()."+p+"(period, number) is deprecated. Please use moment()."+p+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),$=g,g=y,y=$),S=Mr(g,y),bm(this,S,f),this}}function bm(f,p,g,y){var S=p._milliseconds,$=Ff(p._days),j=Ff(p._months);f.isValid()&&(y=y==null?!0:y,j&&em(f,Yr(f,"Month")+j*g),$&&ri(f,"Date",Yr(f,"Date")+$*g),S&&f._d.setTime(f._d.valueOf()+S*g),y&&e.updateOffset(f,$||j))}var Gv=ym(1,"add"),jv=ym(-1,"subtract");function wm(f){return typeof f=="string"||f instanceof String}function Yv(f){return O(f)||c(f)||wm(f)||l(f)||Xv(f)||Jv(f)||f===null||f===void 0}function Jv(f){var p=n(f)&&!a(f),g=!1,y=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],S,$,j=y.length;for(S=0;S<j;S+=1)$=y[S],g=g||s(f,$);return p&&g}function Xv(f){var p=r(f),g=!1;return p&&(g=f.filter(function(y){return!l(y)&&wm(f)}).length===0),p&&g}function Qv(f){var p=n(f)&&!a(f),g=!1,y=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],S,$;for(S=0;S<y.length;S+=1)$=y[S],g=g||s(f,$);return p&&g}function Zv(f,p){var g=f.diff(p,"days",!0);return g<-6?"sameElse":g<-1?"lastWeek":g<0?"lastDay":g<1?"sameDay":g<2?"nextDay":g<7?"nextWeek":"sameElse"}function e1(f,p){arguments.length===1&&(arguments[0]?Yv(arguments[0])?(f=arguments[0],p=void 0):Qv(arguments[0])&&(p=arguments[0],f=void 0):(f=void 0,p=void 0));var g=f||at(),y=Uf(g,this).startOf("day"),S=e.calendarFormat(this,y)||"sameElse",$=p&&(J(p[S])?p[S].call(this,g):p[S]);return this.format($||this.localeData().calendar(S,this,at(g)))}function t1(){return new R(this)}function r1(f,p){var g=O(f)?f:at(f);return this.isValid()&&g.isValid()?(p=Nt(p)||"millisecond",p==="millisecond"?this.valueOf()>g.valueOf():g.valueOf()<this.clone().startOf(p).valueOf()):!1}function o1(f,p){var g=O(f)?f:at(f);return this.isValid()&&g.isValid()?(p=Nt(p)||"millisecond",p==="millisecond"?this.valueOf()<g.valueOf():this.clone().endOf(p).valueOf()<g.valueOf()):!1}function n1(f,p,g,y){var S=O(f)?f:at(f),$=O(p)?p:at(p);return this.isValid()&&S.isValid()&&$.isValid()?(y=y||"()",(y[0]==="("?this.isAfter(S,g):!this.isBefore(S,g))&&(y[1]===")"?this.isBefore($,g):!this.isAfter($,g))):!1}function s1(f,p){var g=O(f)?f:at(f),y;return this.isValid()&&g.isValid()?(p=Nt(p)||"millisecond",p==="millisecond"?this.valueOf()===g.valueOf():(y=g.valueOf(),this.clone().startOf(p).valueOf()<=y&&y<=this.clone().endOf(p).valueOf())):!1}function a1(f,p){return this.isSame(f,p)||this.isAfter(f,p)}function i1(f,p){return this.isSame(f,p)||this.isBefore(f,p)}function l1(f,p,g){var y,S,$;if(!this.isValid())return NaN;if(y=Uf(f,this),!y.isValid())return NaN;switch(S=(y.utcOffset()-this.utcOffset())*6e4,p=Nt(p),p){case"year":$=hi(this,y)/12;break;case"month":$=hi(this,y);break;case"quarter":$=hi(this,y)/3;break;case"second":$=(this-y)/1e3;break;case"minute":$=(this-y)/6e4;break;case"hour":$=(this-y)/36e5;break;case"day":$=(this-y-S)/864e5;break;case"week":$=(this-y-S)/6048e5;break;default:$=this-y}return g?$:tt($)}function hi(f,p){if(f.date()<p.date())return-hi(p,f);var g=(p.year()-f.year())*12+(p.month()-f.month()),y=f.clone().add(g,"months"),S,$;return p-y<0?(S=f.clone().add(g-1,"months"),$=(p-y)/(y-S)):(S=f.clone().add(g+1,"months"),$=(p-y)/(S-y)),-(g+$)||0}e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function f1(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function c1(f){if(!this.isValid())return null;var p=f!==!0,g=p?this.clone().utc():this;return g.year()<0||g.year()>9999?Mt(g,p?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):J(Date.prototype.toISOString)?p?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Mt(g,"Z")):Mt(g,p?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function u1(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var f="moment",p="",g,y,S,$;return this.isLocal()||(f=this.utcOffset()===0?"moment.utc":"moment.parseZone",p="Z"),g="["+f+'("]',y=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",S="-MM-DD[T]HH:mm:ss.SSS",$=p+'[")]',this.format(g+y+S+$)}function d1(f){f||(f=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var p=Mt(this,f);return this.localeData().postformat(p)}function p1(f,p){return this.isValid()&&(O(f)&&f.isValid()||at(f).isValid())?Mr({to:this,from:f}).locale(this.locale()).humanize(!p):this.localeData().invalidDate()}function m1(f){return this.from(at(),f)}function h1(f,p){return this.isValid()&&(O(f)&&f.isValid()||at(f).isValid())?Mr({from:this,to:f}).locale(this.locale()).humanize(!p):this.localeData().invalidDate()}function g1(f){return this.to(at(),f)}function _m(f){var p;return f===void 0?this._locale._abbr:(p=yo(f),p!=null&&(this._locale=p),this)}var vm=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(f){return f===void 0?this.localeData():this.locale(f)});function Sm(){return this._locale}var gi=1e3,Wn=60*gi,xi=60*Wn,km=(365*400+97)*24*xi;function zn(f,p){return(f%p+p)%p}function Lm(f,p,g){return f<100&&f>=0?new Date(f+400,p,g)-km:new Date(f,p,g).valueOf()}function Im(f,p,g){return f<100&&f>=0?Date.UTC(f+400,p,g)-km:Date.UTC(f,p,g)}function x1(f){var p,g;if(f=Nt(f),f===void 0||f==="millisecond"||!this.isValid())return this;switch(g=this._isUTC?Im:Lm,f){case"year":p=g(this.year(),0,1);break;case"quarter":p=g(this.year(),this.month()-this.month()%3,1);break;case"month":p=g(this.year(),this.month(),1);break;case"week":p=g(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":p=g(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":p=g(this.year(),this.month(),this.date());break;case"hour":p=this._d.valueOf(),p-=zn(p+(this._isUTC?0:this.utcOffset()*Wn),xi);break;case"minute":p=this._d.valueOf(),p-=zn(p,Wn);break;case"second":p=this._d.valueOf(),p-=zn(p,gi);break}return this._d.setTime(p),e.updateOffset(this,!0),this}function y1(f){var p,g;if(f=Nt(f),f===void 0||f==="millisecond"||!this.isValid())return this;switch(g=this._isUTC?Im:Lm,f){case"year":p=g(this.year()+1,0,1)-1;break;case"quarter":p=g(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":p=g(this.year(),this.month()+1,1)-1;break;case"week":p=g(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":p=g(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":p=g(this.year(),this.month(),this.date()+1)-1;break;case"hour":p=this._d.valueOf(),p+=xi-zn(p+(this._isUTC?0:this.utcOffset()*Wn),xi)-1;break;case"minute":p=this._d.valueOf(),p+=Wn-zn(p,Wn)-1;break;case"second":p=this._d.valueOf(),p+=gi-zn(p,gi)-1;break}return this._d.setTime(p),e.updateOffset(this,!0),this}function b1(){return this._d.valueOf()-(this._offset||0)*6e4}function w1(){return Math.floor(this.valueOf()/1e3)}function _1(){return new Date(this.valueOf())}function v1(){var f=this;return[f.year(),f.month(),f.date(),f.hour(),f.minute(),f.second(),f.millisecond()]}function S1(){var f=this;return{years:f.year(),months:f.month(),date:f.date(),hours:f.hours(),minutes:f.minutes(),seconds:f.seconds(),milliseconds:f.milliseconds()}}function k1(){return this.isValid()?this.toISOString():null}function L1(){return w(this)}function I1(){return d({},h(this))}function C1(){return h(this).overflow}function T1(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}te("N",0,0,"eraAbbr"),te("NN",0,0,"eraAbbr"),te("NNN",0,0,"eraAbbr"),te("NNNN",0,0,"eraName"),te("NNNNN",0,0,"eraNarrow"),te("y",["y",1],"yo","eraYear"),te("y",["yy",2],0,"eraYear"),te("y",["yyy",3],0,"eraYear"),te("y",["yyyy",4],0,"eraYear"),pe("N",Bf),pe("NN",Bf),pe("NNN",Bf),pe("NNNN",B1),pe("NNNNN",N1),Xe(["N","NN","NNN","NNNN","NNNNN"],function(f,p,g,y){var S=g._locale.erasParse(f,y,g._strict);S?h(g).era=S:h(g).invalidEra=f}),pe("y",Vn),pe("yy",Vn),pe("yyy",Vn),pe("yyyy",Vn),pe("yo",H1),Xe(["y","yy","yyy","yyyy"],Ht),Xe(["yo"],function(f,p,g,y){var S;g._locale._eraYearOrdinalRegex&&(S=f.match(g._locale._eraYearOrdinalRegex)),g._locale.eraYearOrdinalParse?p[Ht]=g._locale.eraYearOrdinalParse(f,S):p[Ht]=parseInt(f,10)});function D1(f,p){var g,y,S,$=this._eras||yo("en")._eras;for(g=0,y=$.length;g<y;++g){switch(typeof $[g].since){case"string":S=e($[g].since).startOf("day"),$[g].since=S.valueOf();break}switch(typeof $[g].until){case"undefined":$[g].until=1/0;break;case"string":S=e($[g].until).startOf("day").valueOf(),$[g].until=S.valueOf();break}}return $}function P1(f,p,g){var y,S,$=this.eras(),j,Se,Be;for(f=f.toUpperCase(),y=0,S=$.length;y<S;++y)if(j=$[y].name.toUpperCase(),Se=$[y].abbr.toUpperCase(),Be=$[y].narrow.toUpperCase(),g)switch(p){case"N":case"NN":case"NNN":if(Se===f)return $[y];break;case"NNNN":if(j===f)return $[y];break;case"NNNNN":if(Be===f)return $[y];break}else if([j,Se,Be].indexOf(f)>=0)return $[y]}function A1(f,p){var g=f.since<=f.until?1:-1;return p===void 0?e(f.since).year():e(f.since).year()+(p-f.offset)*g}function E1(){var f,p,g,y=this.localeData().eras();for(f=0,p=y.length;f<p;++f)if(g=this.clone().startOf("day").valueOf(),y[f].since<=g&&g<=y[f].until||y[f].until<=g&&g<=y[f].since)return y[f].name;return""}function M1(){var f,p,g,y=this.localeData().eras();for(f=0,p=y.length;f<p;++f)if(g=this.clone().startOf("day").valueOf(),y[f].since<=g&&g<=y[f].until||y[f].until<=g&&g<=y[f].since)return y[f].narrow;return""}function R1(){var f,p,g,y=this.localeData().eras();for(f=0,p=y.length;f<p;++f)if(g=this.clone().startOf("day").valueOf(),y[f].since<=g&&g<=y[f].until||y[f].until<=g&&g<=y[f].since)return y[f].abbr;return""}function F1(){var f,p,g,y,S=this.localeData().eras();for(f=0,p=S.length;f<p;++f)if(g=S[f].since<=S[f].until?1:-1,y=this.clone().startOf("day").valueOf(),S[f].since<=y&&y<=S[f].until||S[f].until<=y&&y<=S[f].since)return(this.year()-e(S[f].since).year())*g+S[f].offset;return this.year()}function O1(f){return s(this,"_erasNameRegex")||Nf.call(this),f?this._erasNameRegex:this._erasRegex}function U1(f){return s(this,"_erasAbbrRegex")||Nf.call(this),f?this._erasAbbrRegex:this._erasRegex}function $1(f){return s(this,"_erasNarrowRegex")||Nf.call(this),f?this._erasNarrowRegex:this._erasRegex}function Bf(f,p){return p.erasAbbrRegex(f)}function B1(f,p){return p.erasNameRegex(f)}function N1(f,p){return p.erasNarrowRegex(f)}function H1(f,p){return p._eraYearOrdinalRegex||Vn}function Nf(){var f=[],p=[],g=[],y=[],S,$,j=this.eras();for(S=0,$=j.length;S<$;++S)p.push(dr(j[S].name)),f.push(dr(j[S].abbr)),g.push(dr(j[S].narrow)),y.push(dr(j[S].name)),y.push(dr(j[S].abbr)),y.push(dr(j[S].narrow));this._erasRegex=new RegExp("^("+y.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+p.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+f.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+g.join("|")+")","i")}te(0,["gg",2],0,function(){return this.weekYear()%100}),te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function yi(f,p){te(0,[f,f.length],0,p)}yi("gggg","weekYear"),yi("ggggg","weekYear"),yi("GGGG","isoWeekYear"),yi("GGGGG","isoWeekYear"),ot("weekYear","gg"),ot("isoWeekYear","GG"),ne("weekYear",1),ne("isoWeekYear",1),pe("G",ai),pe("g",ai),pe("GG",ce,Wt),pe("gg",ce,Wt),pe("GGGG",Lf,Xs),pe("gggg",Lf,Xs),pe("GGGGG",si,Y),pe("ggggg",si,Y),Zs(["gggg","ggggg","GGGG","GGGGG"],function(f,p,g,y){p[y.substr(0,2)]=Ae(f)}),Zs(["gg","GG"],function(f,p,g,y){p[y]=e.parseTwoDigitYear(f)});function V1(f){return Cm.call(this,f,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function q1(f){return Cm.call(this,f,this.isoWeek(),this.isoWeekday(),1,4)}function W1(){return xo(this.year(),1,4)}function z1(){return xo(this.isoWeekYear(),1,4)}function K1(){var f=this.localeData()._week;return xo(this.year(),f.dow,f.doy)}function G1(){var f=this.localeData()._week;return xo(this.weekYear(),f.dow,f.doy)}function Cm(f,p,g,y,S){var $;return f==null?ra(this,y,S).year:($=xo(f,y,S),p>$&&(p=$),j1.call(this,f,p,g,y,S))}function j1(f,p,g,y,S){var $=nm(f,p,g,y,S),j=ta($.year,0,$.dayOfYear);return this.year(j.getUTCFullYear()),this.month(j.getUTCMonth()),this.date(j.getUTCDate()),this}te("Q",0,"Qo","quarter"),ot("quarter","Q"),ne("quarter",7),pe("Q",oi),Xe("Q",function(f,p){p[ho]=(Ae(f)-1)*3});function Y1(f){return f==null?Math.ceil((this.month()+1)/3):this.month((f-1)*3+this.month()%3)}te("D",["DD",2],"Do","date"),ot("date","D"),ne("date",9),pe("D",ce),pe("DD",ce,Wt),pe("Do",function(f,p){return f?p._dayOfMonthOrdinalParse||p._ordinalParse:p._dayOfMonthOrdinalParseLenient}),Xe(["D","DD"],Jr),Xe("Do",function(f,p){p[Jr]=Ae(f.match(ce)[0])});var Tm=jr("Date",!0);te("DDD",["DDDD",3],"DDDo","dayOfYear"),ot("dayOfYear","DDD"),ne("dayOfYear",4),pe("DDD",nr),pe("DDDD",ni),Xe(["DDD","DDDD"],function(f,p,g){g._dayOfYear=Ae(f)});function J1(f){var p=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return f==null?p:this.add(f-p,"d")}te("m",["mm",2],0,"minute"),ot("minute","m"),ne("minute",14),pe("m",ce),pe("mm",ce,Wt),Xe(["m","mm"],Er);var X1=jr("Minutes",!1);te("s",["ss",2],0,"second"),ot("second","s"),ne("second",15),pe("s",ce),pe("ss",ce,Wt),Xe(["s","ss"],go);var Q1=jr("Seconds",!1);te("S",0,0,function(){return~~(this.millisecond()/100)}),te(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),te(0,["SSS",3],0,"millisecond"),te(0,["SSSS",4],0,function(){return this.millisecond()*10}),te(0,["SSSSS",5],0,function(){return this.millisecond()*100}),te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),ot("millisecond","ms"),ne("millisecond",16),pe("S",nr,oi),pe("SS",nr,Wt),pe("SSS",nr,ni);var qo,Dm;for(qo="SSSS";qo.length<=9;qo+="S")pe(qo,Vn);function Z1(f,p){p[pn]=Ae(("0."+f)*1e3)}for(qo="S";qo.length<=9;qo+="S")Xe(qo,Z1);Dm=jr("Milliseconds",!1),te("z",0,0,"zoneAbbr"),te("zz",0,0,"zoneName");function eS(){return this._isUTC?"UTC":""}function tS(){return this._isUTC?"Coordinated Universal Time":""}var ie=R.prototype;ie.add=Gv,ie.calendar=e1,ie.clone=t1,ie.diff=l1,ie.endOf=y1,ie.format=d1,ie.from=p1,ie.fromNow=m1,ie.to=h1,ie.toNow=g1,ie.get=Sf,ie.invalidAt=C1,ie.isAfter=r1,ie.isBefore=o1,ie.isBetween=n1,ie.isSame=s1,ie.isSameOrAfter=a1,ie.isSameOrBefore=i1,ie.isValid=L1,ie.lang=vm,ie.locale=_m,ie.localeData=Sm,ie.max=Lv,ie.min=kv,ie.parsingFlags=I1,ie.set=kf,ie.startOf=x1,ie.subtract=jv,ie.toArray=v1,ie.toObject=S1,ie.toDate=_1,ie.toISOString=c1,ie.inspect=u1,typeof Symbol!="undefined"&&Symbol.for!=null&&(ie[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ie.toJSON=k1,ie.toString=f1,ie.unix=w1,ie.valueOf=b1,ie.creationData=T1,ie.eraName=E1,ie.eraNarrow=M1,ie.eraAbbr=R1,ie.eraYear=F1,ie.year=om,ie.isLeapYear=S_,ie.weekYear=V1,ie.isoWeekYear=q1,ie.quarter=ie.quarters=Y1,ie.month=tm,ie.daysInMonth=w_,ie.week=ie.weeks=D_,ie.isoWeek=ie.isoWeeks=P_,ie.weeksInYear=K1,ie.weeksInWeekYear=G1,ie.isoWeeksInYear=W1,ie.isoWeeksInISOWeekYear=z1,ie.date=Tm,ie.day=ie.days=q_,ie.weekday=W_,ie.isoWeekday=z_,ie.dayOfYear=J1,ie.hour=ie.hours=Q_,ie.minute=ie.minutes=X1,ie.second=ie.seconds=Q1,ie.millisecond=ie.milliseconds=Dm,ie.utcOffset=Rv,ie.utc=Ov,ie.local=Uv,ie.parseZone=$v,ie.hasAlignedHourOffset=Bv,ie.isDST=Nv,ie.isLocal=Vv,ie.isUtcOffset=qv,ie.isUtc=gm,ie.isUTC=gm,ie.zoneAbbr=eS,ie.zoneName=tS,ie.dates=E("dates accessor is deprecated. Use date instead.",Tm),ie.months=E("months accessor is deprecated. Use month instead",tm),ie.years=E("years accessor is deprecated. Use year instead",om),ie.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Fv),ie.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Hv);function rS(f){return at(f*1e3)}function oS(){return at.apply(null,arguments).parseZone()}function Pm(f){return f}var je=W.prototype;je.calendar=Pe,je.longDateFormat=gt,je.invalidDate=qt,je.ordinal=js,je.preparse=Pm,je.postformat=Pm,je.relativeTime=Hn,je.pastFuture=Js,je.set=G,je.eras=D1,je.erasParse=P1,je.erasConvertYear=A1,je.erasAbbrRegex=U1,je.erasNameRegex=O1,je.erasNarrowRegex=$1,je.months=g_,je.monthsShort=x_,je.monthsParse=b_,je.monthsRegex=v_,je.monthsShortRegex=__,je.week=L_,je.firstDayOfYear=T_,je.firstDayOfWeek=C_,je.weekdays=$_,je.weekdaysMin=N_,je.weekdaysShort=B_,je.weekdaysParse=V_,je.weekdaysRegex=K_,je.weekdaysShortRegex=G_,je.weekdaysMinRegex=j_,je.isPM=J_,je.meridiem=Z_;function bi(f,p,g,y){var S=yo(),$=m().set(y,p);return S[g]($,f)}function Am(f,p,g){if(l(f)&&(p=f,f=void 0),f=f||"",p!=null)return bi(f,p,g,"month");var y,S=[];for(y=0;y<12;y++)S[y]=bi(f,y,g,"month");return S}function Hf(f,p,g,y){typeof f=="boolean"?(l(p)&&(g=p,p=void 0),p=p||""):(p=f,g=p,f=!1,l(p)&&(g=p,p=void 0),p=p||"");var S=yo(),$=f?S._week.dow:0,j,Se=[];if(g!=null)return bi(p,(g+$)%7,y,"day");for(j=0;j<7;j++)Se[j]=bi(p,(j+$)%7,y,"day");return Se}function nS(f,p){return Am(f,p,"months")}function sS(f,p){return Am(f,p,"monthsShort")}function aS(f,p,g){return Hf(f,p,g,"weekdays")}function iS(f,p,g){return Hf(f,p,g,"weekdaysShort")}function lS(f,p,g){return Hf(f,p,g,"weekdaysMin")}Vo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(f){var p=f%10,g=Ae(f%100/10)===1?"th":p===1?"st":p===2?"nd":p===3?"rd":"th";return f+g}}),e.lang=E("moment.lang is deprecated. Use moment.locale instead.",Vo),e.langData=E("moment.langData is deprecated. Use moment.localeData instead.",yo);var bo=Math.abs;function fS(){var f=this._data;return this._milliseconds=bo(this._milliseconds),this._days=bo(this._days),this._months=bo(this._months),f.milliseconds=bo(f.milliseconds),f.seconds=bo(f.seconds),f.minutes=bo(f.minutes),f.hours=bo(f.hours),f.months=bo(f.months),f.years=bo(f.years),this}function Em(f,p,g,y){var S=Mr(p,g);return f._milliseconds+=y*S._milliseconds,f._days+=y*S._days,f._months+=y*S._months,f._bubble()}function cS(f,p){return Em(this,f,p,1)}function uS(f,p){return Em(this,f,p,-1)}function Mm(f){return f<0?Math.floor(f):Math.ceil(f)}function dS(){var f=this._milliseconds,p=this._days,g=this._months,y=this._data,S,$,j,Se,Be;return f>=0&&p>=0&&g>=0||f<=0&&p<=0&&g<=0||(f+=Mm(Vf(g)+p)*864e5,p=0,g=0),y.milliseconds=f%1e3,S=tt(f/1e3),y.seconds=S%60,$=tt(S/60),y.minutes=$%60,j=tt($/60),y.hours=j%24,p+=tt(j/24),Be=tt(Rm(p)),g+=Be,p-=Mm(Vf(Be)),Se=tt(g/12),g%=12,y.days=p,y.months=g,y.years=Se,this}function Rm(f){return f*4800/146097}function Vf(f){return f*146097/4800}function pS(f){if(!this.isValid())return NaN;var p,g,y=this._milliseconds;if(f=Nt(f),f==="month"||f==="quarter"||f==="year")switch(p=this._days+y/864e5,g=this._months+Rm(p),f){case"month":return g;case"quarter":return g/3;case"year":return g/12}else switch(p=this._days+Math.round(Vf(this._months)),f){case"week":return p/7+y/6048e5;case"day":return p+y/864e5;case"hour":return p*24+y/36e5;case"minute":return p*1440+y/6e4;case"second":return p*86400+y/1e3;case"millisecond":return Math.floor(p*864e5)+y;default:throw new Error("Unknown unit "+f)}}function mS(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ae(this._months/12)*31536e6:NaN}function wo(f){return function(){return this.as(f)}}var hS=wo("ms"),gS=wo("s"),xS=wo("m"),yS=wo("h"),bS=wo("d"),wS=wo("w"),_S=wo("M"),vS=wo("Q"),SS=wo("y");function kS(){return Mr(this)}function LS(f){return f=Nt(f),this.isValid()?this[f+"s"]():NaN}function hn(f){return function(){return this.isValid()?this._data[f]:NaN}}var IS=hn("milliseconds"),CS=hn("seconds"),TS=hn("minutes"),DS=hn("hours"),PS=hn("days"),AS=hn("months"),ES=hn("years");function MS(){return tt(this.days()/7)}var _o=Math.round,Kn={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function RS(f,p,g,y,S){return S.relativeTime(p||1,!!g,f,y)}function FS(f,p,g,y){var S=Mr(f).abs(),$=_o(S.as("s")),j=_o(S.as("m")),Se=_o(S.as("h")),Be=_o(S.as("d")),Qe=_o(S.as("M")),zt=_o(S.as("w")),vo=_o(S.as("y")),Wo=$<=g.ss&&["s",$]||$<g.s&&["ss",$]||j<=1&&["m"]||j<g.m&&["mm",j]||Se<=1&&["h"]||Se<g.h&&["hh",Se]||Be<=1&&["d"]||Be<g.d&&["dd",Be];return g.w!=null&&(Wo=Wo||zt<=1&&["w"]||zt<g.w&&["ww",zt]),Wo=Wo||Qe<=1&&["M"]||Qe<g.M&&["MM",Qe]||vo<=1&&["y"]||["yy",vo],Wo[2]=p,Wo[3]=+f>0,Wo[4]=y,RS.apply(null,Wo)}function OS(f){return f===void 0?_o:typeof f=="function"?(_o=f,!0):!1}function US(f,p){return Kn[f]===void 0?!1:p===void 0?Kn[f]:(Kn[f]=p,f==="s"&&(Kn.ss=p-1),!0)}function $S(f,p){if(!this.isValid())return this.localeData().invalidDate();var g=!1,y=Kn,S,$;return typeof f=="object"&&(p=f,f=!1),typeof f=="boolean"&&(g=f),typeof p=="object"&&(y=Object.assign({},Kn,p),p.s!=null&&p.ss==null&&(y.ss=p.s-1)),S=this.localeData(),$=FS(this,!g,y,S),g&&($=S.pastFuture(+this,$)),S.postformat($)}var qf=Math.abs;function Gn(f){return(f>0)-(f<0)||+f}function wi(){if(!this.isValid())return this.localeData().invalidDate();var f=qf(this._milliseconds)/1e3,p=qf(this._days),g=qf(this._months),y,S,$,j,Se=this.asSeconds(),Be,Qe,zt,vo;return Se?(y=tt(f/60),S=tt(y/60),f%=60,y%=60,$=tt(g/12),g%=12,j=f?f.toFixed(3).replace(/\.?0+$/,""):"",Be=Se<0?"-":"",Qe=Gn(this._months)!==Gn(Se)?"-":"",zt=Gn(this._days)!==Gn(Se)?"-":"",vo=Gn(this._milliseconds)!==Gn(Se)?"-":"",Be+"P"+($?Qe+$+"Y":"")+(g?Qe+g+"M":"")+(p?zt+p+"D":"")+(S||y||f?"T":"")+(S?vo+S+"H":"")+(y?vo+y+"M":"")+(f?vo+j+"S":"")):"P0D"}var Ke=pi.prototype;Ke.isValid=Pv,Ke.abs=fS,Ke.add=cS,Ke.subtract=uS,Ke.as=pS,Ke.asMilliseconds=hS,Ke.asSeconds=gS,Ke.asMinutes=xS,Ke.asHours=yS,Ke.asDays=bS,Ke.asWeeks=wS,Ke.asMonths=_S,Ke.asQuarters=vS,Ke.asYears=SS,Ke.valueOf=mS,Ke._bubble=dS,Ke.clone=kS,Ke.get=LS,Ke.milliseconds=IS,Ke.seconds=CS,Ke.minutes=TS,Ke.hours=DS,Ke.days=PS,Ke.weeks=MS,Ke.months=AS,Ke.years=ES,Ke.humanize=$S,Ke.toISOString=wi,Ke.toString=wi,Ke.toJSON=wi,Ke.locale=_m,Ke.localeData=Sm,Ke.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",wi),Ke.lang=vm,te("X",0,0,"unix"),te("x",0,0,"valueOf"),pe("x",ai),pe("X",a_),Xe("X",function(f,p,g){g._d=new Date(parseFloat(f)*1e3)}),Xe("x",function(f,p,g){g._d=new Date(Ae(f))});return e.version="2.29.4",t(at),e.fn=ie,e.min=Iv,e.max=Cv,e.now=Tv,e.utc=m,e.unix=rS,e.months=nS,e.isDate=c,e.locale=Vo,e.invalid=_,e.duration=Mr,e.isMoment=O,e.weekdays=aS,e.parseZone=oS,e.localeData=yo,e.isDuration=mi,e.monthsShort=sS,e.weekdaysMin=lS,e.defineLocale=Pf,e.updateLocale=ov,e.locales=nv,e.weekdaysShort=iS,e.normalizeUnits=Nt,e.relativeTimeRounding=OS,e.relativeTimeThreshold=US,e.calendarFormat=Zv,e.prototype=ie,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},e})});var GE={};Wf(GE,{default:()=>vf});module.exports=zS(GE);var Et=require("obsidian"),r_=require("obsidian"),o_=jn(vi());var It=()=>new Map,Si=o=>{let e=It();return o.forEach((t,r)=>{e.set(r,t)}),e},Rr=(o,e,t)=>{let r=o.get(e);return r===void 0&&o.set(e,r=t()),r},$m=(o,e)=>{let t=[];for(let[r,n]of o)t.push(e(n,r));return t},Bm=(o,e)=>{for(let[t,r]of o)if(e(r,t))return!0;return!1};var Qr=()=>new Set;var ki=o=>o[o.length-1];var Nm=(o,e)=>{for(let t=0;t<e.length;t++)o.push(e[t])},Fr=Array.from;var Kf=Array.isArray;var Li=class{constructor(){this._observers=It()}on(e,t){return Rr(this._observers,e,Qr).add(t),t}once(e,t){let r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){let r=this._observers.get(e);r!==void 0&&(r.delete(t),r.size===0&&this._observers.delete(e))}emit(e,t){return Fr((this._observers.get(e)||It()).values()).forEach(r=>r(...t))}destroy(){this._observers=It()}},Jn=class{constructor(){this._observers=It()}on(e,t){Rr(this._observers,e,Qr).add(t)}once(e,t){let r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){let r=this._observers.get(e);r!==void 0&&(r.delete(t),r.size===0&&this._observers.delete(e))}emit(e,t){return Fr((this._observers.get(e)||It()).values()).forEach(r=>r(...t))}destroy(){this._observers=It()}};var sr=Math.floor;var Xn=Math.abs;var Qn=(o,e)=>o<e?o:e,Or=(o,e)=>o>e?o:e,XE=Number.isNaN;var Ii=o=>o!==0?o<0:1/o<0;var jf=Number.MAX_SAFE_INTEGER,QE=Number.MIN_SAFE_INTEGER,ZE=1<<31;var Hm=Number.isInteger||(o=>typeof o=="number"&&isFinite(o)&&sr(o)===o),eM=Number.isNaN,tM=Number.parseInt;var GS=String.fromCharCode,rM=String.fromCodePoint,oM=GS(65535),jS=o=>o.toLowerCase(),YS=/^\s*/g,JS=o=>o.replace(YS,""),XS=/([A-Z])/g,Yf=(o,e)=>JS(o.replace(XS,t=>`${e}${jS(t)}`));var QS=o=>{let e=unescape(encodeURIComponent(o)),t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.codePointAt(n);return r},ts=typeof TextEncoder!="undefined"?new TextEncoder:null,ZS=o=>ts.encode(o),qm=ts?ZS:QS;var es=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});es&&es.decode(new Uint8Array).length===1&&(es=null);var gn=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},yn=()=>new gn;var e0=o=>{let e=o.cpos;for(let t=0;t<o.bufs.length;t++)e+=o.bufs[t].length;return e};var pr=o=>{let e=new Uint8Array(e0(o)),t=0;for(let r=0;r<o.bufs.length;r++){let n=o.bufs[r];e.set(n,t),t+=n.length}return e.set(new Uint8Array(o.cbuf.buffer,0,o.cpos),t),e},t0=(o,e)=>{let t=o.cbuf.length;t-o.cpos<e&&(o.bufs.push(new Uint8Array(o.cbuf.buffer,0,o.cpos)),o.cbuf=new Uint8Array(Or(t,e)*2),o.cpos=0)},Ct=(o,e)=>{let t=o.cbuf.length;o.cpos===t&&(o.bufs.push(o.cbuf),o.cbuf=new Uint8Array(t*2),o.cpos=0),o.cbuf[o.cpos++]=e};var Ti=Ct;var Me=(o,e)=>{for(;e>127;)Ct(o,128|127&e),e=sr(e/128);Ct(o,127&e)},Di=(o,e)=>{let t=Ii(e);for(t&&(e=-e),Ct(o,(e>63?128:0)|(t?64:0)|63&e),e=sr(e/64);e>0;)Ct(o,(e>127?128:0)|127&e),e=sr(e/128)},Xf=new Uint8Array(3e4),r0=Xf.length/3,o0=(o,e)=>{if(e.length<r0){let t=ts.encodeInto(e,Xf).written||0;Me(o,t);for(let r=0;r<t;r++)Ct(o,Xf[r])}else Tt(o,qm(e))},n0=(o,e)=>{let t=unescape(encodeURIComponent(e)),r=t.length;Me(o,r);for(let n=0;n<r;n++)Ct(o,t.codePointAt(n))},So=ts&&ts.encodeInto?o0:n0;var fa=(o,e)=>{let t=o.cbuf.length,r=o.cpos,n=Qn(t-r,e.length),s=e.length-n;o.cbuf.set(e.subarray(0,n),r),o.cpos+=n,s>0&&(o.bufs.push(o.cbuf),o.cbuf=new Uint8Array(Or(t*2,s)),o.cbuf.set(e.subarray(n)),o.cpos=s)},Tt=(o,e)=>{Me(o,e.byteLength),fa(o,e)},Qf=(o,e)=>{t0(o,e);let t=new DataView(o.cbuf.buffer,o.cpos,e);return o.cpos+=e,t},s0=(o,e)=>Qf(o,4).setFloat32(0,e,!1),a0=(o,e)=>Qf(o,8).setFloat64(0,e,!1),i0=(o,e)=>Qf(o,8).setBigInt64(0,e,!1);var zm=new DataView(new ArrayBuffer(4)),l0=o=>(zm.setFloat32(0,o),zm.getFloat32(0)===o),os=(o,e)=>{switch(typeof e){case"string":Ct(o,119),So(o,e);break;case"number":Hm(e)&&Xn(e)<=2147483647?(Ct(o,125),Di(o,e)):l0(e)?(Ct(o,124),s0(o,e)):(Ct(o,123),a0(o,e));break;case"bigint":Ct(o,122),i0(o,e);break;case"object":if(e===null)Ct(o,126);else if(Kf(e)){Ct(o,117),Me(o,e.length);for(let t=0;t<e.length;t++)os(o,e[t])}else if(e instanceof Uint8Array)Ct(o,116),Tt(o,e);else{Ct(o,118);let t=Object.keys(e);Me(o,t.length);for(let r=0;r<t.length;r++){let n=t[r];So(o,n),os(o,e[n])}}break;case"boolean":Ct(o,e?120:121);break;default:Ct(o,127)}},la=class extends gn{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Me(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}};var Km=o=>{o.count>0&&(Di(o.encoder,o.count===1?o.s:-o.s),o.count>1&&Me(o.encoder,o.count-2))},xn=class{constructor(){this.encoder=new gn,this.s=0,this.count=0}write(e){this.s===e?this.count++:(Km(this),this.count=1,this.s=e)}toUint8Array(){return Km(this),pr(this.encoder)}};var Gm=o=>{if(o.count>0){let e=o.diff*2+(o.count===1?0:1);Di(o.encoder,e),o.count>1&&Me(o.encoder,o.count-2)}},ns=class{constructor(){this.encoder=new gn,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Gm(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Gm(this),pr(this.encoder)}},Ci=class{constructor(){this.sarr=[],this.s="",this.lensE=new xn}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){let e=new gn;return this.sarr.push(this.s),this.s="",So(e,this.sarr.join("")),fa(e,this.lensE.toUint8Array()),pr(e)}};var Sr=o=>new Error(o),Ur=()=>{throw Sr("Method unimplemented")},kr=()=>{throw Sr("Unexpected case")};var jm=Sr("Unexpected end of array"),Ym=Sr("Integer out of Range"),ss=class{constructor(e){this.arr=e,this.pos=0}},Br=o=>new ss(o),Jm=o=>o.pos!==o.arr.length;var f0=(o,e)=>{let t=new Uint8Array(o.arr.buffer,o.pos+o.arr.byteOffset,e);return o.pos+=e,t},Ft=o=>f0(o,Te(o));var bn=o=>o.arr[o.pos++];var Te=o=>{let e=0,t=1,r=o.arr.length;for(;o.pos<r;){let n=o.arr[o.pos++];if(e=e+(n&127)*t,t*=128,n<128)return e;if(e>jf)throw Ym}throw jm},Ai=o=>{let e=o.arr[o.pos++],t=e&63,r=64,n=(e&64)>0?-1:1;if(!(e&128))return n*t;let s=o.arr.length;for(;o.pos<s;){if(e=o.arr[o.pos++],t=t+(e&127)*r,r*=128,e<128)return n*t;if(t>jf)throw Ym}throw jm};var c0=o=>{let e=Te(o);if(e===0)return"";{let t=String.fromCodePoint(bn(o));if(--e<100)for(;e--;)t+=String.fromCodePoint(bn(o));else for(;e>0;){let r=e<1e4?e:1e4,n=o.arr.subarray(o.pos,o.pos+r);o.pos+=r,t+=String.fromCodePoint.apply(null,n),e-=r}return decodeURIComponent(escape(t))}},u0=o=>es.decode(Ft(o)),$r=es?u0:c0;var tc=(o,e)=>{let t=new DataView(o.arr.buffer,o.arr.byteOffset+o.pos,e);return o.pos+=e,t},d0=o=>tc(o,4).getFloat32(0,!1),p0=o=>tc(o,8).getFloat64(0,!1),m0=o=>tc(o,8).getBigInt64(0,!1);var h0=[o=>{},o=>null,Ai,d0,p0,m0,o=>!1,o=>!0,$r,o=>{let e=Te(o),t={};for(let r=0;r<e;r++){let n=$r(o);t[n]=as(o)}return t},o=>{let e=Te(o),t=[];for(let r=0;r<e;r++)t.push(as(o));return t},Ft],as=o=>h0[127-bn(o)](o),ca=class extends ss{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),Jm(this)?this.count=Te(this)+1:this.count=-1),this.count--,this.s}};var wn=class extends ss{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Ai(this);let e=Ii(this.s);this.count=1,e&&(this.s=-this.s,this.count=Te(this)+2)}return this.count--,this.s}};var is=class extends ss{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){let e=Ai(this),t=e&1;this.diff=sr(e/2),this.count=1,t&&(this.count=Te(this)+2)}return this.s+=this.diff,this.count--,this.s}},Pi=class{constructor(e){this.decoder=new wn(e),this.str=$r(this.decoder),this.spos=0}read(){let e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}};var aM=crypto.subtle,Xm=crypto.getRandomValues.bind(crypto);var ua=()=>Xm(new Uint32Array(1))[0];var g0=[1e7]+-1e3+-4e3+-8e3+-1e11,Mi=()=>g0.replace(/[018]/g,o=>(o^ua()&15>>o/4).toString(16));var _n=Date.now;var ko=o=>new Promise(o);var x0=Promise.all.bind(Promise);var oc=o=>o===void 0?null:o;var nc=class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},eh=new nc,b0=!0;try{typeof localStorage!="undefined"&&localStorage&&(eh=localStorage,b0=!1)}catch(o){}var th=eh;var rh=Object.assign,_0=Object.keys,oh=(o,e)=>{for(let t in o)e(o[t],t)};var da=o=>_0(o).length;var nh=o=>{for(let e in o)return!1;return!0},v0=(o,e)=>{for(let t in o)if(!e(o[t],t))return!1;return!0},sc=(o,e)=>Object.prototype.hasOwnProperty.call(o,e),ac=(o,e)=>o===e||da(o)===da(e)&&v0(o,(t,r)=>(t!==void 0||sc(e,r))&&e[r]===t);var pa=(o,e,t=0)=>{try{for(;t<o.length;t++)o[t](...e)}finally{t<o.length&&pa(o,e,t+1)}};var ah=o=>o,S0=(o,e)=>o===e;var ls=(o,e)=>{if(o==null||e==null)return S0(o,e);if(o.constructor!==e.constructor)return!1;if(o===e)return!0;switch(o.constructor){case ArrayBuffer:o=new Uint8Array(o),e=new Uint8Array(e);case Uint8Array:{if(o.byteLength!==e.byteLength)return!1;for(let t=0;t<o.length;t++)if(o[t]!==e[t])return!1;break}case Set:{if(o.size!==e.size)return!1;for(let t of o)if(!e.has(t))return!1;break}case Map:{if(o.size!==e.size)return!1;for(let t of o.keys())if(!e.has(t)||!ls(o.get(t),e.get(t)))return!1;break}case Object:if(da(o)!==da(e))return!1;for(let t in o)if(!sc(o,t)||!ls(o[t],e[t]))return!1;break;case Array:if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!ls(o[t],e[t]))return!1;break;default:return!1}return!0},ih=(o,e)=>e.includes(o);var ma=typeof process!="undefined"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process!="undefined"?process:0)==="[object process]";var fM=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1,Zr,k0=[],L0=()=>{if(Zr===void 0)if(ma){Zr=It();let o=process.argv,e=null;for(let t=0;t<o.length;t++){let r=o[t];r[0]==="-"?(e!==null&&Zr.set(e,""),e=r):e!==null?(Zr.set(e,r),e=null):k0.push(r)}e!==null&&Zr.set(e,"")}else typeof location=="object"?(Zr=It(),(location.search||"?").slice(1).split("&").forEach(o=>{if(o.length!==0){let[e,t]=o.split("=");Zr.set(`--${Yf(e,"-")}`,t),Zr.set(`-${Yf(e,"-")}`,t)}})):Zr=It();return Zr},lc=o=>L0().has(o);var fc=o=>ma?oc(process.env[o.toUpperCase().replaceAll("-","_")]):oc(th.getItem(o));var I0=o=>lc("--"+o)||fc(o)!==null,cM=I0("production"),lh=ma&&ih(process.env.FORCE_COLOR,["true","1","2"]),fh=!lc("no-colors")&&(!ma||process.stdout.isTTY||lh)&&(!ma||lc("color")||lh||fc("COLORTERM")!==null||(fc("TERM")||"").includes("color"));var T0=o=>new Uint8Array(o);var ch=o=>{let e=T0(o.byteLength);return e.set(o),e};var cc=class{constructor(e,t){this.left=e,this.right=t}},Kt=(o,e)=>new cc(o,e);var uh=(o,e)=>o.forEach(t=>e(t.left,t.right));var eo=typeof document!="undefined"?document:{},P0=o=>eo.createElement(o),A0=()=>eo.createDocumentFragment(),E0=o=>eo.createTextNode(o),uM=typeof DOMParser!="undefined"?new DOMParser:null;var M0=(o,e)=>(uh(e,(t,r)=>{r===!1?o.removeAttribute(t):r===!0?o.setAttribute(t,""):o.setAttribute(t,r)}),o);var R0=o=>{let e=A0();for(let t=0;t<o.length;t++)mh(e,o[t]);return e},dh=(o,e)=>(mh(o,R0(e)),o);var ha=(o,e=[],t=[])=>dh(M0(P0(o),e),t);var fs=E0;var ph=o=>$m(o,(e,t)=>`${t}:${e};`).join("");var mh=(o,e)=>o.appendChild(e),dM=eo.ELEMENT_NODE,pM=eo.TEXT_NODE,mM=eo.CDATA_SECTION_NODE,hM=eo.COMMENT_NODE,gM=eo.DOCUMENT_NODE,xM=eo.DOCUMENT_TYPE_NODE,yM=eo.DOCUMENT_FRAGMENT_NODE;var to=Symbol;var ga=to(),xa=to(),dc=to(),pc=to(),mc=to(),ya=to(),hc=to(),ba=to(),gc=to(),gh=o=>{var n;o.length===1&&((n=o[0])==null?void 0:n.constructor)===Function&&(o=o[0]());let e=[],t=[],r=0;for(;r<o.length;r++){let s=o[r];s===void 0?e.push("undefined"):s.constructor===String||s.constructor===Number?e.push(s):s.constructor===Object&&t.push(JSON.stringify(s))}return t};var bM=_n();var U0={[ga]:Kt("font-weight","bold"),[xa]:Kt("font-weight","normal"),[dc]:Kt("color","blue"),[mc]:Kt("color","green"),[pc]:Kt("color","grey"),[ya]:Kt("color","red"),[hc]:Kt("color","purple"),[ba]:Kt("color","orange"),[gc]:Kt("color","black")},$0=o=>{var a;o.length===1&&((a=o[0])==null?void 0:a.constructor)===Function&&(o=o[0]());let e=[],t=[],r=It(),n=[],s=0;for(;s<o.length;s++){let i=o[s],l=U0[i];if(l!==void 0)r.set(l.left,l.right);else{if(i===void 0)break;if(i.constructor===String||i.constructor===Number){let c=ph(r);s>0||c.length>0?(e.push("%c"+i),t.push(c)):e.push(i)}else break}}for(s>0&&(n=t,n.unshift(e.join("")));s<o.length;s++){let i=o[s];i instanceof Symbol||n.push(i)}return n},B0=fh?$0:gh,xh=(...o)=>{console.log(...B0(o)),N0.forEach(e=>e.print(o))};var N0=Qr();var yh=o=>({[Symbol.iterator](){return this},next:o}),bh=(o,e)=>yh(()=>{let t;do t=o.next();while(!t.done&&!e(t.value));return t}),Ri=(o,e)=>yh(()=>{let{done:t,value:r}=o.next();return{done:t,value:t?void 0:e(r)}});var _a=class{constructor(e,t){this.clock=e,this.len=t}},vn=class{constructor(){this.clients=new Map}},Rh=(o,e,t)=>e.clients.forEach((r,n)=>{let s=o.doc.store.clients.get(n);for(let a=0;a<r.length;a++){let i=r[a];qh(o,s,i.clock,i.len,t)}}),z0=(o,e)=>{let t=0,r=o.length-1;for(;t<=r;){let n=sr((t+r)/2),s=o[n],a=s.clock;if(a<=e){if(e<a+s.len)return n;t=n+1}else r=n-1}return null},Ec=(o,e)=>{let t=o.clients.get(e.client);return t!==void 0&&z0(t,e.clock)!==null},Mc=o=>{o.clients.forEach(e=>{e.sort((n,s)=>n.clock-s.clock);let t,r;for(t=1,r=1;t<e.length;t++){let n=e[r-1],s=e[t];n.clock+n.len>=s.clock?n.len=Or(n.len,s.clock+s.len-n.clock):(r<t&&(e[r]=s),r++)}e.length=r})},yc=o=>{let e=new vn;for(let t=0;t<o.length;t++)o[t].clients.forEach((r,n)=>{if(!e.clients.has(n)){let s=r.slice();for(let a=t+1;a<o.length;a++)Nm(s,o[a].clients.get(n)||[]);e.clients.set(n,s)}});return Mc(e),e},Hi=(o,e,t,r)=>{Rr(o.clients,e,()=>[]).push(new _a(t,r))},Rc=()=>new vn,K0=o=>{let e=Rc();return o.clients.forEach((t,r)=>{let n=[];for(let s=0;s<t.length;s++){let a=t[s];if(a.deleted){let i=a.id.clock,l=a.length;if(s+1<t.length)for(let c=t[s+1];s+1<t.length&&c.deleted;c=t[++s+1])l+=c.length;n.push(new _a(i,l))}}n.length>0&&e.clients.set(r,n)}),e},Yo=(o,e)=>{Me(o.restEncoder,e.clients.size),Fr(e.clients.entries()).sort((t,r)=>r[0]-t[0]).forEach(([t,r])=>{o.resetDsCurVal(),Me(o.restEncoder,t);let n=r.length;Me(o.restEncoder,n);for(let s=0;s<n;s++){let a=r[s];o.writeDsClock(a.clock),o.writeDsLen(a.len)}})},va=o=>{let e=new vn,t=Te(o.restDecoder);for(let r=0;r<t;r++){o.resetDsCurVal();let n=Te(o.restDecoder),s=Te(o.restDecoder);if(s>0){let a=Rr(e.clients,n,()=>[]);for(let i=0;i<s;i++)a.push(new _a(o.readDsClock(),o.readDsLen()))}}return e},vh=(o,e,t)=>{let r=new vn,n=Te(o.restDecoder);for(let s=0;s<n;s++){o.resetDsCurVal();let a=Te(o.restDecoder),i=Te(o.restDecoder),l=t.clients.get(a)||[],c=_t(t,a);for(let u=0;u<i;u++){let d=o.readDsClock(),m=d+o.readDsLen();if(d<c){c<m&&Hi(r,a,c,m-c);let x=oo(l,d),h=l[x];for(!h.deleted&&h.id.clock<d&&(l.splice(x+1,0,Ji(e,h,d-h.id.clock)),x++);x<l.length&&(h=l[x++],h.id.clock<m);)h.deleted||(m<h.id.clock+h.length&&l.splice(x,0,Ji(e,h,m-h.id.clock)),h.delete(e))}else Hi(r,a,d,m-d)}}if(r.clients.size>0){let s=new Lo;return Me(s.restEncoder,0),Yo(s,r),s.toUint8Array()}return null};var Fh=ua,mr=class extends Li{constructor({guid:e=Mi(),collectionid:t=null,gc:r=!0,gcFilter:n=()=>!0,meta:s=null,autoLoad:a=!1,shouldLoad:i=!0}={}){super(),this.gc=r,this.gcFilter=n,this.clientID=Fh(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new Ki,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=i,this.autoLoad=a,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=ko(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});let l=()=>ko(c=>{let u=d=>{(d===void 0||d===!0)&&(this.off("sync",u),c())};this.on("sync",u)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){let e=this._item;e!==null&&!this.shouldLoad&&Ze(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Fr(this.subdocs).map(e=>e.guid))}transact(e,t=null){return Ze(this,e,t)}get(e,t=St){let r=Rr(this.share,e,()=>{let s=new t;return s._integrate(this,null),s}),n=r.constructor;if(t!==St&&n!==t)if(n===St){let s=new t;s._map=r._map,r._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=s}),s._start=r._start;for(let a=s._start;a!==null;a=a.right)a.parent=s;return s._length=r._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,ro)}getText(e=""){return this.get(e,Qo)}getMap(e=""){return this.get(e,Io)}getXmlElement(e=""){return this.get(e,Zo)}getXmlFragment(e=""){return this.get(e,Co)}toJSON(){let e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){Fr(this.subdocs).forEach(t=>t.destroy());let e=this._item;if(e!==null){this._item=null;let t=e.content;t.doc=new mr({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,Ze(e.parent.doc,r=>{let n=t.doc;e.deleted||r.subdocsAdded.add(n),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}},ds=class{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Te(this.restDecoder)}readDsLen(){return Te(this.restDecoder)}},Vi=class extends ds{readLeftID(){return Ne(Te(this.restDecoder),Te(this.restDecoder))}readRightID(){return Ne(Te(this.restDecoder),Te(this.restDecoder))}readClient(){return Te(this.restDecoder)}readInfo(){return bn(this.restDecoder)}readString(){return $r(this.restDecoder)}readParentInfo(){return Te(this.restDecoder)===1}readTypeRef(){return Te(this.restDecoder)}readLen(){return Te(this.restDecoder)}readAny(){return as(this.restDecoder)}readBuf(){return ch(Ft(this.restDecoder))}readJSON(){return JSON.parse($r(this.restDecoder))}readKey(){return $r(this.restDecoder)}},bc=class{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Te(this.restDecoder),this.dsCurrVal}readDsLen(){let e=Te(this.restDecoder)+1;return this.dsCurrVal+=e,e}},Jo=class extends bc{constructor(e){super(e),this.keys=[],Te(e),this.keyClockDecoder=new is(Ft(e)),this.clientDecoder=new wn(Ft(e)),this.leftClockDecoder=new is(Ft(e)),this.rightClockDecoder=new is(Ft(e)),this.infoDecoder=new ca(Ft(e),bn),this.stringDecoder=new Pi(Ft(e)),this.parentInfoDecoder=new ca(Ft(e),bn),this.typeRefDecoder=new wn(Ft(e)),this.lenDecoder=new wn(Ft(e))}readLeftID(){return new jo(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new jo(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return as(this.restDecoder)}readBuf(){return Ft(this.restDecoder)}readJSON(){return as(this.restDecoder)}readKey(){let e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{let t=this.stringDecoder.read();return this.keys.push(t),t}}},ps=class{constructor(){this.restEncoder=yn()}toUint8Array(){return pr(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Me(this.restEncoder,e)}writeDsLen(e){Me(this.restEncoder,e)}},Sn=class extends ps{writeLeftID(e){Me(this.restEncoder,e.client),Me(this.restEncoder,e.clock)}writeRightID(e){Me(this.restEncoder,e.client),Me(this.restEncoder,e.clock)}writeClient(e){Me(this.restEncoder,e)}writeInfo(e){Ti(this.restEncoder,e)}writeString(e){So(this.restEncoder,e)}writeParentInfo(e){Me(this.restEncoder,e?1:0)}writeTypeRef(e){Me(this.restEncoder,e)}writeLen(e){Me(this.restEncoder,e)}writeAny(e){os(this.restEncoder,e)}writeBuf(e){Tt(this.restEncoder,e)}writeJSON(e){So(this.restEncoder,JSON.stringify(e))}writeKey(e){So(this.restEncoder,e)}},qi=class{constructor(){this.restEncoder=yn(),this.dsCurrVal=0}toUint8Array(){return pr(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){let t=e-this.dsCurrVal;this.dsCurrVal=e,Me(this.restEncoder,t)}writeDsLen(e){e===0&&kr(),Me(this.restEncoder,e-1),this.dsCurrVal+=e}},Lo=class extends qi{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new ns,this.clientEncoder=new xn,this.leftClockEncoder=new ns,this.rightClockEncoder=new ns,this.infoEncoder=new la(Ti),this.stringEncoder=new Ci,this.parentInfoEncoder=new la(Ti),this.typeRefEncoder=new xn,this.lenEncoder=new xn}toUint8Array(){let e=yn();return Me(e,0),Tt(e,this.keyClockEncoder.toUint8Array()),Tt(e,this.clientEncoder.toUint8Array()),Tt(e,this.leftClockEncoder.toUint8Array()),Tt(e,this.rightClockEncoder.toUint8Array()),Tt(e,pr(this.infoEncoder)),Tt(e,this.stringEncoder.toUint8Array()),Tt(e,pr(this.parentInfoEncoder)),Tt(e,this.typeRefEncoder.toUint8Array()),Tt(e,this.lenEncoder.toUint8Array()),fa(e,pr(this.restEncoder)),pr(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){os(this.restEncoder,e)}writeBuf(e){Tt(this.restEncoder,e)}writeJSON(e){os(this.restEncoder,e)}writeKey(e){let t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}},G0=(o,e,t,r)=>{r=Or(r,e[0].id.clock);let n=oo(e,r);Me(o.restEncoder,e.length-n),o.writeClient(t),Me(o.restEncoder,r);let s=e[n];s.write(o,r-s.id.clock);for(let a=n+1;a<e.length;a++)e[a].write(o,0)},Fc=(o,e,t)=>{let r=new Map;t.forEach((n,s)=>{_t(e,s)>n&&r.set(s,n)}),Xi(e).forEach((n,s)=>{t.has(s)||r.set(s,0)}),Me(o.restEncoder,r.size),Fr(r.entries()).sort((n,s)=>s[0]-n[0]).forEach(([n,s])=>{G0(o,e.clients.get(n),n,s)})},j0=(o,e)=>{let t=It(),r=Te(o.restDecoder);for(let n=0;n<r;n++){let s=Te(o.restDecoder),a=new Array(s),i=o.readClient(),l=Te(o.restDecoder);t.set(i,{i:0,refs:a});for(let c=0;c<s;c++){let u=o.readInfo();switch(31&u){case 0:{let d=o.readLen();a[c]=new ar(Ne(i,l),d),l+=d;break}case 10:{let d=Te(o.restDecoder);a[c]=new ir(Ne(i,l),d),l+=d;break}default:{let d=(u&192)===0,m=new ft(Ne(i,l),null,(u&128)===128?o.readLeftID():null,null,(u&64)===64?o.readRightID():null,d?o.readParentInfo()?e.get(o.readString()):o.readLeftID():null,d&&(u&32)===32?o.readString():null,lg(o,u));a[c]=m,l+=m.length}}}}return t},Y0=(o,e,t)=>{let r=[],n=Fr(t.keys()).sort((x,h)=>x-h);if(n.length===0)return null;let s=()=>{if(n.length===0)return null;let x=t.get(n[n.length-1]);for(;x.refs.length===x.i;)if(n.pop(),n.length>0)x=t.get(n[n.length-1]);else return null;return x},a=s();if(a===null)return null;let i=new Ki,l=new Map,c=(x,h)=>{let v=l.get(x);(v==null||v>h)&&l.set(x,h)},u=a.refs[a.i++],d=new Map,m=()=>{for(let x of r){let h=x.id.client,v=t.get(h);v?(v.i--,i.clients.set(h,v.refs.slice(v.i)),t.delete(h),v.i=0,v.refs=[]):i.clients.set(h,[x]),n=n.filter(w=>w!==h)}r.length=0};for(;;){if(u.constructor!==ir){let h=Rr(d,u.id.client,()=>_t(e,u.id.client))-u.id.clock;if(h<0)r.push(u),c(u.id.client,u.id.clock-1),m();else{let v=u.getMissing(o,e);if(v!==null){r.push(u);let w=t.get(v)||{refs:[],i:0};if(w.refs.length===w.i)c(v,_t(e,v)),m();else{u=w.refs[w.i++];continue}}else(h===0||h<u.length)&&(u.integrate(o,h),d.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(a!==null&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=s(),a===null)break;u=a.refs[a.i++]}}if(i.clients.size>0){let x=new Lo;return Fc(x,i,new Map),Me(x.restEncoder,0),{missing:l,update:x.toUint8Array()}}return null},J0=(o,e)=>Fc(o,e.doc.store,e.beforeState),X0=(o,e,t,r=new Jo(o))=>Ze(e,n=>{n.local=!1;let s=!1,a=n.doc,i=a.store,l=j0(r,a),c=Y0(n,i,l),u=i.pendingStructs;if(u){for(let[m,x]of u.missing)if(x<_t(i,m)){s=!0;break}if(c){for(let[m,x]of c.missing){let h=u.missing.get(m);(h==null||h>x)&&u.missing.set(m,x)}u.update=Gi([u.update,c.update])}}else i.pendingStructs=c;let d=vh(r,n,i);if(i.pendingDs){let m=new Jo(Br(i.pendingDs));Te(m.restDecoder);let x=vh(m,n,i);d&&x?i.pendingDs=Gi([d,x]):i.pendingDs=d||x}else i.pendingDs=d;if(s){let m=i.pendingStructs.update;i.pendingStructs=null,Oh(n.doc,m)}},t,!1);var Oh=(o,e,t,r=Jo)=>{let n=Br(e);X0(n,o,t,new r(n))},Do=(o,e,t)=>Oh(o,e,t,Vi),Q0=(o,e,t=new Map)=>{Fc(o,e.store,t),Yo(o,K0(e.store))},Z0=(o,e=new Uint8Array([0]),t=new Lo)=>{let r=Uh(e);Q0(t,o,r);let n=[t.toUint8Array()];if(o.store.pendingDs&&n.push(o.store.pendingDs),o.store.pendingStructs&&n.push(dk(o.store.pendingStructs.update,e)),n.length>1){if(t.constructor===Sn)return ck(n.map((s,a)=>a===0?s:mk(s)));if(t.constructor===Lo)return Gi(n)}return n[0]},Cn=(o,e)=>Z0(o,e,new Sn),ek=o=>{let e=new Map,t=Te(o.restDecoder);for(let r=0;r<t;r++){let n=Te(o.restDecoder),s=Te(o.restDecoder);e.set(n,s)}return e},Uh=o=>ek(new ds(Br(o))),$h=(o,e)=>(Me(o.restEncoder,e.size),Fr(e.entries()).sort((t,r)=>r[0]-t[0]).forEach(([t,r])=>{Me(o.restEncoder,t),Me(o.restEncoder,r)}),o),tk=(o,e)=>$h(o,Xi(e.store)),rk=(o,e=new qi)=>(o instanceof Map?$h(e,o):tk(e,o),e.toUint8Array()),Bh=o=>rk(o,new ps),wc=class{constructor(){this.l=[]}},Sh=()=>new wc,kh=(o,e)=>o.l.push(e),Lh=(o,e)=>{let t=o.l,r=t.length;o.l=t.filter(n=>e!==n),r===o.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Nh=(o,e,t)=>pa(o.l,[e,t]),jo=class{constructor(e,t){this.client=e,this.clock=t}},us=(o,e)=>o===e||o!==null&&e!==null&&o.client===e.client&&o.clock===e.clock,Ne=(o,e)=>new jo(o,e);var Hh=o=>{for(let[e,t]of o.doc.share.entries())if(t===o)return e;throw kr()};var Wi=class{constructor(e,t=e.getMap("users")){let r=new Map;this.yusers=t,this.doc=e,this.clients=new Map,this.dss=r;let n=(s,a)=>{let i=s.get("ds"),l=s.get("ids"),c=u=>this.clients.set(u,a);i.observe(u=>{u.changes.added.forEach(d=>{d.content.getContent().forEach(m=>{m instanceof Uint8Array&&this.dss.set(a,yc([this.dss.get(a)||Rc(),va(new ds(Br(m)))]))})})}),this.dss.set(a,yc(i.map(u=>va(new ds(Br(u)))))),l.observe(u=>u.changes.added.forEach(d=>d.content.getContent().forEach(c))),l.forEach(c)};t.observe(s=>{s.keysChanged.forEach(a=>n(t.get(a),a))}),t.forEach(n)}setUserMapping(e,t,r,{filter:n=()=>!0}={}){let s=this.yusers,a=s.get(r);a||(a=new Io,a.set("ids",new ro),a.set("ds",new ro),s.set(r,a)),a.get("ids").push([t]),s.observe(i=>{setTimeout(()=>{let l=s.get(r);if(l!==a){a=l,this.clients.forEach((d,m)=>{r===d&&a.get("ids").push([m])});let c=new ps,u=this.dss.get(r);u&&(Yo(c,u),a.get("ds").push([c.toUint8Array()]))}},0)}),e.on("afterTransaction",i=>{setTimeout(()=>{let l=a.get("ds"),c=i.deleteSet;if(i.local&&c.clients.size>0&&n(i,c)){let u=new ps;Yo(u,c),l.push([u.toUint8Array()])}})})}getUserByClientId(e){return this.clients.get(e)||null}getUserByDeletedId(e){for(let[t,r]of this.dss.entries())if(Ec(r,e))return t;return null}},zi=class{constructor(e,t,r,n=0){this.type=e,this.tname=t,this.item=r,this.assoc=n}};var Oc=o=>new zi(o.type==null?null:Ne(o.type.client,o.type.clock),o.tname||null,o.item==null?null:Ne(o.item.client,o.item.clock),o.assoc==null?0:o.assoc),_c=class{constructor(e,t,r=0){this.type=e,this.index=t,this.assoc=r}},ok=(o,e,t=0)=>new _c(o,e,t),Fi=(o,e,t)=>{let r=null,n=null;return o._item===null?n=Hh(o):r=Ne(o._item.id.client,o._item.id.clock),new zi(r,n,e,t)},Uc=(o,e,t=0)=>{let r=o._start;if(t<0){if(e===0)return Fi(o,null,t);e--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>e)return Fi(o,Ne(r.id.client,r.id.clock+e),t);e-=r.length}if(r.right===null&&t<0)return Fi(o,r.lastId,t);r=r.right}return Fi(o,null,t)};var $c=(o,e)=>{let t=e.store,r=o.item,n=o.type,s=o.tname,a=o.assoc,i=null,l=0;if(r!==null){if(_t(t,r.client)<=r.clock)return null;let c=Mh(t,r),u=c.item;if(!(u instanceof ft))return null;if(i=u.parent,i._item===null||!i._item.deleted){l=u.deleted||!u.countable?0:c.diff+(a>=0?0:1);let d=u.left;for(;d!==null;)!d.deleted&&d.countable&&(l+=d.length),d=d.left}}else{if(s!==null)i=e.get(s);else if(n!==null){if(_t(t,n.client)<=n.clock)return null;let{item:c}=Mh(t,n);if(c instanceof ft&&c.content instanceof Ir)i=c.content.type;else return null}else throw kr();a>=0?l=i._length:l=0}return ok(i,l,o.assoc)},Bc=(o,e)=>o===e||o!==null&&e!==null&&o.tname===e.tname&&us(o.item,e.item)&&us(o.type,e.type)&&o.assoc===e.assoc,vc=class{constructor(e,t){this.ds=e,this.sv=t}};var nk=(o,e)=>new vc(o,e),DM=nk(Rc(),new Map);var cs=(o,e)=>e===void 0?!o.deleted:e.sv.has(o.id.client)&&(e.sv.get(o.id.client)||0)>o.id.clock&&!Ec(e.ds,o.id),Sc=(o,e)=>{let t=Rr(o.meta,Sc,Qr),r=o.doc.store;t.has(e)||(e.sv.forEach((n,s)=>{n<_t(r,s)&&Xo(o,Ne(s,n))}),Rh(o,e.ds,n=>{}),t.add(e))};var Ki=class{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}},Xi=o=>{let e=new Map;return o.clients.forEach((t,r)=>{let n=t[t.length-1];e.set(r,n.id.clock+n.length)}),e},_t=(o,e)=>{let t=o.clients.get(e);if(t===void 0)return 0;let r=t[t.length-1];return r.id.clock+r.length},Vh=(o,e)=>{let t=o.clients.get(e.id.client);if(t===void 0)t=[],o.clients.set(e.id.client,t);else{let r=t[t.length-1];if(r.id.clock+r.length!==e.id.clock)throw kr()}t.push(e)},oo=(o,e)=>{let t=0,r=o.length-1,n=o[r],s=n.id.clock;if(s===e)return r;let a=sr(e/(s+n.length-1)*r);for(;t<=r;){if(n=o[a],s=n.id.clock,s<=e){if(e<s+n.length)return a;t=a+1}else r=a-1;a=sr((t+r)/2)}throw kr()},sk=(o,e)=>{let t=o.clients.get(e.client);return t[oo(t,e.clock)]},$i=sk,kc=(o,e,t)=>{let r=oo(e,t),n=e[r];return n.id.clock<t&&n instanceof ft?(e.splice(r+1,0,Ji(o,n,t-n.id.clock)),r+1):r},Xo=(o,e)=>{let t=o.doc.store.clients.get(e.client);return t[kc(o,t,e.clock)]},Ih=(o,e,t)=>{let r=e.clients.get(t.client),n=oo(r,t.clock),s=r[n];return t.clock!==s.id.clock+s.length-1&&s.constructor!==ar&&r.splice(n+1,0,Ji(o,s,t.clock-s.id.clock+1)),s},ak=(o,e,t)=>{let r=o.clients.get(e.id.client);r[oo(r,e.id.clock)]=t},qh=(o,e,t,r,n)=>{if(r===0)return;let s=t+r,a=kc(o,e,t),i;do i=e[a++],s<i.id.clock+i.length&&kc(o,e,s),n(i);while(a<e.length&&e[a].id.clock<s)},Lc=class{constructor(e,t,r){this.doc=e,this.deleteSet=new vn,this.beforeState=Xi(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}},Ch=(o,e)=>e.deleteSet.clients.size===0&&!Bm(e.afterState,(t,r)=>e.beforeState.get(r)!==t)?!1:(Mc(e.deleteSet),J0(o,e),Yo(o,e.deleteSet),!0),Th=(o,e,t)=>{let r=e._item;(r===null||r.id.clock<(o.beforeState.get(r.id.client)||0)&&!r.deleted)&&Rr(o.changed,e,Qr).add(t)},Bi=(o,e)=>{let t=o[e],r=o[e-1],n=e;for(;n>0;t=r,r=o[--n-1]){if(r.deleted===t.deleted&&r.constructor===t.constructor&&r.mergeWith(t)){t instanceof ft&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,r);continue}break}let s=e-n;return s&&o.splice(e+1-s,s),s},ik=(o,e,t)=>{for(let[r,n]of o.clients.entries()){let s=e.clients.get(r);for(let a=n.length-1;a>=0;a--){let i=n[a],l=i.clock+i.len;for(let c=oo(s,i.clock),u=s[c];c<s.length&&u.id.clock<l;u=s[++c]){let d=s[c];if(i.clock+i.len<=d.id.clock)break;d instanceof ft&&d.deleted&&!d.keep&&t(d)&&d.gc(e,!1)}}}},lk=(o,e)=>{o.clients.forEach((t,r)=>{let n=e.clients.get(r);for(let s=t.length-1;s>=0;s--){let a=t[s],i=Qn(n.length-1,1+oo(n,a.clock+a.len-1));for(let l=i,c=n[l];l>0&&c.id.clock>=a.clock;c=n[l])l-=1+Bi(n,l)}})};var Wh=(o,e)=>{if(e<o.length){let t=o[e],r=t.doc,n=r.store,s=t.deleteSet,a=t._mergeStructs;try{Mc(s),t.afterState=Xi(t.doc.store),r.emit("beforeObserverCalls",[t,r]);let i=[];t.changed.forEach((l,c)=>i.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(t,l)})),i.push(()=>{t.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(u=>u.target._item===null||!u.target._item.deleted),l.forEach(u=>{u.currentTarget=c,u._path=null}),l.sort((u,d)=>u.path.length-d.path.length),Nh(c._dEH,l,t))})}),i.push(()=>r.emit("afterTransaction",[t,r])),pa(i,[]),t._needFormattingCleanup&&Lk(t)}finally{r.gc&&ik(s,n,r.gcFilter),lk(s,n),t.afterState.forEach((u,d)=>{let m=t.beforeState.get(d)||0;if(m!==u){let x=n.clients.get(d),h=Or(oo(x,m),1);for(let v=x.length-1;v>=h;)v-=1+Bi(x,v)}});for(let u=a.length-1;u>=0;u--){let{client:d,clock:m}=a[u].id,x=n.clients.get(d),h=oo(x,m);h+1<x.length&&Bi(x,h+1)>1||h>0&&Bi(x,h)}if(!t.local&&t.afterState.get(r.clientID)!==t.beforeState.get(r.clientID)&&(xh(ba,ga,"[yjs] ",xa,ya,"Changed the client-id because another client seems to be using it."),r.clientID=Fh()),r.emit("afterTransactionCleanup",[t,r]),r._observers.has("update")){let u=new Sn;Ch(u,t)&&r.emit("update",[u.toUint8Array(),t.origin,r,t])}if(r._observers.has("updateV2")){let u=new Lo;Ch(u,t)&&r.emit("updateV2",[u.toUint8Array(),t.origin,r,t])}let{subdocsAdded:i,subdocsLoaded:l,subdocsRemoved:c}=t;(i.size>0||c.size>0||l.size>0)&&(i.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),c.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:l,added:i,removed:c},r,t]),c.forEach(u=>u.destroy())),o.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,o])):Wh(o,e+1)}}},Ze=(o,e,t=null,r=!0)=>{let n=o._transactionCleanups,s=!1,a=null;o._transaction===null&&(s=!0,o._transaction=new Lc(o,t,r),n.push(o._transaction),n.length===1&&o.emit("beforeAllTransactions",[o]),o.emit("beforeTransaction",[o._transaction,o]));try{a=e(o._transaction)}finally{if(s){let i=o._transaction===n[0];o._transaction=null,i&&Wh(n,0)}}return a};function*fk(o){let e=Te(o.restDecoder);for(let t=0;t<e;t++){let r=Te(o.restDecoder),n=o.readClient(),s=Te(o.restDecoder);for(let a=0;a<r;a++){let i=o.readInfo();if(i===10){let l=Te(o.restDecoder);yield new ir(Ne(n,s),l),s+=l}else if(31&i){let l=(i&192)===0,c=new ft(Ne(n,s),null,(i&128)===128?o.readLeftID():null,null,(i&64)===64?o.readRightID():null,l?o.readParentInfo()?o.readString():o.readLeftID():null,l&&(i&32)===32?o.readString():null,lg(o,i));yield c,s+=c.length}else{let l=o.readLen();yield new ar(Ne(n,s),l),s+=l}}}}var Sa=class{constructor(e,t){this.gen=fk(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===ir);return this.curr}};var ka=class{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}},ck=o=>Gi(o,Vi,Sn);var uk=(o,e)=>{if(o.constructor===ar){let{client:t,clock:r}=o.id;return new ar(Ne(t,r+e),o.length-e)}else if(o.constructor===ir){let{client:t,clock:r}=o.id;return new ir(Ne(t,r+e),o.length-e)}else{let t=o,{client:r,clock:n}=t.id;return new ft(Ne(r,n+e),null,Ne(r,n+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},Gi=(o,e=Jo,t=Lo)=>{if(o.length===1)return o[0];let r=o.map(u=>new e(Br(u))),n=r.map(u=>new Sa(u,!0)),s=null,a=new t,i=new ka(a);for(;n=n.filter(m=>m.curr!==null),n.sort((m,x)=>{if(m.curr.id.client===x.curr.id.client){let h=m.curr.id.clock-x.curr.id.clock;return h===0?m.curr.constructor===x.curr.constructor?0:m.curr.constructor===ir?1:-1:h}else return x.curr.id.client-m.curr.id.client}),n.length!==0;){let u=n[0],d=u.curr.id.client;if(s!==null){let m=u.curr,x=!1;for(;m!==null&&m.id.clock+m.length<=s.struct.id.clock+s.struct.length&&m.id.client>=s.struct.id.client;)m=u.next(),x=!0;if(m===null||m.id.client!==d||x&&m.id.clock>s.struct.id.clock+s.struct.length)continue;if(d!==s.struct.id.client)Ko(i,s.struct,s.offset),s={struct:m,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<m.id.clock)if(s.struct.constructor===ir)s.struct.length=m.id.clock+m.length-s.struct.id.clock;else{Ko(i,s.struct,s.offset);let h=m.id.clock-s.struct.id.clock-s.struct.length;s={struct:new ir(Ne(d,s.struct.id.clock+s.struct.length),h),offset:0}}else{let h=s.struct.id.clock+s.struct.length-m.id.clock;h>0&&(s.struct.constructor===ir?s.struct.length-=h:m=uk(m,h)),s.struct.mergeWith(m)||(Ko(i,s.struct,s.offset),s={struct:m,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let m=u.curr;m!==null&&m.id.client===d&&m.id.clock===s.struct.id.clock+s.struct.length&&m.constructor!==ir;m=u.next())Ko(i,s.struct,s.offset),s={struct:m,offset:0}}s!==null&&(Ko(i,s.struct,s.offset),s=null),Nc(i);let l=r.map(u=>va(u)),c=yc(l);return Yo(a,c),a.toUint8Array()},dk=(o,e,t=Jo,r=Lo)=>{let n=Uh(e),s=new r,a=new ka(s),i=new t(Br(o)),l=new Sa(i,!1);for(;l.curr;){let u=l.curr,d=u.id.client,m=n.get(d)||0;if(l.curr.constructor===ir){l.next();continue}if(u.id.clock+u.length>m)for(Ko(a,u,Or(m-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===d;)Ko(a,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===d&&l.curr.id.clock+l.curr.length<=m;)l.next()}Nc(a);let c=va(i);return Yo(s,c),s.toUint8Array()};var zh=o=>{o.written>0&&(o.clientStructs.push({written:o.written,restEncoder:pr(o.encoder.restEncoder)}),o.encoder.restEncoder=yn(),o.written=0)},Ko=(o,e,t)=>{o.written>0&&o.currClient!==e.id.client&&zh(o),o.written===0&&(o.currClient=e.id.client,o.encoder.writeClient(e.id.client),Me(o.encoder.restEncoder,e.id.clock+t)),e.write(o.encoder,t),o.written++},Nc=o=>{zh(o);let e=o.encoder.restEncoder;Me(e,o.clientStructs.length);for(let t=0;t<o.clientStructs.length;t++){let r=o.clientStructs[t];Me(e,r.written),fa(e,r.restEncoder)}},pk=(o,e,t,r)=>{let n=new t(Br(o)),s=new Sa(n,!1),a=new r,i=new ka(a);for(let c=s.curr;c!==null;c=s.next())Ko(i,e(c),0);Nc(i);let l=va(n);return Yo(a,l),a.toUint8Array()};var mk=o=>pk(o,ah,Jo,Sn),Dh="You must not compute changes after the event-handler fired.",ms=class{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=hk(this.currentTarget,this.target))}deletes(e){return Ec(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Sr(Dh);let e=new Map,t=this.target;this.transaction.changed.get(t).forEach(n=>{if(n!==null){let s=t._map.get(n),a,i;if(this.adds(s)){let l=s.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(s))if(l!==null&&this.deletes(l))a="delete",i=ki(l.content.getContent());else return;else l!==null&&this.deletes(l)?(a="update",i=ki(l.content.getContent())):(a="add",i=void 0)}else if(this.deletes(s))a="delete",i=ki(s.content.getContent());else return;e.set(n,{action:a,oldValue:i})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Sr(Dh);let t=this.target,r=Qr(),n=Qr(),s=[];if(e={added:r,deleted:n,delta:s,keys:this.keys},this.transaction.changed.get(t).has(null)){let i=null,l=()=>{i&&s.push(i)};for(let c=t._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((i===null||i.delete===void 0)&&(l(),i={delete:0}),i.delete+=c.length,n.add(c)):this.adds(c)?((i===null||i.insert===void 0)&&(l(),i={insert:[]}),i.insert=i.insert.concat(c.content.getContent()),r.add(c)):((i===null||i.retain===void 0)&&(l(),i={retain:0}),i.retain+=c.length);i!==null&&i.retain===void 0&&l()}this._changes=e}return e}},hk=(o,e)=>{let t=[];for(;e._item!==null&&e!==o;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let r=0,n=e._item.parent._start;for(;n!==e._item&&n!==null;)n.deleted||r++,n=n.right;t.unshift(r)}e=e._item.parent}return t},Kh=80,Hc=0,Ic=class{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=Hc++}},gk=o=>{o.timestamp=Hc++},Gh=(o,e,t)=>{o.p.marker=!1,o.p=e,e.marker=!0,o.index=t,o.timestamp=Hc++},xk=(o,e,t)=>{if(o.length>=Kh){let r=o.reduce((n,s)=>n.timestamp<s.timestamp?n:s);return Gh(r,e,t),r}else{let r=new Ic(e,t);return o.push(r),r}},Qi=(o,e)=>{if(o._start===null||e===0||o._searchMarker===null)return null;let t=o._searchMarker.length===0?null:o._searchMarker.reduce((s,a)=>Xn(e-s.index)<Xn(e-a.index)?s:a),r=o._start,n=0;for(t!==null&&(r=t.p,n=t.index,gk(t));r.right!==null&&n<e;){if(!r.deleted&&r.countable){if(e<n+r.length)break;n+=r.length}r=r.right}for(;r.left!==null&&n>e;)r=r.left,!r.deleted&&r.countable&&(n-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(n-=r.length);return t!==null&&Xn(t.index-n)<r.parent.length/Kh?(Gh(t,r,n),t):xk(o._searchMarker,r,n)},La=(o,e,t)=>{for(let r=o.length-1;r>=0;r--){let n=o[r];if(t>0){let s=n.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(n.index-=s.length);if(s===null||s.marker===!0){o.splice(r,1);continue}n.p=s,s.marker=!0}(e<n.index||t>0&&e===n.index)&&(n.index=Or(e,n.index+t))}};var Zi=(o,e,t)=>{let r=o,n=e.changedParentTypes;for(;Rr(n,o,()=>[]).push(t),o._item!==null;)o=o._item.parent;Nh(r._eH,t,e)},St=class{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Sh(),this._dEH=Sh(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw Ur()}clone(){throw Ur()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){kh(this._eH,e)}observeDeep(e){kh(this._dEH,e)}unobserve(e){Lh(this._eH,e)}unobserveDeep(e){Lh(this._dEH,e)}toJSON(){}},jh=(o,e,t)=>{e<0&&(e=o._length+e),t<0&&(t=o._length+t);let r=t-e,n=[],s=o._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){let a=s.content.getContent();if(a.length<=e)e-=a.length;else{for(let i=e;i<a.length&&r>0;i++)n.push(a[i]),r--;e=0}}s=s.right}return n},Yh=o=>{let e=[],t=o._start;for(;t!==null;){if(t.countable&&!t.deleted){let r=t.content.getContent();for(let n=0;n<r.length;n++)e.push(r[n])}t=t.right}return e};var Ia=(o,e)=>{let t=0,r=o._start;for(;r!==null;){if(r.countable&&!r.deleted){let n=r.content.getContent();for(let s=0;s<n.length;s++)e(n[s],t++,o)}r=r.right}},Jh=(o,e)=>{let t=[];return Ia(o,(r,n)=>{t.push(e(r,n,o))}),t},yk=o=>{let e=o._start,t=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),r=0,e=e.right}let n=t[r++];return t.length<=r&&(t=null),{done:!1,value:n}}}},Xh=(o,e)=>{let t=Qi(o,e),r=o._start;for(t!==null&&(r=t.p,e-=t.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},ji=(o,e,t,r)=>{let n=t,s=o.doc,a=s.clientID,i=s.store,l=t===null?e._start:t.right,c=[],u=()=>{c.length>0&&(n=new ft(Ne(a,_t(i,a)),n,n&&n.lastId,l,l&&l.id,e,null,new Nr(c)),n.integrate(o,0),c=[])};r.forEach(d=>{if(d===null)c.push(d);else switch(d.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(d);break;default:switch(u(),d.constructor){case Uint8Array:case ArrayBuffer:n=new ft(Ne(a,_t(i,a)),n,n&&n.lastId,l,l&&l.id,e,null,new kn(new Uint8Array(d))),n.integrate(o,0);break;case mr:n=new ft(Ne(a,_t(i,a)),n,n&&n.lastId,l,l&&l.id,e,null,new In(d)),n.integrate(o,0);break;default:if(d instanceof St)n=new ft(Ne(a,_t(i,a)),n,n&&n.lastId,l,l&&l.id,e,null,new Ir(d)),n.integrate(o,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Qh=()=>Sr("Length exceeded!"),Zh=(o,e,t,r)=>{if(t>e._length)throw Qh();if(t===0)return e._searchMarker&&La(e._searchMarker,t,r.length),ji(o,e,null,r);let n=t,s=Qi(e,t),a=e._start;for(s!==null&&(a=s.p,t-=s.index,t===0&&(a=a.prev,t+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(t<=a.length){t<a.length&&Xo(o,Ne(a.id.client,a.id.clock+t));break}t-=a.length}return e._searchMarker&&La(e._searchMarker,n,r.length),ji(o,e,a,r)},bk=(o,e,t)=>{let n=(e._searchMarker||[]).reduce((s,a)=>a.index>s.index?a:s,{index:0,p:e._start}).p;if(n)for(;n.right;)n=n.right;return ji(o,e,n,t)},eg=(o,e,t,r)=>{if(r===0)return;let n=t,s=r,a=Qi(e,t),i=e._start;for(a!==null&&(i=a.p,t-=a.index);i!==null&&t>0;i=i.right)!i.deleted&&i.countable&&(t<i.length&&Xo(o,Ne(i.id.client,i.id.clock+t)),t-=i.length);for(;r>0&&i!==null;)i.deleted||(r<i.length&&Xo(o,Ne(i.id.client,i.id.clock+r)),i.delete(o),r-=i.length),i=i.right;if(r>0)throw Qh();e._searchMarker&&La(e._searchMarker,n,-s+r)},Yi=(o,e,t)=>{let r=e._map.get(t);r!==void 0&&r.delete(o)},Vc=(o,e,t,r)=>{let n=e._map.get(t)||null,s=o.doc,a=s.clientID,i;if(r==null)i=new Nr([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:i=new Nr([r]);break;case Uint8Array:i=new kn(r);break;case mr:i=new In(r);break;default:if(r instanceof St)i=new Ir(r);else throw new Error("Unexpected content type")}new ft(Ne(a,_t(s.store,a)),n,n&&n.lastId,null,null,e,t,i).integrate(o,0)},qc=(o,e)=>{let t=o._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},tg=o=>{let e={};return o._map.forEach((t,r)=>{t.deleted||(e[r]=t.content.getContent()[t.length-1])}),e},rg=(o,e)=>{let t=o._map.get(e);return t!==void 0&&!t.deleted};var wk=(o,e)=>{let t={};return o._map.forEach((r,n)=>{let s=r;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&cs(s,e)&&(t[n]=s.content.getContent()[s.length-1])}),t},Oi=o=>bh(o.entries(),e=>!e[1].deleted),Cc=class extends ms{constructor(e,t){super(e,t),this._transaction=t}},ro=class extends St{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){let t=new ro;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ro}clone(){let e=new ro;return e.insert(0,this.toArray().map(t=>t instanceof St?t.clone():t)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(e,t){super._callObserver(e,t),Zi(this,e,new Cc(this,e))}insert(e,t){this.doc!==null?Ze(this.doc,r=>{Zh(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?Ze(this.doc,t=>{bk(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?Ze(this.doc,r=>{eg(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return Xh(this,e)}toArray(){return Yh(this)}slice(e=0,t=this.length){return jh(this,e,t)}toJSON(){return this.map(e=>e instanceof St?e.toJSON():e)}map(e){return Jh(this,e)}forEach(e){Ia(this,e)}[Symbol.iterator](){return yk(this)}_write(e){e.writeTypeRef(Hk)}},_k=o=>new ro,Tc=class extends ms{constructor(e,t,r){super(e,t),this.keysChanged=r}},Io=class extends St{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((r,n)=>{this.set(n,r)}),this._prelimContent=null}_copy(){return new Io}clone(){let e=new Io;return this.forEach((t,r)=>{e.set(r,t instanceof St?t.clone():t)}),e}_callObserver(e,t){Zi(this,e,new Tc(this,e,t))}toJSON(){let e={};return this._map.forEach((t,r)=>{if(!t.deleted){let n=t.content.getContent()[t.length-1];e[r]=n instanceof St?n.toJSON():n}}),e}get size(){return[...Oi(this._map)].length}keys(){return Ri(Oi(this._map),e=>e[0])}values(){return Ri(Oi(this._map),e=>e[1].content.getContent()[e[1].length-1])}entries(){return Ri(Oi(this._map),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Ze(this.doc,t=>{Yi(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?Ze(this.doc,r=>{Vc(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return qc(this,e)}has(e){return rg(this,e)}clear(){this.doc!==null?Ze(this.doc,e=>{this.forEach(function(t,r,n){Yi(e,n,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(Vk)}},vk=o=>new Io,Go=(o,e)=>o===e||typeof o=="object"&&typeof e=="object"&&o&&e&&ac(o,e),Ca=class{constructor(e,t,r,n){this.left=e,this.right=t,this.index=r,this.currentAttributes=n}forward(){switch(this.right===null&&kr(),this.right.content.constructor){case bt:this.right.deleted||ys(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}},Ph=(o,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case bt:e.right.deleted||ys(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&Xo(o,Ne(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},Ui=(o,e,t,r)=>{let n=new Map,s=r?Qi(e,t):null;if(s){let a=new Ca(s.p.left,s.p,s.index,n);return Ph(o,a,t-s.index)}else{let a=new Ca(null,e._start,0,n);return Ph(o,a,t)}},og=(o,e,t,r)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===bt&&Go(r.get(t.right.content.key),t.right.content.value));)t.right.deleted||r.delete(t.right.content.key),t.forward();let n=o.doc,s=n.clientID;r.forEach((a,i)=>{let l=t.left,c=t.right,u=new ft(Ne(s,_t(n.store,s)),l,l&&l.lastId,c,c&&c.id,e,null,new bt(i,a));u.integrate(o,0),t.right=u,t.forward()})},ys=(o,e)=>{let{key:t,value:r}=e;r===null?o.delete(t):o.set(t,r)},ng=(o,e)=>{var t;for(;o.right!==null;){if(!(o.right.deleted||o.right.content.constructor===bt&&Go((t=e[o.right.content.key])!=null?t:null,o.right.content.value)))break;o.forward()}},sg=(o,e,t,r)=>{var i;let n=o.doc,s=n.clientID,a=new Map;for(let l in r){let c=r[l],u=(i=t.currentAttributes.get(l))!=null?i:null;if(!Go(u,c)){a.set(l,u);let{left:d,right:m}=t;t.right=new ft(Ne(s,_t(n.store,s)),d,d&&d.lastId,m,m&&m.id,e,null,new bt(l,c)),t.right.integrate(o,0),t.forward()}}return a},xc=(o,e,t,r,n)=>{t.currentAttributes.forEach((m,x)=>{n[x]===void 0&&(n[x]=null)});let s=o.doc,a=s.clientID;ng(t,n);let i=sg(o,e,t,n),l=r.constructor===String?new Lr(r):r instanceof St?new Ir(r):new To(r),{left:c,right:u,index:d}=t;e._searchMarker&&La(e._searchMarker,t.index,l.getLength()),u=new ft(Ne(a,_t(s.store,a)),c,c&&c.lastId,u,u&&u.id,e,null,l),u.integrate(o,0),t.right=u,t.index=d,t.forward(),og(o,e,t,i)},Ah=(o,e,t,r,n)=>{let s=o.doc,a=s.clientID;ng(t,n);let i=sg(o,e,t,n);e:for(;t.right!==null&&(r>0||i.size>0&&(t.right.deleted||t.right.content.constructor===bt));){if(!t.right.deleted)switch(t.right.content.constructor){case bt:{let{key:l,value:c}=t.right.content,u=n[l];if(u!==void 0){if(Go(u,c))i.delete(l);else{if(r===0)break e;i.set(l,c)}t.right.delete(o)}else t.currentAttributes.set(l,c);break}default:r<t.right.length&&Xo(o,Ne(t.right.id.client,t.right.id.clock+r)),r-=t.right.length;break}t.forward()}if(r>0){let l="";for(;r>0;r--)l+=`
`;t.right=new ft(Ne(a,_t(s.store,a)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new Lr(l)),t.right.integrate(o,0),t.forward()}og(o,e,t,i)},ag=(o,e,t,r,n)=>{var c,u;let s=e,a=It();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===bt){let d=s.content;a.set(d.key,d)}s=s.right}let i=0,l=!1;for(;e!==s;){if(t===e&&(l=!0),!e.deleted){let d=e.content;switch(d.constructor){case bt:{let{key:m,value:x}=d,h=(c=r.get(m))!=null?c:null;(a.get(m)!==d||h===x)&&(e.delete(o),i++,!l&&((u=n.get(m))!=null?u:null)===x&&h!==x&&(h===null?n.delete(m):n.set(m,h))),!l&&!e.deleted&&ys(n,d);break}}}e=e.right}return i},Sk=(o,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;let t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===bt){let r=e.content.key;t.has(r)?e.delete(o):t.add(r)}e=e.left}},kk=o=>{let e=0;return Ze(o.doc,t=>{let r=o._start,n=o._start,s=It(),a=Si(s);for(;n;){if(n.deleted===!1)switch(n.content.constructor){case bt:ys(a,n.content);break;default:e+=ag(t,r,n,s,a),s=Si(a),r=n;break}n=n.right}}),e},Lk=o=>{let e=new Set,t=o.doc;for(let[r,n]of o.afterState.entries()){let s=o.beforeState.get(r)||0;n!==s&&qh(o,t.store.clients.get(r),s,n,a=>{!a.deleted&&a.content.constructor===bt&&a.constructor!==ar&&e.add(a.parent)})}Ze(t,r=>{Rh(o,o.deleteSet,n=>{if(n instanceof ar||!n.parent._hasFormatting||e.has(n.parent))return;let s=n.parent;n.content.constructor===bt?e.add(s):Sk(r,n)});for(let n of e)kk(n)})},Eh=(o,e,t)=>{let r=t,n=Si(e.currentAttributes),s=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Ir:case To:case Lr:t<e.right.length&&Xo(o,Ne(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(o);break}e.forward()}s&&ag(o,s,e.right,n,e.currentAttributes);let a=(e.left||e.right).parent;return a._searchMarker&&La(a._searchMarker,e.index,-r+t),e},Dc=class extends ms{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(n=>{n===null?this.childListChanged=!0:this.keysChanged.add(n)})}get changes(){if(this._changes===null){let e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){let e=this.target.doc,t=[];Ze(e,r=>{var x,h,v;let n=new Map,s=new Map,a=this.target._start,i=null,l={},c="",u=0,d=0,m=()=>{if(i!==null){let w=null;switch(i){case"delete":d>0&&(w={delete:d}),d=0;break;case"insert":(typeof c=="object"||c.length>0)&&(w={insert:c},n.size>0&&(w.attributes={},n.forEach((_,A)=>{_!==null&&(w.attributes[A]=_)}))),c="";break;case"retain":u>0&&(w={retain:u},nh(l)||(w.attributes=rh({},l))),u=0;break}w&&t.push(w),i=null}};for(;a!==null;){switch(a.content.constructor){case Ir:case To:this.adds(a)?this.deletes(a)||(m(),i="insert",c=a.content.getContent()[0],m()):this.deletes(a)?(i!=="delete"&&(m(),i="delete"),d+=1):a.deleted||(i!=="retain"&&(m(),i="retain"),u+=1);break;case Lr:this.adds(a)?this.deletes(a)||(i!=="insert"&&(m(),i="insert"),c+=a.content.str):this.deletes(a)?(i!=="delete"&&(m(),i="delete"),d+=a.length):a.deleted||(i!=="retain"&&(m(),i="retain"),u+=a.length);break;case bt:{let{key:w,value:_}=a.content;if(this.adds(a)){if(!this.deletes(a)){let A=(x=n.get(w))!=null?x:null;Go(A,_)?_!==null&&a.delete(r):(i==="retain"&&m(),Go(_,(h=s.get(w))!=null?h:null)?delete l[w]:l[w]=_)}}else if(this.deletes(a)){s.set(w,_);let A=(v=n.get(w))!=null?v:null;Go(A,_)||(i==="retain"&&m(),l[w]=A)}else if(!a.deleted){s.set(w,_);let A=l[w];A!==void 0&&(Go(A,_)?A!==null&&a.delete(r):(i==="retain"&&m(),_===null?delete l[w]:l[w]=_))}a.deleted||(i==="insert"&&m(),ys(n,a.content));break}}a=a.right}for(m();t.length>0;){let w=t[t.length-1];if(w.retain!==void 0&&w.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}},Qo=class extends St{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Qo}clone(){let e=new Qo;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);let r=new Dc(this,e,t);Zi(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===Lr&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?Ze(this.doc,r=>{let n=new Ca(null,this._start,0,new Map);for(let s=0;s<e.length;s++){let a=e[s];if(a.insert!==void 0){let i=!t&&typeof a.insert=="string"&&s===e.length-1&&n.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof i!="string"||i.length>0)&&xc(r,this,n,i,a.attributes||{})}else a.retain!==void 0?Ah(r,this,n,a.retain,a.attributes||{}):a.delete!==void 0&&Eh(r,n,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){let n=[],s=new Map,a=this.doc,i="",l=this._start;function c(){if(i.length>0){let d={},m=!1;s.forEach((h,v)=>{m=!0,d[v]=h});let x={insert:i};m&&(x.attributes=d),n.push(x),i=""}}let u=()=>{for(;l!==null;){if(cs(l,e)||t!==void 0&&cs(l,t))switch(l.content.constructor){case Lr:{let d=s.get("ychange");e!==void 0&&!cs(l,e)?(d===void 0||d.user!==l.id.client||d.type!=="removed")&&(c(),s.set("ychange",r?r("removed",l.id):{type:"removed"})):t!==void 0&&!cs(l,t)?(d===void 0||d.user!==l.id.client||d.type!=="added")&&(c(),s.set("ychange",r?r("added",l.id):{type:"added"})):d!==void 0&&(c(),s.delete("ychange")),i+=l.content.str;break}case Ir:case To:{c();let d={insert:l.content.getContent()[0]};if(s.size>0){let m={};d.attributes=m,s.forEach((x,h)=>{m[h]=x})}n.push(d);break}case bt:cs(l,e)&&(c(),ys(s,l.content));break}l=l.right}c()};return e||t?Ze(a,d=>{e&&Sc(d,e),t&&Sc(d,t),u()},"cleanup"):u(),n}insert(e,t,r){if(t.length<=0)return;let n=this.doc;n!==null?Ze(n,s=>{let a=Ui(s,this,e,!r);r||(r={},a.currentAttributes.forEach((i,l)=>{r[l]=i})),xc(s,this,a,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r){let n=this.doc;n!==null?Ze(n,s=>{let a=Ui(s,this,e,!r);xc(s,this,a,t,r||{})}):this._pending.push(()=>this.insertEmbed(e,t,r||{}))}delete(e,t){if(t===0)return;let r=this.doc;r!==null?Ze(r,n=>{Eh(n,Ui(n,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(t===0)return;let n=this.doc;n!==null?Ze(n,s=>{let a=Ui(s,this,e,!1);a.right!==null&&Ah(s,this,a,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){this.doc!==null?Ze(this.doc,t=>{Yi(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?Ze(this.doc,r=>{Vc(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return qc(this,e)}getAttributes(){return tg(this)}_write(e){e.writeTypeRef(qk)}},Ik=o=>new Qo,wa=class{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===Zo||t.constructor===Co)&&t._start!==null)e=t._start;else for(;e!==null;)if(e.right!==null){e=e.right;break}else e.parent===this._root?e=null:e=e.parent._item;while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}},Co=class extends St{constructor(){super(),this._prelimContent=[]}get firstChild(){let e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Co}clone(){let e=new Co;return e.insert(0,this.toArray().map(t=>t instanceof St?t.clone():t)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new wa(this,e)}querySelector(e){e=e.toUpperCase();let r=new wa(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),Fr(new wa(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){Zi(this,e,new Pc(this,t,e))}toString(){return Jh(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){let n=e.createDocumentFragment();return r!==void 0&&r._createAssociation(n,this),Ia(this,s=>{n.insertBefore(s.toDOM(e,t,r),null)}),n}insert(e,t){this.doc!==null?Ze(this.doc,r=>{Zh(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)Ze(this.doc,r=>{let n=e&&e instanceof St?e._item:e;ji(r,this,n,t)});else{let r=this._prelimContent,n=e===null?0:r.findIndex(s=>s===e)+1;if(n===0&&e!==null)throw Sr("Reference item not found");r.splice(n,0,...t)}}delete(e,t=1){this.doc!==null?Ze(this.doc,r=>{eg(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return Yh(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Xh(this,e)}slice(e=0,t=this.length){return jh(this,e,t)}forEach(e){Ia(this,e)}_write(e){e.writeTypeRef(zk)}},Ck=o=>new Co,Zo=class extends Co{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((r,n)=>{this.setAttribute(n,r)}),this._prelimAttrs=null}_copy(){return new Zo(this.nodeName)}clone(){let e=new Zo(this.nodeName),t=this.getAttributes();return oh(t,(r,n)=>{typeof r=="string"&&e.setAttribute(n,r)}),e.insert(0,this.toArray().map(r=>r instanceof St?r.clone():r)),e}toString(){let e=this.getAttributes(),t=[],r=[];for(let i in e)r.push(i);r.sort();let n=r.length;for(let i=0;i<n;i++){let l=r[i];t.push(l+'="'+e[l]+'"')}let s=this.nodeName.toLocaleLowerCase(),a=t.length>0?" "+t.join(" "):"";return`<${s}${a}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?Ze(this.doc,t=>{Yi(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?Ze(this.doc,r=>{Vc(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return qc(this,e)}hasAttribute(e){return rg(this,e)}getAttributes(e){return e?wk(this,e):tg(this)}toDOM(e=document,t={},r){let n=e.createElement(this.nodeName),s=this.getAttributes();for(let a in s){let i=s[a];typeof i=="string"&&n.setAttribute(a,i)}return Ia(this,a=>{n.appendChild(a.toDOM(e,t,r))}),r!==void 0&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(Wk),e.writeKey(this.nodeName)}},Tk=o=>new Zo(o.readKey()),Pc=class extends ms{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(n=>{n===null?this.childListChanged=!0:this.attributesChanged.add(n)})}},hs=class extends Io{constructor(e){super(),this.hookName=e}_copy(){return new hs(this.hookName)}clone(){let e=new hs(this.hookName);return this.forEach((t,r)=>{e.set(r,t)}),e}toDOM(e=document,t={},r){let n=t[this.hookName],s;return n!==void 0?s=n.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(e){e.writeTypeRef(Kk),e.writeKey(this.hookName)}},Dk=o=>new hs(o.readKey()),gs=class extends Qo{get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new gs}clone(){let e=new gs;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){let n=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(n,this),n}toString(){return this.toDelta().map(e=>{let t=[];for(let n in e.attributes){let s=[];for(let a in e.attributes[n])s.push({key:a,value:e.attributes[n][a]});s.sort((a,i)=>a.key<i.key?-1:1),t.push({nodeName:n,attrs:s})}t.sort((n,s)=>n.nodeName<s.nodeName?-1:1);let r="";for(let n=0;n<t.length;n++){let s=t[n];r+=`<${s.nodeName}`;for(let a=0;a<s.attrs.length;a++){let i=s.attrs[a];r+=` ${i.key}="${i.value}"`}r+=">"}r+=e.insert;for(let n=t.length-1;n>=0;n--)r+=`</${t[n].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(Gk)}},Pk=o=>new gs,Ta=class{constructor(e,t){this.id=e,this.length=t}get deleted(){throw Ur()}mergeWith(e){return!1}write(e,t,r){throw Ur()}integrate(e,t){throw Ur()}},Ak=0,ar=class extends Ta{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),Vh(e.doc.store,this)}write(e,t){e.writeInfo(Ak),e.writeLen(this.length-t)}getMissing(e,t){return null}},kn=class{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new kn(this.content)}splice(e){throw Ur()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}},Ek=o=>new kn(o.readBuf()),Ln=class{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Ln(this.len)}splice(e){let t=new Ln(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){Hi(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}},Mk=o=>new Ln(o.readLen()),ig=(o,e)=>new mr({guid:o,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1}),In=class{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;let t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new In(ig(this.doc.guid,this.opts))}splice(e){throw Ur()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}},Rk=o=>new In(ig(o.readString(),o.readAny())),To=class{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new To(this.embed)}splice(e){throw Ur()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}},Fk=o=>new To(o.readJSON()),bt=class{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new bt(this.key,this.value)}splice(e){throw Ur()}mergeWith(e){return!1}integrate(e,t){let r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}},Ok=o=>new bt(o.readKey(),o.readJSON()),xs=class{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new xs(this.arr)}splice(e){let t=new xs(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let s=this.arr[n];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}},Uk=o=>{let e=o.readLen(),t=[];for(let r=0;r<e;r++){let n=o.readString();n==="undefined"?t.push(void 0):t.push(JSON.parse(n))}return new xs(t)},Nr=class{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Nr(this.arr)}splice(e){let t=new Nr(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let s=this.arr[n];e.writeAny(s)}}getRef(){return 8}},$k=o=>{let e=o.readLen(),t=[];for(let r=0;r<e;r++)t.push(o.readAny());return new Nr(t)},Lr=class{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Lr(this.str)}splice(e){let t=new Lr(this.str.slice(e));this.str=this.str.slice(0,e);let r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"\uFFFD",t.str="\uFFFD"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}},Bk=o=>new Lr(o.readString()),Nk=[_k,vk,Ik,Tk,Ck,Dk,Pk],Hk=0,Vk=1,qk=2,Wk=3,zk=4,Kk=5,Gk=6,Ir=class{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Ir(this.type._copy())}splice(e){throw Ur()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}},jk=o=>new Ir(Nk[o.readTypeRef()](o)),Mh=(o,e)=>{let t=e,r=0,n;do r>0&&(t=Ne(t.client,t.clock+r)),n=$i(o,t),r=t.clock-n.id.clock,t=n.redone;while(t!==null&&n instanceof ft);return{item:n,diff:r}};var Ji=(o,e,t)=>{let{client:r,clock:n}=e.id,s=new ft(Ne(r,n+t),e,Ne(r,n+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Ne(e.redone.client,e.redone.clock+t)),e.right=s,s.right!==null&&(s.right.left=s),o._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=t,s};var ft=class extends Ta{constructor(e,t,r,n,s,a,i,l){super(e,l.getLength()),this.origin=r,this.left=t,this.right=n,this.rightOrigin=s,this.parent=a,this.parentSub=i,this.redone=null,this.content=l,this.info=this.content.isCountable()?2:0}set marker(e){(this.info&8)>0!==e&&(this.info^=8)}get marker(){return(this.info&8)>0}get keep(){return(this.info&1)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(this.info&2)>0}get deleted(){return(this.info&4)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=_t(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=_t(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===jo&&this.id.client!==this.parent.client&&this.parent.clock>=_t(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Ih(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Xo(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===ar||this.right&&this.right.constructor===ar)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===ft&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===ft&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===jo){let r=$i(t,this.parent);r.constructor===ar?this.parent=null:this.parent=r.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=Ih(e,e.doc.store,Ne(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,n;if(r!==null)n=r.right;else if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start;let s=new Set,a=new Set;for(;n!==null&&n!==this.right;){if(a.add(n),s.add(n),us(this.origin,n.origin)){if(n.id.client<this.id.client)r=n,s.clear();else if(us(this.rightOrigin,n.rightOrigin))break}else if(n.origin!==null&&a.has($i(e.doc.store,n.origin)))s.has($i(e.doc.store,n.origin))||(r=n,s.clear());else break;n=n.right}this.left=r}if(this.left!==null){let r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Vh(e.doc.store,this),this.content.integrate(e,this),Th(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new ar(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Ne(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&us(e.origin,this.lastId)&&this.right===e&&us(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){let t=this.parent._searchMarker;return t&&t.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){let t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),Hi(e.deleteSet,this.id.client,this.id.clock,this.length),Th(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw kr();this.content.gc(e),t?ak(e,this,new ar(this.id,this.length)):this.content=new Ln(this.length)}write(e,t){let r=t>0?Ne(this.id.client,this.id.clock+t-1):this.origin,n=this.rightOrigin,s=this.parentSub,a=this.content.getRef()&31|(r===null?0:128)|(n===null?0:64)|(s===null?0:32);if(e.writeInfo(a),r!==null&&e.writeLeftID(r),n!==null&&e.writeRightID(n),r===null&&n===null){let i=this.parent;if(i._item!==void 0){let l=i._item;if(l===null){let c=Hh(i);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else i.constructor===String?(e.writeParentInfo(!0),e.writeString(i)):i.constructor===jo?(e.writeParentInfo(!1),e.writeLeftID(i)):kr();s!==null&&e.writeString(s)}this.content.write(e,t)}},lg=(o,e)=>Yk[e&31](o),Yk=[()=>{kr()},Mk,Uk,Ek,Bk,Fk,Ok,jk,$k,Rk,()=>{kr()}],Jk=10,ir=class extends Ta{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){kr()}write(e,t){e.writeInfo(Jk),Me(e.restEncoder,this.length-t)}getMissing(e,t){return null}},fg=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:{},cg="__ $YJS$ __";fg[cg]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");fg[cg]=!0;var kt=require("obsidian");var Tn=o=>ko((e,t)=>{o.onerror=r=>t(new Error(r.target.error)),o.onsuccess=r=>e(r.target.result)}),ug=(o,e)=>ko((t,r)=>{let n=indexedDB.open(o);n.onupgradeneeded=s=>e(s.target.result),n.onerror=s=>r(Sr(s.target.error)),n.onsuccess=s=>{let a=s.target.result;a.onversionchange=()=>{a.close()},t(a)}}),dg=o=>Tn(indexedDB.deleteDatabase(o)),pg=(o,e)=>e.forEach(t=>o.createObjectStore.apply(o,t)),no=(o,e,t="readwrite")=>{let r=o.transaction(e,t);return e.map(n=>eL(r,n))},Dn=(o,e)=>Tn(o.count(e)),mg=(o,e)=>Tn(o.get(e)),Wc=(o,e)=>Tn(o.delete(e)),hg=(o,e,t)=>Tn(o.put(e,t));var el=(o,e)=>Tn(o.add(e)),gg=(o,e,t)=>Tn(o.getAll(e,t));var Xk=(o,e,t)=>{let r=null;return Zk(o,e,n=>(r=n,!1),t).then(()=>r)},xg=(o,e=null)=>Xk(o,e,"prev");var Qk=(o,e)=>ko((t,r)=>{o.onerror=r,o.onsuccess=async n=>{let s=n.target.result;if(s===null||await e(s)===!1)return t();s.continue()}});var Zk=(o,e,t,r="next")=>Qk(o.openKeyCursor(e,r),n=>t(n.key)),eL=(o,e)=>o.objectStore(e);var yg=(o,e)=>IDBKeyRange.upperBound(o,e),bg=(o,e)=>IDBKeyRange.lowerBound(o,e);var Kc="custom",wg="updates",_g=500,vg=(o,e=()=>{},t=()=>{})=>{let[r]=no(o.db,[wg]);return gg(r,bg(o._dbref,!1)).then(n=>{o._destroyed||(e(r),Ze(o.doc,()=>{n.forEach(s=>Do(o.doc,s))},o,!1),t(r))}).then(()=>xg(r).then(n=>{o._dbref=n+1})).then(()=>Dn(r).then(n=>{o._dbsize=n})).then(()=>r)},tL=(o,e=!0)=>vg(o).then(t=>{(e||o._dbsize>=_g)&&el(t,Cn(o.doc)).then(()=>Wc(t,yg(o._dbref,!0))).then(()=>Dn(t).then(r=>{o._dbsize=r}))});var ws=class extends Jn{constructor(e,t){super(),this.doc=t,this.name=e,this._dbref=0,this._dbsize=0,this._destroyed=!1,this.db=null,this.synced=!1,this._db=ug(e,r=>pg(r,[["updates",{autoIncrement:!0}],["custom"]])),this.whenSynced=ko(r=>this.on("synced",()=>r(this))),this._db.then(r=>{this.db=r,vg(this,a=>el(a,Cn(t)),()=>{if(this._destroyed)return this;this.synced=!0,this.emit("synced",[this])})}),this._storeTimeout=1e3,this._storeTimeoutId=null,this._storeUpdate=(r,n)=>{if(this.db&&n!==this){let[s]=no(this.db,[wg]);el(s,r),++this._dbsize>=_g&&(this._storeTimeoutId!==null&&clearTimeout(this._storeTimeoutId),this._storeTimeoutId=setTimeout(()=>{tL(this,!1),this._storeTimeoutId=null},this._storeTimeout))}},t.on("update",this._storeUpdate),this.destroy=this.destroy.bind(this),t.on("destroy",this.destroy)}destroy(){return this._storeTimeoutId&&clearTimeout(this._storeTimeoutId),this.doc.off("update",this._storeUpdate),this.doc.off("destroy",this.destroy),this._destroyed=!0,this._db.then(e=>{e.close()})}clearData(){return this.destroy().then(()=>{dg(this.name)})}get(e){return this._db.then(t=>{let[r]=no(t,[Kc],"readonly");return mg(r,e)})}set(e,t){return this._db.then(r=>{let[n]=no(r,[Kc]);return hg(n,t,e)})}del(e){return this._db.then(t=>{let[r]=no(t,[Kc]);return Wc(r,e)})}};var tl,rL=new Uint8Array(16);function Gc(){if(!tl&&(tl=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!tl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tl(rL)}var Ot=[];for(let o=0;o<256;++o)Ot.push((o+256).toString(16).slice(1));function Sg(o,e=0){return Ot[o[e+0]]+Ot[o[e+1]]+Ot[o[e+2]]+Ot[o[e+3]]+"-"+Ot[o[e+4]]+Ot[o[e+5]]+"-"+Ot[o[e+6]]+Ot[o[e+7]]+"-"+Ot[o[e+8]]+Ot[o[e+9]]+"-"+Ot[o[e+10]]+Ot[o[e+11]]+Ot[o[e+12]]+Ot[o[e+13]]+Ot[o[e+14]]+Ot[o[e+15]]}var oL=typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),jc={randomUUID:oL};function nL(o,e,t){if(jc.randomUUID&&!e&&!o)return jc.randomUUID();o=o||{};let r=o.random||(o.rng||Gc)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let n=0;n<16;++n)e[t+n]=r[n];return e}return Sg(r)}var Da=nL;var Pr=jn(vi());var kg=0,rl=1,Lg=2,ol=(o,e)=>{Me(o,kg);let t=Bh(e);Tt(o,t)},Yc=(o,e,t)=>{Me(o,rl),Tt(o,Cn(e,t))},sL=(o,e,t)=>Yc(e,t,Ft(o)),Ig=(o,e,t)=>{try{Do(e,Ft(o),t)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Cg=(o,e)=>{Me(o,Lg),Tt(o,e)},aL=Ig,Tg=(o,e,t,r)=>{let n=Te(o);switch(n){case kg:sL(o,e,t);break;case rl:Ig(o,t,r);break;case Lg:aL(o,t,r);break;default:throw new Error("Unknown message type")}return n};var lL=0;var Dg=(o,e,t)=>{switch(Te(o)){case lL:t(e,$r(o))}};var Jc=3e4,nl=class extends Jn{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let t=_n();this.getLocalState()!==null&&Jc/2<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let r=[];this.meta.forEach((n,s)=>{s!==this.clientID&&Jc<=t-n.lastUpdated&&this.states.has(s)&&r.push(s)}),r.length>0&&sl(this,r,"timeout")},sr(Jc/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){let t=this.clientID,r=this.meta.get(t),n=r===void 0?0:r.clock+1,s=this.states.get(t);e===null?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:n,lastUpdated:_n()});let a=[],i=[],l=[],c=[];e===null?c.push(t):s==null?e!=null&&a.push(t):(i.push(t),ls(s,e)||l.push(t)),(a.length>0||l.length>0||c.length>0)&&this.emit("change",[{added:a,updated:l,removed:c},"local"]),this.emit("update",[{added:a,updated:i,removed:c},"local"])}setLocalStateField(e,t){let r=this.getLocalState();r!==null&&this.setLocalState({...r,[e]:t})}getStates(){return this.states}},sl=(o,e,t)=>{let r=[];for(let n=0;n<e.length;n++){let s=e[n];if(o.states.has(s)){if(o.states.delete(s),s===o.clientID){let a=o.meta.get(s);o.meta.set(s,{clock:a.clock+1,lastUpdated:_n()})}r.push(s)}}r.length>0&&(o.emit("change",[{added:[],updated:[],removed:r},t]),o.emit("update",[{added:[],updated:[],removed:r},t]))},_s=(o,e,t=o.states)=>{let r=e.length,n=yn();Me(n,r);for(let s=0;s<r;s++){let a=e[s],i=t.get(a)||null,l=o.meta.get(a).clock;Me(n,a),Me(n,l),So(n,JSON.stringify(i))}return pr(n)};var Pg=(o,e,t)=>{let r=Br(e),n=_n(),s=[],a=[],i=[],l=[],c=Te(r);for(let u=0;u<c;u++){let d=Te(r),m=Te(r),x=JSON.parse($r(r)),h=o.meta.get(d),v=o.states.get(d),w=h===void 0?0:h.clock;(w<m||w===m&&x===null&&o.states.has(d))&&(x===null?d===o.clientID&&o.getLocalState()!=null?m++:o.states.delete(d):o.states.set(d,x),o.meta.set(d,{clock:m,lastUpdated:n}),h===void 0&&x!==null?s.push(d):h!==void 0&&x===null?l.push(d):x!==null&&(ls(x,v)||i.push(d),a.push(d)))}(s.length>0||i.length>0||l.length>0)&&o.emit("change",[{added:s,updated:i,removed:l},t]),(s.length>0||a.length>0||l.length>0)&&o.emit("update",[{added:s,updated:a,removed:l},t])};var Ss=()=>new Map,Fg=(o,e,t)=>{let r=o.get(e);return r===void 0&&o.set(e,r=t()),r},Og=()=>new Set,uL=Array.from,VM=Array.isArray,Ug=String.fromCharCode,qM=String.fromCodePoint,WM=Ug(65535),dL=o=>o.toLowerCase(),pL=/^\s*/g,mL=o=>o.replace(pL,""),hL=/([A-Z])/g,Ag=(o,e)=>mL(o.replace(hL,t=>`${e}${dL(t)}`)),gL=o=>{let e=unescape(encodeURIComponent(o)),t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.codePointAt(n);return r},Pa=typeof TextEncoder!="undefined"?new TextEncoder:null,xL=o=>Pa.encode(o),yL=Pa?xL:gL,Xc=typeof TextDecoder=="undefined"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Xc&&Xc.decode(new Uint8Array).length===1&&(Xc=null);var Eg=o=>o===void 0?null:o,bL=class{constructor(){this.map=new Map}setItem(o,e){this.map.set(o,e)}getItem(o){return this.map.get(o)}},$g=new bL,ou=!0;try{typeof localStorage!="undefined"&&($g=localStorage,ou=!1)}catch(o){}var Bg=$g,wL=o=>ou||addEventListener("storage",o),_L=o=>ou||removeEventListener("storage",o),vL=(o,e)=>{let t=[];for(let r in o)t.push(e(o[r],r));return t},SL=(o,e)=>e.includes(o),Is=typeof process!="undefined"&&process.release&&/node|io\.js/.test(process.release.name),Ng=typeof window!="undefined"&&typeof document!="undefined"&&!Is,zM=typeof navigator!="undefined"?/Mac/.test(navigator.platform):!1,so,kL=[],LL=()=>{if(so===void 0)if(Is){so=Ss();let o=process.argv,e=null;for(let t=0;t<o.length;t++){let r=o[t];r[0]==="-"?(e!==null&&so.set(e,""),e=r):e!==null?(so.set(e,r),e=null):kL.push(r)}e!==null&&so.set(e,"")}else typeof location=="object"?(so=Ss(),(location.search||"?").slice(1).split("&").forEach(o=>{if(o.length!==0){let[e,t]=o.split("=");so.set(`--${Ag(e,"-")}`,t),so.set(`-${Ag(e,"-")}`,t)}})):so=Ss();return so},Zc=o=>LL().has(o),eu=o=>Eg(Is?process.env[o.toUpperCase()]:Bg.getItem(o)),IL=o=>Zc("--"+o)||eu(o)!==null,KM=IL("production"),Mg=Is&&SL(process.env.FORCE_COLOR,["true","1","2"]),GM=!Zc("no-colors")&&(!Is||process.stdout.isTTY||Mg)&&(!Is||Zc("color")||Mg||eu("COLORTERM")!==null||(eu("TERM")||"").includes("color")),Hg=Math.floor,Vg=(o,e)=>o<e?o:e,CL=(o,e)=>o>e?o:e,jM=Number.isNaN,TL=Math.pow,qg=128,DL=1<<17,PL=1<<18,AL=1<<19,EL=1<<20,ML=1<<21,RL=1<<22,FL=1<<23,OL=1<<24,UL=1<<25,$L=1<<26,BL=1<<27,NL=1<<28,HL=1<<29,VL=1<<30,YM=1<<31,al=127,JM=DL-1,XM=PL-1,QM=AL-1,ZM=EL-1,eR=ML-1,tR=RL-1,rR=FL-1,oR=OL-1,nR=UL-1,sR=$L-1,aR=BL-1,iR=NL-1,lR=HL-1,fR=VL-1,qL=Number.MAX_SAFE_INTEGER,cR=Number.MIN_SAFE_INTEGER,uR=1<<31,dR=Number.isInteger||(o=>typeof o=="number"&&isFinite(o)&&Hg(o)===o),pR=Number.isNaN,mR=Number.parseInt,WL=class{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}},Hr=()=>new WL,nu=o=>{let e=o.cpos;for(let t=0;t<o.bufs.length;t++)e+=o.bufs[t].length;return e},Cr=o=>{let e=new Uint8Array(nu(o)),t=0;for(let r=0;r<o.bufs.length;r++){let n=o.bufs[r];e.set(n,t),t+=n.length}return e.set(Kg(o.cbuf.buffer,0,o.cpos),t),e},il=(o,e)=>{let t=o.cbuf.length;o.cpos===t&&(o.bufs.push(o.cbuf),o.cbuf=new Uint8Array(t*2),o.cpos=0),o.cbuf[o.cpos++]=e},Gt=(o,e)=>{for(;e>al;)il(o,qg|al&e),e=Hg(e/128);il(o,al&e)},tu=new Uint8Array(3e4),zL=tu.length/3,KL=(o,e)=>{if(e.length<zL){let t=Pa.encodeInto(e,tu).written||0;Gt(o,t);for(let r=0;r<t;r++)il(o,tu[r])}else ks(o,yL(e))},GL=(o,e)=>{let t=unescape(encodeURIComponent(e)),r=t.length;Gt(o,r);for(let n=0;n<r;n++)il(o,t.codePointAt(n))},hR=Pa&&Pa.encodeInto?KL:GL,jL=(o,e)=>{let t=o.cbuf.length,r=o.cpos,n=Vg(t-r,e.length),s=e.length-n;o.cbuf.set(e.subarray(0,n),r),o.cpos+=n,s>0&&(o.bufs.push(o.cbuf),o.cbuf=new Uint8Array(CL(t*2,s)),o.cbuf.set(e.subarray(n)),o.cpos=s)},ks=(o,e)=>{Gt(o,e.byteLength),jL(o,e)},gR=new DataView(new ArrayBuffer(4)),Wg=o=>new Error(o),YL=Wg("Unexpected end of array"),JL=Wg("Integer out of Range"),XL=class{constructor(o){this.arr=o,this.pos=0}},QL=o=>new XL(o),ZL=(o,e)=>{let t=Kg(o.arr.buffer,o.pos+o.arr.byteOffset,e);return o.pos+=e,t},eI=o=>ZL(o,zg(o)),zg=o=>{let e=0,t=1,r=o.arr.length;for(;o.pos<r;){let n=o.arr[o.pos++];if(e=e+(n&al)*t,t*=128,n<qg)return e;if(e>qL)throw JL}throw YL},tI=o=>new Uint8Array(o),Kg=(o,e,t)=>new Uint8Array(o,e,t),rI=o=>new Uint8Array(o),oI=o=>{let e="";for(let t=0;t<o.byteLength;t++)e+=Ug(o[t]);return btoa(e)},nI=o=>Buffer.from(o.buffer,o.byteOffset,o.byteLength).toString("base64"),sI=o=>{let e=atob(o),t=tI(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t},aI=o=>{let e=Buffer.from(o,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},iI=Ng?oI:nI,lI=Ng?sI:aI,Gg=new Map,fI=class{constructor(o){this.room=o,this.onmessage=null,this._onChange=e=>e.key===o&&this.onmessage!==null&&this.onmessage({data:lI(e.newValue||"")}),wL(this._onChange)}postMessage(o){Bg.setItem(this.room,iI(rI(o)))}close(){_L(this._onChange)}},cI=typeof BroadcastChannel=="undefined"?fI:BroadcastChannel,su=o=>Fg(Gg,o,()=>{let e=Og(),t=new cI(o);return t.onmessage=r=>e.forEach(n=>n(r.data,"broadcastchannel")),{bc:t,subs:e}}),uI=(o,e)=>(su(o).subs.add(e),e),dI=(o,e)=>{let t=su(o),r=t.subs.delete(e);return r&&t.subs.size===0&&(t.bc.close(),Gg.delete(o)),r},vs=(o,e,t=null)=>{let r=su(o);r.bc.postMessage(e),r.subs.forEach(n=>n(e,t))},ru=Date.now,pI=class{constructor(){this._observers=Ss()}on(o,e){Fg(this._observers,o,Og).add(e)}once(o,e){let t=(...r)=>{this.off(o,t),e(...r)};this.on(o,t)}off(o,e){let t=this._observers.get(o);t!==void 0&&(t.delete(e),t.size===0&&this._observers.delete(o))}emit(o,e){return uL((this._observers.get(o)||Ss()).values()).forEach(t=>t(...e))}destroy(){this._observers=Ss()}},mI=o=>vL(o,(e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`).join("&"),Pn=0,jg=3,Ls=1,hI=2,Aa=[];Aa[Pn]=(o,e,t,r,n)=>{Gt(o,Pn);let s=Tg(e,o,t.doc,t);r&&s===rl&&!t.synced&&(t.synced=!0)};Aa[jg]=(o,e,t,r,n)=>{Gt(o,Ls),ks(o,_s(t.awareness,Array.from(t.awareness.getStates().keys())))};Aa[Ls]=(o,e,t,r,n)=>{Pg(t.awareness,eI(e),t)};Aa[hI]=(o,e,t,r,n)=>{Dg(e,t.doc,(s,a)=>gI(t,a))};var Rg=3e4,gI=(o,e)=>console.warn(`Permission denied to access ${o.url}.
${e}`),Yg=(o,e,t)=>{let r=QL(e),n=Hr(),s=zg(r),a=o.messageHandlers[s];return a?a(n,r,o,t,s):console.error("Unable to compute message"),n},Jg=o=>{if(o.shouldConnect&&o.ws===null){let e=new o._WS(o.url);e.binaryType="arraybuffer",o.ws=e,o.wsconnecting=!0,o.wsconnected=!1,o.synced=!1,e.onmessage=t=>{o.wsLastMessageReceived=ru();let r=Yg(o,new Uint8Array(t.data),!0);nu(r)>1&&e.send(Cr(r))},e.onerror=t=>{o.emit("connection-error",[t,o])},e.onclose=t=>{o.emit("connection-close",[t,o]),o.ws=null,o.wsconnecting=!1,o.wsconnected?(o.wsconnected=!1,o.synced=!1,sl(o.awareness,Array.from(o.awareness.getStates().keys()).filter(r=>r!==o.doc.clientID),o),o.emit("status",[{status:"disconnected"}])):o.wsUnsuccessfulReconnects++,setTimeout(Jg,Vg(TL(2,o.wsUnsuccessfulReconnects)*100,o.maxBackoffTime),o)},e.onopen=()=>{o.wsLastMessageReceived=ru(),o.wsconnecting=!1,o.wsconnected=!0,o.wsUnsuccessfulReconnects=0,o.emit("status",[{status:"connected"}]);let t=Hr();if(Gt(t,Pn),ol(t,o.doc),e.send(Cr(t)),o.awareness.getLocalState()!==null){let r=Hr();Gt(r,Ls),ks(r,_s(o.awareness,[o.doc.clientID])),e.send(Cr(r))}},o.emit("status",[{status:"connecting"}])}},Qc=(o,e)=>{let t=o.ws;o.wsconnected&&t&&t.readyState===t.OPEN&&t.send(e),o.bcconnected&&vs(o.bcChannel,e,o)},Xg=class extends pI{constructor(o,e,t,{connect:r=!0,awareness:n=new nl(t),params:s={},WebSocketPolyfill:a=WebSocket,resyncInterval:i=-1,maxBackoffTime:l=2500,disableBc:c=!1}={}){for(super();o[o.length-1]==="/";)o=o.slice(0,o.length-1);let u=mI(s);this.maxBackoffTime=l,this.bcChannel=o+"/"+e,this.url=o+"/"+e+(u.length===0?"":"?"+u),this.roomname=e,this.doc=t,this._WS=a,this.awareness=n,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=c,this.wsUnsuccessfulReconnects=0,this.messageHandlers=Aa.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=r,this._resyncInterval=0,i>0&&(this._resyncInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){let d=Hr();Gt(d,Pn),ol(d,t),this.ws.send(Cr(d))}},i)),this._bcSubscriber=(d,m)=>{if(m!==this){let x=Yg(this,new Uint8Array(d),!1);nu(x)>1&&vs(this.bcChannel,Cr(x),this)}},this._updateHandler=(d,m)=>{if(m!==this){let x=Hr();Gt(x,Pn),Cg(x,d),Qc(this,Cr(x))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:d,updated:m,removed:x},h)=>{let v=d.concat(m).concat(x),w=Hr();Gt(w,Ls),ks(w,_s(n,v)),Qc(this,Cr(w))},this._unloadHandler=()=>{sl(this.awareness,[t.clientID],"window unload")},typeof window!="undefined"?window.addEventListener("unload",this._unloadHandler):typeof process!="undefined"&&process.on("exit",this._unloadHandler),n.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{var d;this.wsconnected&&Rg<ru()-this.wsLastMessageReceived&&((d=this.ws)==null||d.close())},Rg/10),r&&this.connect()}get synced(){return this._synced}set synced(o){this._synced!==o&&(this._synced=o,this.emit("synced",[o]),this.emit("sync",[o]))}destroy(){this._resyncInterval!==0&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),typeof window!="undefined"?window.removeEventListener("unload",this._unloadHandler):typeof process!="undefined"&&process.off("exit",this._unloadHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;this.bcconnected||(uI(this.bcChannel,this._bcSubscriber),this.bcconnected=!0);let o=Hr();Gt(o,Pn),ol(o,this.doc),vs(this.bcChannel,Cr(o),this);let e=Hr();Gt(e,Pn),Yc(e,this.doc),vs(this.bcChannel,Cr(e),this);let t=Hr();Gt(t,jg),vs(this.bcChannel,Cr(t),this);let r=Hr();Gt(r,Ls),ks(r,_s(this.awareness,[this.doc.clientID])),vs(this.bcChannel,Cr(r),this)}disconnectBc(){let o=Hr();Gt(o,Ls),ks(o,_s(this.awareness,[this.doc.clientID],new Map)),Qc(this,Cr(o)),this.bcconnected&&(dI(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.wsconnected&&this.ws===null&&(Jg(this),this.connectBc())}};var Dt=new WeakMap,Qg=!1;function fl(o){Qg=o}var Vr={maxFileSize:1024*1024,maxBackups:5,disableConsole:!1,batchInterval:1e3,maxRetries:3},jt,Yt,ll=[];function Zg(o,e,t,r){Yt=o,jt=t,r&&(Vr={...Vr,...r}),e.setInterval(au,Vr.batchInterval)}async function au(){if(ll.length===0)return;let o=[...ll];ll.length=0;for(let e=0;e<Vr.maxRetries;e++)try{await xI();let t=o.map(ex).join(`
`)+`
`;await Yt.append(jt,t);return}catch(t){console.error(`Failed to write logs (attempt ${e+1}):`,t),e===Vr.maxRetries-1&&console.error("Max retries reached. Discarding log entries.")}}async function xI(){let o=await Yt.stat(jt);if(o&&o.size>Vr.maxFileSize){for(let e=Vr.maxBackups;e>0;e--){let t=`${jt}.${e}`,r=`${jt}.${e+1}`;await Yt.exists(t)&&(e===Vr.maxBackups?await Yt.remove(t):await Yt.rename(t,r))}await Yt.exists(jt)&&await Yt.rename(jt,`${jt}.1`),await Yt.write(jt,"")}}function ex(o){return`[${o.timestamp}] [${o.level.toUpperCase()}] ${o.message}
    at ${o.callerInfo}`}function yI(o,e){return e?t=>(o.notify(t.name+`
`+t.message),t):t=>(o.notify(t.name+`:
An error has occurred, please reload Obsidian.`),t)}var bI=["token","authorization","email"];function wI(o){if(typeof o=="object"&&o!==null){let e=new WeakSet;try{return JSON.stringify(o,(t,r)=>{var n;if(typeof r=="object"&&r!==null){if(e.has(r))return"[Circular]";e.add(r)}return typeof t=="string"&&bI.some(s=>t.toLowerCase().includes(s.toLowerCase()))?"[REDACTED]":r instanceof Error?{name:r.name,message:r.message,stack:(n=r.stack)==null?void 0:n.split(`
`).map(s=>s.trim()).join(" ")}:r},2)}catch(t){return t instanceof Error?t instanceof RangeError?`[Complex Object: ${Object.prototype.toString.call(o)}]`:`[Unserializable: ${t.message}]`:"[Unknown Error]"}}return String(o)}function Le(o,e="log"){return(...t)=>{if(Qg){let r=new Date().toISOString(),n=new Error().stack,s=n?n.split(`
`)[2].trim():"",a=t.map(wI).join(" "),i={timestamp:r,level:e,message:`${o}: ${a}`,callerInfo:s};Vr.disableConsole||console[e](ex(i)),ll.push(i)}}}async function cl(){let o=[];await Yt.exists(jt)&&o.push(jt);for(let e=1;e<=Vr.maxBackups;e++){let t=`${jt}.${e}`;await Yt.exists(t)&&o.push(t)}return o}async function tx(){let o=[];if(await Yt.exists(jt)){let e=await Yt.read(jt);o.push(e)}for(let e=1;e<=Vr.maxBackups;e++){let t=`${jt}.${e}`;if(await Yt.exists(t)){let r=await Yt.read(t);o.push(r)}}return o.reverse().join(`
`)}var Po=class{constructor(e){let t=e||this.constructor.name;this.debug=Le(`[${t}]`,"debug"),this.log=Le(`[${t}]`,"log"),this.warn=Le(`[${t}]`,"warn"),this.error=Le(`[${t}]`,"error")}setLoggers(e){this.debug=Le(`[${e}]`,"debug"),this.log=Le(`[${e}]`,"log"),this.warn=Le(`[${e}]`,"warn"),this.error=Le(`[${e}]`,"error")}},_I=!1;function rx(o){return yI(o,_I)}var iu=class{constructor(){this.platform="s3rn";this.product="relay"}},lu=class{constructor(e){this.relayId=e;this.platform="s3rn";this.product="relay"}},Ao=class{constructor(e,t){this.relayId=e;this.folderId=t;this.platform="s3rn";this.product="relay"}},qr=class{constructor(e,t,r){this.relayId=e;this.folderId=t;this.documentId=r;this.platform="s3rn";this.product="relay"}},en=class{constructor(e){this.folderId=e;this.platform="s3rn";this.product="relay"}},An=class{constructor(e,t){this.folderId=e;this.documentId=t;this.platform="s3rn";this.product="relay"}},Jt=class{static validateUUID(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}static encode(e){let t=`${e.platform}:${e.product}`;if("relayId"in e){if(!this.validateUUID(e.relayId))throw new Error("Invalid relay UUID");t+=`:relay:${e.relayId}`}if("folderId"in e){if(!this.validateUUID(e.folderId))throw new Error("Invalid folder UUID");t+=`:folder:${e.folderId}`}if("documentId"in e){if(!this.validateUUID(e.documentId))throw new Error("Invalid document UUID");t+=`:doc:${e.documentId}`}return t}static decode(e){let t=e.split(":");if(t.length<3)throw new Error("Invalid s3rn format");let[,r,n,s,a,i,l,c]=t;if(!this.validateUUID(s))throw new Error("Invalid UUID");if(i&&!this.validateUUID(i))throw new Error("Invalid UUID");if(c&&!this.validateUUID(c))throw new Error("Invalid UUID");if(r==="relay"&&n==="relay"&&a==="folder"&&l==="doc")return new qr(s,i,c);if(r==="relay"&&n==="relay"&&a=="folder")return new Ao(s,i);if(r==="relay"&&n==="folder"&&a==="document")return new An(s,i);if(r==="relay"&&n==="folder")return new en(s);if(r==="relay"&&n==="relay")return new lu(s);if(n===void 0)return new iu;throw new Error("Invalid s3rn format for the given product type")}};function vI(o){if(typeof window!="undefined"&&window.btoa)return window.btoa(o);if(typeof Buffer!="undefined")return Buffer.from(o).toString("base64");throw new Error("Unable to encode to Base64")}function ox(o){let e=JSON.stringify(o),t=vI(e);return t=t.replace("+","-").replace("/","_").replace(/=+$/,""),t}var ul={enableUpdateYDocFromDiskBuffer:!1,enableDocumentStatus:!1,enableDebugFileTag:!1,enableNewLinkFormat:!1,enableDeltaLogging:!1,enableHTTPSync:!1,enableSyncMenu:!0,enableDocumentServer:!1,enableDocumentHistory:!1,enableEditorTweens:!1,enableSyncModal:!1,enableDesyncPill:!1,enableAutomaticUpdatesOption:!1};function SI(){return new Proxy({},{get:(o,e)=>e})}var Tr=SI();var Cs=class{constructor(){this.timeouts=[],this.intervals=[]}getTime(){return Date.now()}setInterval(e,t){let r=window.setInterval(e,t);return this.intervals.push(r),r}clearInterval(e){window.clearInterval(e)}setTimeout(e,t){let r=window.setTimeout(()=>{this.timeouts.remove(r),e()},t);return this.timeouts.push(r),r}clearTimeout(e){window.clearTimeout(e)}destroy(){for(let e of this.timeouts)this.clearTimeout(e);this.timeouts=[];for(let e of this.intervals)this.clearInterval(e);this.intervals=[]}debounce(e,t=500){let r;return(...n)=>{r&&clearTimeout(r),r=setTimeout(()=>{e(...n)},t)}}};var Ut=class{constructor(e,t=20){this.timeProvider=e;this.deliveryWindow=t;this.mailboxes=new Map;this.allMailLog=[];this.deliveredMailLog=[];this.isDelivering=!1;this.deliveryInterval=null;this.currentTransactionId=0;this.isInTransaction=!1}static getInstance(){if(this._destroyed)throw new Error("tried to access postie during teardown");return Ut.instance||(Ut.instance=new Ut(new Cs),Dt.set(this.instance,"postie")),Ut.instance}beginTransaction(){this.isInTransaction=!0,this.currentTransactionId++}commitTransaction(){this.isInTransaction=!1,this.isDelivering||this.scheduleDelivery()}send(e,t,r=!1){let n={sender:e,recipient:t,transactionId:this.currentTransactionId,timestamp:Date.now(),recipientOrigin:this.getFunctionOrigin(t)};this.allMailLog.push(n),this.mailboxes.has(t)||this.mailboxes.set(t,new Set),this.mailboxes.get(t).add(e),r?this.deliverImmediate(e,t):!this.isInTransaction&&!this.isDelivering&&this.scheduleDelivery()}deliverImmediate(e,t){t(e),this.deliveredMailLog.push({sender:e,recipient:t,transactionId:this.currentTransactionId,timestamp:Date.now(),recipientOrigin:this.getFunctionOrigin(t)})}scheduleDelivery(){this.isDelivering=!0,this.deliveryInterval=this.timeProvider.setTimeout(()=>{this.deliver(),this.deliveryInterval=null,this.isDelivering=!1,this.mailboxes.size>0&&!this.isInTransaction&&this.scheduleDelivery()},this.deliveryWindow)}deliver(){let e=Le("[postie]","debug");for(let[t,r]of this.mailboxes){for(let n of r)t(n),e("send",n.constructor.name,t),this.deliveredMailLog.push({sender:n,recipient:t,transactionId:this.currentTransactionId,timestamp:Date.now(),recipientOrigin:this.getFunctionOrigin(t)});r.clear()}}getAllMailLog(){return[...this.allMailLog]}getDeliveredMailLog(){return[...this.deliveredMailLog]}prettyPrintAllMailLog(){Le("[postie]","warn")("All Mail Log:"),this.prettyPrintMailLog(this.allMailLog)}prettyPrintDeliveredMailLog(){Le("[postie]","warn")("Delivered Mail Log:"),this.prettyPrintMailLog(this.deliveredMailLog)}prettyPrintMailLog(e){let t=Le("[postie]","warn");e.forEach((r,n)=>{t(`Mail #${n+1}:`),t(`  Timestamp: ${new Date(r.timestamp).toISOString()}`),t(`  Transaction ID: ${r.transactionId}`),t(`  Sender: ${r.sender.observableName||r.sender.constructor.name}`),t(`  Recipient: ${r.recipient.name||"Anonymous function"}`),t(`  Recipient Origin: ${r.recipientOrigin||"Unknown"}`),t("---")})}getFunctionOrigin(e){if(e.name)return e.name;let t=e.toString(),r=t.match(/^(function|class)?\s*([^\s(]*)/);if(r&&r[2])return r[2];let n=200,s=t.replace(/\s+/g," ").slice(0,n);return s.length===n&&(s+="..."),`AnonymousFunction(${s})`}static destroy(){Ut.instance&&(Ut.instance.mailboxes=null,Ut.instance.allMailLog=[],Ut.instance.deliveredMailLog=[],Ut.instance.timeProvider.destroy(),Ut.instance.timeProvider=null,Ut.instance.isDelivering=!1,Ut.instance.isInTransaction=!1,Ut.instance.currentTransactionId=0,Ut._destroyed=!0,Ut.instance=void 0)}},Dr=Ut;Dr._destroyed=!1;var fu=new Map;function nx(){for(let[,o]of fu)o();fu.clear()}var Pt=class extends Po{constructor(t){super();this.observableName=t;this.destroyed=!1;fu.set(this,()=>{this._listeners&&this._listeners.size>0&&this.warn(`Missing tear down of ${this._listeners.size} listeners on ${this.observableName}`)}),this._listeners=new Set,this.unsubscribes=[]}notifyListeners(){for(let t of this._listeners)Dr.getInstance().send(this,t)}on(t){return this._listeners.add(t),()=>{this.off(t)}}subscribe(t){return this._listeners.add(t),Dr.getInstance().send(this,t,!0),()=>{this.unsubscribe(t)}}off(t){this._listeners.delete(t)}unsubscribe(t){this._listeners&&this._listeners.delete(t)}destroy(){var t;this.destroyed=!0,this.unsubscribes&&this.unsubscribes.forEach(r=>{r()}),(t=this._listeners)==null||t.clear(),this._listeners=null}};function Xt(){return{...Vt.getInstance().flags}}function ao(o,e,t=()=>{}){Vt.getInstance().flags[o]?e():t()}function sx(o,e,t=()=>{}){o.forEach(r=>{if(Vt.getInstance().flags[r]){e();return}}),t()}var Vt=class extends Pt{constructor(){super();this.flags=ul}static getInstance(){return Vt.instance||(Vt.instance=new Vt),Vt.instance}setSettings(t){this.settings=t,this.settings.subscribe(r=>{this.flags={...this.flags,...r},this.notifyListeners()})}getFlag(t){return this.flags[t]}setFlag(t,r){this.settings&&this.settings.update(n=>({...n,[t]:r}))}static destroy(){Vt.instance=null}};var kI={3:"disconnected",2:"disconnected",1:"connected",0:"connecting"};function ax(o,e,t){let r={token:o.token},n=new Xg(o.url,o.docId,e,{connect:!1,params:r,disableBc:!0});return t&&n.awareness.setLocalStateField("user",{name:t.name,color:t.color.color,colorLight:t.color.light}),n}var Ts=class extends Po{constructor(t,r,n,s){var c;super();this.guid=t;this._s3rn=r;this.tokenStore=n;this.loginManager=s;this._providerSynced=!1;this.PROVIDER_MAX_ERRORS=3;this.listeners=new Map,this.loginManager=s;let a=(c=this.loginManager)==null?void 0:c.user;this.ydoc=new mr,Xt().enableDocumentHistory&&(this.ydoc.gc=!1),a&&new Wi(this.ydoc).setUserMapping(this.ydoc,this.ydoc.clientID,a.id),this.tokenStore=n,this.clientToken=this.tokenStore.getTokenSync(Jt.encode(this.s3rn))||{token:"",url:"",docId:"-",expiryTime:0},this._provider=ax(this.clientToken,this.ydoc,a);let i=this.providerConnectionErrorSubscription(u=>{this.log(`[${this.path}] disconnection event`,u);let d=this._provider.url&&this._provider.shouldConnect&&this._provider.wsUnsuccessfulReconnects<this.PROVIDER_MAX_ERRORS;this.disconnect(),d&&this.connect()});i.on(),this._offConnectionError=i.off;let l=this.providerStateSubscription(u=>{this.notifyListeners()});l.on(),this._offState=l.off}get s3rn(){return this._s3rn}set s3rn(t){this._s3rn=t,this.refreshProvider(this.clientToken)}get debuggerUrl(){return`https://debugger.y-sweet.dev/?payload=${ox(this.clientToken)}`}notifyListeners(){this.debug("[Provider State]",this.path,this.state),this.listeners.forEach(t=>{t(this.state)})}subscribe(t,r){return this.listeners.set(t,r),()=>{this.unsubscribe(t)}}unsubscribe(t){this.listeners.delete(t)}async getProviderToken(){return this.log("get provider token"),this.tokenStore.getToken(Jt.encode(this.s3rn),this.path||"unknown",this.refreshProvider.bind(this))}providerActive(){var t;if(this.clientToken){let r=this._provider.url==this.clientToken.url,n=Date.now()>(((t=this.clientToken)==null?void 0:t.expiryTime)||0);return r&&!n}return!1}refreshProvider(t){var a;this.clientToken=t;let r=new mr,n=ax(t,r),s=n.url;if(this._provider){if(this._provider.url!==s){this._provider.url=s,this._provider.wsUnsuccessfulReconnects=0;let i=this._provider.url.replace(/token=[^&]+/,"token=[REDACTED]");this.log(`Token Refreshed: setting new provider url, ${i}`),(a=this._provider.ws)==null||a.close()}}else throw new Error("missing provider!");n.awareness.destroy(),n.destroy(),r.destroy()}get connected(){return this.state.status==="connected"}connect(){return this.connected?Promise.resolve(!0):this.getProviderToken().then(t=>(this.refreshProvider(t),this._provider.connect(),this.notifyListeners(),!0)).catch(t=>!1)}get state(){var t;return{status:kI[((t=this._provider.ws)==null?void 0:t.readyState)||3],intent:this.intent}}get intent(){return this._provider.shouldConnect?"connected":"disconnected"}get synced(){return this._providerSynced}disconnect(){var t;this._provider.shouldConnect=!1,(t=this._provider.ws)==null||t.close(),this._provider.ws=null,this.tokenStore.removeFromRefreshQueue(this.guid),this.notifyListeners()}withActiveProvider(){return this.providerActive()?new Promise(t=>{t(this)}):this.getProviderToken().then(t=>this)}onceConnected(){return new Promise(t=>{let r=n=>{n.status==="connected"&&t()};this._provider.on("status",r)})}onceProviderSynced(){return this.synced?new Promise(t=>{t()}):new Promise(t=>{this._provider.once("synced",()=>{this._providerSynced=!0,t()})})}_injectIntent(t){return n=>{t({status:n.status,intent:this.intent})}}providerConnectionErrorSubscription(t){return{on:()=>{this._provider.on("connection-error",t)},off:()=>{this._provider.off("connection-error",t)}}}providerStateSubscription(t){return{on:()=>{this._provider.on("status",this._injectIntent(t))},off:()=>{this._provider.off("status",this._injectIntent(t))}}}destroy(){this._offConnectionError&&this._offConnectionError(),this._offState&&this._offState(),this._provider&&(this._provider.disconnect(),this._provider.awareness.destroy(),this._provider._observers.clear(),this._provider.destroy(),window.clearInterval(this._provider.awareness._checkInterval)),this.loginManager=null}};var tn=class{constructor(e,t,r){this.vault=e;this.contents=r;this.parent=null;this.path=t,this.name=t.split("/").pop()||"",this.extension=this.name.includes(".")&&this.name.split(".").pop()||"",this.basename=this.name.replace(`.${this.extension}`,""),this.stat={ctime:Date.now(),mtime:Date.now(),size:0}}delete(){return Promise.resolve()}rename(e){return this.path=e,this.name=e.split("/").pop()||"",this.extension=this.name.includes(".")&&this.name.split(".").pop()||"",this.basename=this.name.replace(`.${this.extension}`,""),Promise.resolve()}getBasePath(){return this.path.substring(0,this.path.lastIndexOf("/"))}},dl=class{constructor(){this.dbName="RelayDiskBuffer";this.storeName="diskBuffers";this.dbPromise=null}async getDB(){return this.dbPromise||(this.dbPromise=this.openDB()),this.dbPromise}async openDB(){return new Promise((e,t)=>{let r=indexedDB.open(this.dbName,1);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=n=>{n.target.result.createObjectStore(this.storeName,{keyPath:"guid"})}})}async saveDiskBuffer(e,t){let r=await this.getDB();return new Promise((n,s)=>{try{let l=r.transaction(this.storeName,"readwrite").objectStore(this.storeName).put({guid:e,contents:t});l.onerror=()=>s(l.error),l.onsuccess=()=>n()}catch(a){s(a)}})}async loadDiskBuffer(e){let t=await this.getDB();return new Promise((r,n)=>{try{let i=t.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e);i.onerror=()=>n(i.error),i.onsuccess=()=>r(i.result?i.result.contents:null)}catch(s){n(s)}})}async removeDiskBuffer(e){let t=await this.getDB();return new Promise((r,n)=>{try{let i=t.transaction(this.storeName,"readwrite").objectStore(this.storeName).delete(e);i.onerror=()=>n(i.error),i.onsuccess=()=>r()}catch(s){n(s)}})}};var rn=class{constructor(e,t){this.currentPromise=null;this.promiseFunction=e,this.checkFunction=t}getPromise(){let[e,t]=this.checkFunction(),r=n=>{if(this.currentPromise&&this.resolver){let s=this.resolver;s(n),this.timeoutId&&clearTimeout(this.timeoutId),this.resolver=void 0}return this.currentPromise};if(e){let n=r(t);if(n)return n}return this.currentPromise||(this.currentPromise=new Promise((n,s)=>{this.resolver=n,this.timeoutId=window.setTimeout(()=>{Le("[Promise]","debug")("Dependency stuck after 3s. Checking.",this.promiseFunction.toString());let[a,i]=this.checkFunction();a&&r(i)},3e3),this.promiseFunction().then(a=>{this.timeoutId&&clearTimeout(this.timeoutId),n(a)},a=>{this.timeoutId&&clearTimeout(this.timeoutId),this.currentPromise=null,s(a)})})),this.currentPromise}destroy(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this.currentPromise=null,this.resolver=void 0}},pl=class{constructor(e){this.currentPromise=null;this.promiseFunction=e}getPromise(){return this.currentPromise||(this.currentPromise=new Promise((e,t)=>{this.timeoutId=window.setTimeout(()=>{Le("[Promise]","error")("SharedPromise stuck after 3s:",this.promiseFunction.toString())},3e3),this.promiseFunction().then(r=>{this.timeoutId&&clearTimeout(this.timeoutId),this.currentPromise=null,e(r)},r=>{this.timeoutId&&clearTimeout(this.timeoutId),this.currentPromise=null,t(r)})})),this.currentPromise}destroy(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this.currentPromise=null}};function cu(o,...e){return new Promise((t,r)=>{let n=window.setTimeout(()=>{Le("[Promise]","error")("Promise stuck after 3s:",...e)},3e3);o.then(s=>{clearTimeout(n),t(s)},s=>{clearTimeout(n),r(s)})})}var LI={md:"text/plain",txt:"text/plain",json:"application/json",js:"application/javascript",ts:"application/typescript",html:"text/html",css:"text/css",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",svg:"image/svg+xml",pdf:"application/pdf",canvas:"application/json"};function ix(o){var t;let e=((t=o.split(".").pop())==null?void 0:t.toLowerCase())||"";return LI[e]||"application/octet-stream"}var ct=class extends Ts{constructor(t,r,n,s){let a=s.relayId?new qr(s.relayId,s.guid,r):new An(s.guid,r);super(r,a,s.tokenStore,n);this.whenSyncedPromise=null;this.persistenceSynced=!1;this.userLock=!1;this.unsubscribes=[];this._parent=s,this.path=t,this.name="[CRDT] "+t.split("/").pop()||"",this.setLoggers(this.name),this.extension=this.name.split(".").pop()||"",this.basename=this.name.replace(`.${this.extension}`,""),this.vault=this._parent.vault,this.stat={ctime:Date.now(),mtime:Date.now(),size:0},this._diskBufferStore=this.sharedFolder.diskBufferStore,this.unsubscribes.push(this._parent.subscribe(this.path,i=>{i.intent==="disconnected"&&this.disconnect()})),this.setLoggers(`[SharedDoc](${this.path})`);try{let i=`${this.sharedFolder.appId}-relay-doc-${this.guid}`;this._persistence=new ws(i,this.ydoc)}catch(i){throw this.warn("Unable to open persistence.",this.guid),console.error(i),i}this.whenSynced().then(()=>{let i=l=>{let c=l.transaction.origin;l.changes.keys.size!==0&&c!=this&&this.updateStats()};this.ytext.observe(i),this.unsubscribes.push(()=>{var l;(l=this.ytext)==null||l.unobserve(i)}),this.updateStats();try{this._persistence.set("path",this.path),this._persistence.set("relay",this.sharedFolder.relayId||""),this._persistence.set("appId",this.sharedFolder.appId),this._persistence.set("s3rn",Jt.encode(this.s3rn))}catch(l){}(async()=>(await this.getServerSynced()||(await this.onceProviderSynced(),await this.markSynced()),this.sharedFolder.markUploaded(this)))()}),ao(Tr.enableDeltaLogging,()=>{let i=l=>{var u,d;let c="";c+=`Transaction origin: ${l.transaction.origin} ${(d=(u=l.transaction.origin)==null?void 0:u.constructor)==null?void 0:d.name}
`;for(let m of l.changes.delta)c+=`insert: ${m.insert}

retain: ${m.retain}

delete: ${m.delete}
`;this.debug(c)};this.ytext.observe(i),this.unsubscribes.push(()=>{this.ytext.unobserve(i)})}),this._tfile=null}move(t){this.path=t,this.name=t.split("/").pop()||"",this.extension=this.name.split(".").pop()||"",this.basename=this.name.replace(`.${this.extension}`,""),this.updateStats()}get parent(){var t;return((t=this.tfile)==null?void 0:t.parent)||null}get sharedFolder(){return this._parent}get tfile(){return this._tfile||(this._tfile=this._parent.getTFile(this)),this._tfile}get ytext(){return this.ydoc.getText("contents")}get text(){return this.ytext?this.ytext.toString():""}async diskBuffer(t=!1){if(t||this._diskBuffer===void 0){let r;try{let n=await this._parent.diskBufferStore.loadDiskBuffer(this.guid).catch(s=>null);return n!==null&&n!==""?r=n:r=await this._parent.read(this),this.setDiskBuffer(r.replace(`\r
`,`
`))}catch(n){throw console.error(n),n}}return this._diskBuffer}setDiskBuffer(t){return this._diskBuffer?this._diskBuffer.contents=t:this._diskBuffer=new tn(this._parent.vault,"local disk",t),this._parent.diskBufferStore.saveDiskBuffer(this.guid,t).catch(r=>{}),this._diskBuffer}async clearDiskBuffer(){this._diskBuffer&&(this._diskBuffer.contents="",this._diskBuffer=void 0),await this._parent.diskBufferStore.removeDiskBuffer(this.guid).catch(t=>{})}async checkStale(){await this.whenSynced();let r=(await this.diskBuffer(!0)).contents,n=this.text!==r;return n||this.clearDiskBuffer(),n}async connect(){return this.sharedFolder.s3rn instanceof en?!1:(this.s3rn instanceof An&&(this.sharedFolder.relayId?this.s3rn=new qr(this.sharedFolder.relayId,this.sharedFolder.guid,this.guid):this.s3rn=new An(this.sharedFolder.guid,this.guid)),this.sharedFolder.shouldConnect&&this.sharedFolder.connect().then(t=>super.connect()))}get ready(){return this._persistence.synced&&(this.synced||!!this._serverSynced||this._origin==="local")}hasLocalDB(){return!!this._serverSynced||this._persistence._dbsize>3||!!(this._dbsize&&this._dbsize>3)}async awaitingUpdates(){return await this.whenSynced(),await this.getServerSynced(),this._awaitingUpdates?(this._awaitingUpdates=!this.hasLocalDB(),this._awaitingUpdates):!1}async whenReady(){let t=async()=>await this.awaitingUpdates()?(this.log("awaiting updates"),this.connect(),await this.onceConnected(),this.log("connected"),await this.onceProviderSynced(),this.log("synced"),this):this;return this.readyPromise=this.readyPromise||new rn(t,()=>[this.ready,this]),this.readyPromise.getPromise()}whenSynced(){let t=async()=>(await this.sharedFolder.whenSynced(),this._persistence.synced&&!this.persistenceSynced?(await this.count(),this.persistenceSynced=!0,Promise.resolve()):new Promise(r=>{this.persistenceSynced&&r(),this._persistence.once("synced",async()=>{await this.count(),this.persistenceSynced=!0,r()})}));return this.whenSyncedPromise=this.whenSyncedPromise||new rn(t,()=>[this.persistenceSynced,void 0]),this.whenSyncedPromise.getPromise()}async hasKnownPeers(){return await this.whenSynced(),this.hasLocalDB()}get mimetype(){return ix(this.path)}async markOrigin(t){this._origin=t,await this._persistence.set("origin",t)}async getOrigin(){return this._origin!==void 0?this._origin:(this._origin=await this._persistence.get("origin"),this._origin)}async markSynced(){this._serverSynced=!0,await this._persistence.set("serverSync",1)}async getServerSynced(){return this._serverSynced!==void 0?this._serverSynced:await this._persistence.get("serverSync")===1?(this._serverSynced=!0,this._serverSynced):!1}async count(){if(this._persistence.db===null)throw new Error("database not ready yet");if(this._dbsize)return this._dbsize;if(this._persistence._dbsize>3)return this._dbsize=this._persistence._dbsize,this._dbsize;let[t]=no(this._persistence.db,["updates"],"readonly"),r=await Dn(t);return this._dbsize=r,this._dbsize}get dbsize(){if(!this._dbsize)throw new Error("dbsize accessed before count");return this._persistence._dbsize===0&&this._dbsize?this._dbsize:this._persistence._dbsize}static checkExtension(t){return t.endsWith(".md")}destroy(){var t,r;this.unsubscribes.forEach(n=>{n()}),super.destroy(),this.ydoc.destroy(),this._diskBuffer&&(this._diskBuffer.contents="",this._diskBuffer=void 0),this._diskBufferStore=null,(t=this.whenSyncedPromise)==null||t.destroy(),this.whenSyncedPromise=null,(r=this.readyPromise)==null||r.destroy(),this.readyPromise=null}async read(){return this.text}async rename(t){this.move(t)}async cleanup(){var t;(t=this._diskBufferStore)==null||t.removeDiskBuffer(this.guid)}updateStats(){this.stat.mtime=Date.now(),this.stat.size=this.text.length}async write(t){this.ytext.delete(0,this.ytext.length),this.ytext.insert(0,t),this.updateStats()}async append(t){this.ytext.insert(this.ytext.length,t),this.updateStats()}};var on=class extends Pt{constructor(){super();this._set=new Set}add(t){return this._set.add(t),this.notifyListeners(),this}delete(t){let r=this._set.delete(t);return r&&this.notifyListeners(),r}clear(){this._set.clear(),this.notifyListeners()}has(t){return this._set.has(t)}items(){return[...this._set]}get size(){return this._set.size}map(t){return this.items().map(t)}forEach(t){this.items().forEach(t)}find(t){return this.items().find(t)}some(t){for(let r of this._set)if(t(r))return!0;return!1}filter(t){let r=[];for(let n of this._set)t(n)&&r.push(n);return r}};var Eo=class{constructor(e){this.seperator="/";this.namespace=e}fullKey(e){return`${this.namespace}${this.seperator}${e}`}get size(){return Object.keys(localStorage).filter(e=>e.startsWith(this.namespace+this.seperator)).length}clear(){Object.keys(localStorage).filter(e=>e.startsWith(this.namespace+this.seperator)).forEach(e=>localStorage.removeItem(e))}delete(e){let t=this.fullKey(e),r=localStorage.getItem(t)!==null;return localStorage.removeItem(t),r}forEach(e,t){Object.keys(localStorage).filter(r=>r.startsWith(this.namespace+this.seperator)).forEach(r=>{let n=r.split(`${this.namespace}${this.seperator}`)[1],s=this.get(n);e.call(t,s,n,this)})}get(e){let t=this.fullKey(e),r=localStorage.getItem(t);return r?JSON.parse(r):void 0}has(e){let t=this.fullKey(e);return localStorage.getItem(t)!==null}set(e,t){let r=this.fullKey(e);return localStorage.setItem(r,JSON.stringify(t)),this}keys(){return Object.keys(localStorage).filter(t=>t.startsWith(this.namespace+this.seperator)).map(t=>t.split(`${this.namespace}${this.seperator}`)[1]).values()}values(){return Array.from(this.keys()).map(t=>this.get(t)).values()}entries(){return Array.from(this.keys()).map(t=>[t,this.get(t)]).values()}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return"LocalStorage"}};function lx(o,e,t=(r,n)=>r.substring(n.length).replace(/^\/+/,"")){return new Proxy(o,{get(r,n){let s=r[n];return typeof s=="function"?function(...a){return a.length>0&&typeof a[0]=="string"&&(a[0]=t(a[0],e)),s.apply(r,a)}:s}})}var uu=class extends on{constructor(){super(...arguments);this.notifyListeners=(0,kt.debounce)(super.notifyListeners,100)}update(){this.notifyListeners()}add(t,r=!0){return r=r&&!this._set.has(t),this._set.add(t),r&&this.notifyListeners(),this}},ml=class extends Ts{constructor(t,r,n,s,a,i,l,c,u,d,m,x=!0){var v;let h=m?new Ao(m,r):new en(r);super(r,h,l,s);this.appId=t;this.backgroundSync=u;this._settings=d;this.destroyed=!1;this.readyPromise=null;this.whenSyncedPromise=null;this.persistenceSynced=!1;this.syncFileTreePromise=null;this.syncRequestedDuringSync=!1;this.unsubscribes=[];this.addLocalDocs=()=>{let t=this.getFiles(),r=[],n=[];t.forEach(a=>{this.checkPath(a.path)&&(this.ids.has(a.path)||n.push(this.getVirtualPath(a.path)))});let s=this.placeHold(n);t.forEach(a=>{if(!this.checkPath(a.path)||!ct.checkExtension(a.path)||a instanceof kt.TFolder)return;let i=this.getVirtualPath(a.path);if(s.contains(i)){let c=this.uploadDoc(i,!1);r.push(c)}else{let c=this.getDoc(i,!1);r.push(c)}}),r.length>0&&this.docset.update()};this.path=n,this.setLoggers(`[SharedFile](${this.path})`),this.fileManager=i,this.vault=a,this.ids=this.ydoc.getMap("docs"),this.docs=new Map,this.docset=new uu,this.pendingUpload=new Eo(`${t}-system3-relay/folders/${this.guid}/pendingUploads`),this.relayManager=c,this.relayId=m,this.diskBufferStore=new dl,this._shouldConnect=(v=this.settings.connect)!=null?v:!0,this.authoritative=!x,this.unsubscribes.push(this.relayManager.remoteFolders.subscribe(w=>{this.remote=w.find(_=>_.guid==this.guid)})),this.proxy=lx(this,this.path,w=>this.getVirtualPath(w));try{this._persistence=new ws(this.guid,this.ydoc)}catch(w){throw this.warn("Unable to open persistence.",this.guid),console.error(w),w}s.loggedIn&&this.connect(),this.whenReady().then(async()=>{this.destroyed||(this.addLocalDocs(),await this.syncFileTree(this.ydoc))}),ao(Tr.enableDeltaLogging,()=>{let w=_=>{var U,L;let A="";A+=`Transaction origin: ${_.transaction.origin}${(L=(U=_.transaction.origin)==null?void 0:U.constructor)==null?void 0:L.name}
`,_.changes.keys.forEach((R,O)=>{R.action==="add"&&(A+=`Added ${O}: ${this.ids.get(O)}
`),R.action==="update"&&(A+=`Updated ${O}: ${this.ids.get(O)}
`),R.action==="delete"&&(A+=`Deleted ${O}
`)}),this.debug(A)};this.ids.observe(w),this.unsubscribes.push(()=>{this.ids.unobserve(w)})}),this.whenSynced().then(async()=>{let w=async _=>{if(_.changes.keys.size===0){this.log("no changes detected");return}_.transaction.origin!=this&&(this.log("file tree",this._debugFileTree()),await this.syncFileTree(this.ydoc))};this.ids.observe(w),this.unsubscribes.push(()=>{this.ids.unobserve(w)});try{this._persistence.set("path",this.path),this._persistence.set("relay",this.relayId||""),this._persistence.set("appId",this.appId),this._persistence.set("s3rn",Jt.encode(this.s3rn))}catch(_){}}),(async()=>await this.getServerSynced()||(await this.onceProviderSynced(),await this.markSynced()))(),Dt.set(this,this.path)}get shouldConnect(){return this._shouldConnect}set shouldConnect(t){this._settings.update(r=>({...r,connect:t})),this._shouldConnect=t}async netSync(){await this.whenReady(),this.addLocalDocs(),await this.syncFileTree(this.ydoc),this.backgroundSync.enqueueSharedFolderSync(this)}get settings(){return this._settings.get()}getFiles(){let t=this.vault.getAbstractFileByPath(this.path);if(!(t instanceof kt.TFolder))throw new Error(`Could not find shared folders on file system at ${this.path}`);let r=[];return kt.Vault.recurseChildren(t,n=>{n instanceof kt.TFile&&r.push(n)}),r}connect(){return this.s3rn instanceof Ao&&(this.connected||this.shouldConnect)?(this.backgroundSync.resume(),super.connect()):Promise.resolve(!1)}get name(){return this.path.split("/").pop()||""}get location(){return this.path.split("/").slice(0,-1).join("/")}get remote(){var t;try{(t=this._remote)==null||t.relay}catch(r){return}return this._remote}set remote(t){var r;this._remote!==t&&(this._remote=t,this.relayId=(r=t==null?void 0:t.relay)==null?void 0:r.guid,this.s3rn=this.relayId?new Ao(this.relayId,this.guid):new en(this.guid),this._settings.update(n=>this.relayId?{guid:this.guid,path:this.path,relay:this.relayId}:{guid:this.guid,path:this.path}),this.notifyListeners())}get ready(){return this.persistenceSynced&&(this.authoritative||this._serverSynced||this.synced)}async count(){if(this._persistence.db===null)throw new Error("unexpected missing database");if(this._dbsize)return this._dbsize;if(this._persistence._dbsize>3)return this._dbsize=this._persistence._dbsize,this._dbsize;let[t]=no(this._persistence.db,["updates"],"readonly"),r=await Dn(t);return this._dbsize=r,this._dbsize}async markSynced(){this._serverSynced=!0,await this._persistence.set("serverSync",1)}async getServerSynced(){return this._serverSynced!==void 0?this._serverSynced:await this._persistence.get("serverSync")===1?(this._serverSynced=!0,this._serverSynced):!1}hasLocalDB(){return this._persistence._dbsize>3||!!(this._dbsize&&this._dbsize>3)}async awaitingUpdates(){return await this.whenSynced(),this.authoritative||await this.getServerSynced()?!1:!this.hasLocalDB()}whenReady(){let t=async()=>await this.awaitingUpdates()?(this.connect(),await this.onceConnected(),await this.onceProviderSynced(),this):this;return this.readyPromise=this.readyPromise||new rn(t,()=>[this.ready,this]),this.readyPromise.getPromise()}_debugFileTree(){let t=new Map;return this.ydoc.getMap("docs")._map.forEach((r,n)=>{r.content instanceof Nr?t.set(n,r.content.arr[0]):t.set(n,r.content)}),t}whenSynced(){let t=async()=>{if(this._persistence.synced){await this.count(),this.persistenceSynced=!0;return}return new Promise(r=>{this._persistence.once("synced",async()=>{await this.count(),this.persistenceSynced=!0,r()})})};return this.whenSyncedPromise=this.whenSyncedPromise||new rn(t,()=>(this._persistence.synced&&this._dbsize&&(this.persistenceSynced=!0),[this.persistenceSynced,void 0])),this.whenSyncedPromise.getPromise()}get intent(){return this.shouldConnect?"connected":"disconnected"}async _handleServerRename(t,r,n,s){s==null||s.push(`${n.path} was renamed to ${r}`);let a=(0,Pr.dirname)(r);this.existsSync(a)||(await this.mkdir(a),s==null||s.push(`creating directory ${a}`)),this.fileManager.renameFile(n,(0,kt.normalizePath)(this.getPath(r))).then(()=>{t.move(r)})}async _handleServerCreate(t,r){let n=(0,Pr.dirname)(t);this.existsSync(n)||(await this.mkdir(n),r==null||r.push(`creating directory ${n}`));let s=await this.downloadDoc(t,!1);return r==null||r.push(`created local file for remotely added doc ${t}`),s}_assertNamespacing(t){try{this.assertPath(this.path+t)}catch(r){this.error("Deleting doc (somehow moved outside of shared folder)",t),this.ids.delete(t);return}}applyRemoteState(t,r,n,s){let a=this.docs.get(t);if(this.existsSync(r)||!ct.checkExtension(r))return{op:"noop",path:r,promise:Promise.resolve()};if(n.has(t)&&a){let l=this.getPath(a.path),c=this.vault.getAbstractFileByPath(l);if(c){let u=this._handleServerRename(a,r,c,s);return{op:"rename",path:r,from:l,to:r,promise:u}}}let i=this._handleServerCreate(r,s);return{op:"create",path:r,promise:i}}cleanupExtraLocalFiles(t,r){let n=this.getFiles(),s=[];return n.forEach(a=>{var m,x;let i=ct.checkExtension(a.path),l=this.checkPath(a.path),c=t.contains(a.path.slice(this.path.length)),u=this.pendingUpload.has(this.getVirtualPath(a.path)),d=((m=this._provider)==null?void 0:m.synced)&&((x=this._persistence)==null?void 0:x.synced);if(l&&!c&&!u&&i&&d){r.push(`deleted local file ${a.path} for remotely deleted doc`);let h=this.vault.adapter.trashLocal(a.path);s.push({op:"delete",path:a.path,promise:h})}}),s}syncFileTree(t){if(this.syncFileTreePromise){this.syncRequestedDuringSync=!0;let n=this.syncFileTreePromise.getPromise();return n.then(()=>{if(this.syncRequestedDuringSync)return this.syncRequestedDuringSync=!1,this.syncFileTree(t)}),n}let r=async()=>{try{let n=[],s=t.getMap("docs"),a=[];this.ydoc.transact(()=>{s.forEach((m,x)=>{this._assertNamespacing(x)});let d=new Set(this.ids.values());s.forEach((m,x)=>{this._assertNamespacing(x),n.push(this.applyRemoteState(m,x,d,a))})});let i=n.filter(d=>d.op==="create"),l=n.filter(d=>d.op==="rename"),c=n.map(d=>d.path);await Promise.all([...i,...l].map(d=>cu(d.promise,d)));let u=this.cleanupExtraLocalFiles(c,a);(l.length>0||i.length>0||u.length>0)&&this.docset.update(),this.log(`syncFileTree diff:
`+a.join(`
`))}finally{this.syncFileTreePromise=null}};return this.syncFileTreePromise=new pl(r),this.syncFileTreePromise.getPromise()}move(t){this.path=t,this.setLoggers(`[SharedFile](${this.path})`),this._settings.update(r=>({...r,path:t}))}read(t){let r=(0,Pr.join)(this.path,t.path);return this.vault.adapter.read((0,kt.normalizePath)(r))}existsSync(t){let r=(0,kt.normalizePath)((0,Pr.join)(this.path,t));return this.vault.getAbstractFileByPath(r)!==null}exists(t){let r=(0,Pr.join)(this.path,t.path);return this.vault.adapter.exists((0,kt.normalizePath)(r))}flush(t,r){let n=(0,Pr.join)(this.path,t.path);return this.log("writing to ",(0,kt.normalizePath)(n)),this.vault.adapter.write((0,kt.normalizePath)(n),r)}getPath(t){return(0,Pr.join)(this.path,t)}assertPath(t){if(!this.checkPath(t))throw new Error("Path is not in shared folder: "+t)}mkdir(t){let r=(0,Pr.join)(this.path,t);return this.vault.adapter.mkdir((0,kt.normalizePath)(r))}checkPath(t){return t.startsWith(this.path+Pr.sep)}getVirtualPath(t){return this.assertPath(t),t.slice(this.path.length)}getTFile(t){let r=this.vault.getAbstractFileByPath(this.getPath(t.path));return r instanceof kt.TFile?r:null}getDoc(t,r=!0){let n=this.ids.get(t)||this.pendingUpload.get(t);if(n!==void 0){let s=this.docs.get(n);return s!==void 0?(s.move(t),s):(this.log("[getDoc]: creating doc for shared ID"),this.createDoc(t,r))}else return this.warn("[getDoc]: creating new shared ID for existing file"),this.placeHold([t]).length>0?this.uploadDoc(t):this.createDoc(t,r)}placeHold(t){let r=[];return t.forEach(n=>{if(!this.ids.has(n)&&!this.pendingUpload.has(n)){this.debug("creating entirely new doc for",n);let s=Da();r.push(n),this.pendingUpload.set(n,s)}}),r}viewDoc(t){let r=this.ids.get(t)||this.pendingUpload.get(t);return r?this.docs.get(r):void 0}async downloadDoc(t,r=!0){if(!ct.checkExtension(t))throw new Error("unexpected extension");if(!this.synced&&!this.ids.has(t))throw new Error(`potential for document split at ${t}`);let n=this.ids.get(t);if(!n)throw new Error(`called download on item that is not in ids ${t}`);let s=this.docs.get(n)||new ct(t,n,this.loginManager,this);return s.markOrigin("remote"),await cu(this.backgroundSync.enqueueDownload(s),s.path),this.docs.set(n,s),this.docset.add(s,r),s}uploadDoc(t,r=!0){if(!ct.checkExtension(t))throw new Error("unexpected extension");if(!this.synced&&!this.ids.has(t)&&!this.pendingUpload.has(t))throw new Error(`potential for document split at ${t}`);let n=this.ids.get(t)||this.pendingUpload.get(t);if(!n)throw new Error("missing guid");let s=this.docs.get(n)||new ct(t,n,this.loginManager,this),a=s.getOrigin(),i=this.awaitingUpdates();return(async()=>{if(!await this.exists(s))throw new Error(`Upload failed, doc does not exist at ${t}`);let[c,u,d]=await Promise.all([this.read(s),a,i]),m=s.ydoc.getText("contents");!d&&u===void 0&&(this.log(`[${s.path}] No Known Peers: Syncing file into ytext.`),this.ydoc.transact(()=>{m.insert(0,c)},this._persistence),s.markOrigin("local"),this.log(`[${s.path}] Uploading file`),await this.backgroundSync.enqueueSync(s),this.markUploaded(s))})(),this.docs.set(n,s),this.docset.add(s,r),s}markUploaded(t){this.ids.has(t.path)||t._serverSynced&&this.ydoc.transact(()=>{this.log(`[${t.path}] File uploaded: adding to set`),this.ids.set(t.path,t.guid),this.pendingUpload.delete(t.path)},this)}createDoc(t,r=!0){if(!ct.checkExtension(t))throw new Error("unexpected extension");if(!this.synced&&!this.ids.has(t)&&!this.pendingUpload.get(t))throw new Error(`potential for document split at ${t}`);let n=this.ids.get(t)||this.pendingUpload.get(t);if(!n)throw new Error("expected guid");let s=this.docs.get(n)||new ct(t,n,this.loginManager,this);return(async()=>this.whenReady().then(async()=>{var i;let a=await s.getServerSynced();((i=s.tfile)==null?void 0:i.stat.size)===0&&!a?this.backgroundSync.enqueueDownload(s):this.pendingUpload.get(s.path)&&this.backgroundSync.enqueueSync(s)}))(),this.docs.set(n,s),this.docset.add(s,r),s}deleteDoc(t){let r=this.ids.get(t)||this.pendingUpload.get(t);r&&this.ydoc.transact(()=>{var s;this.ids.delete(t),this.pendingUpload.delete(t);let n=this.docs.get(r);n&&((s=n._diskBufferStore)==null||s.removeDiskBuffer(r),n.destroy(),this.docset.delete(n)),this.docs.delete(r)},this)}renameFile(t,r){let n="",s="";try{n=this.getVirtualPath(t)}catch(a){this.log("Moving out of shared folder")}try{s=this.getVirtualPath(r)}catch(a){this.log("Moving in from outside of shared folder")}if(!(!n&&!s))if(s){let a=this.ids.get(s)||this.pendingUpload.get(s);if(!a)return;let i=this.docs.get(a);if(!n)this.ydoc.transact(()=>{this.ids.delete(s)},this),this.pendingUpload.delete(s),i&&(i.destroy(),this.docset.delete(i)),this.docs.delete(a);else{let l=this.ids.get(s)||this.pendingUpload.get(s);if(!l)return;let c=this.pendingUpload.get(s);c?(this.pendingUpload.set(n,c),this.pendingUpload.delete(s)):this.ydoc.transact(()=>{this.ids.has(s)&&(this.ids.set(n,l),this.ids.delete(s))},this),i&&i.move(n)}}else{if(this.assertPath(t),!ct.checkExtension(t))return;this.placeHold([n]),this.uploadDoc(n)}}destroy(){var t,r,n;this.destroyed=!0,this.unsubscribes.forEach(s=>{s()}),this.docs.forEach(s=>{s.destroy(),this.docs.delete(s.guid)}),super.destroy(),this.ydoc.destroy(),this.docset.clear(),this.unsubscribes.forEach(s=>{s()}),this._settings.destroy(),this._settings=null,this.diskBufferStore=null,this.relayManager=null,this.backgroundSync=null,this.loginManager=null,this.tokenStore=null,this.fileManager=null,this.vault=null,(t=this.whenSyncedPromise)==null||t.destroy(),this.whenSyncedPromise=null,(r=this.readyPromise)==null||r.destroy(),this.readyPromise=null,(n=this.syncFileTreePromise)==null||n.destroy(),this.syncFileTreePromise=null}},hl=class extends on{constructor(t,r,n,s){super();this.relayManager=t;this.vault=r;this.settings=s;this.update=(0,kt.debounce)(this.notifyListeners,100);this.folderBuilder=n,this._offRemoteUpdates||(this._offRemoteUpdates=this.relayManager.remoteFolders.subscribe(a=>{let i=!1;this.items().forEach(l=>{let c=a.find(u=>u.guid==l.guid);l.remote!=c&&(i=!0),l.remote=c}),i&&this.update()}))}delete(t){t==null||t.destroy();let r=super.delete(t);return this.settings.update(n=>n.filter(s=>s.guid!==t.guid)),r}lookup(t){let r=this.find(n=>n.checkPath(t));return r||null}destroy(){this.items().forEach(t=>{t.destroy()}),this.clear(),this._offRemoteUpdates&&this._offRemoteUpdates(),this.unsubscribes.forEach(t=>{t()}),this.relayManager=null,this.folderBuilder=null}load(){this._load(this.settings.get())}_load(t){let r=!1;t.forEach(n=>{if(!this.vault.getFolderByPath(n.path)){this.warn(`Invalid settings, ${n.path} does not exist`);return}this._new(n.path,n.guid,n==null?void 0:n.relay),r=!0}),r&&this.notifyListeners()}_new(t,r,n,s){let a=this.find(u=>u.path==t&&u.guid==r);if(a)return a;let i=this.find(u=>u.guid==r);if(i)throw new Error(`This folder is already mounted at ${i.path}.`);if(this.find(u=>u.path==t))throw new Error("Conflict: Tracked folder exists at this location.");let c=this.folderBuilder(t,r,n,s);return this._set.add(c),c}new(t,r,n,s){let a=this._new(t,r,n,s);return this.notifyListeners(),a}};var Al=require("@codemirror/state"),Ns=require("obsidian");function X(){}function le(o,e){for(let t in e)o[t]=e[t];return o}function fx(o){return!!o&&(typeof o=="object"||typeof o=="function")&&typeof o.then=="function"}function du(o){return o()}function xl(){return Object.create(null)}function ke(o){o.forEach(du)}function ut(o){return typeof o=="function"}function Q(o,e){return o!=o?e==e:o!==e||o&&typeof o=="object"||typeof o=="function"}var gl;function pu(o,e){return o===e?!0:(gl||(gl=document.createElement("a")),gl.href=e,o===gl.href)}function cx(o){return Object.keys(o).length===0}function Qt(o,...e){if(o==null){for(let r of e)r(void 0);return X}let t=o.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function me(o,e,t){o.$$.on_destroy.push(Qt(e,t))}function he(o,e,t,r){if(o){let n=ux(o,e,t,r);return o[0](n)}}function ux(o,e,t,r){return o[1]&&r?le(t.ctx.slice(),o[1](r(e))):t.ctx}function ge(o,e,t,r){if(o[2]&&r){let n=o[2](r(t));if(e.dirty===void 0)return n;if(typeof n=="object"){let s=[],a=Math.max(e.dirty.length,n.length);for(let i=0;i<a;i+=1)s[i]=e.dirty[i]|n[i];return s}return e.dirty|n}return e.dirty}function xe(o,e,t,r,n,s){if(n){let a=ux(e,t,r,s);o.p(a,n)}}function ye(o){if(o.ctx.length>32){let e=[],t=o.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function ve(o){let e={};for(let t in o)t[0]!=="$"&&(e[t]=o[t]);return e}function mu(o,e){let t={};e=new Set(e);for(let r in o)!e.has(r)&&r[0]!=="$"&&(t[r]=o[r]);return t}function Ds(o){return o==null?"":o}function dx(o,e,t){return o.set(t),e}function px(o){return o&&ut(o.destroy)?o.destroy:X}var En=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;var Ps=class{constructor(e){pt(this,"_listeners","WeakMap"in En?new WeakMap:void 0);pt(this,"_observer");pt(this,"options");this.options=e}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!=null?e:this._observer=new ResizeObserver(t=>{var r;for(let n of t)Ps.entries.set(n.target,n),(r=this._listeners.get(n.target))==null||r(n)})}};Ps.entries="WeakMap"in En?new WeakMap:void 0;var mx=!1;function hx(){mx=!0}function gx(){mx=!1}function k(o,e){o.appendChild(e)}function De(o,e,t){let r=xx(o);if(!r.getElementById(e)){let n=D("style");n.id=e,n.textContent=t,TI(r,n)}}function xx(o){if(!o)return document;let e=o.getRootNode?o.getRootNode():o.ownerDocument;return e&&e.host?e:o.ownerDocument}function TI(o,e){return k(o.head||o,e),e.sheet}function T(o,e,t){o.insertBefore(e,t||null)}function C(o){o.parentNode&&o.parentNode.removeChild(o)}function it(o,e){for(let t=0;t<o.length;t+=1)o[t]&&o[t].d(e)}function D(o){return document.createElement(o)}function Wr(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function K(o){return document.createTextNode(o)}function B(){return K(" ")}function Ce(){return K("")}function re(o,e,t,r){return o.addEventListener(e,t,r),()=>o.removeEventListener(e,t,r)}function yx(o){return function(e){return e.stopPropagation(),o.call(this,e)}}function b(o,e,t){t==null?o.removeAttribute(e):o.getAttribute(e)!==t&&o.setAttribute(e,t)}function Ea(o,e){for(let t in e)b(o,t,e[t])}function bx(o){return Array.from(o.childNodes)}function se(o,e){e=""+e,o.data!==e&&(o.data=e)}function Zt(o,e){o.value=e==null?"":e}function ue(o,e,t,r){t==null?o.style.removeProperty(e):o.style.setProperty(e,t,r?"important":"")}function ze(o,e,t){o.classList.toggle(e,!!t)}function yl(o,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(o,{detail:e,bubbles:t,cancelable:r})}var As=class{constructor(e=!1){pt(this,"is_svg",!1);pt(this,"e");pt(this,"n");pt(this,"t");pt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,r=null){this.e||(this.is_svg?this.e=Wr(t.nodeName):this.e=D(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)T(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(C)}};function wx(o){let e={};return o.childNodes.forEach(t=>{e[t.slot||"default"]=!0}),e}function Es(o,e){return new o(e)}var nn;function hr(o){nn=o}function Ma(){if(!nn)throw new Error("Function called outside component initialization");return nn}function er(o){Ma().$$.on_mount.push(o)}function hu(o){Ma().$$.on_destroy.push(o)}function $t(){let o=Ma();return(e,t,{cancelable:r=!1}={})=>{let n=o.$$.callbacks[e];if(n){let s=yl(e,t,{cancelable:r});return n.slice().forEach(a=>{a.call(o,s)}),!s.defaultPrevented}return!0}}function zr(o,e){let t=o.$$.callbacks[e.type];t&&t.slice().forEach(r=>r.call(this,e))}var Mn=[];var Ar=[],Rs=[],_x=[],RI=Promise.resolve(),xu=!1;function vx(){xu||(xu=!0,RI.then(Fa))}function Ra(o){Rs.push(o)}var gu=new Set,Ms=0;function Fa(){if(Ms!==0)return;let o=nn;do{try{for(;Ms<Mn.length;){let e=Mn[Ms];Ms++,hr(e),FI(e.$$)}}catch(e){throw Mn.length=0,Ms=0,e}for(hr(null),Mn.length=0,Ms=0;Ar.length;)Ar.pop()();for(let e=0;e<Rs.length;e+=1){let t=Rs[e];gu.has(t)||(gu.add(t),t())}Rs.length=0}while(Mn.length);for(;_x.length;)_x.pop()();xu=!1,gu.clear(),hr(o)}function FI(o){if(o.fragment!==null){o.update(),ke(o.before_update);let e=o.dirty;o.dirty=[-1],o.fragment&&o.fragment.p(o.ctx,e),o.after_update.forEach(Ra)}}function Sx(o){let e=[],t=[];Rs.forEach(r=>o.indexOf(r)===-1?e.push(r):t.push(r)),t.forEach(r=>r()),Rs=e}var bl=new Set,Rn;function be(){Rn={r:0,c:[],p:Rn}}function we(){Rn.r||ke(Rn.c),Rn=Rn.p}function I(o,e){o&&o.i&&(bl.delete(o),o.i(e))}function P(o,e,t,r){if(o&&o.o){if(bl.has(o))return;bl.add(o),Rn.c.push(()=>{bl.delete(o),r&&(t&&o.d(1),r())}),o.o(e)}else r&&r()}function Fs(o,e){let t=e.token={};function r(n,s,a,i){if(e.token!==t)return;e.resolved=i;let l=e.ctx;a!==void 0&&(l=l.slice(),l[a]=i);let c=n&&(e.current=n)(l),u=!1;e.block&&(e.blocks?e.blocks.forEach((d,m)=>{m!==s&&d&&(be(),P(d,1,1,()=>{e.blocks[m]===d&&(e.blocks[m]=null)}),we())}):e.block.d(1),c.c(),I(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[s]=c),u&&Fa()}if(fx(o)){let n=Ma();if(o.then(s=>{hr(n),r(e.then,1,e.value,s),hr(null)},s=>{if(hr(n),r(e.catch,2,e.error,s),hr(null),!e.hasCatch)throw s}),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,o),!0;e.resolved=o}}function wl(o,e,t){let r=e.slice(),{resolved:n}=o;o.current===o.then&&(r[o.value]=n),o.current===o.catch&&(r[o.error]=n),o.block.p(r,t)}function Re(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function kx(o,e){P(o,1,1,()=>{e.delete(o.key)})}function Lx(o,e,t,r,n,s,a,i,l,c,u,d){let m=o.length,x=s.length,h=m,v={};for(;h--;)v[o[h].key]=h;let w=[],_=new Map,A=new Map,U=[];for(h=x;h--;){let M=d(n,s,h),E=t(M),F=a.get(E);F?r&&U.push(()=>F.p(M,e)):(F=c(E,M),F.c()),_.set(E,w[h]=F),E in v&&A.set(E,Math.abs(h-v[E]))}let L=new Set,R=new Set;function O(M){I(M,1),M.m(i,u),a.set(M.key,M),u=M.first,x--}for(;m&&x;){let M=w[x-1],E=o[m-1],F=M.key,q=E.key;M===E?(u=M.first,m--,x--):_.has(q)?!a.has(F)||L.has(F)?O(M):R.has(q)?m--:A.get(F)>A.get(q)?(R.add(F),O(M)):(L.add(q),m--):(l(E,a),m--)}for(;m--;){let M=o[m];_.has(M.key)||l(M,a)}for(;x;)O(w[x-1]);return ke(U),w}function Oe(o,e){let t={},r={},n={$$scope:1},s=o.length;for(;s--;){let a=o[s],i=e[s];if(i){for(let l in a)l in i||(r[l]=1);for(let l in i)n[l]||(t[l]=i[l],n[l]=1);o[s]=i}else for(let l in a)n[l]=1}for(let a in r)a in t||(t[a]=void 0);return t}function Ve(o){return typeof o=="object"&&o!==null?o:{}}var OI=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],UI=new Set([...OI]);function V(o){o&&o.c()}function N(o,e,t){let{fragment:r,after_update:n}=o.$$;r&&r.m(e,t),Ra(()=>{let s=o.$$.on_mount.map(du).filter(ut);o.$$.on_destroy?o.$$.on_destroy.push(...s):ke(s),o.$$.on_mount=[]}),n.forEach(Ra)}function H(o,e){let t=o.$$;t.fragment!==null&&(Sx(t.after_update),ke(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function BI(o,e){o.$$.dirty[0]===-1&&(Mn.push(o),vx(),o.$$.dirty.fill(0)),o.$$.dirty[e/31|0]|=1<<e%31}function ee(o,e,t,r,n,s,a=null,i=[-1]){let l=nn;hr(o);let c=o.$$={fragment:null,ctx:[],props:s,update:X,not_equal:n,bound:xl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:xl(),dirty:i,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let u=!1;if(c.ctx=t?t(o,e.props||{},(d,m,...x)=>{let h=x.length?x[0]:m;return c.ctx&&n(c.ctx[d],c.ctx[d]=h)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](h),u&&BI(o,d)),m}):[],c.update(),u=!0,ke(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){hx();let d=bx(e.target);c.fragment&&c.fragment.l(d),d.forEach(C)}else c.fragment&&c.fragment.c();e.intro&&I(o.$$.fragment),N(o,e.target,e.anchor),gx(),Fa()}hr(l)}var NI;typeof HTMLElement=="function"&&(NI=class extends HTMLElement{constructor(e,t,r){super();pt(this,"$$ctor");pt(this,"$$s");pt(this,"$$c");pt(this,"$$cn",!1);pt(this,"$$d",{});pt(this,"$$r",!1);pt(this,"$$p_d",{});pt(this,"$$l",{});pt(this,"$$l_u",new Map);this.$$ctor=e,this.$$s=t,r&&this.attachShadow({mode:"open"})}addEventListener(e,t,r){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){let n=this.$$c.$on(e,t);this.$$l_u.set(t,n)}super.addEventListener(e,t,r)}removeEventListener(e,t,r){if(super.removeEventListener(e,t,r),this.$$c){let n=this.$$l_u.get(t);n&&(n(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(s){return()=>{let a;return{c:function(){a=D("slot"),s!=="default"&&b(a,"name",s)},m:function(c,u){T(c,a,u)},d:function(c){c&&C(a)}}}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;let t={},r=wx(this);for(let s of this.$$s)s in r&&(t[s]=[e(s)]);for(let s of this.attributes){let a=this.$$g_p(s.name);a in this.$$d||(this.$$d[a]=yu(a,s.value,this.$$p_d,"toProp"))}for(let s in this.$$p_d)!(s in this.$$d)&&this[s]!==void 0&&(this.$$d[s]=this[s],delete this[s]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:t,$$scope:{ctx:[]}}});let n=()=>{this.$$r=!0;for(let s in this.$$p_d)if(this.$$d[s]=this.$$c.$$.ctx[this.$$c.$$.props[s]],this.$$p_d[s].reflect){let a=yu(s,this.$$d[s],this.$$p_d,"toAttribute");a==null?this.removeAttribute(this.$$p_d[s].attribute||s):this.setAttribute(this.$$p_d[s].attribute||s,a)}this.$$r=!1};this.$$c.$$.after_update.push(n),n();for(let s in this.$$l)for(let a of this.$$l[s]){let i=this.$$c.$on(s,a);this.$$l_u.set(a,i)}this.$$l={}}}attributeChangedCallback(e,t,r){var n;this.$$r||(e=this.$$g_p(e),this.$$d[e]=yu(e,r,this.$$p_d,"toProp"),(n=this.$$c)==null||n.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(e){return Object.keys(this.$$p_d).find(t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e)||e}});function yu(o,e,t,r){var s;let n=(s=t[o])==null?void 0:s.type;if(e=n==="Boolean"&&typeof e!="boolean"?e!=null:e,!r||!t[o])return e;if(r==="toAttribute")switch(n){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e==null?null:e;default:return e}else switch(n){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}var Z=class{constructor(){pt(this,"$$");pt(this,"$$set")}$destroy(){H(this,1),this.$destroy=X}$on(e,t){if(!ut(t))return X;let r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}$set(e){this.$$set&&!cx(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var Ix="4";typeof window!="undefined"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ix);var HI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},bu=HI;function Cx(o,e,t){let r=o.slice();return r[11]=e[t][0],r[12]=e[t][1],r}function wu(o){let e,t=[o[12]],r={};for(let n=0;n<t.length;n+=1)r=le(r,t[n]);return{c(){e=Wr(o[11]),Ea(e,r)},m(n,s){T(n,e,s)},p(n,s){Ea(e,r=Oe(t,[s&32&&n[12]]))},d(n){n&&C(e)}}}function Tx(o){let e=o[11],t,r=o[11]&&wu(o);return{c(){r&&r.c(),t=Ce()},m(n,s){r&&r.m(n,s),T(n,t,s)},p(n,s){n[11]?e?Q(e,n[11])?(r.d(1),r=wu(n),e=n[11],r.c(),r.m(t.parentNode,t)):r.p(n,s):(r=wu(n),e=n[11],r.c(),r.m(t.parentNode,t)):e&&(r.d(1),r=null,e=n[11])},d(n){n&&C(t),r&&r.d(n)}}}function VI(o){let e,t,r,n,s,a=Re(o[5]),i=[];for(let m=0;m<a.length;m+=1)i[m]=Tx(Cx(o,a,m));let l=o[10].default,c=he(l,o,o[9],null),u=[bu,o[7],{width:o[2]},{height:o[2]},{stroke:o[1]},{"stroke-width":r=o[4]?Number(o[3])*24/Number(o[2]):o[3]},{class:n=o[6]("lucide-icon","lucide",o[0]?`lucide-${o[0]}`:"",o[8].class)}],d={};for(let m=0;m<u.length;m+=1)d=le(d,u[m]);return{c(){e=Wr("svg");for(let m=0;m<i.length;m+=1)i[m].c();t=Ce(),c&&c.c(),Ea(e,d)},m(m,x){T(m,e,x);for(let h=0;h<i.length;h+=1)i[h]&&i[h].m(e,null);k(e,t),c&&c.m(e,null),s=!0},p(m,[x]){if(x&32){a=Re(m[5]);let h;for(h=0;h<a.length;h+=1){let v=Cx(m,a,h);i[h]?i[h].p(v,x):(i[h]=Tx(v),i[h].c(),i[h].m(e,t))}for(;h<i.length;h+=1)i[h].d(1);i.length=a.length}c&&c.p&&(!s||x&512)&&xe(c,l,m,m[9],s?ge(l,m[9],x,null):ye(m[9]),null),Ea(e,d=Oe(u,[bu,x&128&&m[7],(!s||x&4)&&{width:m[2]},(!s||x&4)&&{height:m[2]},(!s||x&2)&&{stroke:m[1]},(!s||x&28&&r!==(r=m[4]?Number(m[3])*24/Number(m[2]):m[3]))&&{"stroke-width":r},(!s||x&257&&n!==(n=m[6]("lucide-icon","lucide",m[0]?`lucide-${m[0]}`:"",m[8].class)))&&{class:n}]))},i(m){s||(I(c,m),s=!0)},o(m){P(c,m),s=!1},d(m){m&&C(e),it(i,m),c&&c.d(m)}}}function qI(o,e,t){let r=["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode","mergeClasses"],n=mu(e,r),{$$slots:s={},$$scope:a}=e,{name:i=void 0}=e,{color:l="currentColor"}=e,{size:c=24}=e,{strokeWidth:u=2}=e,{absoluteStrokeWidth:d=!1}=e,{iconNode:m}=e,x=(...h)=>h.filter((v,w,_)=>Boolean(v)&&_.indexOf(v)===w).join(" ");return o.$$set=h=>{t(8,e=le(le({},e),ve(h))),t(7,n=mu(e,r)),"name"in h&&t(0,i=h.name),"color"in h&&t(1,l=h.color),"size"in h&&t(2,c=h.size),"strokeWidth"in h&&t(3,u=h.strokeWidth),"absoluteStrokeWidth"in h&&t(4,d=h.absoluteStrokeWidth),"iconNode"in h&&t(5,m=h.iconNode),"$$scope"in h&&t(9,a=h.$$scope)},e=ve(e),[i,l,c,u,d,m,x,n,e,a,s]}var _u=class extends Z{constructor(e){super(),ee(this,e,qI,VI,Q,{name:0,color:1,size:2,strokeWidth:3,absoluteStrokeWidth:4,iconNode:5,mergeClasses:6})}get mergeClasses(){return this.$$.ctx[6]}},qe=_u;function WI(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function zI(o){let e,t,r=[{name:"arrow-right-left"},o[1],{iconNode:o[0]}],n={$$slots:{default:[WI]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function KI(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"m16 3 4 4-4 4"}],["path",{d:"M20 7H4"}],["path",{d:"m8 21-4-4 4-4"}],["path",{d:"M4 17h16"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var vu=class extends Z{constructor(e){super(),ee(this,e,KI,zI,Q,{})}},Su=vu;function GI(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function jI(o){let e,t,r=[{name:"arrow-up-down"},o[1],{iconNode:o[0]}],n={$$slots:{default:[GI]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function YI(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"m21 16-4 4-4-4"}],["path",{d:"M17 20V4"}],["path",{d:"m3 8 4-4 4 4"}],["path",{d:"M7 4v16"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var ku=class extends Z{constructor(e){super(),ee(this,e,YI,jI,Q,{})}},Lu=ku;function JI(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function XI(o){let e,t,r=[{name:"chevron-left"},o[1],{iconNode:o[0]}],n={$$slots:{default:[JI]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function QI(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"m15 18-6-6 6-6"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Iu=class extends Z{constructor(e){super(),ee(this,e,QI,XI,Q,{})}},Cu=Iu;function ZI(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function eC(o){let e,t,r=[{name:"chevron-right"},o[1],{iconNode:o[0]}],n={$$slots:{default:[ZI]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function tC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"m9 18 6-6-6-6"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Tu=class extends Z{constructor(e){super(),ee(this,e,tC,eC,Q,{})}},Du=Tu;function rC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function oC(o){let e,t,r=[{name:"circle-check-big"},o[1],{iconNode:o[0]}],n={$$slots:{default:[rC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function nC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}],["path",{d:"m9 11 3 3L22 4"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Pu=class extends Z{constructor(e){super(),ee(this,e,nC,oC,Q,{})}},Au=Pu;function sC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function aC(o){let e,t,r=[{name:"circle-help"},o[1],{iconNode:o[0]}],n={$$slots:{default:[sC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function iC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}],["path",{d:"M12 17h.01"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Eu=class extends Z{constructor(e){super(),ee(this,e,iC,aC,Q,{})}},Oa=Eu;function lC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function fC(o){let e,t,r=[{name:"clock"},o[1],{iconNode:o[0]}],n={$$slots:{default:[lC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function cC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 16 14"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Mu=class extends Z{constructor(e){super(),ee(this,e,cC,fC,Q,{})}},Ua=Mu;function uC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function dC(o){let e,t,r=[{name:"download"},o[1],{iconNode:o[0]}],n={$$slots:{default:[uC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function pC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["polyline",{points:"7 10 12 15 17 10"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Ru=class extends Z{constructor(e){super(),ee(this,e,pC,dC,Q,{})}},Fu=Ru;function mC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function hC(o){let e,t,r=[{name:"folder"},o[1],{iconNode:o[0]}],n={$$slots:{default:[mC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function gC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Ou=class extends Z{constructor(e){super(),ee(this,e,gC,hC,Q,{})}},Uu=Ou;function xC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function yC(o){let e,t,r=[{name:"info"},o[1],{iconNode:o[0]}],n={$$slots:{default:[xC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function bC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var $u=class extends Z{constructor(e){super(),ee(this,e,bC,yC,Q,{})}},Bu=$u;function wC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function _C(o){let e,t,r=[{name:"layers"},o[1],{iconNode:o[0]}],n={$$slots:{default:[wC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function vC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Nu=class extends Z{constructor(e){super(),ee(this,e,vC,_C,Q,{})}},Mo=Nu;function SC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function kC(o){let e,t,r=[{name:"message-square-heart"},o[1],{iconNode:o[0]}],n={$$slots:{default:[SC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function LC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}],["path",{d:"M14.8 7.5a1.84 1.84 0 0 0-2.6 0l-.2.3-.3-.3a1.84 1.84 0 1 0-2.4 2.8L12 13l2.7-2.7c.9-.9.8-2.1.1-2.8"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Hu=class extends Z{constructor(e){super(),ee(this,e,LC,kC,Q,{})}},Vu=Hu;function IC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function CC(o){let e,t,r=[{name:"pause"},o[1],{iconNode:o[0]}],n={$$slots:{default:[IC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function TC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var qu=class extends Z{constructor(e){super(),ee(this,e,TC,CC,Q,{})}},Wu=qu;function DC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function PC(o){let e,t,r=[{name:"play"},o[1],{iconNode:o[0]}],n={$$slots:{default:[DC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function AC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["polygon",{points:"6 3 20 12 6 21 6 3"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var zu=class extends Z{constructor(e){super(),ee(this,e,AC,PC,Q,{})}},Ku=zu;function EC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function MC(o){let e,t,r=[{name:"refresh-cw"},o[1],{iconNode:o[0]}],n={$$slots:{default:[EC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function RC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Gu=class extends Z{constructor(e){super(),ee(this,e,RC,MC,Q,{})}},ju=Gu;function FC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function OC(o){let e,t,r=[{name:"satellite"},o[1],{iconNode:o[0]}],n={$$slots:{default:[FC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function UC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M13 7 9 3 5 7l4 4"}],["path",{d:"m17 11 4 4-4 4-4-4"}],["path",{d:"m8 12 4 4 6-6-4-4Z"}],["path",{d:"m16 8 3-3"}],["path",{d:"M9 21a6 6 0 0 0-6-6"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Yu=class extends Z{constructor(e){super(),ee(this,e,UC,OC,Q,{})}},Fn=Yu;function $C(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function BC(o){let e,t,r=[{name:"settings"},o[1],{iconNode:o[0]}],n={$$slots:{default:[$C]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function NC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Ju=class extends Z{constructor(e){super(),ee(this,e,NC,BC,Q,{})}},Xu=Ju;function HC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function VC(o){let e,t,r=[{name:"triangle-alert"},o[1],{iconNode:o[0]}],n={$$slots:{default:[HC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function qC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Qu=class extends Z{constructor(e){super(),ee(this,e,qC,VC,Q,{})}},$a=Qu;function WC(o){let e,t=o[2].default,r=he(t,o,o[3],null);return{c(){r&&r.c()},m(n,s){r&&r.m(n,s),e=!0},p(n,s){r&&r.p&&(!e||s&8)&&xe(r,t,n,n[3],e?ge(t,n[3],s,null):ye(n[3]),null)},i(n){e||(I(r,n),e=!0)},o(n){P(r,n),e=!1},d(n){r&&r.d(n)}}}function zC(o){let e,t,r=[{name:"upload"},o[1],{iconNode:o[0]}],n={$$slots:{default:[WC]},$$scope:{ctx:o}};for(let s=0;s<r.length;s+=1)n=le(n,r[s]);return e=new qe({props:n}),{c(){V(e.$$.fragment)},m(s,a){N(e,s,a),t=!0},p(s,[a]){let i=a&3?Oe(r,[r[0],a&2&&Ve(s[1]),a&1&&{iconNode:s[0]}]):{};a&8&&(i.$$scope={dirty:a,ctx:s}),e.$set(i)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function KC(o,e,t){let{$$slots:r={},$$scope:n}=e,s=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["polyline",{points:"17 8 12 3 7 8"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15"}]];return o.$$set=a=>{t(1,e=le(le({},e),ve(a))),"$$scope"in a&&t(3,n=a.$$scope)},e=ve(e),[s,e,r,n]}var Zu=class extends Z{constructor(e){super(),ee(this,e,KC,zC,Q,{})}},ed=Zu;function GC(o){De(o,"svelte-1gxdage","button.notebook.svelte-1gxdage{color:var(--color-base-30);background-color:transparent}button.notebook-synced.svelte-1gxdage{color:var(--color-accent)}button.system3-connected.svelte-1gxdage{color:var(--color-accent)}button.system3-disconnected.svelte-1gxdage{color:var(--color-base-40)}")}function jC(o){let e,t,r,n,s,a;return t=new Mo({props:{class:"svg-icon inline-icon"}}),{c(){var i;e=D("button"),V(t.$$.fragment),b(e,"class",r="clickable-icon view-action system3-view-action "+(o[0].tracking?"notebook-synced":"notebook")+" svelte-1gxdage"),b(e,"aria-label",n=o[0].tracking?"Tracking changes: local file and update log are in sync":"Not tracking changes: local file and update log are not in sync"),b(e,"tabindex","0"),b(e,"data-filename",s=(i=o[0].view.file)==null?void 0:i.name)},m(i,l){T(i,e,l),N(t,e,null),a=!0},p(i,l){var c;(!a||l&1&&r!==(r="clickable-icon view-action system3-view-action "+(i[0].tracking?"notebook-synced":"notebook")+" svelte-1gxdage"))&&b(e,"class",r),(!a||l&1&&n!==(n=i[0].tracking?"Tracking changes: local file and update log are in sync":"Not tracking changes: local file and update log are not in sync"))&&b(e,"aria-label",n),(!a||l&1&&s!==(s=(c=i[0].view.file)==null?void 0:c.name))&&b(e,"data-filename",s)},i(i){a||(I(t.$$.fragment,i),a=!0)},o(i){P(t.$$.fragment,i),a=!1},d(i){i&&C(e),H(t)}}}function YC(o){let e,t,r,n,s,a,i,l,c,u,d,m,x;return t=new Mo({props:{class:"svg-icon inline-icon"}}),l=new Fn({props:{class:"svg-icon inline-icon"}}),{c(){var h;e=D("button"),V(t.$$.fragment),a=B(),i=D("button"),V(l.$$.fragment),b(e,"class",r="clickable-icon view-action system3-view-action "+(o[0].tracking?"notebook-synced":"notebook")+" svelte-1gxdage"),b(e,"aria-label",n=o[0].tracking?"Tracking changes: local file and update log are in sync":"Not tracking changes: local file and update log are not in sync"),b(e,"tabindex","0"),b(e,"data-filename",s=(h=o[0].view.file)==null?void 0:h.name),b(i,"class",c="system3-"+o[1].status+" clickable-icon view-action system3-view-action svelte-1gxdage"),b(i,"aria-label",u=`${o[2].relay.name} (${o[1].status})`),b(i,"tabindex","0")},m(h,v){T(h,e,v),N(t,e,null),T(h,a,v),T(h,i,v),N(l,i,null),d=!0,m||(x=[re(i,"click",o[3]),re(i,"keypress",o[4])],m=!0)},p(h,v){var w;(!d||v&1&&r!==(r="clickable-icon view-action system3-view-action "+(h[0].tracking?"notebook-synced":"notebook")+" svelte-1gxdage"))&&b(e,"class",r),(!d||v&1&&n!==(n=h[0].tracking?"Tracking changes: local file and update log are in sync":"Not tracking changes: local file and update log are not in sync"))&&b(e,"aria-label",n),(!d||v&1&&s!==(s=(w=h[0].view.file)==null?void 0:w.name))&&b(e,"data-filename",s),(!d||v&2&&c!==(c="system3-"+h[1].status+" clickable-icon view-action system3-view-action svelte-1gxdage"))&&b(i,"class",c),(!d||v&6&&u!==(u=`${h[2].relay.name} (${h[1].status})`))&&b(i,"aria-label",u)},i(h){d||(I(t.$$.fragment,h),I(l.$$.fragment,h),d=!0)},o(h){P(t.$$.fragment,h),P(l.$$.fragment,h),d=!1},d(h){h&&(C(e),C(a),C(i)),H(t),H(l),m=!1,ke(x)}}}function JC(o){let e,t,r,n,s=[YC,jC],a=[];function i(l,c){return l[2]?0:1}return e=i(o,-1),t=a[e]=s[e](o),{c(){t.c(),r=Ce()},m(l,c){a[e].m(l,c),T(l,r,c),n=!0},p(l,[c]){let u=e;e=i(l,c),e===u?a[e].p(l,c):(be(),P(a[u],1,1,()=>{a[u]=null}),we(),t=a[e],t?t.p(l,c):(t=a[e]=s[e](l),t.c()),I(t,1),t.m(r.parentNode,r))},i(l){n||(I(t),n=!0)},o(l){P(t),n=!1},d(l){l&&C(r),a[e].d(l)}}}function XC(o,e,t){let{view:r}=e,{state:n}=e,{remote:s}=e,a={connected:"connected: click to go offline",connecting:"connecting...",disconnected:"disconnected: click to go online",unknown:"unknown status"},i=()=>{r.toggleConnection()},l=c=>{c.key==="Enter"&&i()};return o.$$set=c=>{"view"in c&&t(0,r=c.view),"state"in c&&t(1,n=c.state),"remote"in c&&t(2,s=c.remote)},[r,n,s,i,l]}var td=class extends Z{constructor(e){super(),ee(this,e,XC,JC,Q,{view:0,state:1,remote:2},GC)}},Dx=td;var Os=class{constructor(e,t,r){this.view=e,this.text=t,this.onClick=r,this.display()}display(){let e=this.view.containerEl,t=this.view.containerEl.querySelector(".view-content");if(!e)return;let r=e.querySelector(".system3-banner-box");r||(r=document.createElement("div"),r.classList.add("system3-banner-box"),e.insertBefore(r,t));let n=e.querySelector(".system3-banner");if(!n){n=document.createElement("div"),n.classList.add("system3-banner");let s=n.createSpan();s.setText(this.text),n.appendChild(s),r.appendChild(n);let a=async()=>{await this.onClick()&&this.destroy()};n.addEventListener("click",a)}return!0}destroy(){let e=this.view.containerEl;if(!e)return;let t=e.querySelector(".system3-banner-box");return t&&t.replaceChildren(),!0}};var _l=require("@codemirror/state"),Px=require("@codemirror/view");function Ba(o,e){let t=Object.keys(e).map(r=>QC(o,r,e[r]));return t.length===1?t[0]:function(){t.forEach(r=>r())}}function QC(o,e,t){let r=o[e],n=o.hasOwnProperty(e),s=n?r:function(){return Object.getPrototypeOf(o)[e].apply(this,arguments)},a=t(s);return r&&Object.setPrototypeOf(a,r),Object.setPrototypeOf(i,a),o[e]=i,l;function i(...c){return a===s&&o[e]===i&&l(),a.apply(this,c)}function l(){o[e]===i&&(n?o[e]=s:delete o[e]),a!==s&&(a=s,Object.setPrototypeOf(i,r||Function))}}var Ax=jn(rd());var ZC=25,b4=_l.Facet.define({combine(o){return o[o.length-1]}}),od=_l.Annotation.define(),nd=class{constructor(e){this.initialSet=!1;this.destroyed=!1;this.keyFrameCounter=0;this.debug=(...e)=>{};this.log=(...e)=>{};this.warn=(...e)=>{};var r,n,s,a;if(this.editor=e,this.connectionManager=this.editor.state.field(sn),this.view=(r=this.connectionManager)==null?void 0:r.findView(e),!this.view||(this.log=Le(`[LiveCMPluginValue][${(n=this.view.view.file)==null?void 0:n.path}]`,"log"),this.warn=Le(`[LiveCMPluginValue][${(s=this.view.view.file)==null?void 0:s.path}]`,"warn"),this.debug=Le(`[LiveCMPluginValue][${(a=this.view.view.file)==null?void 0:a.path}]`,"debug"),this.debug("created"),!this.view.document))return;let t=this;this.uninstallMonkeyPatch=Ba(this.view.view,{setViewData(i){return function(l,c){return c&&(Ro(t.view)&&t.view.document.text===l&&(t.view.tracking=!0),t.resync()),i.call(this,l,c)}}}),this.view.document.connected?this.resync():this.view.document.onceConnected().then(()=>{this.resync()}),this._observer=async(i,l)=>{if(!Ro(this.view)){this.debug("Recived yjs event against a non-live view");return}if(this.destroyed){this.debug("Recived yjs event but editor was destroyed");return}if(l.origin!==this){let c=i.delta,u=[],d=0;for(let m=0;m<c.length;m++){let x=c[m];x.insert!=null?u.push({from:d,to:d,insert:x.insert}):x.delete!=null?(u.push({from:d,to:d+x.delete,insert:""}),d+=x.delete):x.retain!=null&&(d+=x.retain)}!this.view.tracking||Xt().enableEditorTweens&&this.keyFrameCounter>ZC?(this.keyFrameCounter=0,u=await this.getKeyFrame(!0),this.debug("dispatch (full)")):(this.keyFrameCounter+=1,this.debug(`dispatch (incremental + ${this.keyFrameCounter})`)),Ro(this.view)&&(e.dispatch({changes:u,annotations:[od.of(this.editor)]}),this.view.tracking=!0)}},this.observer=(i,l)=>{var c;try{(c=this._observer)==null||c.call(this,i,l)}catch(u){u instanceof RangeError&&Ro(this.view)&&(this.view.tracking=!1)}},this._ytext=this.view.document.ytext,this._ytext.observe(this.observer)}incrementalBufferChange(e){let t=this.editor.state.doc.toString(),r=new Ax.default,n=r.diff_main(t,e);r.diff_cleanupSemantic(n);let s=[],a=0;for(let[i,l]of n)switch(i){case 0:a+=l.length;break;case 1:s.push({from:a,to:a,insert:l}),a+=l.length;break;case-1:s.push({from:a,to:a+l.length,insert:""});break}return s}getBufferChange(e,t=!1){return t?this.incrementalBufferChange(e):[{from:0,to:this.editor.state.doc.length,insert:e}]}async resync(){if(Ro(this.view)&&!this.view.tracking&&!this.destroyed){await this.view.document.whenSynced();let e=await this.getKeyFrame();Ro(this.view)&&!this.view.tracking&&!this.destroyed&&this.editor.dispatch({changes:e,annotations:[od.of(this.editor)]})}}async getKeyFrame(e=!1){return!Ro(this.view)||this.destroyed?[]:this.view.document.text===this.view.view.getViewData()?(this.view.tracking=!0,[]):(this.warn(`|${this.view.document.text}|
|${this.view.view.getViewData()}|`),this.warn("ytext and editor buffer need syncing"),!this.view.document.hasLocalDB()&&this.view.document.text===""?(this.warn("local db missing, not setting buffer"),[]):(this.view.tracking||this.view.checkStale(),Ro(this.view)&&!this.destroyed?[this.getBufferChange(this.view.document.text,e)]:[]))}update(e){var n,s,a,i;if(!e.docChanged||e.transactions.length>0&&e.transactions[0].annotation(od)===this.editor)return;let t=e.view;this.view=(n=this.connectionManager)==null?void 0:n.findView(t);let r=(a=(s=this.view)==null?void 0:s.document)==null?void 0:a.ytext;r&&((i=r.doc)==null||i.transact(()=>{let l=0;e.changes.iterChanges((c,u,d,m,x)=>{let h=x.sliceString(0,x.length,`
`);c!==u&&r.delete(c+l,u-c),h.length>0&&r.insert(c+l,h),l+=h.length-(u-c)})},this))}destroy(){var e;this.destroyed=!0,this.observer&&((e=this._ytext)==null||e.unobserve(this.observer)),this.uninstallMonkeyPatch&&(this.uninstallMonkeyPatch(),this.uninstallMonkeyPatch=void 0),this.connectionManager=null,this.view=void 0,this._ytext=void 0,this.editor=null}},Ex=Px.ViewPlugin.fromClass(nd);var vl=require("@codemirror/state"),lr=require("@codemirror/view");var Mx=lr.EditorView.baseTheme({".cm-ySelection":{},".cm-yLineSelection":{padding:0,margin:"0px 2px 0px 4px"},".cm-ySelectionCaret":{position:"relative",borderLeft:"1px solid black",borderRight:"1px solid black",marginLeft:"-1px",marginRight:"-1px",boxSizing:"border-box",display:"inline"},".cm-ySelectionCaretDot":{borderRadius:"50%",position:"absolute",width:".4em",height:".4em",top:"-.2em",left:"-.2em",backgroundColor:"inherit",transition:"transform .3s ease-in-out",boxSizing:"border-box"},".cm-ySelectionCaret:hover > .cm-ySelectionCaretDot":{transformOrigin:"bottom center",transform:"scale(0)"},".cm-ySelectionInfo":{position:"absolute",top:"-1.05em",left:"-1px",fontSize:".75em",fontFamily:"serif",fontStyle:"normal",fontWeight:"normal",lineHeight:"normal",userSelect:"none",color:"white",paddingLeft:"2px",paddingRight:"2px",zIndex:101,transition:"opacity .3s ease-in-out",backgroundColor:"inherit",opacity:0,transitionDelay:"0s",whiteSpace:"nowrap"},".cm-ySelectionCaret:hover > .cm-ySelectionInfo":{opacity:1,transitionDelay:"0s"}}),e2=vl.Annotation.define(),sd=class extends lr.WidgetType{constructor(t,r){super();this.color=t,this.name=r}toDOM(t){return ha("span",[Kt("class","cm-ySelectionCaret"),Kt("style",`background-color: ${this.color}; border-color: ${this.color}`)],[fs("\u2060"),ha("div",[Kt("class","cm-ySelectionCaretDot")]),fs("\u2060"),ha("div",[Kt("class","cm-ySelectionInfo")],[fs(this.name)]),fs("\u2060")])}eq(t){return t.color===this.color}compare(t){return t.color===this.color}updateDOM(){return!1}get estimatedHeight(){return-1}ignoreEvent(){return!0}},ad=class{constructor(e){var r,n;this.editor=e,this.decorations=vl.RangeSet.of([]),this.connectionManager=this.editor.state.field(sn);let t=(r=this.connectionManager)==null?void 0:r.findView(e);if(t&&t instanceof an){this.view=t;let s=(n=this.view.document)==null?void 0:n._provider;this._listener=({added:a,updated:i,removed:l},c,u)=>{a.concat(i).concat(l).findIndex(m=>{var x;return m!==((x=this._awareness)==null?void 0:x.doc.clientID)})>=0&&e.dispatch({annotations:[e2.of([])]})},s&&(this._awareness=s.awareness,this._awareness.on("change",this._listener))}}destroy(){var e;this._listener&&((e=this._awareness)==null||e.off("change",this._listener),this._listener=void 0),this.connectionManager=null,this.view=null,this.editor=null}update(e){var c,u,d,m;let t=e.view;this.view=(c=this.connectionManager)==null?void 0:c.findView(t);let r=(d=(u=this.view)==null?void 0:u.document)==null?void 0:d.ytext;if(!(this.view&&r&&r.doc))return;let n=(m=this.view.document)==null?void 0:m._provider;if(!n)return;this._awareness=n.awareness;let s=this._awareness,a=r.doc,i=[],l=this._awareness.getLocalState();if(l!=null){let x=e.view.hasFocus&&e.view.dom.ownerDocument.hasFocus(),h=x?e.state.selection.main:null,v=l.cursor==null?null:Oc(l.cursor.anchor),w=l.cursor==null?null:Oc(l.cursor.head);if(h!=null){let _=Uc(r,h.anchor),A=Uc(r,h.head);(l.cursor==null||!Bc(v,_)||!Bc(w,A))&&s.setLocalStateField("cursor",{anchor:_,head:A})}else l.cursor!=null&&x&&s.setLocalStateField("cursor",null)}s.getStates().forEach((x,h)=>{if(h===s.doc.clientID)return;let v=x.cursor;if(v==null||v.anchor==null||v.head==null)return;let w=$c(v.anchor,a),_=$c(v.head,a);if(w==null||_==null||w.type!==r||_.type!==r)return;if(w.index>e.state.doc.length||_.index>e.state.doc.length){Le("[RemoteSelections]","warn")(`cursor positions (${w.index}, ${_.index}) out of range of document length: ${e.state.doc.length}`),this.decorations=lr.Decoration.none;return}let{color:A="#30bced",name:U="Anonymous"}=x.user||{},L=x.user&&x.user.colorLight||A+"33",R=Qn(w.index,_.index),O=Or(w.index,_.index),M=e.view.state.doc.lineAt(R),E=e.view.state.doc.lineAt(O);if(M.number===E.number)i.push({from:R,to:O,value:lr.Decoration.mark({attributes:{style:`background-color: ${L}`},class:"cm-ySelection"})});else{i.push({from:R,to:M.from+M.length,value:lr.Decoration.mark({attributes:{style:`background-color: ${L}`},class:"cm-ySelection"})}),i.push({from:E.from,to:O,value:lr.Decoration.mark({attributes:{style:`background-color: ${L}`},class:"cm-ySelection"})});for(let F=M.number+1;F<E.number;F++){let q=e.view.state.doc.line(F).from;i.push({from:q,to:q,value:lr.Decoration.line({attributes:{style:`background-color: ${L}`,class:"cm-yLineSelection"}})})}}i.push({from:_.index,to:_.index,value:lr.Decoration.widget({side:_.index-w.index>0?-1:1,block:!1,widget:new sd(A,U)})})}),this.decorations=lr.Decoration.set(i,!0)}},Rx=lr.ViewPlugin.fromClass(ad,{decorations:o=>o.decorations});var Sl=require("@codemirror/state"),Fo=require("@codemirror/view"),Fx=require("@codemirror/view");var E4=Sl.Annotation.define(),ld=class extends Fx.WidgetType{toDOM(){let e=document.createElement("span");return e.style.display="inline-flex",e.addClass("invalid-link"),e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-warning"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>',e.title="This link points outside the shared folder and may not be accessible to other users.",e}},id=Sl.StateEffect.define(),fd=class{constructor(e){this.log=e=>{};var t;if(this.editor=e,this.connectionManager=this.editor.state.field(sn),this.decorations=Fo.Decoration.none,this.decorationAnchors=[],this.metadata=new Map,this.cb=(r,n)=>{this.updateFromMetadata(n),this.editor.dispatch({effects:id.of(null)})},!this.connectionManager){Le("[InvalidLinkPluginValue]","warn")("ConnectionManager not found in InvalidLinkPlugin");return}this.app=this.connectionManager.app,this.view=this.connectionManager.findView(e),this.view&&(this.log=Le(`[InvalidLinkPluginValue][${(t=this.view.view.file)==null?void 0:t.path}]`,"debug"),this.log("created"),this.view.document&&this.view.document.whenSynced().then(()=>{var r,n;if(this.connectionManager&&this.app&&((n=(r=this.view)==null?void 0:r.document)!=null&&n.tfile)){this.connectionManager.onMeta(this.view.document.tfile,this.cb);let s=this.app.metadataCache.getFileCache(this.view.document.tfile);s&&(this.updateFromMetadata(s),this.editor.dispatch({effects:id.of(null)}))}else this.log("unable to subscribe to metadata updates")}))}findInternalLinks(e){let t=[];return e.state.facet(Fo.EditorView.decorations).forEach(n=>{(typeof n=="function"?n(e):n).between(0,e.state.doc.length,(a,i,l)=>{var d;(((d=l.spec)==null?void 0:d.class)||"").contains("cm-formatting-link-end")&&t.push({from:a,to:i})})}),t}updateFromMetadata(e){var r,n,s,a;if(this.connectionManager&&(this.view=this.connectionManager.findView(this.editor)),!this.view||!this.view.document||!this.app||!((n=(r=this.view)==null?void 0:r.document)!=null&&n.sharedFolder)||!((a=(s=this.view)==null?void 0:s.document)!=null&&a.tfile))return;let t=new Map;for(let i of(e==null?void 0:e.links)||[]){let l=this.app.metadataCache.getFirstLinkpathDest(i.link,this.view.document.path);l&&!this.view.document.sharedFolder.checkPath(l.path)&&t.set(i.position.start.offset,{from:i.position.start.offset,to:i.position.end.offset,link:i.link,original:i.original})}for(let i of(e==null?void 0:e.embeds)||[]){let l=this.app.metadataCache.getFirstLinkpathDest(i.link,this.view.document.path);l&&!this.view.document.sharedFolder.checkPath(l.path)&&t.set(i.position.start.offset,{from:i.position.start.offset,to:i.position.end.offset,link:i.link,original:i.original})}this.metadata=t}updateMetadataPositions(e){for(let[t,r]of this.metadata)try{this.metadata.set(t,{from:e.changes.mapPos(r.from),to:e.changes.mapPos(r.to),link:r.link,original:r.original})}catch(n){this.metadata.delete(t)}}updateFromEditor(e){var s,a,i,l;if(this.connectionManager&&(this.view=this.connectionManager.findView(this.editor)),!this.view||!this.view.document||!this.app||!((a=(s=this.view)==null?void 0:s.document)!=null&&a.sharedFolder)||!((l=(i=this.view)==null?void 0:i.document)!=null&&l.tfile))return;let t=[],r=new Map(this.metadata),n=this.findInternalLinks(this.editor);for(let c of n){let u=null;for(let[x,h]of r)if(c.from<=h.to&&c.to>=h.from){u=h,r.delete(x);break}if(!u)continue;let d=this.app.metadataCache.getFirstLinkpathDest(u.link,this.view.document.path);d&&!this.view.document.sharedFolder.checkPath(d.path)&&t.push(c.from)}t.filter(c=>c<=e.state.doc.length),this.decorationAnchors=t}updateDecorations(){this.decorationAnchors.sort();let e=this.decorationAnchors.map(t=>Fo.Decoration.widget({widget:new ld,side:1}).range(t));e.length>0?this.decorations=Fo.Decoration.set(e,!0):this.decorations=Fo.Decoration.none}update(e){let t=!1;return e.transactions.forEach(r=>{r.effects.some(n=>n.is(id))&&(t=!0)}),(e.docChanged||e.viewportChanged||t)&&(t||this.updateMetadataPositions(e),this.updateFromEditor(e),this.updateDecorations()),this.decorations}destroy(){var e,t;this.connectionManager&&((t=(e=this.view)==null?void 0:e.document)!=null&&t.tfile)&&this.connectionManager.offMeta(this.view.document.tfile),this.connectionManager=null,this.view=void 0,this.metadata.clear(),this.metadata=null,this.editor=null}},Ox=Fo.ViewPlugin.fromClass(fd,{decorations:o=>o.decorations});function Oo(){}Oo.prototype={diff:function(e,t){var r,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=n.callback;typeof n=="function"&&(s=n,n={}),this.options=n;var a=this;function i(L){return s?(setTimeout(function(){s(void 0,L)},0),!0):L}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e)),t=this.removeEmpty(this.tokenize(t));var l=t.length,c=e.length,u=1,d=l+c;n.maxEditLength&&(d=Math.min(d,n.maxEditLength));var m=(r=n.timeout)!==null&&r!==void 0?r:1/0,x=Date.now()+m,h=[{oldPos:-1,lastComponent:void 0}],v=this.extractCommon(h[0],t,e,0);if(h[0].oldPos+1>=c&&v+1>=l)return i([{value:this.join(t),count:t.length}]);var w=-1/0,_=1/0;function A(){for(var L=Math.max(w,-u);L<=Math.min(_,u);L+=2){var R=void 0,O=h[L-1],M=h[L+1];O&&(h[L-1]=void 0);var E=!1;if(M){var F=M.oldPos-L;E=M&&0<=F&&F<l}var q=O&&O.oldPos+1<c;if(!E&&!q){h[L]=void 0;continue}if(!q||E&&O.oldPos+1<M.oldPos?R=a.addToPath(M,!0,void 0,0):R=a.addToPath(O,void 0,!0,1),v=a.extractCommon(R,t,e,L),R.oldPos+1>=c&&v+1>=l)return i(t2(a,R.lastComponent,t,e,a.useLongestToken));h[L]=R,R.oldPos+1>=c&&(_=Math.min(_,L-1)),v+1>=l&&(w=Math.max(w,L+1))}u++}if(s)(function L(){setTimeout(function(){if(u>d||Date.now()>x)return s();A()||L()},0)})();else for(;u<=d&&Date.now()<=x;){var U=A();if(U)return U}},addToPath:function(e,t,r,n){var s=e.lastComponent;return s&&s.added===t&&s.removed===r?{oldPos:e.oldPos+n,lastComponent:{count:s.count+1,added:t,removed:r,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+n,lastComponent:{count:1,added:t,removed:r,previousComponent:s}}},extractCommon:function(e,t,r,n){for(var s=t.length,a=r.length,i=e.oldPos,l=i-n,c=0;l+1<s&&i+1<a&&this.equals(t[l+1],r[i+1]);)l++,i++,c++;return c&&(e.lastComponent={count:c,previousComponent:e.lastComponent}),e.oldPos=i,l},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(e[r]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function t2(o,e,t,r,n){for(var s=[],a;e;)s.push(e),a=e.previousComponent,delete e.previousComponent,e=a;s.reverse();for(var i=0,l=s.length,c=0,u=0;i<l;i++){var d=s[i];if(d.removed){if(d.value=o.join(r.slice(u,u+d.count)),u+=d.count,i&&s[i-1].added){var x=s[i-1];s[i-1]=s[i],s[i]=x}}else{if(!d.added&&n){var m=t.slice(c,c+d.count);m=m.map(function(v,w){var _=r[u+w];return _.length>v.length?_:v}),d.value=o.join(m)}else d.value=o.join(t.slice(c,c+d.count));c+=d.count,d.added||(u+=d.count)}}var h=s[l-1];return l>1&&typeof h.value=="string"&&(h.added||h.removed)&&o.equals("",h.value)&&(s[l-2].value+=h.value,s.pop()),s}var R4=new Oo;function r2(o,e){if(typeof o=="function")e.callback=o;else if(o)for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);return e}var Ux=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,$x=/\S/,md=new Oo;md.equals=function(o,e){return this.options.ignoreCase&&(o=o.toLowerCase(),e=e.toLowerCase()),o===e||this.options.ignoreWhitespace&&!$x.test(o)&&!$x.test(e)};md.tokenize=function(o){for(var e=o.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<e.length-1;t++)!e[t+1]&&e[t+2]&&Ux.test(e[t])&&Ux.test(e[t+2])&&(e[t]+=e[t+2],e.splice(t+1,2),t--);return e};function Bx(o,e,t){return t=r2(t,{ignoreWhitespace:!0}),md.diff(o,e,t)}var hd=new Oo;hd.tokenize=function(o){this.options.stripTrailingCr&&(o=o.replace(/\r\n/g,`
`));var e=[],t=o.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var r=0;r<t.length;r++){var n=t[r];r%2&&!this.options.newlineIsToken?e[e.length-1]+=n:(this.options.ignoreWhitespace&&(n=n.trim()),e.push(n))}return e};function o2(o,e,t){return hd.diff(o,e,t)}var n2=new Oo;n2.tokenize=function(o){return o.split(/(\S.+?[.!?])(?=\s+|$)/)};var s2=new Oo;s2.tokenize=function(o){return o.split(/([{}:;,]|\s+)/)};function kl(o){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?kl=function(e){return typeof e}:kl=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kl(o)}function cd(o){return a2(o)||i2(o)||l2(o)||f2()}function a2(o){if(Array.isArray(o))return ud(o)}function i2(o){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(o))return Array.from(o)}function l2(o,e){if(o){if(typeof o=="string")return ud(o,e);var t=Object.prototype.toString.call(o).slice(8,-1);if(t==="Object"&&o.constructor&&(t=o.constructor.name),t==="Map"||t==="Set")return Array.from(o);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ud(o,e)}}function ud(o,e){(e==null||e>o.length)&&(e=o.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=o[t];return r}function f2(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c2=Object.prototype.toString,Na=new Oo;Na.useLongestToken=!0;Na.tokenize=hd.tokenize;Na.castInput=function(o){var e=this.options,t=e.undefinedReplacement,r=e.stringifyReplacer,n=r===void 0?function(s,a){return typeof a=="undefined"?t:a}:r;return typeof o=="string"?o:JSON.stringify(dd(o,null,null,n),n,"  ")};Na.equals=function(o,e){return Oo.prototype.equals.call(Na,o.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function dd(o,e,t,r,n){e=e||[],t=t||[],r&&(o=r(n,o));var s;for(s=0;s<e.length;s+=1)if(e[s]===o)return t[s];var a;if(c2.call(o)==="[object Array]"){for(e.push(o),a=new Array(o.length),t.push(a),s=0;s<o.length;s+=1)a[s]=dd(o[s],e,t,r,n);return e.pop(),t.pop(),a}if(o&&o.toJSON&&(o=o.toJSON()),kl(o)==="object"&&o!==null){e.push(o),a={},t.push(a);var i=[],l;for(l in o)o.hasOwnProperty(l)&&i.push(l);for(i.sort(),s=0;s<i.length;s+=1)l=i[s],a[l]=dd(o[l],e,t,r,l);e.pop(),t.pop()}else a=o;return a}var pd=new Oo;pd.tokenize=function(o){return o.slice()};pd.join=pd.removeEmpty=function(o){return o};function Nx(o,e,t,r,n,s,a){a||(a={}),typeof a.context=="undefined"&&(a.context=4);var i=o2(t,r,a);if(!i)return;i.push({value:"",lines:[]});function l(_){return _.map(function(A){return" "+A})}for(var c=[],u=0,d=0,m=[],x=1,h=1,v=function(A){var U=i[A],L=U.lines||U.value.replace(/\n$/,"").split(`
`);if(U.lines=L,U.added||U.removed){var R;if(!u){var O=i[A-1];u=x,d=h,O&&(m=a.context>0?l(O.lines.slice(-a.context)):[],u-=m.length,d-=m.length)}(R=m).push.apply(R,cd(L.map(function(W){return(U.added?"+":"-")+W}))),U.added?h+=L.length:x+=L.length}else{if(u)if(L.length<=a.context*2&&A<i.length-2){var M;(M=m).push.apply(M,cd(l(L)))}else{var E,F=Math.min(L.length,a.context);(E=m).push.apply(E,cd(l(L.slice(0,F))));var q={oldStart:u,oldLines:x-u+F,newStart:d,newLines:h-d+F,lines:m};if(A>=i.length-2&&L.length<=a.context){var J=/\n$/.test(t),G=/\n$/.test(r),z=L.length==0&&m.length>q.oldLines;!J&&z&&t.length>0&&m.splice(q.oldLines,0,"\\ No newline at end of file"),(!J&&!z||!G)&&m.push("\\ No newline at end of file")}c.push(q),u=0,d=0,m=[]}x+=L.length,h+=L.length}},w=0;w<i.length;w++)v(w);return{oldFileName:o,newFileName:e,oldHeader:n,newHeader:s,hunks:c}}var qx=require("obsidian");var Ll=class{constructor(e){this.file1Start=e.file1Start,this.file2Start=e.file2Start,this.file1Lines=e.file1Lines,this.file2Lines=e.file2Lines}};var Il=class{constructor(e){this.file1Name=e.file1Name,this.file2Name=e.file2Name,this.differences=e.differences}static fromParsedDiff(e){let t=[];return e.hunks.forEach(r=>{let n=0,s=0;for(let a=0;a<r.lines.length;a+=1){let i=r.lines[a];if(i.startsWith("+")||i.startsWith("-")){let l=a,c=l;for(;c<r.lines.length-1&&(r.lines[c+1].startsWith("+")||r.lines[c+1].startsWith("-"));)c+=1;let u=r.lines.slice(l,c+1).filter(m=>m.startsWith("-")).map(m=>m.slice(1)),d=r.lines.slice(l,c+1).filter(m=>m.startsWith("+")).map(m=>m.slice(1));t.push(new Ll({file1Start:r.oldStart+l-s-1,file2Start:r.newStart+l-n-1,file1Lines:u,file2Lines:d})),n+=u.length,s+=d.length,a+=c-l}}}),new this({file1Name:e.oldFileName,file2Name:e.newFileName,differences:t})}};function gd(o){let e=o.fullText.split(`
`);return e.splice(o.position,0,o.newLine),e.join(`
`)}function Ha(o){let e=o.fullText.split(`
`);return o.newLine===""?e.splice(o.position,o.linesToReplace):e.splice(o.position,o.linesToReplace,o.newLine),e.join(`
`)}function Va(o){let e=o.fullText.split(`
`);return e.splice(o.position,o.count),e.join(`
`)}function $s(o){return o!==""?o:"\u200E"}var fr=class{constructor(e){this.text=e.text,this.onClick=e.onClick}build(e){e.createEl("a",{text:this.text,cls:"no-decoration text-xxs file-diff__action-line"}).onClickEvent(this.onClick)}};var io=class{static build(e){e.createEl("span",{text:"|",cls:"text-xxs file-diff__action-line"})}};var yd=require("obsidian");var Hx=jn(rd());var gr=class extends Pt{constructor(t){super();this.observableName=t;this._map=new Map,this._derivedMaps=new WeakMap}set(t,r){return this._map.set(t,r),this.notifyListeners(),this}delete(t){let r=this._map.delete(t);return r&&this.notifyListeners(),r}clear(){this._map.clear(),this.notifyListeners()}has(t){return this._map.has(t)}get(t){return this._map.get(t)}keys(){return[...this._map.keys()]}values(){return[...this._map.values()]}entries(){return[...this._map.entries()]}get size(){return this._map.size}forEach(t){this._map.forEach(t)}find(t){for(let[r,n]of this._map)if(t(n,r))return n}some(t){for(let[r,n]of this._map)if(t(n,r))return!0;return!1}filter(t){let r=this._derivedMaps.get(t);if(r)return r;let n=new xd(this,t);return this._derivedMaps.set(t,n),n}},xd=class extends gr{constructor(t,r){super();this.parentMap=t;this.predicate=r;this.sub(),this.observableName=t.observableName+"(filter: "+r.toString()+")"}sub(){this.unsub||(this.unsub=this.parentMap.subscribe(()=>{let t=new Map;this.parentMap.forEach((r,n)=>{this.predicate(r,n)&&t.set(n,r)}),this._map=t,this.notifyListeners()}))}subscribe(t){return this.sub(),super.subscribe(t),()=>{this.unsubscribe(t)}}unsubscribe(t){super.unsubscribe(t),this._listeners.size===0&&this.unsub&&(this.unsub(),this.unsub=void 0)}destroy(){this.unsub&&this.unsub()}};function qa(o,e){let t=o.path.split("/"),r=e.path.split("/");if(t.length===2&&r.length>2)return 1;if(r.length===2&&t.length>2)return-1;let n=Math.min(t.length,r.length);for(let s=0;s<n;s++)if(t[s]!==r[s]){if(s===t.length-1){let a=t[s].match(/\d+/g),i=r[s].match(/\d+/g);if(a&&i){let l=parseInt(a[0]),c=parseInt(i[0]);if(l!==c)return l-c}}return t[s].localeCompare(r[s])}return t.length-r.length}function Vx(o,e){let t=o.getText("contents"),r=t.toString(),n=new Hx.diff_match_patch,s=n.diff_main(r,e);n.diff_cleanupSemantic(s);let a=0,i=Le("[updateYDocFromDiskBuffer]","debug");i("Updating YDoc:"),i("Current content length:",r.length),i("Disk buffer length:",e.length),s.length!=0&&(o.transact(()=>{for(let[l,c]of s)switch(l){case 1:i(`Inserting "${c}" at position ${a}`),t.insert(a,c),a+=c.length;break;case 0:i(`Keeping "${c}" (length: ${c.length})`),a+=c.length;break;case-1:i(`Deleting "${c}" at position ${a}`),t.delete(a,c.length);break}}),i("Update complete. New content length:",t.toString().length))}var Cl=class{constructor(e,t,r,n=3){this.loginManager=e;this.timeProvider=t;this.sharedFolders=r;this.concurrency=n;this.activeSync=new on;this.activeDownloads=new on;this.syncGroups=new gr;this.syncQueue=[];this.downloadQueue=[];this.isProcessingSync=!1;this.isProcessingDownloads=!1;this.isPaused=!0;this.inProgressSyncs=new Set;this.inProgressDownloads=new Set;this.syncCompletionCallbacks=new Map;this.downloadCompletionCallbacks=new Map;this.loggedItems=new Map;this.maxLogEntries=100;this.subscriptions=[];this.log=Le("[BackgroundSync]","log");this.debug=Le("[BackgroundSync]","debug");this.error=Le("[BackgroundSync]","error");this.start=this.resume;Dt.set(this,"BackgroundSync"),this.timeProvider.setInterval(()=>{this.processSyncQueue(),this.processDownloadQueue()},1e3)}get pendingSyncs(){return this.syncQueue}get pendingDownloads(){return this.downloadQueue}getOverallProgress(){let e=0,t=0,r=0,n=0,s=0,a=0;this.syncGroups.forEach(u=>{e+=u.total,t+=u.completed,r+=u.syncs,n+=u.completedSyncs,s+=u.downloads,a+=u.completedDownloads});let i=e>0?t/e*100:0,l=r>0?n/r*100:0,c=s>0?a/s*100:0;return{totalPercent:Math.round(i),syncPercent:Math.round(l),downloadPercent:Math.round(c),totalItems:e,completedItems:t,syncItems:r,completedSyncs:n,downloadItems:s,completedDownloads:a}}getGroupProgress(e){let t=this.syncGroups.get(e);if(!t)return null;let r=t.total>0?t.completed/t.total*100:0,n=t.syncs>0?t.completedSyncs/t.syncs*100:0,s=t.downloads>0?t.completedDownloads/t.downloads*100:0;return{percent:Math.round(r),syncPercent:Math.round(n),downloadPercent:Math.round(s),sharedFolder:e,status:t.status}}getAllGroupsProgress(){let e=[];return this.syncGroups.forEach((t,r)=>{let n=this.getGroupProgress(r);n&&e.push(n)}),e}async processSyncQueue(){if(this.isPaused||this.isProcessingSync)return;this.isProcessingSync=!0;let e=this.syncQueue.filter(t=>t.sharedFolder.connected);for(;e.length>0&&this.activeSync.size<this.concurrency;){let t=e.shift();if(!t)break;this.syncQueue=this.syncQueue.filter(r=>r.guid!==t.guid),t.status="running",this.activeSync.add(t);try{let r=t.doc;await this.syncDocument(r),t.status="completed";let n=this.syncCompletionCallbacks.get(t.guid);n&&(n.resolve(),this.syncCompletionCallbacks.delete(t.guid));let s=this.syncGroups.get(t.sharedFolder);s&&(this.debug(`[Sync Progress] Before: completed=${s.completed}, total=${s.total}, syncs=${s.syncs}, completedSyncs=${s.completedSyncs}`),s.completedSyncs++,s.completed++,this.debug(`[Sync Progress] After: completed=${s.completed}, total=${s.total}, syncs=${s.syncs}, completedSyncs=${s.completedSyncs}`),s.completed===s.total&&(s.status="completed",this.debug("[Sync Progress] Group completed!")),this.syncGroups.set(t.sharedFolder,s))}catch(r){t.status="failed";let n=this.syncCompletionCallbacks.get(t.guid);n&&(n.reject(r instanceof Error?r:new Error(String(r))),this.syncCompletionCallbacks.delete(t.guid));let s=this.syncGroups.get(t.sharedFolder);s&&(this.error("[Sync Failed]",r),s.status="failed",this.syncGroups.set(t.sharedFolder,s))}finally{this.activeSync.delete(t),this.inProgressSyncs.delete(t.guid)}}this.isProcessingSync=!1,this.syncQueue.length>0&&!this.isPaused&&this.syncQueue.some(r=>r.sharedFolder.connected)&&this.processSyncQueue()}async processDownloadQueue(){if(this.isPaused||this.isProcessingDownloads)return;this.isProcessingDownloads=!0;let e=this.downloadQueue.filter(t=>t.sharedFolder.connected);for(;e.length>0&&this.activeDownloads.size<this.concurrency;){let t=e.shift();if(!t)break;this.downloadQueue=this.downloadQueue.filter(r=>r.guid!==t.guid),t.status="running",this.activeDownloads.add(t);try{await this.getDocument(t.doc),t.status="completed";let r=this.downloadCompletionCallbacks.get(t.guid);r&&(r.resolve(),this.downloadCompletionCallbacks.delete(t.guid));let n=this.syncGroups.get(t.sharedFolder);n&&(n.completedDownloads++,n.completed++,n.completed===n.total&&(n.status="completed"),this.syncGroups.set(t.sharedFolder,n))}catch(r){t.status="failed";let n=this.downloadCompletionCallbacks.get(t.guid);n&&(n.reject(r instanceof Error?r:new Error(String(r))),this.downloadCompletionCallbacks.delete(t.guid));let s=this.syncGroups.get(t.sharedFolder);s&&(s.status="failed",this.syncGroups.set(t.sharedFolder,s)),this.error("[processDownloadQueue]",r)}finally{this.activeDownloads.delete(t),this.inProgressDownloads.delete(t.guid)}}this.isProcessingDownloads=!1,this.downloadQueue.length>0&&!this.isPaused&&this.downloadQueue.some(r=>r.sharedFolder.connected)&&this.processDownloadQueue()}async enqueueSync(e){if(this.inProgressSyncs.has(e.guid)){this.debug(`[enqueueSync] Item ${e.guid} already in progress, skipping`);let a=this.syncCompletionCallbacks.get(e.guid);return a?new Promise((i,l)=>{a.resolve=i,a.reject=l}):(this.processSyncQueue(),Promise.resolve())}let t=e.sharedFolder,r={guid:e.guid,path:t.getPath(e.path),doc:e,status:"pending",sharedFolder:t},n=this.syncGroups.get(t);n?(n.total++,n.syncs++):n={sharedFolder:t,total:1,completed:0,status:"pending",downloads:0,syncs:1,completedDownloads:0,completedSyncs:0},this.syncGroups.set(t,n),this.inProgressSyncs.add(e.guid);let s=new Promise((a,i)=>{this.syncCompletionCallbacks.set(e.guid,{resolve:a,reject:i})});return this.syncQueue.push(r),this.syncQueue.sort(qa),this.processSyncQueue(),s}enqueueDownload(e){if(this.inProgressDownloads.has(e.guid)){this.debug(`[enqueueDownload] Item ${e.guid} already in progress, skipping`);let a=this.downloadCompletionCallbacks.get(e.guid);return a?(this.processDownloadQueue(),new Promise((i,l)=>{a.resolve=i,a.reject=l})):(this.processDownloadQueue(),Promise.resolve())}let t=e.sharedFolder,r=this.syncGroups.get(t);r||(r={sharedFolder:t,total:0,completed:0,status:"pending",downloads:0,syncs:0,completedDownloads:0,completedSyncs:0}),r.downloads++,r.total++,this.syncGroups.set(t,r);let n={guid:e.guid,path:t.getPath(e.path),doc:e,status:"pending",sharedFolder:t};this.inProgressDownloads.add(e.guid);let s=new Promise((a,i)=>{this.downloadCompletionCallbacks.set(e.guid,{resolve:a,reject:i})});return this.downloadQueue.push(n),this.downloadQueue.sort(qa),this.processDownloadQueue(),s}enqueueSharedFolderSync(e){let t=[...e.docs.values()],r={sharedFolder:e,total:t.length,completed:0,status:"pending",downloads:0,syncs:t.length,completedDownloads:0,completedSyncs:0};this.syncGroups.set(e,r);let n=[...t].sort(qa);for(let s of n)this.enqueueDocumentForGroupSync(s);r.status="running",this.syncGroups.set(e,r)}async enqueueDocumentForGroupSync(e){if(this.inProgressSyncs.has(e.guid)){this.debug(`[enqueueDocumentForGroupSync] Item ${e.guid} already in progress, skipping`);let s=this.syncCompletionCallbacks.get(e.guid);return s?(this.processSyncQueue(),new Promise((a,i)=>{s.resolve=a,s.reject=i})):Promise.resolve()}let t=e.sharedFolder,r={guid:e.guid,path:t.getPath(e.path),doc:e,status:"pending",sharedFolder:t};this.inProgressSyncs.add(e.guid);let n=new Promise((s,a)=>{this.syncCompletionCallbacks.set(e.guid,{resolve:s,reject:a})});return this.syncQueue.push(r),this.syncQueue.sort(qa),this.processSyncQueue(),n}getAuthHeader(e){var t;return{Authorization:Xt().enableDocumentServer?`Bearer ${e.token}`:`Bearer ${(t=this.loginManager.user)==null?void 0:t.token}`}}getBaseUrl(e,t){var a;let r=new URL(e.url);r.protocol="https:";let n=r.pathname.split("/");n.pop(),n.push(e.docId),r.pathname=n.join("/");let s=((a=e.baseUrl)==null?void 0:a.replace(/\/$/,""))||r.toString();return Xt().enableDocumentServer?s:`https://api.system3.md/relay/${t.relayId}/doc/${t.documentId}`}async downloadItem(e){let t=e.s3rn;if(this.log("[downloadItem]",e.path,`${Jt.encode(t)}`),!(t instanceof qr))throw new Error("Unable to decode S3RN");let r=await e.getProviderToken(),n=this.getAuthHeader(r),s=this.getBaseUrl(r,t),a=`${s}/as-update`,i=await(0,yd.requestUrl)({url:a,method:"GET",headers:n});return i.status===200?this.debug("[downloadItem]",t.documentId,i.status):this.error("[downloadItem]",t.documentId,s,i.status,i.text),i}async syncDocumentWebsocket(e){let t=e.text,r="";try{r=await e.sharedFolder.read(e)}catch(i){}if(!(t===r)&&r)return this.log("file is not tracking local disk. resolve merge conflicts before syncing."),!1;let s=e.onceProviderSynced(),a=e.intent;return e.connect(),a==="disconnected"&&!e.userLock&&await s,a==="disconnected"&&!e.userLock&&(e.disconnect(),e.sharedFolder.tokenStore.removeFromRefreshQueue(Jt.encode(e.s3rn))),!0}async uploadItem(e){let t=e.s3rn;if(this.log("[uploadItem]",`${Jt.encode(t)}`),!(t instanceof qr))throw new Error("Unable to decode S3RN");if(!this.loginManager.loggedIn)throw new Error("Not logged in");let r=await e.getProviderToken(),n={"Content-Type":"application/octet-stream",...this.getAuthHeader(r)},s=Cn(e.ydoc),i=`${this.getBaseUrl(r,t)}/update`,l=await(0,yd.requestUrl)({url:i,method:"POST",headers:n,body:s.buffer,throw:!1});return l.status===200?this.debug("[uploadItem]",t.documentId,l.status,l.text):this.error("[uploadItem]",t.documentId,i,l.status,l.text),l}async getDocument(e,t=3,r=3e3){try{let n=e.text,s="";try{s=await e.sharedFolder.read(e)}catch(h){}let a=n===s,i=s!=="",c=(await this.downloadItem(e)).arrayBuffer,u=new Uint8Array(c),d=new mr;Do(d,u);let m=d.getMap("users");if(d.getText("contents").toString()===""){if(m.size===0){this.log("[getDocument] Server contains uninitialized document. Waiting for peer to upload.",m.size,t,r),t>0&&this.timeProvider.setTimeout(()=>{this.getDocument(e,t-1,r*2)},r);return}if(e.text){this.log("[getDocument] local crdt has contents, but remote is empty"),this.enqueueSync(e);return}}if(this.log("[getDocument] applying content from server"),Do(e.ydoc,u),i&&!a){this.log("Skipping flush - file requires merge conflict resolution.");return}e.sharedFolder.ids.has(e.path)&&(e.sharedFolder.flush(e,e.text),this.log("[getDocument] flushed"))}catch(n){throw this.error(n),n}}async syncItem(e){let t=e.text,r="";try{r=await e.sharedFolder.read(e)}catch(d){}if(!(t===r))return this.log("file is not tracking local disk. resolve merge conflicts before syncing."),!1;let s=await this.downloadItem(e);if(s.status!==200)return this.log("server returned an error."),!1;let a=s.arrayBuffer,i=new Uint8Array(a),l=new mr;Do(l,i);let c=l.getText("contents").toString();return l.getMap("users").size>0&&c===t||(Do(e.ydoc,i),e.sharedFolder.flush(e,e.text),this.uploadItem(e)),!0}async syncDocument(e){var t;try{Xt().enableHTTPSync&&((t=e.sharedFolder.remote)!=null&&t.relay.provider)?await this.syncItem(e):(this.debug("fallback to websocket sync"),await this.syncDocumentWebsocket(e))}catch(r){console.error(r);return}}subscribeToSync(e){return this.activeSync.subscribe(e)}subscribeToDownloads(e){return this.activeDownloads.subscribe(e)}subscribeToSyncGroups(e){return this.syncGroups.subscribe(e)}subscribeToProgress(e){let t=()=>{e(this.getOverallProgress())},r=this.activeSync.subscribe(()=>t()),n=this.activeDownloads.subscribe(()=>t()),s=this.syncGroups.subscribe(()=>t());return()=>{r(),n(),s()}}subscribeToGroupProgress(e,t){return this.syncGroups.subscribe(()=>{t(this.getGroupProgress(e))})}pause(){this.isPaused=!0}resume(){this.debug("starting"),this.isPaused=!1,this.processSyncQueue(),this.processDownloadQueue()}getQueueStatus(){return{syncsQueued:this.syncQueue.length,syncsActive:this.activeSync.size,downloadsQueued:this.downloadQueue.length,downloadsActive:this.activeDownloads.size,isPaused:this.isPaused}}destroy(){for(let[e,t]of this.syncCompletionCallbacks)t.reject(new Error("BackgroundSync destroyed")),this.syncCompletionCallbacks.delete(e);for(let[e,t]of this.downloadCompletionCallbacks)t.reject(new Error("BackgroundSync destroyed")),this.downloadCompletionCallbacks.delete(e);this.activeSync.destroy(),this.activeDownloads.destroy(),this.syncGroups.destroy(),this.syncQueue=[],this.downloadQueue=[],this.inProgressSyncs.clear(),this.inProgressDownloads.clear(),this.loggedItems.clear(),this.loginManager=null,this.timeProvider=null,this.subscriptions.forEach(e=>e())}};var Tl=class{constructor(e,t){this.app=e;this.difference=t.difference,this.file1=t.file1,this.file2=t.file2,this.file1Content=t.file1Content,this.file2Content=t.file2Content,this.triggerRebuild=t.triggerRebuild}async modify(e,t){if(e instanceof ct){Vx(e.ydoc,t);return}else if(e instanceof tn){e.contents=t;return}await this.app.vault.modify(e,t)}build(e){let t=e.createDiv({cls:"flex flex-row gap-1 py-0-5"}),r=this.difference.file1Lines.length>0,n=this.difference.file2Lines.length>0;n&&r?(new fr({text:"Accept Top (Editor)",onClick:s=>this.acceptTopClick(s,this.difference)}).build(t),io.build(t),new fr({text:"Accept Bottom (Local Disk)",onClick:s=>this.acceptBottomClick(s,this.difference)}).build(t),io.build(t),new fr({text:"Accept All",onClick:s=>this.acceptAllClick(s,this.difference)}).build(t),io.build(t),new fr({text:"Accept None",onClick:s=>this.acceptNoneClick(s,this.difference)}).build(t)):r?(new fr({text:"Keep in Editor",onClick:s=>this.insertFile1Difference(s,this.difference)}).build(t),io.build(t),new fr({text:"Discard in Editor",onClick:s=>this.discardFile1Difference(s,this.difference)}).build(t)):n&&(new fr({text:"Accept from Local Disk",onClick:s=>this.insertFile2Difference(s,this.difference)}).build(t),io.build(t),new fr({text:"Discard on Disk",onClick:s=>this.discardFile2Difference(s,this.difference)}).build(t))}async acceptTopClick(e,t){e.preventDefault();let r=t.file1Lines.join(`
`),n=Ha({fullText:this.file2Content,newLine:r,position:t.file2Start,linesToReplace:t.file2Lines.length});await this.modify(this.file2,n),this.triggerRebuild()}async acceptBottomClick(e,t){e.preventDefault();let r=t.file2Lines.join(`
`),n=Ha({fullText:this.file1Content,newLine:r,position:t.file1Start,linesToReplace:t.file1Lines.length});await this.modify(this.file1,n),this.triggerRebuild()}async acceptAllClick(e,t){e.preventDefault();let r=[...t.file1Lines,...t.file2Lines].join(`
`),n=Ha({fullText:this.file1Content,newLine:r,position:t.file1Start,linesToReplace:t.file1Lines.length});await this.modify(this.file1,n);let s=Ha({fullText:this.file2Content,newLine:r,position:t.file2Start,linesToReplace:t.file2Lines.length});await this.modify(this.file2,s),this.triggerRebuild()}async acceptNoneClick(e,t){e.preventDefault();let r=Va({fullText:this.file1Content,position:t.file1Start,count:t.file1Lines.length});await this.modify(this.file1,r);let n=Va({fullText:this.file2Content,position:t.file2Start,count:t.file2Lines.length});await this.modify(this.file2,n),this.triggerRebuild()}async insertFile1Difference(e,t){e.preventDefault();let r=t.file1Lines.join(`
`),n=gd({fullText:this.file2Content,newLine:r,position:t.file2Start});await this.modify(this.file2,n),this.triggerRebuild()}async insertFile2Difference(e,t){e.preventDefault();let r=t.file2Lines.join(`
`),n=gd({fullText:this.file1Content,newLine:r,position:t.file1Start});await this.modify(this.file1,n),this.triggerRebuild()}async discardFile1Difference(e,t){e.preventDefault();let r=Va({fullText:this.file1Content,position:t.file1Start,count:t.file1Lines.length});await this.modify(this.file1,r),this.triggerRebuild()}async discardFile2Difference(e,t){e.preventDefault();let r=Va({fullText:this.file2Content,position:t.file2Start,count:t.file2Lines.length});await this.modify(this.file2,r),this.triggerRebuild()}};var Bs="system3-differences-view";async function Wx(o,e){o.detachLeavesOfType(Bs);let t=o.getLeaf(!0);t.setViewState({type:Bs,active:!0,state:e}),o.revealLeaf(t)}var Dl=class extends qx.ItemView{constructor(t){super(t);this.file1Lines=[];this.file2Lines=[]}async getContent(t){return t instanceof ct?t.text:t instanceof tn?t.contents:await this.app.vault.cachedRead(t)}getViewType(){return Bs}getDisplayText(){var t,r;return(t=this.state)!=null&&t.file1&&((r=this.state)!=null&&r.file2)?`File Diff: ${this.state.file1.name} and ${this.state.file2.name}`:"File Diff"}async setState(t,r){super.setState(t,r),this.state=t,await this.updateState(),this.build()}async onunload(){var t,r;(r=(t=this.state)==null?void 0:t.onResolve)==null||r.call(t)}async updateState(){var r,n;if(((r=this.state)==null?void 0:r.file1)==null||((n=this.state)==null?void 0:n.file2)==null)return;this.file1Content=await this.getContent(this.state.file1),this.file2Content=await this.getContent(this.state.file2),this.file1Lines=this.file1Content.concat(`
`).split(`
`).map(s=>s.trimEnd()),this.file2Lines=this.file2Content.concat(`
`).split(`
`).map(s=>s.trimEnd());let t=Nx(this.state.file1.path,this.state.file2.path,this.file1Lines.join(`
`),this.file2Lines.join(`
`));this.fileDifferences=Il.fromParsedDiff(t),this.fileDifferences.differences.length===0&&this.leaf.detach()}build(){this.contentEl.empty();let t=this.contentEl.createDiv({cls:"file-diff__container"});this.buildHeader(t),this.buildLines(t),this.scrollToFirstDifference()}update(){let t=this.contentEl.scrollTop;this.contentEl.empty();let r=this.contentEl.createDiv({cls:"file-diff__container"});this.buildHeader(r),this.buildLines(r),this.contentEl.scrollTop=t}buildHeader(t){let r=t.createDiv({cls:"flex flex-row gap-1 py-0-5"});new fr({text:"Keep Editor Contents",onClick:async n=>{n.preventDefault(),await this.acceptAllFromLeft()}}).build(r),io.build(r),new fr({text:"Accept All from Local Disk",onClick:async n=>{n.preventDefault(),await this.acceptAllFromRight()}}).build(r)}async acceptAllFromLeft(){!this.state||!this.fileDifferences||(await this.app.vault.modify(this.state.file2,this.file1Content||""),this.leaf.detach())}async acceptAllFromRight(){!this.state||!this.fileDifferences||(await this.app.vault.modify(this.state.file1,this.file2Content||""),this.leaf.detach())}buildLines(t){var a,i,l;let r=0,n=0,s=Math.max(((a=this.file1Lines)==null?void 0:a.length)||0,((i=this.file2Lines)==null?void 0:i.length)||0);for(;r<=s||n<=s;){let c=(l=this.fileDifferences)==null?void 0:l.differences.find(u=>u.file1Start===r&&u.file2Start===n);if(c!=null){let u=t.createDiv({cls:"difference"});this.buildDifferenceVisualizer(u,c),r+=c.file1Lines.length,n+=c.file2Lines.length}else{let u=r<=n?this.file1Lines[r]:this.file2Lines[n];t.createDiv({text:$s(u),cls:"file-diff__line"}),r+=1,n+=1}}}buildDifferenceVisualizer(t,r){var n;(n=this.state)!=null&&n.showMergeOption&&new Tl(this.app,{difference:r,file1:this.state.file1,file2:this.state.file2,file1Content:this.file1Content||"",file2Content:this.file2Content||"",triggerRebuild:async()=>{await this.updateState(),this.update()}}).build(t);for(let s=0;s<r.file1Lines.length;s+=1){let a=r.file1Lines[s],i=r.file2Lines[s],l=t.createDiv({cls:"file-diff__line file-diff__top-line__bg"}),c=this.buildDiffLine(a,i,"file-diff_top-line__character");(s<r.file1Lines.length-1||r.file2Lines.length!==0)&&l.classList.add("file-diff__no-bottom-border"),s!==0&&l.classList.add("file-diff__no-top-border"),l.appendChild(c)}for(let s=0;s<r.file2Lines.length;s+=1){let a=r.file1Lines[s],i=r.file2Lines[s],l=t.createDiv({cls:"file-diff__line file-diff__bottom-line__bg"}),c=this.buildDiffLine(i,a,"file-diff_bottom-line__character");(s==0&&r.file1Lines.length>0||s>0)&&l.classList.add("file-diff__no-top-border"),s<r.file2Lines.length-1&&l.classList.add("file-diff__no-bottom-border"),l.appendChild(c)}}buildDiffLine(t,r,n){let s=document.createElement("div");if(t!=null&&t.length===0)s.textContent=$s(t);else if(t!=null&&r!=null){let a=Bx(r,t);for(let i of a){if(i.removed)continue;let l=document.createElement("span");l.textContent=$s(i.value),i.added&&l.classList.add(n),s.appendChild(l)}}else if(t!=null&&r==null){let a=document.createElement("span");a.textContent=$s(t),a.classList.add(n),s.appendChild(a)}else s.textContent=$s(t);return s}scrollToFirstDifference(){var n;if(((n=this.fileDifferences)==null?void 0:n.differences.length)===0)return;let t=this.contentEl.getElementsByClassName("file-diff__container")[0].getBoundingClientRect(),r=this.contentEl.getElementsByClassName("difference")[0].getBoundingClientRect();this.contentEl.scrollTo({top:r.top-t.top-100,behavior:"smooth"})}};var p2=3;function bd(o,e){o.iterateAllLeaves(t=>{t.view instanceof Ns.MarkdownView&&e(t.view)})}function m2(o,e){var t,r,n,s;if(o.length!==e.length)return!1;for(let a=0;a<o.length;a++)if(((t=o[a].view.file)==null?void 0:t.path)!==((r=e[a].view.file)==null?void 0:r.path)||((n=o[a].document)==null?void 0:n.path)!==((s=e[a].document)==null?void 0:s.path))return!1;return!0}var wd=class{constructor(e,t,r){this.document=null;this.canConnect=!1;this._parent=e,this.view=t,this.login=r}attach(){return this.banner=new Os(this.view,"Login to enable Live edits",async()=>await this.login()),Promise.resolve(this)}release(){var e;(e=this.banner)==null||e.destroy()}destroy(){this.release(),this.banner=void 0,this.view=null}};function Ro(o){return o instanceof an&&o.document!==void 0&&o.document.text!==void 0}var an=class{constructor(e,t,r,n=!0,s=!0){this._parent=e,this.view=t,this.document=r,this._tracking=!1,this.shouldConnect=n,this.canConnect=s,e.networkStatus.online||this.offlineBanner()}toggleConnection(){this.shouldConnect=!this.shouldConnect,this.shouldConnect?this.document.connect().then(e=>{e||(this.shouldConnect=!1)}):this.document.disconnect()}get tracking(){return this._tracking}set tracking(e){let t=this._tracking;this._tracking=e,this._tracking!==t&&this.attach()}get ytext(){return this.document.ytext}mergeBanner(){return this._banner=new Os(this.view,"Merge conflict -- click to resolve",async()=>{let e=await this.document.diskBuffer();return await this.document.checkStale()&&this._parent.openDiffView({file1:this.document,file2:e,showMergeOption:!0,onResolve:async()=>{this.document.clearDiskBuffer()}}),!0}),()=>{}}offlineBanner(){if(this.shouldConnect){let e=new Os(this.view,"You're offline -- click to reconnect",async()=>(this._parent.networkStatus.checkStatus(),this.connect(),this._parent.networkStatus.online));this._parent.networkStatus.onceOnline(()=>{this.connect(),e.destroy()})}return()=>{}}setConnectionDot(){let e=this.view.containerEl.querySelector(".view-actions");e&&e.firstChild&&(this._viewActions||(this.clearViewActions(),this.offConnectionStatusSubscription&&this.offConnectionStatusSubscription(),this._viewActions=new Dx({target:e,anchor:e.firstChild,props:{view:this,state:this.document.state,remote:this.document.sharedFolder.remote}}),this.offConnectionStatusSubscription=this.document.subscribe(e,t=>{var r;(r=this._viewActions)==null||r.$set({view:this,state:t,remote:this.document.sharedFolder.remote})})),this._viewActions.$set({view:this,state:this.document.state,remote:this.document.sharedFolder.remote}))}clearViewActions(){let e=this.view.containerEl.querySelector(".view-actions");if(e&&e.firstChild){let t=this.view.containerEl.querySelectorAll(".system3-view-action");t.length>0&&t.forEach(r=>{r.remove()})}}async checkStale(){var t,r;let e=await this.document.checkStale();return e&&((t=this.document._diskBuffer)!=null&&t.contents)?this.mergeBanner():((r=this._banner)==null||r.destroy(),this._banner=void 0),e}attach(){return this.document.userLock=!0,this.setConnectionDot(),new Promise(e=>this.document.whenReady().then(t=>{this._parent.networkStatus.online&&this.document.sharedFolder.shouldConnect&&this.shouldConnect&&this.canConnect?this.connect():this.document.disconnect(),e(this)}).catch(()=>{this.offlineBanner()}))}connect(){this.document.connect()}release(){var e,t;(e=this._viewActions)==null||e.$destroy(),this._viewActions=void 0,(t=this._banner)==null||t.destroy(),this._banner=void 0,this.offConnectionStatusSubscription&&(this.offConnectionStatusSubscription(),this.offConnectionStatusSubscription=void 0),this.document.disconnect(),this.document.userLock=!1}destroy(){this.release(),this.clearViewActions(),this.view.leaf.rebuildView(),this._parent=null,this.view=null,this.document=null}},Pl=class{constructor(e,t,r,n){this.app=e;this.destroyed=!1;this.offListeners=[];this.folderListeners=new Map;this.workspace=e.workspace,this.sharedFolders=t,this.views=[],this.extensions=[],this._activePromise=null,this.loginManager=r,this.networkStatus=n,this.refreshQueue=[],this._compartment=new Al.Compartment,this.log=Le("[LiveViews]","log"),this.warn=Le("[LiveViews]","warn"),this.metadataListeners=new Map;let s=(l,c,u)=>{let d=this.metadataListeners.get(l);d==null||d(c,u)},a=this.app.metadataCache.on("changed",s);this.offListeners.push(()=>{this.app.metadataCache.offref(a)}),this.offListeners.push(this.loginManager.on(()=>{this.refresh("[LoginManager]")}));let i=l=>(l.ready||(async()=>l.whenReady().then(()=>{this.refresh("[Shared Folder Ready]")}).catch(c=>{this.views.forEach(u=>{var d;((d=u.document)==null?void 0:d.sharedFolder)===l&&u.offlineBanner()})}))(),l.docset.on(()=>{this.refresh("[Docset]")}));this.offListeners.push(this.sharedFolders.subscribe(()=>{this.refresh("[Shared Folders]"),this.folderListeners.forEach((l,c)=>{this.sharedFolders.has(c)||(l(),this.folderListeners.delete(c))}),this.sharedFolders.forEach(l=>{this.folderListeners.has(l)||this.folderListeners.set(l,i(l))})})),Dt.set(this,"LiveViewManager")}reconfigure(e){e.dispatch({effects:this._compartment.reconfigure([sn.init(()=>this)])})}onMeta(e,t){this.metadataListeners.set(e,t)}offMeta(e){this.metadataListeners.delete(e)}openDiffView(e){Wx(this.workspace,e)}goOffline(){this.log("[System 3][Relay][Live Views] going offline"),this.views.forEach(e=>{var t;return(t=e.document)==null?void 0:t.disconnect()}),this.refresh("[NetworkStatus]")}goOnline(){this.log("[System 3][Relay][Live Views] going online"),this.refresh("[NetworkStatus]"),this.sharedFolders.items().forEach(e=>{e.connect()}),this.viewsAttachedWithConnectionPool(this.views)}docIsOpen(e){return this.views.some(t=>t.document===e)}releaseViews(e){e.forEach(t=>{t.release()})}findFolders(){let e=new Set;return bd(this.workspace,t=>{var s;let r=(s=t.file)==null?void 0:s.path;if(!r)return;let n=this.sharedFolders.lookup(r);n&&e.add(n)}),e.size==0?[]:[...e]}async foldersReady(){let e=new Set;if(bd(this.workspace,r=>{var a;let n=(a=r.file)==null?void 0:a.path;if(!n)return;let s=this.sharedFolders.lookup(n);s&&e.add(s)}),e.size===0)return[];let t=[...e].map(r=>r.whenReady());return Promise.all(t)}async getViews(){let e=[];return bd(this.workspace,async t=>{var s;let r=(s=t.file)==null?void 0:s.path;if(!r)return;let n=this.sharedFolders.lookup(r);if(n)if(this.loginManager.loggedIn)if(n.ready){let a=n.proxy.getDoc(r),i=new an(this,t,a);e.push(i)}else this.log(`Folder not ready, skipping views. folder=${n.path}`);else{let a=new wd(this,t,()=>this.loginManager.openLoginPage());e.push(a)}}),e}findView(e){return this.views.find(t=>t.view.editor.cm===e)}async viewsReady(e){return await Promise.all(e.filter(t=>t instanceof an).map(async t=>t.document.whenReady().then(r=>t)))}async viewsAttachedWithConnectionPool(e,t=p2){let r=this.workspace.getActiveViewOfType(Ns.MarkdownView),n=0,s=e.sort((i,l)=>l.view.leaf.activeTime-i.view.leaf.activeTime),a=new Set;for(let i of s)i instanceof an&&(i.view===r||a.has(i.document)?(i.canConnect=!0,a.add(i.document)):n<t?(i.canConnect=!0,a.add(i.document),n++):i.canConnect=!1);return n>t&&this.warn(`[System 3][Relay][Live Views] connection pool (max ${t}): rejected connections for ${n-t} views`),this.viewsAttached(e)}async viewsAttached(e){return await Promise.all(e.map(async t=>t.attach()))}deduplicate(e){let t=[],r=[];return this.views.forEach(n=>{let s=e.find(a=>{if(n.document==a.document&&n.view==a.view)return!0});s?(r.push(n),e.remove(s)):t.push(n)}),e.forEach(n=>{r.push(n)}),[r,t]}async _refreshViews(e,t){let r=`[LiveViews][${e}]`,n=Le(r,"debug"),s=(d,m)=>{n(d,m.map(x=>{var h;return{type:x.constructor.name,file:(h=x.document)==null?void 0:h.path,canConnect:x.canConnect}}))};if(n("Refresh"),this.destroyed)return!1;await this.foldersReady();let a=[];try{a=await this.getViews()}catch(d){return this.warn("[System 3][Relay][Live Views] error getting views",d),!1}let i=this.findFolders();if(i.length===0&&a.length===0)return this.extensions.length!==0&&(n("Unexpected plugins loaded."),this.wipe()),s("Releasing Views",this.views),this.releaseViews(this.views),this.views=[],!0;this.loginManager.loggedIn&&this.networkStatus.online?i.forEach(d=>{d.connect()}):this.sharedFolders.forEach(d=>{d.disconnect()});let[l,c]=this.deduplicate(a);if(s("Releasing Views",c),this.releaseViews(c),c.length===0&&m2(l,this.views)){let d=await this.viewsAttachedWithConnectionPool(this.views);s("Attached Views",d)}else{let d=await this.viewsReady(l);s("Ready Views",d);let m=await this.viewsAttachedWithConnectionPool(d);s("Attached Views",m),this.views=l}n("loading plugins"),this.load();let u=Ns.moment.utc();return n(`refresh completed in ${u.diff(t)}ms`,r),!0}async refresh(e){if(this.destroyed)return!1;let t=Le(e,"warn"),r=Ns.moment.utc();if(this.refreshQueue.push(()=>this._refreshViews(e,r)),this._activePromise!==null)return!1;for(;this.refreshQueue.length>0;){if(this.destroyed)return!1;this.refreshQueue.length>2&&t("refreshQueue size:",this.refreshQueue.length);let n=this.refreshQueue.pop();this.refreshQueue.length=0,this._activePromise=n().finally(()=>{this._activePromise=null}),await this._activePromise}return!0}wipe(){this.extensions.length=0,this.workspace.updateOptions()}load(){this.wipe(),this.views.length>0&&(this.extensions.push([this._compartment.of(sn.init(()=>this)),Ex,Mx,Rx,Ox]),this.workspace.updateOptions())}destroy(){this.destroyed=!0,this.releaseViews(this.views),this.offListeners.forEach(e=>e()),this.offListeners.length=0,this.metadataListeners.clear(),this.metadataListeners=null,this.folderListeners.forEach(e=>e()),this.folderListeners.clear(),this.folderListeners=null,this.views.forEach(e=>e.destroy()),this.views=[],this.wipe(),this.sharedFolders=null,this.refreshQueue=null,this.networkStatus=null,this._activePromise=null,this.loginManager=null,this.app=null,this.workspace=null}},sn=Al.StateField.define({create(o){},update(o,e){return o}});var Hs=require("obsidian");function h2(o){De(o,"svelte-1siabfk",".system3-folder-icons.svelte-1siabfk{display:inline-flex;align-items:center;vertical-align:middle;border-radius:var(--radius-m);transition:width 0.3s ease;margin-right:0.6em;padding-left:0.2em;padding-right:0.2em;background-color:var(--color-base-05);position:relative}.system3-icon.svelte-1siabfk{margin-right:0.2em;margin-left:0.2em;width:1em;display:flex;transition:display 0.3s ease}span.system3-connected.svelte-1siabfk{color:var(--color-accent)}span.system3-disconnected.svelte-1siabfk{color:var(--color-base-40)}span.notebook.svelte-1siabfk{color:var(--color-accent)}span.hidden.svelte-1siabfk{display:none}.system3-progress-text.svelte-1siabfk{margin-right:0.4em;font-size:0.8em;color:var(--color-accent);opacity:1;transition:opacity 0.3s ease}.system3-progress-text.completed.svelte-1siabfk{animation:svelte-1siabfk-fadeOutDelay 0.3s ease forwards}.system3-progress-text.failed.svelte-1siabfk{color:var(--color-red)}@keyframes svelte-1siabfk-fadeOutDelay{0%,50%{opacity:1}100%{opacity:0;display:none}}")}function zx(o){let e,t,r,n;return{c(){e=D("span"),t=K(o[3]),r=K("%"),b(e,"class",n="system3-progress-text system3-"+o[4]+" svelte-1siabfk"),ue(e,"opacity","1")},m(s,a){T(s,e,a),k(e,t),k(e,r)},p(s,a){a&8&&se(t,s[3]),a&16&&n!==(n="system3-progress-text system3-"+s[4]+" svelte-1siabfk")&&b(e,"class",n)},d(s){s&&C(e)}}}function g2(o){let e,t,r;return t=new Mo({props:{class:"inline-icon",style:"width: 0.8em"}}),{c(){e=D("span"),V(t.$$.fragment),b(e,"class","notebook system3-icon svelte-1siabfk"),b(e,"aria-label","Tracking Changes")},m(n,s){T(n,e,s),N(t,e,null),r=!0},p:X,i(n){r||(I(t.$$.fragment,n),r=!0)},o(n){P(t.$$.fragment,n),r=!1},d(n){n&&C(e),H(t)}}}function x2(o){let e,t,r,n,s,a,i,l;return t=new Mo({props:{class:"inline-icon",style:"width: 0.8em"}}),s=new Fn({props:{class:"inline-icon"}}),{c(){var c;e=D("span"),V(t.$$.fragment),r=B(),n=D("span"),V(s.$$.fragment),b(e,"class","notebook system3-icon hidden svelte-1siabfk"),b(e,"aria-label","Tracking Changes"),b(n,"class",a="satellite system3-icon system3-"+o[0]+" svelte-1siabfk"),b(n,"aria-label",i=`${((c=o[2])==null?void 0:c.relay.name)||"Relay Server"} (${o[0]})`)},m(c,u){T(c,e,u),N(t,e,null),T(c,r,u),T(c,n,u),N(s,n,null),l=!0},p(c,u){var d;(!l||u&1&&a!==(a="satellite system3-icon system3-"+c[0]+" svelte-1siabfk"))&&b(n,"class",a),(!l||u&5&&i!==(i=`${((d=c[2])==null?void 0:d.relay.name)||"Relay Server"} (${c[0]})`))&&b(n,"aria-label",i)},i(c){l||(I(t.$$.fragment,c),I(s.$$.fragment,c),l=!0)},o(c){P(t.$$.fragment,c),P(s.$$.fragment,c),l=!1},d(c){c&&(C(e),C(r),C(n)),H(t),H(s)}}}function y2(o){let e,t,r,n,s,a=o[5]&&zx(o),i=[x2,g2],l=[];function c(u,d){return u[1]?0:1}return r=c(o,-1),n=l[r]=i[r](o),{c(){e=D("div"),a&&a.c(),t=B(),n.c(),b(e,"class","system3-folder-icons svelte-1siabfk")},m(u,d){T(u,e,d),a&&a.m(e,null),k(e,t),l[r].m(e,null),s=!0},p(u,[d]){u[5]?a?a.p(u,d):(a=zx(u),a.c(),a.m(e,t)):a&&(a.d(1),a=null);let m=r;r=c(u,d),r===m?l[r].p(u,d):(be(),P(l[m],1,1,()=>{l[m]=null}),we(),n=l[r],n?n.p(u,d):(n=l[r]=i[r](u),n.c()),I(n,1),n.m(e,null))},i(u){s||(I(n),s=!0)},o(u){P(n),s=!1},d(u){u&&C(e),a&&a.d(),l[r].d()}}}function b2(o,e,t){let r,{status:n="disconnected"}=e,{relayId:s}=e,{remote:a}=e,{progress:i=0}=e,{syncStatus:l="pending"}=e;return o.$$set=c=>{"status"in c&&t(0,n=c.status),"relayId"in c&&t(1,s=c.relayId),"remote"in c&&t(2,a=c.remote),"progress"in c&&t(3,i=c.progress),"syncStatus"in c&&t(4,l=c.syncStatus)},o.$$.update=()=>{if(o.$$.dirty&24){e:t(5,r=(l!=="completed"||i<100)&&i>0)}},[n,s,a,i,l,r]}var _d=class extends Z{constructor(e){super(),ee(this,e,b2,y2,Q,{status:0,relayId:1,remote:2,progress:3,syncStatus:4},h2)}},Kx=_d;function w2(o){De(o,"svelte-1swndfj",".system3-filepill.svelte-1swndfj{text-wrap:nowrap}")}function _2(o){let e,t,r;return{c(){e=D("div"),t=D("span"),r=K(o[0]),b(e,"class","nav-file-tag system3-filepill svelte-1swndfj"),b(e,"aria-label",o[1])},m(n,s){T(n,e,s),k(e,t),k(t,r)},p(n,[s]){s&1&&se(r,n[0]),s&2&&b(e,"aria-label",n[1])},i:X,o:X,d(n){n&&C(e)}}}function v2(o,e,t){let{text:r}=e,{label:n}=e;return o.$$set=s=>{"text"in s&&t(0,r=s.text),"label"in s&&t(1,n=s.label)},[r,n]}var vd=class extends Z{constructor(e){super(),ee(this,e,v2,_2,Q,{text:0,label:1},w2)}},El=vd;var Sd=class{constructor(e,t){this.el=e,this.mutationObserver=new MutationObserver((r,n)=>{for(let s of r)s.type==="childList"&&e.nextSibling&&(t(e),n.disconnect())}),this.mutationObserver.observe(e.parentElement,{childList:!0,subtree:!0})}destroy(){var e;(e=this.mutationObserver)==null||e.disconnect(),this.mutationObserver=null}},Uo=class{visitFolder(e,t,r,n){return null}visitFile(e,t,r,n){return null}},kd=class{constructor(e,t){this.el=e,this.sharedFolder=t,this.siblingWatcher=new Sd(this.el,r=>{this.add()}),this.add()}add(){var e;(e=this.el.nextSibling)==null||e.addClass("system3-live")}remove(){var e;(e=this.el.nextSibling)==null||e.removeClass("system3-live")}destroy(){this.siblingWatcher.destroy(),this.remove()}},Ld=class extends Uo{visitFolder(e,t,r,n){return n&&n.path===e.path?r||new kd(t.selfEl,n):(r&&r.destroy(),null)}},Id=class{constructor(e,t){this.sharedFolder=t;let r=e.querySelectorAll(".system3-folder-icons");r.length>1&&(r==null||r.forEach(s=>{s.remove()})),this.el=e,this.el.addClass("system3-pill"),this.pill=new Kx({target:this.el,props:{status:this.sharedFolder.state.status,relayId:this.sharedFolder.relayId,remote:this.sharedFolder.remote,progress:0,syncStatus:"pending"}});let n=[];n.push(this.sharedFolder.subscribe(this.el,s=>{this.pill.$set({status:s.status,relayId:this.sharedFolder.relayId,remote:this.sharedFolder.remote})})),n.push(this.sharedFolder.backgroundSync.subscribeToGroupProgress(this.sharedFolder,s=>{s&&this.pill.$set({progress:s.percent,syncStatus:s.status})})),this.unsubscribe=()=>n.forEach(s=>s())}destroy(){this.pill.$destroy(),this.unsubscribe(),this.el.removeClass("system3-pill")}},Cd=class extends Uo{visitFolder(e,t,r,n){return n&&n.path===e.path?r||new Id(t.selfEl,n):(r&&r.destroy(),null)}},Td=class{constructor(e,t,r,n){this.el=e;this.path=t;this.activeSync=r;this.activeDownloads=n;this.unsubscribers=[];this.titleEl=e.querySelector(".nav-file-title")||e,this.unsubscribers.push(this.activeSync.subscribe(()=>this.checkStatus()),this.activeDownloads.subscribe(()=>this.checkStatus())),this.checkStatus()}checkStatus(){let e=this.activeSync.some(r=>r.path===this.path),t=this.activeDownloads.some(r=>r.path===this.path);e?this.titleEl.addClass("system3-syncing"):this.titleEl.removeClass("system3-syncing"),t?this.titleEl.addClass("system3-downloading"):this.titleEl.removeClass("system3-downloading")}destroy(){this.titleEl.removeClass("system3-uploading"),this.titleEl.removeClass("system3-downloading"),this.unsubscribers.forEach(e=>e())}},Dd=class extends Uo{constructor(t,r){super();this.activeSync=t;this.activeDownloads=r}visitFile(t,r,n,s){return s&&s.ready&&s.checkPath(t.path)&&ct.checkExtension(t.path)?n||new Td(r.el,t.path,this.activeSync,this.activeDownloads):(n&&n.destroy(),null)}},Pd=class{constructor(e,t){this.el=e;this.doc=t;this.el.querySelectorAll(".system3-filepill").forEach(n=>{n.remove()}),this.pill=new El({target:this.el,props:{text:`${t.guid.slice(0,3)}`}});let r=async()=>{await t.whenSynced(),await t.count(),this.pill.$set({text:`${t.guid.slice(0,3)} ${t.dbsize}`})};t.whenReady().then(()=>{t.ydoc.on("update",r),r()}),this.unsubscribe=()=>{t.ydoc.off("update",r)}}destroy(){var e;this.pill.$destroy(),(e=this.unsubscribe)==null||e.call(this),this.el.querySelectorAll(".system3-filepill").forEach(t=>{t.remove()})}},Ad=class extends Uo{visitFile(e,t,r,n){if(n&&n.ready&&ct.checkExtension(e.path)){let s=n.proxy.viewDoc(e.path);return!s||!s.ready?null:r||new Pd(t.selfEl,s)}return r&&r.destroy(),null}},Ed=class{constructor(e){this.el=e;this.el.querySelectorAll(".system3-filepill").forEach(t=>{t.remove()}),this.pill=new El({target:this.el,props:{text:"NOT SYNCED",label:"Relay does not support this file type."}})}destroy(){this.pill.$destroy(),this.el.querySelectorAll(".system3-filepill").forEach(e=>{e.remove()})}},Md=class extends Uo{visitFile(e,t,r,n){return n&&!ct.checkExtension(e.path)?r||new Ed(t.selfEl):(r&&r.destroy(),null)}},Rd=class{constructor(e,t,r){this.el=e,this.document=t,this.document.subscribe(e,n=>{this.docStatus(n)}),this.docStatus(this.document.state)}docStatus(e){(e==null?void 0:e.status)==="connected"?(this.el.removeClass("system3-connecting"),this.el.addClass("system3-connected"),this.el.addClass("system3-live")):(e==null?void 0:e.status)==="connecting"?(this.el.removeClass("system3-connected"),this.el.addClass("system3-connecting"),this.el.addClass("system3-live")):(e==null?void 0:e.status)==="disconnected"?(this.el.addClass("system3-live"),this.el.removeClass("system3-connected"),this.el.removeClass("system3-connecting")):(this.el.removeClass("system3-connected"),this.el.removeClass("system3-connecting"),this.el.removeClass("system3-live"))}destroy(){var e;(e=this.document)==null||e.unsubscribe(this.el),this.docStatus()}},Fd=class extends Uo{visitFile(e,t,r,n){if(n)try{let s=n.ids.get(n.getVirtualPath(e.path));if(!s)return null;let a=n.docs.get(s);return a?r||new Rd(t.el,a,e):null}catch(s){return null}return r&&r.destroy(),null}},Od=class{constructor(e){this.el=e;this.el.querySelectorAll(".system3-filepill").forEach(t=>{t.remove()}),this.pill=new El({target:this.el,props:{text:"DESYNC",label:"File content does not match document content"}})}destroy(){this.pill.$destroy(),this.el.querySelectorAll(".system3-filepill").forEach(e=>{e.remove()})}},Ud=class extends Uo{visitFile(e,t,r,n){if(n&&ct.checkExtension(e.path)){let s=n.proxy.viewDoc(e.path);if(!s||!s.ready)return null;if(e.stat.size!==s.stat.size)return r||new Od(t.selfEl)}return r&&r.destroy(),null}},Ml=class{constructor(e,t,r){this.fileExplorer=e,this.sharedFolders=t,this.visitors=r,this.storage=new Map;for(let n of this.visitors)this.storage.set(n,new Map)}_getFileExplorerItem(e){try{return this.fileExplorer.view.fileItems[e]}catch(t){return null}}getFileExplorerItem(e,t){return typeof t=="string"?this._getFileExplorerItem(t):this._getFileExplorerItem(t.path)}walk(e,t){if(this.fileExplorer.view.getViewType()!=="file-explorer")return;let r=this.sharedFolders.find(s=>s.path===e.path)||t,n=this.getFileExplorerItem(this.fileExplorer,e);n&&this.storage.forEach((s,a)=>{let i=s.get(n),l=a.visitFolder(e,n,i,r);i&&!l?s.delete(n):l&&s.set(n,l)}),e.children.forEach(s=>{if(s instanceof Hs.TFolder)this.walk(s,r);else if(s instanceof Hs.TFile){let a=this.getFileExplorerItem(this.fileExplorer,s);if(!a)return;this.storage.forEach((i,l)=>{let c=i.get(a),u=l.visitFile(s,a,c,r);c&&!u?i.delete(a):u&&i.set(a,u)})}})}destroy(){this.storage.forEach(e=>{e.forEach(t=>{t.destroy()})})}},Rl=class{constructor(e,t,r,n){this.layoutReady=!1;this.queueSubscriptions=[];this.vault=e,this.workspace=t,this.sharedFolders=r,this.backgroundSync=n,this.treeState=new Map,this.workspace.onLayoutReady(()=>{this.layoutReady=!0,this.refresh()}),this.queueSubscriptions.push(n.activeSync.subscribe(()=>this.quickRefresh()),n.activeDownloads.subscribe(()=>this.quickRefresh()),n.syncGroups.subscribe(()=>this.quickRefresh())),this.offDocumentListeners=new Map,this.offFolderListener=this.sharedFolders.subscribe(()=>{this.sharedFolders.forEach(s=>{sx([Tr.enableDocumentStatus,Tr.enableDebugFileTag],()=>{this.offDocumentListeners.get(s)||this.offDocumentListeners.set(s,s.docset.on(()=>{this.refresh()}))}),s.whenReady().then(()=>{this.refresh()})}),this.refresh()}),this.offLayoutChange=(()=>{let s=this.workspace.on("layout-change",()=>this.quickRefresh());return()=>{this.workspace.offref(s)}})()}makeVisitors(){let e=[];return e.push(new Ld),e.push(new Cd),ao(Tr.enableDocumentStatus,()=>{e.push(new Fd),e.push(new Dd(this.backgroundSync.activeSync,this.backgroundSync.activeDownloads))}),ao(Tr.enableDebugFileTag,()=>{e.push(new Ad)}),ao(Tr.enableDesyncPill,()=>{e.push(new Ud)}),e.push(new Md),e}getFileExplorers(){let e=[];return this.workspace.iterateAllLeaves(t=>{t.view.getViewType()==="file-explorer"&&(e.includes(t)||e.push(t))}),e}quickRefresh(){if(!this.layoutReady)return;let e=this.getFileExplorers(),t=this.sharedFolders.map(r=>r.path);for(let r of e){let n=this.treeState.get(r)||new Ml(r,this.sharedFolders,this.makeVisitors());this.treeState.set(r,n);for(let s of t){let a=this.vault.getAbstractFileByPath(s);a instanceof Hs.TFolder&&n.walk(a)}}}refresh(){if(!this.layoutReady)return;let e=this.getFileExplorers();for(let t of e){let r=this.treeState.get(t)||new Ml(t,this.sharedFolders,this.makeVisitors());this.treeState.set(t,r);let n=this.vault.getAbstractFileByPath("/");n instanceof Hs.TFolder&&r.walk(n)}}destroy(){var e;(e=this.offFolderListener)==null||e.call(this),this.offDocumentListeners.forEach(t=>t()),this.offDocumentListeners.clear(),this.treeState.forEach(t=>{t.destroy()}),this.treeState.clear(),this.offLayoutChange(),this.queueSubscriptions.forEach(t=>t()),this.queueSubscriptions=[],this.vault=null,this.workspace=null,this.sharedFolders=null,this.backgroundSync=null,this.offFolderListener=null}};var nb=require("obsidian");function Ge(o,e,t,r){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function i(u){try{c(r.next(u))}catch(d){a(d)}}function l(u){try{c(r.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):n(u.value).then(i,l)}c((r=r.apply(o,e||[])).next())})}var ln=require("obsidian");function S2(o){let e,t,r;return{c(){e=Wr("svg"),t=Wr("g"),r=Wr("path"),b(r,"d","M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z"),b(r,"fill","#5865F2"),b(r,"fill-rule","nonzero"),b(e,"width",o[0]),b(e,"height",o[0]),b(e,"viewBox","0 -28.5 256 256"),b(e,"version","1.1"),b(e,"xmlns","http://www.w3.org/2000/svg"),b(e,"xmlns:xlink","http://www.w3.org/1999/xlink"),b(e,"preserveAspectRatio","xMidYMid")},m(n,s){T(n,e,s),k(e,t),k(t,r)},p(n,[s]){s&1&&b(e,"width",n[0]),s&1&&b(e,"height",n[0])},i:X,o:X,d(n){n&&C(e)}}}function k2(o,e,t){let{size:r="1em"}=e;return o.$$set=n=>{"size"in n&&t(0,r=n.size)},[r]}var $d=class extends Z{constructor(e){super(),ee(this,e,k2,S2,Q,{size:0})}},Fl=$d;function L2(o){De(o,"svelte-4t8k3t",`.menu-container.svelte-4t8k3t{display:inline-block;position:relative}.menu-button.svelte-4t8k3t{box-shadow:none;padding:8px;border:none;background:transparent;color:var(--text-muted)}.menu-button.svelte-4t8k3t:hover{color:var(--icon-color-hover)}.menu-button.svelte-4t8k3t:focus{color:var(--icon-color-focus)}.menu-dropdown.svelte-4t8k3t{position:absolute;right:0;margin-top:8px;width:224px;background:var(--color-base-10);border-radius:6px;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1),
			0 2px 4px -1px rgba(0, 0, 0, 0.06);border:1px solid rgba(0, 0, 0, 0.1)}.arrow.svelte-4t8k3t{position:absolute;top:-5px;right:12px;width:10px;height:10px;background:var(--color-base-10);border-left:1px solid rgba(0, 0, 0, 0.1);border-top:1px solid rgba(0, 0, 0, 0.1);transform:rotate(45deg)}.menu-content.svelte-4t8k3t{display:flex;flex-direction:column;gap:8px;padding:8px}.menu-item.svelte-4t8k3t{display:flex;width:100%;align-items:center;gap:12px;padding:8px;border-radius:4px;text-decoration:none;color:var(--text-muted);transition:background-color 0.2s;font-size:14px}.menu-item.svelte-4t8k3t:hover{background-color:var(--background-modifier-hover)}.menu-item.svelte-4t8k3t:focus{background-color:var(--background-modifier-hover)}`)}function Gx(o){let e,t,r,n,s,a,i,l,c,u,d,m,x;return i=new Fl({props:{size:20}}),{c(){e=D("div"),t=D("div"),r=B(),n=D("div"),s=D("span"),a=D("a"),V(i.$$.fragment),l=B(),c=D("span"),c.textContent="Join the community",b(t,"class","arrow svelte-4t8k3t"),b(a,"href","https://discord.system3.md"),b(a,"target","_blank"),b(a,"rel","noopener noreferrer"),b(a,"class","menu-item svelte-4t8k3t"),ue(s,"text-align","center"),ue(s,"display","flex"),b(n,"class","menu-content svelte-4t8k3t"),b(e,"class","menu-dropdown svelte-4t8k3t")},m(h,v){T(h,e,v),k(e,t),k(e,r),k(e,n),k(n,s),k(s,a),N(i,a,null),k(a,l),k(a,c),d=!0,m||(x=px(u=o[1].call(null,e)),m=!0)},i(h){d||(I(i.$$.fragment,h),d=!0)},o(h){P(i.$$.fragment,h),d=!1},d(h){h&&C(e),H(i),m=!1,x()}}}function I2(o){let e,t,r,n,s,a,i;r=new Vu({props:{size:"20px"}});let l=o[0]&&Gx(o);return{c(){e=D("div"),t=D("button"),V(r.$$.fragment),n=B(),l&&l.c(),b(t,"class","menu-button svelte-4t8k3t"),b(e,"class","menu-container svelte-4t8k3t")},m(c,u){T(c,e,u),k(e,t),N(r,t,null),k(e,n),l&&l.m(e,null),s=!0,a||(i=re(t,"click",yx(o[2])),a=!0)},p(c,[u]){c[0]?l?u&1&&I(l,1):(l=Gx(c),l.c(),I(l,1),l.m(e,null)):l&&(be(),P(l,1,1,()=>{l=null}),we())},i(c){s||(I(r.$$.fragment,c),I(l),s=!0)},o(c){P(r.$$.fragment,c),P(l),s=!1},d(c){c&&C(e),H(r),l&&l.d(),a=!1,i()}}}function C2(o,e,t){let r=!1;function n(a){let i=l=>{let c=document.querySelector(".menu-button");!a.contains(l.target)&&l.target!==c&&!(c!=null&&c.contains(l.target))&&t(0,r=!1)};return setTimeout(()=>{document.addEventListener("click",i)},0),{destroy(){document.removeEventListener("click",i)}}}function s(a){a.stopPropagation(),t(0,r=!r)}return[r,n,s]}var Bd=class extends Z{constructor(e){super(),ee(this,e,C2,I2,Q,{},L2)}},jx=Bd;function T2(o){De(o,"svelte-ycfe1d",".relay-text.svelte-ycfe1d{fill:var(--text-normal)}")}function D2(o){let e,t;return{c(){e=Wr("svg"),t=Wr("path"),b(t,"d","m112.88679 65.94517c-1.8219-.6498-2.8316-1.9996-2.8205-3.7707.019-2.9692 4.2679-9.1564 8.5532-12.4538.8896-.6846 3.2865-2.0796 5.3264-3.1002l3.7089-1.8555 1.1034-2.1157c.6069-1.1636 1.0788-2.1403 1.0487-2.1704-.03-.03-.7517.2969-1.6037.7266-1.7893.9026-3.4923 1.0179-5.6348.3816-1.2664-.376-2.6971-1.5724-3.0511-2.5512-.1036-.2865-.2262-.2926-.6259-.031-1.6133 1.0551-3.9805 2.2931-5.3124 2.7783-3.2045 1.1672-7.1579.5507-8.5509-1.3335l-.5903-.7983-1.2238.7491c-3.1246 1.9126-7.5052 2.5576-9.6905 1.4268-1.3209-.6835-2.1336-1.8529-2.3663-3.405-.099-.6587-.2706-1.1976-.3819-1.1976-.1112 0-.4909.3082-.8437.685-1.1393 1.2168-4.3891 3.211-6.2437 3.8314-4.3168 1.4441-8.0424.1949-8.8532-2.9684-.1823-.7114-.3977-1.2593-.4786-1.2177-8.2088 4.2188-13.1666 5.5617-17.3451 4.6983-7.2318-1.4943-8.5363-7.633-3.2721-15.3969 3.43-5.0586 8.1226-8.1393 12.5368-8.2303 4.2661-.088 6.1851 2.8612 4.6067 7.0798-1.4639 3.9129-6.6553 7.7738-11.3995 8.4781l-1.2322.183-.173.9219c-.2449 1.3054.055 2.3726.8414 2.9909 1.4773 1.162 5.3481.4499 9.169-1.6869 4.0877-2.286 9.2494-6.7459 10.2254-8.8353 2.1729-4.6512 10.3391-19.4528 12.6199-22.8741 1.9649-2.9472 2.9544-3.913 4.6877-4.575 2.2454-.8575 3.8556.1204 3.8556 2.3418 0 1.0627-.8749 2.8756-5.2398 10.8581-4.5459 8.3134-10.5554 20.346-10.9601 21.9446-.372 1.4696-.093 1.8547 1.0954 1.5137 3.1691-.9088 8.5727-5.615 10.728-9.3431 3.192-5.5215 7.5241-8.5901 12.516-8.8657 1.3396-.074 2.6532.01 3.3914.2166 1.585.4437 3.5318 2.2009 3.7762 3.4083.1003.4954.3584.9822.5736 1.0817 1.6112.7453 1.9862 1.0047 2.0682 1.4307.051.2665-.9529 2.6236-2.2318 5.238-1.8799 3.8432-2.328 4.9899-2.3404 5.9886l-.015 1.2352.9261.077c1.132.094 3.2883-1.1349 5.6894-3.243 2.3304-2.0459 3.4794-3.659 6.2257-8.7403 1.3371-2.4739 2.6529-4.8096 2.924-5.1906.7068-.9931 1.8337-1.3742 3.6712-1.2413 1.7839.1291 2.6563.7039 2.6563 1.7502 0 .3631-1.6536 3.8273-3.6747 7.698-3.6147 6.9231-4.2241 8.2285-3.8408 8.2285.3864 0 2.6593-1.4351 4.2082-2.6571 2.9724-2.3449 4.1289-3.8334 6.7129-8.64 3.2167-5.9836 4.0513-6.6961 7.4599-6.3685 1.5037.1444 2.3637.7781 2.3637 1.7416 0 .6971-3.7642 8.1283-7.3844 14.5783-1.1774 2.0975-2.1406 3.9288-2.1406 4.0695 0 1.0032 6.4569-2.0079 10.373-4.8373 1.75083-1.265 2.80833-1.8553 3.32363-1.8553.8396 0 1.9138.8456 1.9138 1.5065 0 1.6136-6.83683 5.3607-15.31743 8.3952l-3.0144 1.0785-3.1147 4.959c-6.6125 10.5277-11.2414 15.4863-16.0267 17.1682-1.6492.5797-2.5036.6042-3.8855.1114zm3.4676-4.0874c2.3533-1.2035 5.0029-4.3759 7.0335-8.4211 1.4729-2.9341 1.2858-3.2801-1.0497-1.9405-2.6054 1.4944-6.0792 5.1835-7.6115 8.0833-1.3391 2.5343-.6792 3.458 1.6277 2.2783zm-13.7433-25.7067c2.0798-1.3888 2.707-2.2251 5.1929-6.9235 1.1337-2.1427 2.4702-4.3736 2.9701-4.9576.4999-.5839.8343-1.1823.7432-1.3297-.3028-.49-1.5733-.2724-2.9201.5001-3.9 2.237-10.6318 12.1845-9.2087 13.6076.4489.4489 1.7491.087 3.2226-.8969zm-39.6413-6.7383c1.4951-.7532 3.4914-2.3885 4.373-3.5822.8778-1.1886.8303-2.7169-.089-2.8472-.9504-.1348-2.84 1.147-4.3353 2.9408-1.4368 1.7237-2.8652 3.8321-2.8652 4.2293 0 .3431 1.5421-.048 2.916-.7407zm-15.7519 34.9397c-7.7618-1.6901-14.6809-7.6649-17.3519-14.9834-1.0082-2.7626-2.5946-8.8926-3.6898-14.2584-.7621-3.7334-1.4567-5.8195-2.0623-6.1938-.1258-.078-.173.4384-.1049 1.147l.1238 1.2883-2.6916 5.648c-3.9954 8.3841-5.3958 10.566-7.4555 11.6168-1.4222.7256-3.7417.6896-5.2712-.082-1.0729-.541-1.1779-.6797-1.1514-1.5213.017-.5465.8143-2.6067 1.945-5.0271 3.1568-6.7568 12.4018-25.1754 13.3068-26.5105 1.1089-1.6358 2.3136-2.186 4.3772-1.9989 1.8988.1722 3.7575 1.0556 3.7575 1.7858 0 .685-.9801 3.23-2.4839 6.4499-.6712 1.437-1.2203 2.6574-1.2203 2.712 0 .2508 2.423.059 3.8048-.3005 2.1083-.5492 3.5885-1.4764 5.2895-3.3138 2.9831-3.2221 3.5133-7.5609 1.1835-9.6842-3.8351-3.4952-12.7275-2.9971-21.5226 1.2055-6.4797 3.0962-10.7971 8.141-11.8606 13.8587-.5183 2.7868-1.354 3.618-2.8384 2.8236-2.234-1.1956-1.5337-5.997 1.651-11.3196 5.1483-8.6044 15.656-14.9768 26.6996-16.192 9.3582-1.0298 17.2345 3.5198 17.8697 10.322.3469 3.7147-1.5827 8.0493-5.1855 11.6487-2.6104 2.6078-4.969 3.9861-7.9877 4.6679l-1.94.4381.8512.2875c1.5709.5307 1.8619 1.0923 3.1019 5.988 2.5245 9.9665 4.9471 14.9264 9.4592 19.3659 6.055 5.9576 14.0611 6.1192 19.4354.3922.7131-.7598 2.2084-2.7055 3.323-4.3238 1.1145-1.6182 2.2218-3.0172 2.4606-3.1088 2.1176-.8126 2.9615 1.5236 1.6137 4.4675-2.2327 4.877-6.6161 9.1629-11.4944 11.2387-4.1481 1.7652-9.8251 2.3621-13.9414 1.4657z"),b(e,"class","relay-text svelte-ycfe1d"),b(e,"width",o[0]),b(e,"height",o[1]),b(e,"viewBox","0 0 154.24573 66.293579"),b(e,"xmlns","http://www.w3.org/2000/svg")},m(r,n){T(r,e,n),k(e,t)},p:X,i:X,o:X,d(r){r&&C(e)}}}function P2(o,e,t){let{size:r=64}=e,n=r,s=r/2;return o.$$set=a=>{"size"in a&&t(2,r=a.size)},[n,s,r]}var Nd=class extends Z{constructor(e){super(),ee(this,e,P2,D2,Q,{size:2},T2)}},Ol=Nd;function A2(o){De(o,"svelte-120r7kg",".subtitle.svelte-120r7kg{color:var(--text-muted);font-size:1.25rem;margin:0}.description.svelte-120r7kg{color:var(--text-muted);font-size:1rem;max-width:480px;margin:0}")}function E2(o){let e,t,r,n,s,a;return e=new Ol({props:{size:140}}),{c(){V(e.$$.fragment),t=B(),r=D("p"),r.textContent="Real-time collaboration in Obsidian",n=B(),s=D("p"),s.textContent=`Share folders with your team, edit together in real time, and keep your
	knowledge library exactly how you want it.`,b(r,"class","subtitle svelte-120r7kg"),b(s,"class","description svelte-120r7kg")},m(i,l){N(e,i,l),T(i,t,l),T(i,r,l),T(i,n,l),T(i,s,l),a=!0},p:X,i(i){a||(I(e.$$.fragment,i),a=!0)},o(i){P(e.$$.fragment,i),a=!1},d(i){i&&(C(t),C(r),C(n),C(s)),H(e,i)}}}var Hd=class extends Z{constructor(e){super(),ee(this,e,null,E2,Q,{},A2)}},Yx=Hd;var Ul=require("obsidian");function M2(o){De(o,"svelte-1kvxms3",`.help-section.svelte-1kvxms3{width:100%;padding:0 2rem;margin-bottom:2rem}.footer.svelte-1kvxms3{padding:0 2rem;margin-bottom:2rem;text-align:center}.help-container.svelte-1kvxms3{position:relative;max-width:640px;margin:0 auto}.why-google.svelte-1kvxms3:hover{background-color:transparent !important;box-shadow:none;color:var(--text-modifier-hover)}.why-google.svelte-1kvxms3{outline:0;color:var(--text-muted);font-size:0.875rem;margin:0;background-color:transparent !important;box-shadow:none;text-decoration-line:var(--link-decoration);padding:0;border:none;cursor:pointer;width:100%;text-align:left}.why-google.svelte-1kvxms3:hover{color:var(--text-normal)}.help-content.svelte-1kvxms3{margin-top:8px;padding:12px 16px;background:var(--color-base-05);border-radius:4px;font-size:0.9em;color:var(--text-muted);box-shadow:inset 0 1px 3px rgba(0, 0, 0, 0.1);text-align:left}.popover.svelte-1kvxms3{position:absolute;z-index:50;width:256px;padding-left:1em;padding-right:1em;font-size:0.875rem;background-color:var(--background-primary);border:1px solid var(--background-modifier-border);border-radius:4px;box-shadow:var(--shadow-s);top:calc(100% + 8px);text-align:left;left:50%;transform:translateX(-50%);opacity:0;visibility:hidden;transition:opacity 0.3s ease,
			visibility 0.3s ease;transition-delay:0.1s}.popover.visible.svelte-1kvxms3{opacity:1;visibility:visible}.popover.svelte-1kvxms3:not(.visible){transition-delay:0s}.arrow.svelte-1kvxms3{position:absolute;width:8px;height:8px;background-color:var(--background-primary);border-top:1px solid var(--background-modifier-border);border-left:1px solid var(--background-modifier-border);transform:rotate(45deg);top:-5px;right:40px}.discord-link.svelte-1kvxms3{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;color:var(--text-muted);font-size:0.875rem;margin:0}`)}function R2(o){let e,t,r,n;return{c(){e=D("div"),t=D("div"),r=B(),n=D("p"),n.textContent=`${Xx}`,b(t,"class","arrow svelte-1kvxms3"),b(e,"class","popover svelte-1kvxms3"),ze(e,"visible",o[0])},m(s,a){T(s,e,a),k(e,t),k(e,r),k(e,n),o[9](e)},p(s,a){a&1&&ze(e,"visible",s[0])},d(s){s&&C(e),o[9](null)}}}function F2(o){let e,t=o[0]&&Jx(o);return{c(){t&&t.c(),e=Ce()},m(r,n){t&&t.m(r,n),T(r,e,n)},p(r,n){r[0]?t?t.p(r,n):(t=Jx(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(r){r&&C(e),t&&t.d(r)}}}function Jx(o){let e,t;return{c(){e=D("div"),t=D("p"),t.textContent=`${Xx}`,b(e,"class","help-content svelte-1kvxms3")},m(r,n){T(r,e,n),k(e,t)},p:X,d(r){r&&C(e)}}}function O2(o){let e,t,r,n,s,a,i,l,c,u,d,m;function x(w,_){return w[1]?F2:R2}let h=x(o,-1),v=h(o);return l=new Fl({}),{c(){e=D("div"),t=D("div"),r=D("button"),r.textContent="Why sign in with Google?",n=B(),v.c(),s=B(),a=D("div"),i=D("a"),V(l.$$.fragment),c=K(`
		Join the project on Discord`),b(r,"class","why-google svelte-1kvxms3"),ze(r,"mobile",o[1]),b(t,"class","help-container svelte-1kvxms3"),b(e,"class","help-section svelte-1kvxms3"),b(i,"href","https://discord.system3.md"),b(i,"class","discord-link svelte-1kvxms3"),b(a,"class","footer svelte-1kvxms3")},m(w,_){T(w,e,_),k(e,t),k(t,r),o[8](r),k(t,n),v.m(t,null),T(w,s,_),T(w,a,_),k(a,i),N(l,i,null),k(i,c),u=!0,d||(m=[re(r,"mouseenter",o[4]),re(r,"mouseleave",o[5]),re(r,"click",o[6])],d=!0)},p(w,[_]){(!u||_&2)&&ze(r,"mobile",w[1]),h===(h=x(w,_))&&v?v.p(w,_):(v.d(1),v=h(w),v&&(v.c(),v.m(t,null)))},i(w){u||(I(l.$$.fragment,w),u=!0)},o(w){P(l.$$.fragment,w),u=!1},d(w){w&&(C(e),C(s),C(a)),o[8](null),v.d(),H(l),d=!1,ke(m)}}}var Xx="We require sign-in because your vault needs to communicate securely with Relay servers for syncing. An identity provider like Google helps to prevent spam accounts. We may add more sign-in options based on user feedback \u2014 let us know in Discord.";function U2(o,e,t){var r;let n=!1,s=!1,a,i;function l(){s||t(0,n=!0)}function c(){s||t(0,n=!1)}function u(){s&&t(0,n=!n)}function d(x){Ar[x?"unshift":"push"](()=>{a=x,t(2,a)})}function m(x){Ar[x?"unshift":"push"](()=>{i=x,t(3,i)})}return o.$$.update=()=>{if(o.$$.dirty&128){e:t(1,s=t(7,r=Ul.Platform===null||Ul.Platform===void 0?void 0:Ul.Platform.isMobile)!==null&&r!==void 0?r:!1)}},[n,s,a,i,l,c,u,r,d,m]}var Vd=class extends Z{constructor(e){super(),ee(this,e,U2,O2,Q,{},M2)}},Qx=Vd;var Zx=[{color:"#30bced",light:"#30bced33"},{color:"#6eeb83",light:"#6eeb8333"},{color:"#ffbc42",light:"#ffbc4233"},{color:"#ecd444",light:"#ecd44433"},{color:"#ee6352",light:"#ee635233"},{color:"#9ac2c9",light:"#9ac2c933"},{color:"#8acb88",light:"#8acb8833"},{color:"#1be7ff",light:"#1be7ff33"}],$l=class{constructor(e,t,r,n,s){this.id=e;this.name=t;this.email=r;this.picture=n;this.token=s;this.color=Zx[ua()%Zx.length]}};function $2(o){De(o,"svelte-1ym1y1w",".avatar.svelte-1ym1y1w{position:relative;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;background-color:var(--color-base-30)}.initial.svelte-1ym1y1w{color:var(--text-on-accent)}img.svelte-1ym1y1w{width:100%;height:100%;object-fit:cover}")}function B2(o){let e,t;return{c(){e=D("span"),t=K(o[5]),b(e,"class","initial svelte-1ym1y1w"),ue(e,"font-size",o[4])},m(r,n){T(r,e,n),k(e,t)},p(r,n){n&32&&se(t,r[5]),n&16&&ue(e,"font-size",r[4])},d(r){r&&C(e)}}}function N2(o){let e,t,r,n;return{c(){e=D("img"),pu(e.src,t=o[0].picture)||b(e,"src",t),b(e,"alt",o[1]),b(e,"class","svelte-1ym1y1w")},m(s,a){T(s,e,a),r||(n=re(e,"error",o[6]),r=!0)},p(s,a){a&1&&!pu(e.src,t=s[0].picture)&&b(e,"src",t),a&2&&b(e,"alt",s[1])},d(s){s&&C(e),r=!1,n()}}}function H2(o){let e;function t(s,a){return!s[3]&&s[0].picture?N2:B2}let r=t(o,-1),n=r(o);return{c(){e=D("div"),n.c(),b(e,"class","avatar svelte-1ym1y1w"),ue(e,"width",o[2]),ue(e,"height",o[2])},m(s,a){T(s,e,a),n.m(e,null)},p(s,[a]){r===(r=t(s,a))&&n?n.p(s,a):(n.d(1),n=r(s),n&&(n.c(),n.m(e,null))),a&4&&ue(e,"width",s[2]),a&4&&ue(e,"height",s[2])},i:X,o:X,d(s){s&&C(e),n.d()}}}function V2(o){var e;return((e=o.match(/[a-z]+$/i))===null||e===void 0?void 0:e[0])||"px"}function q2(o,e,t){let r,n,s,{user:a}=e,{alt:i="Profile picture"}=e,{size:l="40px"}=e,c=!1;function u(){t(3,c=!0)}return o.$$set=d=>{"user"in d&&t(0,a=d.user),"alt"in d&&t(1,i=d.alt),"size"in d&&t(2,l=d.size)},o.$$.update=()=>{if(o.$$.dirty&1){e:t(5,r=a.name?a.name.charAt(0).toUpperCase():"?")}if(o.$$.dirty&4){e:t(7,n=V2(l))}if(o.$$.dirty&132){e:t(4,s=`${parseFloat(l)/2}${n}`)}},[a,i,l,c,s,r,u,n]}var qd=class extends Z{constructor(e){super(),ee(this,e,q2,H2,Q,{user:0,alt:1,size:2},$2)}},ey=qd;function W2(o){let e,t,r,n,s,a=(o[0].name||"")+"",i,l,c,u,d=(o[0].email||"")+"",m,x,h,v;t=new ey({props:{size:"2.5em",user:o[0]}});let w=o[2].default,_=he(w,o,o[1],null);return{c(){e=D("div"),V(t.$$.fragment),r=B(),n=D("div"),s=D("div"),i=K(a),l=B(),c=D("br"),u=B(),m=K(d),x=B(),h=D("div"),_&&_.c(),b(s,"class","setting-item-description"),b(n,"class","setting-item-info"),ue(n,"display","grid"),b(h,"class","setting-item-control"),b(e,"class","setting-item")},m(A,U){T(A,e,U),N(t,e,null),k(e,r),k(e,n),k(n,s),k(s,i),k(s,l),k(s,c),k(s,u),k(s,m),k(e,x),k(e,h),_&&_.m(h,null),v=!0},p(A,[U]){let L={};U&1&&(L.user=A[0]),t.$set(L),(!v||U&1)&&a!==(a=(A[0].name||"")+"")&&se(i,a),(!v||U&1)&&d!==(d=(A[0].email||"")+"")&&se(m,d),_&&_.p&&(!v||U&2)&&xe(_,w,A,A[1],v?ge(w,A[1],U,null):ye(A[1]),null)},i(A){v||(I(t.$$.fragment,A),I(_,A),v=!0)},o(A){P(t.$$.fragment,A),P(_,A),v=!1},d(A){A&&C(e),H(t),_&&_.d(A)}}}function z2(o,e,t){let{$$slots:r={},$$scope:n}=e,{user:s}=e;return o.$$set=a=>{"user"in a&&t(0,s=a.user),"$$scope"in a&&t(1,n=a.$$scope)},[s,n,r]}var Wd=class extends Z{constructor(e){super(),ee(this,e,z2,W2,Q,{user:0})}},ty=Wd;var Bl=require("obsidian");function K2(o){De(o,"svelte-5zjjwa",".help-container.svelte-5zjjwa{position:relative;display:inline-block}button.svelte-5zjjwa{display:flex;align-items:center;justify-content:center;width:24px;height:24px;padding:2px;margin:0;background:transparent;border:none;color:var(--text-muted);box-shadow:none;border-radius:50%}button.svelte-5zjjwa:hover{box-shadow:none;color:var(--icon-color-hover);opacity:var(--icon-opacity-hover);background-color:transparent;border-radius:0}button.svelte-5zjjwa:focus{outline:none;box-shadow:none;color:var(--icon-color-focus)}.popover.svelte-5zjjwa{position:absolute;z-index:50;width:256px;padding:8px;font-size:0.875rem;background-color:var(--background-primary);border:1px solid var(--background-modifier-border);border-radius:4px;box-shadow:var(--shadow-s);top:32px;transition-delay:0.1s}.popover.left.svelte-5zjjwa{right:100%;margin-right:8px}.popover.right.svelte-5zjjwa{left:0}.arrow.svelte-5zjjwa{position:absolute;width:8px;height:8px;background-color:var(--background-primary);border-top:1px solid var(--background-modifier-border);border-left:1px solid var(--background-modifier-border);transform:rotate(45deg);top:-5px}.arrow.left.svelte-5zjjwa{right:8px}.arrow.right.svelte-5zjjwa{left:8px}p.svelte-5zjjwa{margin:0;color:var(--text-normal)}")}function ry(o){let e,t,r,n,s;return{c(){e=D("div"),t=D("div"),r=B(),n=D("p"),s=K(o[0]),b(t,"class","arrow svelte-5zjjwa"),ze(t,"left",o[4]==="left"),ze(t,"right",o[4]==="right"),b(n,"class","svelte-5zjjwa"),b(e,"class","popover svelte-5zjjwa"),ze(e,"left",o[4]==="left"),ze(e,"right",o[4]==="right")},m(a,i){T(a,e,i),k(e,t),k(e,r),k(e,n),k(n,s),o[9](e)},p(a,i){i&16&&ze(t,"left",a[4]==="left"),i&16&&ze(t,"right",a[4]==="right"),i&1&&se(s,a[0]),i&16&&ze(e,"left",a[4]==="left"),i&16&&ze(e,"right",a[4]==="right")},d(a){a&&C(e),o[9](null)}}}function G2(o){let e,t,r,n,s,a,i;r=new Oa({props:{size:16}});let l=o[1]&&ry(o);return{c(){e=D("div"),t=D("button"),V(r.$$.fragment),n=B(),l&&l.c(),b(t,"type","button"),b(t,"class","svelte-5zjjwa"),b(e,"class","help-container svelte-5zjjwa")},m(c,u){T(c,e,u),k(e,t),N(r,t,null),o[8](t),k(e,n),l&&l.m(e,null),s=!0,a||(i=[re(t,"mouseenter",o[5]),re(t,"mouseleave",o[6]),re(t,"click",o[7])],a=!0)},p(c,[u]){c[1]?l?l.p(c,u):(l=ry(c),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i(c){s||(I(r.$$.fragment,c),s=!0)},o(c){P(r.$$.fragment,c),s=!1},d(c){c&&C(e),H(r),o[8](null),l&&l.d(),a=!1,ke(i)}}}function j2(o,e,t){let{helpText:r}=e,n=!1,s="right",a,i;function l(){t(1,n=!0)}function c(){t(1,n=!1)}function u(){t(1,n=!n)}function d(x){Ar[x?"unshift":"push"](()=>{a=x,t(2,a)})}function m(x){Ar[x?"unshift":"push"](()=>{i=x,t(3,i)})}return o.$$set=x=>{"helpText"in x&&t(0,r=x.helpText)},o.$$.update=()=>{if(o.$$.dirty&14){e:if(n&&a&&i){let x=a.getBoundingClientRect(),h=i.getBoundingClientRect(),v=window.innerWidth;t(4,s=x.right+h.width>v-20?"left":"right")}}},[r,n,a,i,s,l,c,u,d,m]}var zd=class extends Z{constructor(e){super(),ee(this,e,j2,G2,Q,{helpText:0},K2)}},oy=zd;function Y2(o){De(o,"svelte-1v3t6m3",".setting-item-name.svelte-1v3t6m3{display:flex;align-items:center;gap:8px}.help-button.svelte-1v3t6m3{display:flex;align-items:center;justify-content:center;width:24px;height:24px;padding:2px !important;margin:0;background:transparent;border:none;color:var(--text-muted);border-radius:50%;-webkit-tap-highlight-color:transparent}@media(hover: hover){.help-button.svelte-1v3t6m3:hover{box-shadow:none;color:var(--text-normal);background:transparent;border-radius:0}}.help-button.svelte-1v3t6m3:active{color:var(--text-normal)}.help-content.svelte-1v3t6m3{margin-top:8px;padding:12px 16px;background:var(--color-base-05);border-radius:4px;font-size:0.9em;color:var(--text-muted);box-shadow:inset 0 1px 3px rgba(0, 0, 0, 0.1)}p.svelte-1v3t6m3{margin:0}")}var J2=o=>({}),ny=o=>({}),X2=o=>({}),sy=o=>({}),Q2=o=>({}),ay=o=>({});function Z2(o){let e;return{c(){e=K(o[0])},m(t,r){T(t,e,r)},p(t,r){r&1&&se(e,t[0])},d(t){t&&C(e)}}}function iy(o){let e,t,r,n,s=[tT,eT],a=[];function i(l,c){return l[3]?0:1}return e=i(o,-1),t=a[e]=s[e](o),{c(){t.c(),r=Ce()},m(l,c){a[e].m(l,c),T(l,r,c),n=!0},p(l,c){let u=e;e=i(l,c),e===u?a[e].p(l,c):(be(),P(a[u],1,1,()=>{a[u]=null}),we(),t=a[e],t?t.p(l,c):(t=a[e]=s[e](l),t.c()),I(t,1),t.m(r.parentNode,r))},i(l){n||(I(t),n=!0)},o(l){P(t),n=!1},d(l){l&&C(r),a[e].d(l)}}}function eT(o){let e,t;return e=new oy({props:{helpText:o[1]}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&2&&(s.helpText=r[1]),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function tT(o){let e,t,r,n,s;return t=new Oa({props:{size:16}}),{c(){e=D("button"),V(t.$$.fragment),b(e,"class","help-button svelte-1v3t6m3"),b(e,"aria-expanded",o[2])},m(a,i){T(a,e,i),N(t,e,null),r=!0,n||(s=re(e,"click",o[4]),n=!0)},p(a,i){(!r||i&4)&&b(e,"aria-expanded",a[2])},i(a){r||(I(t.$$.fragment,a),r=!0)},o(a){P(t.$$.fragment,a),r=!1},d(a){a&&C(e),H(t),n=!1,s()}}}function rT(o){let e,t,r=o[7].description,n=he(r,o,o[6],ny);return{c(){e=D("div"),n&&n.c(),b(e,"class","setting-item-description")},m(s,a){T(s,e,a),n&&n.m(e,null),t=!0},p(s,a){n&&n.p&&(!t||a&64)&&xe(n,r,s,s[6],t?ge(r,s[6],a,J2):ye(s[6]),ny)},i(s){t||(I(n,s),t=!0)},o(s){P(n,s),t=!1},d(s){s&&C(e),n&&n.d(s)}}}function ly(o){let e,t,r;return{c(){e=D("div"),t=D("p"),r=K(o[1]),b(t,"class","svelte-1v3t6m3"),b(e,"class","help-content svelte-1v3t6m3"),ze(e,"expanded",o[2])},m(n,s){T(n,e,s),k(e,t),k(t,r)},p(n,s){s&2&&se(r,n[1]),s&4&&ze(e,"expanded",n[2])},d(n){n&&C(e)}}}function oT(o){let e,t,r,n,s,a,i,l,c,u=o[7].name,d=he(u,o,o[6],ay),m=d||Z2(o),x=o[1]&&iy(o),h=o[7].description,v=he(h,o,o[6],sy),w=v||rT(o),_=o[1]&&o[2]&&o[3]&&ly(o),A=o[7].default,U=he(A,o,o[6],null);return{c(){e=D("div"),t=D("div"),r=D("div"),m&&m.c(),n=B(),x&&x.c(),s=B(),w&&w.c(),a=B(),_&&_.c(),i=B(),l=D("div"),U&&U.c(),b(r,"class","setting-item-name svelte-1v3t6m3"),b(t,"class","setting-item-info"),b(l,"class","setting-item-control"),b(e,"class","setting-item setting-item-heading")},m(L,R){T(L,e,R),k(e,t),k(t,r),m&&m.m(r,null),k(r,n),x&&x.m(r,null),k(t,s),w&&w.m(t,null),k(t,a),_&&_.m(t,null),k(e,i),k(e,l),U&&U.m(l,null),c=!0},p(L,[R]){d?d.p&&(!c||R&64)&&xe(d,u,L,L[6],c?ge(u,L[6],R,Q2):ye(L[6]),ay):m&&m.p&&(!c||R&1)&&m.p(L,c?R:-1),L[1]?x?(x.p(L,R),R&2&&I(x,1)):(x=iy(L),x.c(),I(x,1),x.m(r,null)):x&&(be(),P(x,1,1,()=>{x=null}),we()),v?v.p&&(!c||R&64)&&xe(v,h,L,L[6],c?ge(h,L[6],R,X2):ye(L[6]),sy):w&&w.p&&(!c||R&64)&&w.p(L,c?R:-1),L[1]&&L[2]&&L[3]?_?_.p(L,R):(_=ly(L),_.c(),_.m(t,null)):_&&(_.d(1),_=null),U&&U.p&&(!c||R&64)&&xe(U,A,L,L[6],c?ge(A,L[6],R,null):ye(L[6]),null)},i(L){c||(I(m,L),I(x),I(w,L),I(U,L),c=!0)},o(L){P(m,L),P(x),P(w,L),P(U,L),c=!1},d(L){L&&C(e),m&&m.d(L),x&&x.d(),w&&w.d(L),_&&_.d(),U&&U.d(L)}}}function nT(o,e,t){let{$$slots:r={},$$scope:n}=e;var s;let{name:a=""}=e,{helpText:i=void 0}=e,l=!1,c=!1;function u(){c&&t(2,l=!l)}return o.$$set=d=>{"name"in d&&t(0,a=d.name),"helpText"in d&&t(1,i=d.helpText),"$$scope"in d&&t(6,n=d.$$scope)},o.$$.update=()=>{if(o.$$.dirty&32){e:t(3,c=t(5,s=Bl.Platform===null||Bl.Platform===void 0?void 0:Bl.Platform.isMobile)!==null&&s!==void 0?s:!1)}},[a,i,l,c,u,s,n,r]}var Kd=class extends Z{constructor(e){super(),ee(this,e,nT,oT,Q,{name:0,helpText:1},Y2)}},Je=Kd;var Vs=[];function sT(o,e){return{subscribe:_e(o,e).subscribe}}function _e(o,e=X){let t,r=new Set;function n(i){if(Q(o,i)&&(o=i,t)){let l=!Vs.length;for(let c of r)c[1](),Vs.push(c,o);if(l){for(let c=0;c<Vs.length;c+=2)Vs[c][0](Vs[c+1]);Vs.length=0}}}function s(i){n(i(o))}function a(i,l=X){let c=[i,l];return r.add(c),r.size===1&&(t=e(n,s)||X),i(o),()=>{r.delete(c),r.size===0&&t&&(t(),t=null)}}return{set:n,update:s,subscribe:a}}function lo(o,e,t){let r=!Array.isArray(o),n=r?[o]:o;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");let s=e.length<2;return sT(t,(a,i)=>{let l=!1,c=[],u=0,d=X,m=()=>{if(u)return;d();let h=e(r?c[0]:c,a,i);s?a(h):d=ut(h)?h:X},x=n.map((h,v)=>Qt(h,w=>{c[v]=w,u&=~(1<<v),l&&m()},()=>{u|=1<<v}));return l=!0,m(),function(){ke(x),d(),l=!1}})}var hy=require("obsidian"),gy=require("obsidian");if(globalThis.Response===void 0||globalThis.Headers===void 0)try{if(console.warn("[Relay] Polyfilling Fetch API (Electron Bug: https://github.com/electron/electron/pull/42419)"),globalThis.blinkfetch){globalThis.fetch=globalThis.blinkFetch;let o=["fetch","Response","FormData","Request","Headers"];for(let e of o)globalThis[e]=globalThis[`blink${e}`]}}catch(o){console.error(o)}globalThis.EventSource===void 0&&(gy.Platform.isMobile?console.warn("[Relay] Polyfilling EventSource API required, but unable to polyfill on Mobile"):(console.warn("[Relay] Polyfilling EventSource API"),globalThis.EventSource=my()));var xr=async(o,e)=>{let t=o instanceof URL?o.toString():o,r=(e==null?void 0:e.method)||"GET",n=Object.assign({},e==null?void 0:e.headers,{"Relay-Version":"0.4.8"}),s={url:t,method:r,body:e==null?void 0:e.body,headers:n,throw:!1},a;if(a=await(0,hy.requestUrl)(s),!a.arrayBuffer.byteLength)return new Response(null,{status:a.status,statusText:a.status.toString(),headers:new Headers(a.headers)});let i=new Response(a.arrayBuffer,{status:a.status,statusText:a.status.toString(),headers:new Headers(a.headers)});Object.defineProperty(i,"json",{value:async()=>JSON.parse(a.text)});let c=a.status>=500?"error":a.status>=400?"warn":"debug",u=a.text,d;try{d=JSON.parse(u)}catch(m){}if(Le("[CustomFetch]",c)(a.status.toString(),r,t,d||u),a.status>=500)throw new Error(u);return i};function yT(o){De(o,"svelte-xcpzqp",`.continue.svelte-xcpzqp{font-weight:600;font-size:larger;margin-top:0;margin-bottom:0px}.link.svelte-xcpzqp{color:var(--text-muted)}.link.svelte-xcpzqp:hover{color:var(--text-normal)}.not-working.svelte-xcpzqp{margin-top:0px;margin-bottom:0px;color:var(--text-faint);font-size:0.75em}.link-button.svelte-xcpzqp{box-shadow:none;background:none;border:none;padding:0;font:inherit;text-decoration:underline}button.link-button.svelte-xcpzqp:hover{box-shadow:none;color:var(--text-normal)}button.link.link-button.svelte-xcpzqp{height:auto;padding:0;color:var(--text-faint)}.welcome.svelte-xcpzqp{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:7rem 2rem 1rem 2rem;max-width:640px;margin:0 auto;gap:2rem}.google-sign-in-button.svelte-xcpzqp{height:unset;padding:12px 16px 12px 42px !important;border:none;border-radius:3px;box-shadow:0 -1px 0 rgba(0, 0, 0, 0.04),
			0 1px 1px rgba(0, 0, 0, 0.25);color:var(--text-color);font-size:14px;font-weight:500;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
			Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMTcuNiA5LjJsLS4xLTEuOEg5djMuNGg0LjhDMTMuNiAxMiAxMyAxMyAxMiAxMy42djIuMmgzYTguOCA4LjggMCAwIDAgMi42LTYuNnoiIGZpbGw9IiM0Mjg1RjQiIGZpbGwtcnVsZT0ibm9uemVybyIvPjxwYXRoIGQ9Ik05IDE4YzIuNCAwIDQuNS0uOCA2LTIuMmwtMy0yLjJhNS40IDUuNCAwIDAgMS04LTIuOUgxVjEzYTkgOSAwIDAgMCA4IDV6IiBmaWxsPSIjMzRBODUzIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48cGF0aCBkPSJNNCAxMC43YTUuNCA1LjQgMCAwIDEgMC0zLjRWNUgxYTkgOSAwIDAgMCAwIDhsMy0yLjN6IiBmaWxsPSIjRkJCQzA1IiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48cGF0aCBkPSJNOSAzLjZjMS4zIDAgMi41LjQgMy40IDEuM0wxNSAyLjNBOSA5IDAgMCAwIDEgNWwzIDIuNGE1LjQgNS40IDAgMCAxIDUtMy43eiIgZmlsbD0iI0VBNDMzNSIgZmlsbC1ydWxlPSJub256ZXJvIi8+PHBhdGggZD0iTTAgMGgxOHYxOEgweiIvPjwvZz48L3N2Zz4=);background-color:var(--background-secondary);background-repeat:no-repeat;background-position:12px 11px}.google-sign-in-button.svelte-xcpzqp:hover{box-shadow:0 -1px 0 rgba(0, 0, 0, 0.04),
			0 2px 4px rgba(0, 0, 0, 0.25)}.google-sign-in-button.svelte-xcpzqp:disabled{cursor:unset;filter:grayscale(100%);box-shadow:0 -1px 0 rgba(0, 0, 0, 0.04),
			0 1px 1px rgba(0, 0, 0, 0.25)}`)}function bT(o){let e,t,r,n,s,a,i;t=new Yx({});function l(h,v){return h[3]?vT:_T}let c=l(o,[-1,-1]),u=c(o);function d(h,v){if(h[5])return kT;if(h[4])return ST}let m=d(o,[-1,-1]),x=m&&m(o);return a=new Qx({}),{c(){e=D("div"),V(t.$$.fragment),r=B(),u.c(),n=B(),x&&x.c(),s=B(),V(a.$$.fragment),b(e,"class","welcome svelte-xcpzqp")},m(h,v){T(h,e,v),N(t,e,null),k(e,r),u.m(e,null),k(e,n),x&&x.m(e,null),T(h,s,v),N(a,h,v),i=!0},p(h,v){c===(c=l(h,v))&&u?u.p(h,v):(u.d(1),u=c(h),u&&(u.c(),u.m(e,n))),m===(m=d(h,v))&&x?x.p(h,v):(x&&x.d(1),x=m&&m(h),x&&(x.c(),x.m(e,null)))},i(h){i||(I(t.$$.fragment,h),I(a.$$.fragment,h),i=!0)},o(h){P(t.$$.fragment,h),P(a.$$.fragment,h),i=!1},d(h){h&&(C(e),C(s)),H(t),u.d(),x&&x.d(),H(a,h)}}}function wT(o){let e,t,r,n,s,a,i;e=new Je({props:{$$slots:{name:[IT],default:[LT]},$$scope:{ctx:o}}}),r=new Je({props:{name:"Account"}}),s=new ty({props:{user:o[2].user,$$slots:{default:[CT]},$$scope:{ctx:o}}});let l=o[18].default,c=he(l,o,o[25],null);return{c(){V(e.$$.fragment),t=B(),V(r.$$.fragment),n=B(),V(s.$$.fragment),a=B(),c&&c.c()},m(u,d){N(e,u,d),T(u,t,d),N(r,u,d),T(u,n,d),N(s,u,d),T(u,a,d),c&&c.m(u,d),i=!0},p(u,d){let m={};d[0]&33554432&&(m.$$scope={dirty:d,ctx:u}),e.$set(m);let x={};d[0]&4&&(x.user=u[2].user),d[0]&33554432&&(x.$$scope={dirty:d,ctx:u}),s.$set(x),c&&c.p&&(!i||d[0]&33554432)&&xe(c,l,u,u[25],i?ge(l,u[25],d,null):ye(u[25]),null)},i(u){i||(I(e.$$.fragment,u),I(r.$$.fragment,u),I(s.$$.fragment,u),I(c,u),i=!0)},o(u){P(e.$$.fragment,u),P(r.$$.fragment,u),P(s.$$.fragment,u),P(c,u),i=!1},d(u){u&&(C(t),C(n),C(a)),H(e,u),H(r,u),H(s,u),c&&c.d(u)}}}function _T(o){let e,t,r,n,s;return{c(){e=D("a"),t=D("button"),r=K("Sign in with Google"),b(t,"class","google-sign-in-button svelte-xcpzqp"),t.disabled=o[4],b(e,"href",o[1]),b(e,"target","_blank")},m(a,i){T(a,e,i),k(e,t),k(t,r),n||(s=re(t,"click",o[21]),n=!0)},p(a,i){i[0]&16&&(t.disabled=a[4]),i[0]&2&&b(e,"href",a[1])},d(a){a&&C(e),n=!1,s()}}}function vT(o){let e,t,r,n;return{c(){e=D("button"),t=K("Sign in with Google"),b(e,"class","google-sign-in-button svelte-xcpzqp"),e.disabled=o[4]},m(s,a){T(s,e,a),k(e,t),r||(n=re(e,"click",(0,ln.debounce)(o[20])),r=!0)},p(s,a){a[0]&16&&(e.disabled=s[4])},d(s){s&&C(e),r=!1,n()}}}function ST(o){let e,t,r,n,s,a,i,l;return{c(){e=D("div"),t=D("p"),t.textContent="Continue in your browser...",r=B(),n=D("p"),s=K(`Not working?
					`),a=D("button"),a.textContent="(try again)",b(t,"class","continue svelte-xcpzqp"),b(a,"class","link link-button svelte-xcpzqp"),b(n,"class","not-working svelte-xcpzqp")},m(c,u){T(c,e,u),k(e,t),k(e,r),k(e,n),k(n,s),k(n,a),i||(l=re(a,"click",o[24]),i=!0)},p:X,d(c){c&&C(e),i=!1,l()}}}function kT(o){let e,t,r,n,s,a,i,l,c,u,d,m=o[6]&&xy(o);return{c(){e=D("p"),t=K(o[5]),r=K("."),n=D("br"),s=B(),m&&m.c(),a=B(),i=D("p"),l=K(`Not working?
				`),c=D("button"),c.textContent="(try again)",b(c,"class","link link-button svelte-xcpzqp"),b(i,"class","not-working svelte-xcpzqp")},m(x,h){T(x,e,h),k(e,t),k(e,r),k(e,n),k(e,s),m&&m.m(e,null),T(x,a,h),T(x,i,h),k(i,l),k(i,c),u||(d=re(c,"click",o[23]),u=!0)},p(x,h){h[0]&32&&se(t,x[5]),x[6]?m?m.p(x,h):(m=xy(x),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(x){x&&(C(e),C(a),C(i)),m&&m.d(),u=!1,d()}}}function xy(o){let e,t,r,n;return{c(){e=K("Already logged in? "),t=D("button"),t.textContent="(click here)",b(t,"class","link link-button svelte-xcpzqp")},m(s,a){T(s,e,a),T(s,t,a),r||(n=re(t,"click",(0,ln.debounce)(o[22])),r=!0)},p:X,d(s){s&&(C(e),C(t)),r=!1,n()}}}function LT(o){let e,t;return e=new jx({}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function IT(o){let e,t;return e=new Ol({props:{slot:"name"}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p:X,i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function CT(o){let e,t,r;return{c(){e=D("button"),e.textContent="Logout"},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,ln.debounce)(o[19])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function TT(o){let e,t,r,n,s=[wT,bT],a=[];function i(l,c){return l[2].hasUser&&l[2].user?0:1}return e=i(o,[-1,-1]),t=a[e]=s[e](o),{c(){t.c(),r=Ce()},m(l,c){a[e].m(l,c),T(l,r,c),n=!0},p(l,c){let u=e;e=i(l,c),e===u?a[e].p(l,c):(be(),P(a[u],1,1,()=>{a[u]=null}),we(),t=a[e],t?t.p(l,c):(t=a[e]=s[e](l),t.c()),I(t,1),t.m(r.parentNode,r))},i(l){n||(I(t),n=!0)},o(l){P(t),n=!1},d(l){l&&C(r),a[e].d(l)}}}function DT(o,e,t){let r,n,s,a=X,i=()=>(a(),a=Qt(v,fe=>t(2,s=fe)),v),l,c,u,d;o.$$.on_destroy.push(()=>a());let{$$slots:m={},$$scope:x}=e,{plugin:h}=e,v,w=_e(!ln.Platform.isIosApp);me(o,w,fe=>t(3,l=fe));let _=_e(!1);me(o,_,fe=>t(4,c=fe)),i(v=h.loginManager);let A=_e(!1);me(o,A,fe=>t(6,d=fe));let U=_e(!1),L=_e(!0);me(o,L,fe=>t(28,r=fe));let R=_e("please wait...");me(o,R,fe=>t(1,n=fe));let O,M,E=_e("");me(o,E,fe=>t(5,u=fe));function F(){return Ge(this,void 0,void 0,function*(){h.loginManager.logout(),U.set(!1),A.set(!1)})}function q(){return Ge(this,void 0,void 0,function*(){try{yield h.loginManager.login()}catch(fe){w.set(!1),U.set(!1),n&&n!=="please wait..."&&(window.open(n,"_blank"),W())}})}let J=_e(h.loginManager.pb);function G(){J.set(h.loginManager.pb)}function z(){try{let fe=r?xr:fetch;O=void 0,R.set("please wait..."),v.initiateManualOAuth2CodeFlow(fe).then(([te,$e,Lt])=>{O=$e,M=Lt,R.set(te)}).catch(te=>{let $e=te.message;throw $e=$e,E.set($e),U.set(!1),te})}catch(fe){E.set(fe.message)}}er(()=>{U.set(!1),z()});function W(){return Ge(this,void 0,void 0,function*(){if(!(!O||!M))return yield h.loginManager.poll(O,M).then(fe=>{U.set(!0),_.set(!1),E.set("")}).catch(fe=>{A.set(!0),_.set(!1),U.set(!1),E.set(fe.message)})})}function oe(fe){let te=fe.target;te.focus(),te.select(),navigator.clipboard.writeText(te.value).then(()=>new ln.Notice("Invite link copied")).catch($e=>{}),W()}let Ie=()=>{F()},Pe=async()=>{_.set(!0),await q()},Ee=()=>{_.set(!0),W()},Ye=()=>{W()},Fe=()=>{_.set(!1),w.set(!1),E.set(""),z()},de=()=>{_.set(!1),w.set(!1)};return o.$$set=fe=>{"plugin"in fe&&t(17,h=fe.plugin),"$$scope"in fe&&t(25,x=fe.$$scope)},[v,n,s,l,c,u,d,w,_,A,L,R,E,F,q,z,W,h,m,Ie,Pe,Ee,Ye,Fe,de,x]}var Gd=class extends Z{constructor(e){super(),ee(this,e,DT,TT,Q,{plugin:17},yT,[-1,-1])}},yy=Gd;function by(o,e,t){let r=o.slice();return r[5]=e[t],r}var PT=o=>({}),wy=o=>({}),AT=o=>({}),_y=o=>({});function ET(o){let e;return{c(){e=K(o[0])},m(t,r){T(t,e,r)},p(t,r){r&1&&se(e,t[0])},d(t){t&&C(e)}}}function MT(o){let e,t=Re(o[1]),r=[];for(let n=0;n<t.length;n+=1)r[n]=vy(by(o,t,n));return{c(){for(let n=0;n<r.length;n+=1)r[n].c();e=Ce()},m(n,s){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(n,s);T(n,e,s)},p(n,s){if(s&2){t=Re(n[1]);let a;for(a=0;a<t.length;a+=1){let i=by(n,t,a);r[a]?r[a].p(i,s):(r[a]=vy(i),r[a].c(),r[a].m(e.parentNode,e))}for(;a<r.length;a+=1)r[a].d(1);r.length=t.length}},d(n){n&&C(e),it(r,n)}}}function vy(o){let e;return{c(){e=D("div"),e.textContent=`${o[5]} `},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function RT(o){let e,t=o[1].length>0&&MT(o);return{c(){t&&t.c(),e=Ce()},m(r,n){t&&t.m(r,n),T(r,e,n)},p(r,n){r[1].length>0&&t.p(r,n)},d(r){r&&C(e),t&&t.d(r)}}}function FT(o){let e,t,r,n,s,a,i,l,c=o[4].name,u=he(c,o,o[3],_y),d=u||ET(o),m=o[4].description,x=he(m,o,o[3],wy),h=x||RT(o),v=o[4].default,w=he(v,o,o[3],null);return{c(){e=D("div"),t=D("div"),r=D("div"),d&&d.c(),n=B(),s=D("div"),h&&h.c(),a=B(),i=D("div"),w&&w.c(),b(r,"class","setting-item-name"),ue(r,"display","grid"),ue(r,"align-items","center"),b(s,"class","setting-item-description"),b(t,"class","setting-item-info"),ue(t,"display","grid"),b(i,"class","setting-item-control"),b(e,"class","setting-item")},m(_,A){T(_,e,A),k(e,t),k(t,r),d&&d.m(r,null),k(t,n),k(t,s),h&&h.m(s,null),k(e,a),k(e,i),w&&w.m(i,null),l=!0},p(_,[A]){u?u.p&&(!l||A&8)&&xe(u,c,_,_[3],l?ge(c,_[3],A,AT):ye(_[3]),_y):d&&d.p&&(!l||A&1)&&d.p(_,l?A:-1),x&&x.p&&(!l||A&8)&&xe(x,m,_,_[3],l?ge(m,_[3],A,PT):ye(_[3]),wy),w&&w.p&&(!l||A&8)&&xe(w,v,_,_[3],l?ge(v,_[3],A,null):ye(_[3]),null)},i(_){l||(I(d,_),I(h,_),I(w,_),l=!0)},o(_){P(d,_),P(h,_),P(w,_),l=!1},d(_){_&&C(e),d&&d.d(_),h&&h.d(_),w&&w.d(_)}}}function OT(o,e,t){let{$$slots:r={},$$scope:n}=e,{name:s=""}=e,{description:a}=e,i=a!==void 0?a.split(`
`):[];return o.$$set=l=>{"name"in l&&t(0,s=l.name),"description"in l&&t(2,a=l.description),"$$scope"in l&&t(3,n=l.$$scope)},[s,i,a,n,r]}var jd=class extends Z{constructor(e){super(),ee(this,e,OT,FT,Q,{name:0,description:2})}},He=jd;function UT(o){De(o,"svelte-tyruzk",".setting-item-control.svelte-tyruzk{width:unset !important;margin-top:unset !important}.setting-item.svelte-tyruzk{flex-direction:unset !important;align-items:flex-start}.setting-item-info.svelte-tyruzk{min-width:0;margin-top:auto;margin-bottom:auto}.setting-item-name.svelte-tyruzk{min-width:0}.truncate.svelte-tyruzk *{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}")}var $T=o=>({}),Sy=o=>({}),BT=o=>({}),ky=o=>({});function NT(o){let e;return{c(){e=K(o[0])},m(t,r){T(t,e,r)},p(t,r){r&1&&se(e,t[0])},d(t){t&&C(e)}}}function HT(o){let e,t,r,n,s,a,i,l=o[2].name,c=he(l,o,o[1],ky),u=c||NT(o),d=o[2].description,m=he(d,o,o[1],Sy),x=o[2].default,h=he(x,o,o[1],null);return{c(){e=D("div"),t=D("div"),r=D("div"),u&&u.c(),n=B(),m&&m.c(),s=B(),a=D("div"),h&&h.c(),b(r,"class","setting-item-name truncate svelte-tyruzk"),b(t,"class","setting-item-info svelte-tyruzk"),b(a,"class","setting-item-control svelte-tyruzk"),b(e,"class","setting-item svelte-tyruzk")},m(v,w){T(v,e,w),k(e,t),k(t,r),u&&u.m(r,null),k(e,n),m&&m.m(e,null),k(e,s),k(e,a),h&&h.m(a,null),i=!0},p(v,[w]){c?c.p&&(!i||w&2)&&xe(c,l,v,v[1],i?ge(l,v[1],w,BT):ye(v[1]),ky):u&&u.p&&(!i||w&1)&&u.p(v,i?w:-1),m&&m.p&&(!i||w&2)&&xe(m,d,v,v[1],i?ge(d,v[1],w,$T):ye(v[1]),Sy),h&&h.p&&(!i||w&2)&&xe(h,x,v,v[1],i?ge(x,v[1],w,null):ye(v[1]),null)},i(v){i||(I(u,v),I(m,v),I(h,v),i=!0)},o(v){P(u,v),P(m,v),P(h,v),i=!1},d(v){v&&C(e),u&&u.d(v),m&&m.d(v),h&&h.d(v)}}}function VT(o,e,t){let{$$slots:r={},$$scope:n}=e,{name:s=""}=e;return o.$$set=a=>{"name"in a&&t(0,s=a.name),"$$scope"in a&&t(1,n=a.$$scope)},[s,n,r]}var Yd=class extends Z{constructor(e){super(),ee(this,e,VT,HT,Q,{name:0},UT)}},cr=Yd;function qT(o){De(o,"svelte-y529x8",".extra-setting-button.svelte-y529x8:focus{outline:none;box-shadow:none;color:var(--icon-color-focus)}.extra-setting-button.svelte-y529x8:hover{box-shadow:none;opacity:var(--icon-opacity-hover);color:var(--icon-color-hover);background-color:var(--background-modifier-hover)}")}function WT(o){let e,t,r,n,s;return t=new Xu({props:{class:"svg-icon lucide-settings",props:{class:"svg-icon lucide-settings"}}}),{c(){e=D("div"),V(t.$$.fragment),b(e,"class","clickable-icon extra-setting-button svelte-y529x8"),b(e,"aria-label","Options"),b(e,"role","button"),b(e,"tabindex","0")},m(a,i){T(a,e,i),N(t,e,null),r=!0,n||(s=[re(e,"click",o[0]),re(e,"keydown",o[0])],n=!0)},p:X,i(a){r||(I(t.$$.fragment,a),r=!0)},o(a){P(t.$$.fragment,a),r=!1},d(a){a&&C(e),H(t),n=!1,ke(s)}}}function zT(o){let e=$t();function t(r){(r instanceof MouseEvent||r instanceof KeyboardEvent&&(r.key==="Enter"||r.key===" "))&&e("settings")}return[t]}var Jd=class extends Z{constructor(e){super(),ee(this,e,zT,WT,Q,{},qT)}},On=Jd;function KT(o){let e,t,r,n,s,a;t=new Fn({props:{class:"svg-icon",style:"margin-right: .2em; flex-shrink: 0;"}});let i=o[3].default,l=he(i,o,o[2],null);return{c(){e=D("span"),V(t.$$.fragment),r=B(),l&&l.c(),b(e,"role","button"),b(e,"tabindex","0"),ue(e,"display","flex"),ue(e,"align-items","center"),ue(e,"width","100%")},m(c,u){T(c,e,u),N(t,e,null),k(e,r),l&&l.m(e,null),n=!0,s||(a=[re(e,"keypress",o[0]),re(e,"click",o[0])],s=!0)},p(c,[u]){l&&l.p&&(!n||u&4)&&xe(l,i,c,c[2],n?ge(i,c[2],u,null):ye(c[2]),null)},i(c){n||(I(t.$$.fragment,c),I(l,c),n=!0)},o(c){P(t.$$.fragment,c),P(l,c),n=!1},d(c){c&&C(e),H(t),l&&l.d(c),s=!1,ke(a)}}}function GT(o,e,t){let{$$slots:r={},$$scope:n}=e,{relay:s=void 0}=e,a=$t();function i(){s&&a("manageRelay",{relay:s})}return o.$$set=l=>{"relay"in l&&t(1,s=l.relay),"$$scope"in l&&t(2,n=l.$$scope)},[i,s,n,r]}var Xd=class extends Z{constructor(e){super(),ee(this,e,GT,KT,Q,{relay:1})}},fn=Xd;function jT(o){let e,t,r,n,s,a;t=new Uu({props:{class:"svg-icon",style:"margin-right: .2em; flex-shrink: 0"}});let i=o[3].default,l=he(i,o,o[2],null);return{c(){e=D("span"),V(t.$$.fragment),r=B(),l&&l.c(),b(e,"role","button"),b(e,"tabindex","0"),ue(e,"display","inline-flex"),ue(e,"align-items","center"),ue(e,"width","100%")},m(c,u){T(c,e,u),N(t,e,null),k(e,r),l&&l.m(e,null),n=!0,s||(a=[re(e,"keypress",o[0]),re(e,"click",o[0])],s=!0)},p(c,[u]){l&&l.p&&(!n||u&4)&&xe(l,i,c,c[2],n?ge(i,c[2],u,null):ye(c[2]),null)},i(c){n||(I(t.$$.fragment,c),I(l,c),n=!0)},o(c){P(t.$$.fragment,c),P(l,c),n=!1},d(c){c&&C(e),H(t),l&&l.d(c),s=!1,ke(a)}}}function YT(o,e,t){let{$$slots:r={},$$scope:n}=e,{folder:s=void 0}=e,a=$t();function i(){var l;s&&a("manageSharedFolder",{folder:s,relay:(l=s.remote)===null||l===void 0?void 0:l.relay})}return o.$$set=l=>{"folder"in l&&t(1,s=l.folder),"$$scope"in l&&t(2,n=l.$$scope)},[i,s,n,r]}var Qd=class extends Z{constructor(e){super(),ee(this,e,YT,jT,Q,{folder:1})}},fo=Qd;function JT(o){let e,t=o[0].name+"",r;return{c(){e=D("span"),r=K(t),ue(e,"overflow","hidden"),ue(e,"text-overflow","ellipsis"),ue(e,"white-space","nowrap")},m(n,s){T(n,e,s),k(e,r)},p(n,s){s&1&&t!==(t=n[0].name+"")&&se(r,t)},d(n){n&&C(e)}}}function Ly(o){let e,t,r,n,s;return t=new Su({props:{size:16,class:"svg-icon"}}),n=new fn({props:{relay:o[1],$$slots:{default:[XT]},$$scope:{ctx:o}}}),n.$on("manageRelay",o[3]),{c(){e=D("span"),V(t.$$.fragment),r=B(),V(n.$$.fragment),ue(e,"width","16px"),ue(e,"flex-shrink","0"),ue(e,"display","flex"),ue(e,"justify-content","center")},m(a,i){T(a,e,i),N(t,e,null),T(a,r,i),N(n,a,i),s=!0},p(a,i){let l={};i&2&&(l.relay=a[1]),i&17&&(l.$$scope={dirty:i,ctx:a}),n.$set(l)},i(a){s||(I(t.$$.fragment,a),I(n.$$.fragment,a),s=!0)},o(a){P(t.$$.fragment,a),P(n.$$.fragment,a),s=!1},d(a){a&&(C(e),C(r)),H(t),H(n,a)}}}function XT(o){let e,t=o[0].remote.relay.name+"",r;return{c(){e=D("span"),r=K(t),ue(e,"flex","1"),ue(e,"min-width","0"),ue(e,"text-overflow","ellipsis"),ue(e,"white-space","nowrap")},m(n,s){T(n,e,s),k(e,r)},p(n,s){s&1&&t!==(t=n[0].remote.relay.name+"")&&se(r,t)},d(n){n&&C(e)}}}function QT(o){let e,t,r,n,s;r=new fo({props:{folder:o[0],$$slots:{default:[JT]},$$scope:{ctx:o}}}),r.$on("manageSharedFolder",o[2]);let a=o[0].remote&&Ly(o);return{c(){e=D("span"),t=D("span"),V(r.$$.fragment),n=B(),a&&a.c(),ue(t,"display","inline-flex"),ue(t,"align-items","center"),ue(t,"width","200px"),ue(t,"min-width","200px"),ue(t,"flex-shrink","0"),ue(e,"display","inline-flex"),ue(e,"align-items","center"),ue(e,"width","100%"),ue(e,"gap","8px")},m(i,l){T(i,e,l),k(e,t),N(r,t,null),k(e,n),a&&a.m(e,null),s=!0},p(i,[l]){let c={};l&1&&(c.folder=i[0]),l&17&&(c.$$scope={dirty:l,ctx:i}),r.$set(c),i[0].remote?a?(a.p(i,l),l&1&&I(a,1)):(a=Ly(i),a.c(),I(a,1),a.m(e,null)):a&&(be(),P(a,1,1,()=>{a=null}),we())},i(i){s||(I(r.$$.fragment,i),I(a),s=!0)},o(i){P(r.$$.fragment,i),P(a),s=!1},d(i){i&&C(e),H(r),a&&a.d()}}}function ZT(o,e,t){let{folder:r}=e,{relay:n}=e;function s(i){zr.call(this,o,i)}function a(i){zr.call(this,o,i)}return o.$$set=i=>{"folder"in i&&t(0,r=i.folder),"relay"in i&&t(1,n=i.relay)},[r,n,s,a]}var Zd=class extends Z{constructor(e){super(),ee(this,e,ZT,QT,Q,{folder:0,relay:1})}},Iy=Zd;var qs=require("obsidian");function eD(o){De(o,"svelte-yg42fv","input.system3-input-invalid.svelte-yg42fv{border:1px solid var(--color-red) !important}span.faint.svelte-yg42fv{color:var(--text-faint)}")}function Cy(o,e,t){let r=o.slice();return r[21]=e[t],r}function Ty(o,e,t){let r=o.slice();return r[24]=e[t],r}function tD(o){let e,t,r,n,s,a;return{c(){e=D("input"),r=B(),n=D("button"),n.textContent="Join",b(e,"type","text"),b(e,"placeholder","Enter share key"),b(e,"class",t=Ds(o[2]?"system3-input-invalid":"")+" svelte-yg42fv"),b(n,"class","mod-cta")},m(i,l){T(i,e,l),Zt(e,o[1]),T(i,r,l),T(i,n,l),s||(a=[re(e,"input",o[12]),re(e,"input",o[8]),re(n,"click",function(){ut((0,qs.debounce)(o[13]))&&(0,qs.debounce)(o[13]).apply(this,arguments)})],s=!0)},p(i,l){o=i,l&4&&t!==(t=Ds(o[2]?"system3-input-invalid":"")+" svelte-yg42fv")&&b(e,"class",t),l&2&&e.value!==o[1]&&Zt(e,o[1])},d(i){i&&(C(e),C(r),C(n)),s=!1,ke(a)}}}function rD(o){let e;return{c(){e=D("span"),e.textContent="Relay Servers",b(e,"slot","name"),ue(e,"display","inline-flex"),ue(e,"align-items","center")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function oD(o){let e,t;function r(){return o[15](o[24])}return e=new On({}),e.$on("settings",r),{c(){V(e.$$.fragment)},m(n,s){N(e,n,s),t=!0},p(n,s){o=n},i(n){t||(I(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){H(e,n)}}}function nD(o){let e;return{c(){e=D("span"),e.textContent="(Untitled Relay Server)",b(e,"class","faint svelte-yg42fv")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function sD(o){let e=o[24].name+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n&8&&e!==(e=r[24].name+"")&&se(t,e)},d(r){r&&C(t)}}}function aD(o){let e;function t(s,a){return s[24].name?sD:nD}let r=t(o,-1),n=r(o);return{c(){n.c(),e=Ce()},m(s,a){n.m(s,a),T(s,e,a)},p(s,a){r===(r=t(s,a))&&n?n.p(s,a):(n.d(1),n=r(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&C(e),n.d(s)}}}function iD(o){let e,t;return e=new fn({props:{slot:"name",relay:o[24],t:"name",$$slots:{default:[aD]},$$scope:{ctx:o}}}),e.$on("manageRelay",o[14]),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&8&&(s.relay=r[24]),n&134217736&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function Dy(o){let e,t;return e=new cr({props:{$$slots:{name:[iD],default:[oD]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&134217736&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function lD(o){let e,t,r;return{c(){e=D("button"),e.textContent="Create",b(e,"class","mod-cta")},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,qs.debounce)(o[16])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function Py(o){let e,t;return e=new He({props:{description:"Go to a Relay Server's settings page above to share existing folders, or add Shared Folders to your vault."}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function fD(o){let e,t,r;function n(){return o[19](o[21])}return e=new On({}),e.$on("settings",function(){ut((0,qs.debounce)(n))&&(0,qs.debounce)(n).apply(this,arguments)}),{c(){V(e.$$.fragment),t=B()},m(s,a){N(e,s,a),T(s,t,a),r=!0},p(s,a){o=s},i(s){r||(I(e.$$.fragment,s),r=!0)},o(s){P(e.$$.fragment,s),r=!1},d(s){s&&C(t),H(e,s)}}}function cD(o){var r;let e,t;return e=new Iy({props:{folder:o[21],relay:(r=o[21].remote)==null?void 0:r.relay,slot:"name"}}),e.$on("manageRelay",o[17]),e.$on("manageSharedFolder",o[18]),{c(){V(e.$$.fragment)},m(n,s){N(e,n,s),t=!0},p(n,s){var i;let a={};s&16&&(a.folder=n[21]),s&16&&(a.relay=(i=n[21].remote)==null?void 0:i.relay),e.$set(a)},i(n){t||(I(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){H(e,n)}}}function Ay(o){let e,t;return e=new cr({props:{$$slots:{name:[cD],default:[fD]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&134217752&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function uD(o){let e,t,r,n,s,a,i,l,c,u,d,m=o[4].items().length===0,x,h,v;e=new Je({props:{name:"Join a Relay Server"}}),r=new He({props:{name:"Share key",description:"Enter the code that was shared with you.",$$slots:{default:[tD]},$$scope:{ctx:o}}}),s=new Je({props:{helpText:"A Relay Server coordinates real-time updates between collaborators. You can add collaborators and share folders on the Relay Server's settings page.",$$slots:{name:[rD]},$$scope:{ctx:o}}});let w=Re(o[3].values().sort(Ey)),_=[];for(let M=0;M<w.length;M+=1)_[M]=Dy(Ty(o,w,M));let A=M=>P(_[M],1,1,()=>{_[M]=null});l=new He({props:{name:"",description:"",$$slots:{default:[lD]},$$scope:{ctx:o}}}),u=new Je({props:{name:"Shared Folders",helpText:"Shared Folders enhance local folders by tracking edits. You can see what Relay Server a Shared Folder is connected to below."}});let U=m&&Py(o),L=Re(o[4].items()),R=[];for(let M=0;M<L.length;M+=1)R[M]=Ay(Cy(o,L,M));let O=M=>P(R[M],1,1,()=>{R[M]=null});return{c(){V(e.$$.fragment),t=B(),V(r.$$.fragment),n=B(),V(s.$$.fragment),a=B();for(let M=0;M<_.length;M+=1)_[M].c();i=B(),V(l.$$.fragment),c=B(),V(u.$$.fragment),d=B(),U&&U.c(),x=B();for(let M=0;M<R.length;M+=1)R[M].c();h=Ce()},m(M,E){N(e,M,E),T(M,t,E),N(r,M,E),T(M,n,E),N(s,M,E),T(M,a,E);for(let F=0;F<_.length;F+=1)_[F]&&_[F].m(M,E);T(M,i,E),N(l,M,E),T(M,c,E),N(u,M,E),T(M,d,E),U&&U.m(M,E),T(M,x,E);for(let F=0;F<R.length;F+=1)R[F]&&R[F].m(M,E);T(M,h,E),v=!0},p(M,[E]){let F={};E&134217734&&(F.$$scope={dirty:E,ctx:M}),r.$set(F);let q={};if(E&134217728&&(q.$$scope={dirty:E,ctx:M}),s.$set(q),E&72){w=Re(M[3].values().sort(Ey));let G;for(G=0;G<w.length;G+=1){let z=Ty(M,w,G);_[G]?(_[G].p(z,E),I(_[G],1)):(_[G]=Dy(z),_[G].c(),I(_[G],1),_[G].m(i.parentNode,i))}for(be(),G=w.length;G<_.length;G+=1)A(G);we()}let J={};if(E&134217728&&(J.$$scope={dirty:E,ctx:M}),l.$set(J),E&16&&(m=M[4].items().length===0),m?U?E&16&&I(U,1):(U=Py(M),U.c(),I(U,1),U.m(x.parentNode,x)):U&&(be(),P(U,1,1,()=>{U=null}),we()),E&152){L=Re(M[4].items());let G;for(G=0;G<L.length;G+=1){let z=Cy(M,L,G);R[G]?(R[G].p(z,E),I(R[G],1)):(R[G]=Ay(z),R[G].c(),I(R[G],1),R[G].m(h.parentNode,h))}for(be(),G=L.length;G<R.length;G+=1)O(G);we()}},i(M){if(!v){I(e.$$.fragment,M),I(r.$$.fragment,M),I(s.$$.fragment,M);for(let E=0;E<w.length;E+=1)I(_[E]);I(l.$$.fragment,M),I(u.$$.fragment,M),I(U);for(let E=0;E<L.length;E+=1)I(R[E]);v=!0}},o(M){P(e.$$.fragment,M),P(r.$$.fragment,M),P(s.$$.fragment,M),_=_.filter(Boolean);for(let E=0;E<_.length;E+=1)P(_[E]);P(l.$$.fragment,M),P(u.$$.fragment,M),P(U),R=R.filter(Boolean);for(let E=0;E<R.length;E+=1)P(R[E]);v=!1},d(M){M&&(C(t),C(n),C(a),C(i),C(c),C(d),C(x),C(h)),H(e,M),H(r,M),H(s,M),it(_,M),H(l,M),H(u,M),U&&U.d(M),it(R,M)}}}function Ey(o,e){return o.owner&&!e.owner?-1:e.owner&&!o.owner||o.name>e.name?1:-1}function dD(o,e,t){let r,n=X,s=()=>(n(),n=Qt(l,q=>t(3,r=q)),l),a;o.$$.on_destroy.push(()=>n());let{plugin:i}=e,{relays:l}=e;s();let c=i.sharedFolders;me(o,c,q=>t(4,a=q));let u="",d=!1,m=$t();function x(q){q&&m("manageRelay",{relay:q})}function h(q,J){q&&m("manageSharedFolder",{folder:q,relay:J})}function v(){t(2,d=!1)}function w(q){return Ge(this,void 0,void 0,function*(){try{let J=yield i.relayManager.acceptInvitation(q);m("joinRelay",{relay:J})}catch(J){t(2,d=!0)}})}function _(){m("createRelay")}function A(){u=this.value,t(1,u)}let U=()=>w(u);function L(q){zr.call(this,o,q)}let R=q=>{x(q)},O=()=>_();function M(q){zr.call(this,o,q)}function E(q){zr.call(this,o,q)}let F=q=>{let J=r.values().find(G=>{var z;return((z=q.remote)==null?void 0:z.relay.guid)===G.guid});h(q,J)};return o.$$set=q=>{"plugin"in q&&t(11,i=q.plugin),"relays"in q&&s(t(0,l=q.relays))},[l,u,d,r,a,c,x,h,v,w,_,i,A,U,L,R,O,M,E,F]}var ep=class extends Z{constructor(e){super(),ee(this,e,dD,uD,Q,{plugin:11,relays:0},eD)}},co=ep;var mt=require("obsidian");var Xy=jn(vi());function pD(o){let e,t,r,n,s,a,i,l,c;n=new Du({props:{size:16}});let u=o[3].default,d=he(u,o,o[4],null);return{c(){e=D("span"),t=K(o[1]),r=B(),V(n.$$.fragment),s=B(),a=D("span"),d&&d.c(),b(e,"tabindex","0"),b(e,"role","button"),ue(a,"flex","1"),ue(a,"min-width","0"),ue(a,"text-overflow","ellipsis"),ue(a,"white-space","nowrap"),ue(a,"overflow","hidden")},m(m,x){T(m,e,x),k(e,t),T(m,r,x),N(n,m,x),T(m,s,x),T(m,a,x),d&&d.m(a,null),i=!0,l||(c=[re(e,"click",o[2]),re(e,"keypress",o[2])],l=!0)},p(m,x){(!i||x&2)&&se(t,m[1]),d&&d.p&&(!i||x&16)&&xe(d,u,m,m[4],i?ge(u,m[4],x,null):ye(m[4]),null)},i(m){i||(I(n.$$.fragment,m),I(d,m),i=!0)},o(m){P(n.$$.fragment,m),P(d,m),i=!1},d(m){m&&(C(e),C(r),C(s),C(a)),H(n,m),d&&d.d(m),l=!1,ke(c)}}}function mD(o){let e,t,r;var n=o[0];function s(a,i){return{props:{$$slots:{default:[pD]},$$scope:{ctx:a}}}}return n&&(t=Es(n,s(o))),{c(){e=D("h4"),t&&V(t.$$.fragment)},m(a,i){T(a,e,i),t&&N(t,e,null),r=!0},p(a,[i]){if(i&1&&n!==(n=a[0])){if(t){be();let l=t;P(l.$$.fragment,1,0,()=>{H(l,1)}),we()}n?(t=Es(n,s(a,i)),V(t.$$.fragment),I(t.$$.fragment,1),N(t,e,null)):t=null}else if(n){let l={};i&18&&(l.$$scope={dirty:i,ctx:a}),t.$set(l)}},i(a){r||(t&&I(t.$$.fragment,a),r=!0)},o(a){t&&P(t.$$.fragment,a),r=!1},d(a){a&&C(e),t&&H(t)}}}function hD(o,e,t){let{$$slots:r={},$$scope:n}=e,{category:s}=e,{categoryText:a}=e,i=$t();function l(){i("goBack")}return o.$$set=c=>{"category"in c&&t(0,s=c.category),"categoryText"in c&&t(1,a=c.categoryText),"$$scope"in c&&t(4,n=c.$$scope)},[s,a,l,r,n]}var tp=class extends Z{constructor(e){super(),ee(this,e,hD,mD,Q,{category:0,categoryText:1})}},Nl=tp;var Vl=require("obsidian");function gD(o){let e,t,r=o[0].shared&&My(o);return{c(){e=D("div"),r&&r.c(),b(e,"class","suggestion-icon")},m(n,s){T(n,e,s),r&&r.m(e,null),t=!0},p(n,s){n[0].shared?r?s&1&&I(r,1):(r=My(n),r.c(),I(r,1),r.m(e,null)):r&&(be(),P(r,1,1,()=>{r=null}),we())},i(n){t||(I(r),t=!0)},o(n){P(r),t=!1},d(n){n&&C(e),r&&r.d()}}}function xD(o){let e;return{c(){e=D("span"),e.textContent="Enter to create",b(e,"class","suggestion-action")},m(t,r){T(t,e,r)},p:X,i:X,o:X,d(t){t&&C(e)}}}function My(o){let e,t;return e=new Mo({props:{class:"svg-icon"}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function yD(o){let e,t,r=o[0].folder+"",n,s,a,i,l,c,u=[xD,gD],d=[];function m(x,h){return x[0].exists?1:0}return i=m(o,-1),l=d[i]=u[i](o),{c(){e=D("div"),t=D("div"),n=K(r),s=B(),a=D("div"),l.c(),b(t,"class","suggestion-title"),b(e,"class","suggestion-content"),b(a,"class","suggestion-aux")},m(x,h){T(x,e,h),k(e,t),k(t,n),T(x,s,h),T(x,a,h),d[i].m(a,null),c=!0},p(x,[h]){(!c||h&1)&&r!==(r=x[0].folder+"")&&se(n,r);let v=i;i=m(x,h),i===v?d[i].p(x,h):(be(),P(d[v],1,1,()=>{d[v]=null}),we(),l=d[i],l?l.p(x,h):(l=d[i]=u[i](x),l.c()),I(l,1),l.m(a,null))},i(x){c||(I(l),c=!0)},o(x){P(l),c=!1},d(x){x&&(C(e),C(s),C(a)),d[i].d()}}}function bD(o,e,t){let{suggestion:r}=e;return o.$$set=n=>{"suggestion"in n&&t(0,r=n.suggestion)},[r]}var rp=class extends Z{constructor(e){super(),ee(this,e,bD,yD,Q,{suggestion:0})}},Ry=rp;var Hl=class extends Vl.SuggestModal{constructor(t,r,n){super(t);this.sharedFolders=r;this.onChoose=n;this.components=[];this.sharedPaths=new Set(this.sharedFolders.map(s=>s.path)),this.hasRemotes=new Set(this.sharedFolders.filter(s=>s.remote!==void 0).map(s=>s.path)),this.setInstructions([{command:"\u2191/\u2193",purpose:"Navigate"},{command:"Enter",purpose:"Choose and share folder"},{command:"Esc",purpose:"Cancel"}])}sortFn(t,r){return t.exists&&!r.exists?1:!t.exists&&r.exists||t.shared&&!r.shared?-1:r.shared&&!t.shared?1:t.folder.localeCompare(r.folder)}onClose(){super.onClose(),this.components.forEach(t=>{t.$destroy()})}getSuggestions(t){this.components.forEach(i=>{i.$destroy()});let r=t.toLowerCase(),n=[],s=this.app.vault.getAbstractFileByPath(t)!==null;t.length>0&&!s&&n.push({folder:t,exists:!1,shared:!1});let a=i=>{let l=this.sharedPaths.has(i.path),c=this.hasRemotes.has(i.path);if(i.path.toLowerCase().contains(r)&&i.path.length>1&&!c&&n.push({folder:i.path,exists:!0,shared:l}),!l)for(let u of i.children)u instanceof Vl.TFolder&&a(u)};return a(this.app.vault.getRoot()),n.sort(this.sortFn)}renderSuggestion(t,r){r.addClass("mod-complex");let n=new Ry({target:r,props:{suggestion:t}});this.components.push(n)}onChooseSuggestion(t,r){this.onChoose(t.folder)}};var Ny=require("obsidian");var np=require("obsidian");var Fy=require("obsidian"),Oy=require("obsidian"),ql=class extends Oy.AbstractInputSuggest{constructor(t,r,n){super(t,n);this.app=t;this.sharedFolders=r;this.inputEl=n;this.sharedPaths=new Set(this.sharedFolders.map(s=>s.path))}getSuggestions(t){let r=t.toLowerCase(),n=[],s=a=>{if(!this.sharedPaths.has(a.path)){a.path.toLowerCase().contains(r)&&n.push(a.path);for(let l of a.children)l instanceof Fy.TFolder&&s(l)}};return s(this.app.vault.getRoot()),n}renderSuggestion(t,r){r.setText(t)}selectSuggestion(t){this.inputEl.value=t,this.inputEl.trigger("input"),this.close()}};function wD(o){let e,t,r,n;return{c(){e=D("div"),t=D("input"),b(t,"type","text"),b(t,"placeholder","/"),b(e,"class","folder-suggest-container")},m(s,a){T(s,e,a),k(e,t),o[5](t),Zt(t,o[2]),r||(n=[re(t,"input",_D),re(t,"input",o[6])],r=!0)},p(s,[a]){a&4&&t.value!==s[2]&&Zt(t,s[2])},i:X,o:X,d(s){s&&C(e),o[5](null),r=!1,ke(n)}}}function _D(){}function vD(o,e,t){let r,n=X,s=()=>(n(),n=Qt(u,x=>t(2,r=x)),u);o.$$.on_destroy.push(()=>n());let{app:a}=e,i,l,{sharedFolders:c}=e,{selectedFolder:u=_e()}=e;s(),er(()=>{l=new ql(a,c,i);let x=h=>{s(t(0,u=h.detail.folder.path))};return i.addEventListener("folder-selected",x),()=>{i.removeEventListener("folder-selected",x)}}),hu(()=>{l&&l.close()});function d(x){Ar[x?"unshift":"push"](()=>{i=x,t(1,i)})}function m(){r=this.value,u.set(r)}return o.$$set=x=>{"app"in x&&t(3,a=x.app),"sharedFolders"in x&&t(4,c=x.sharedFolders),"selectedFolder"in x&&s(t(0,u=x.selectedFolder))},[u,i,r,a,c,d,m]}var op=class extends Z{constructor(e){super(),ee(this,e,vD,wD,Q,{app:3,sharedFolders:4,selectedFolder:0})}},Uy=op;function SD(o){De(o,"svelte-hgd3zf","span.error.svelte-hgd3zf{flex:auto;align-content:center}")}function kD(o){let e,t,r;return{c(){e=D("input"),b(e,"type","text")},m(n,s){T(n,e,s),Zt(e,o[4]),t||(r=re(e,"input",o[8]),t=!0)},p(n,s){s&16&&e.value!==n[4]&&Zt(e,n[4])},d(n){n&&C(e),t=!1,r()}}}function LD(o){let e,t;return e=new Uy({props:{app:o[0],sharedFolders:o[2],selectedFolder:o[7]}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&1&&(s.app=r[0]),n&4&&(s.sharedFolders=r[2]),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function $y(o){let e,t;return{c(){e=D("span"),t=K(o[5]),b(e,"class","mod-warning error svelte-hgd3zf")},m(r,n){T(r,e,n),k(e,t)},p(r,n){n&32&&se(t,r[5])},d(r){r&&C(e)}}}function ID(o){let e,t,r,n,s,a,i,l,c,u,d,m,x;n=new He({props:{name:"Folder name",description:"Set the name of the folder to be added.",$$slots:{default:[kD]},$$scope:{ctx:o}}}),a=new He({props:{name:"Folder location",description:"Set the location in your vault.",$$slots:{default:[LD]},$$scope:{ctx:o}}});let h=o[5]&&$y(o);return{c(){e=D("div"),e.textContent="Add to vault",t=B(),r=D("div"),V(n.$$.fragment),s=B(),V(a.$$.fragment),i=B(),l=D("div"),h&&h.c(),c=B(),u=D("button"),u.textContent="Confirm",b(e,"class","modal-title"),b(u,"class","mod-cta"),b(l,"class","modal-button-container"),b(r,"class","modal-content")},m(v,w){T(v,e,w),T(v,t,w),T(v,r,w),N(n,r,null),k(r,s),N(a,r,null),k(r,i),k(r,l),h&&h.m(l,null),k(l,c),k(l,u),d=!0,m||(x=re(u,"click",function(){ut((0,np.debounce)(o[9]))&&(0,np.debounce)(o[9]).apply(this,arguments)}),m=!0)},p(v,[w]){o=v;let _={};w&1040&&(_.$$scope={dirty:w,ctx:o}),n.$set(_);let A={};w&1029&&(A.$$scope={dirty:w,ctx:o}),a.$set(A),o[5]?h?h.p(o,w):(h=$y(o),h.c(),h.m(l,c)):h&&(h.d(1),h=null)},i(v){d||(I(n.$$.fragment,v),I(a.$$.fragment,v),d=!0)},o(v){P(n.$$.fragment,v),P(a.$$.fragment,v),d=!1},d(v){v&&(C(e),C(t),C(r)),H(n),H(a),h&&h.d(),m=!1,x()}}}function CD(o,e,t){let r,{app:n}=e,{remoteFolder:s}=e,{sharedFolders:a}=e,{onConfirm:i}=e,l=s.name,c=_e();me(o,c,x=>t(6,r=x));let u="";function d(){l=this.value,t(4,l)}let m=async()=>{i(s,l,r||"").catch(x=>{t(5,u=x.message)})};return o.$$set=x=>{"app"in x&&t(0,n=x.app),"remoteFolder"in x&&t(1,s=x.remoteFolder),"sharedFolders"in x&&t(2,a=x.sharedFolders),"onConfirm"in x&&t(3,i=x.onConfirm)},[n,s,a,i,l,u,r,c,d,m]}var sp=class extends Z{constructor(e){super(),ee(this,e,CD,ID,Q,{app:0,remoteFolder:1,sharedFolders:2,onConfirm:3},SD)}},By=sp;var Wl=class extends Ny.Modal{constructor(t,r,n,s){super(t);this.sharedFolders=r;this.remoteFolder=n;this.onConfirm=s;this.onConfirm=s}onOpen(){let{contentEl:t}=this;this.component=new By({target:t,props:{remoteFolder:this.remoteFolder,sharedFolders:this.sharedFolders,onConfirm:async(r,n,s)=>{await this.onConfirm(r,n,s),this.close()},app:this.app}})}onClose(){var r;let{contentEl:t}=this;t.empty(),(r=this.component)==null||r.$destroy()}};var ip=jn(Hy());function TD(o){De(o,"svelte-xzg7gq",".system3-settings-danger-zone.svelte-xzg7gq{margin-top:6em}input.system3-updating.svelte-xzg7gq{border:1px solid var(--color-accent) !important}input.system3-input-invalid.svelte-xzg7gq{border:1px solid var(--color-red) !important}.faint.svelte-xzg7gq{color:var(--text-faint)}")}function Vy(o,e,t){let r=o.slice();return r[50]=e[t],r}function qy(o,e,t){let r=o.slice();return r[53]=e[t],r}function DD(o){let e;return{c(){e=D("span"),e.textContent="(Untitled Relay Server)",b(e,"class","faint svelte-xzg7gq")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function PD(o){let e=o[0].name+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n[0]&1&&e!==(e=r[0].name+"")&&se(t,e)},d(r){r&&C(t)}}}function AD(o){let e;function t(s,a){return s[0].name?PD:DD}let r=t(o,[-1,-1]),n=r(o);return{c(){n.c(),e=Ce()},m(s,a){n.m(s,a),T(s,e,a)},p(s,a){r===(r=t(s,a))&&n?n.p(s,a):(n.d(1),n=r(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&C(e),n.d(s)}}}function Wy(o){let e,t;return e=new He({props:{name:"Name",description:"Set the Relay Server's name.",$$slots:{default:[ED]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&297|n[1]&33554432&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function ED(o){let e,t,r,n;return{c(){e=D("input"),b(e,"type","text"),b(e,"spellcheck","false"),b(e,"placeholder","Example: Shared Notes"),b(e,"class",t=Ds((o[8]?"system3-updating":"")+(o[5]?"":" system3-input-invalid"))+" svelte-xzg7gq")},m(s,a){T(s,e,a),Zt(e,o[0].name),o[35](e),r||(n=[re(e,"input",o[34]),re(e,"input",o[26])],r=!0)},p(s,a){a[0]&288&&t!==(t=Ds((s[8]?"system3-updating":"")+(s[5]?"":" system3-input-invalid"))+" svelte-xzg7gq")&&b(e,"class",t),a[0]&1&&e.value!==s[0].name&&Zt(e,s[0].name)},d(s){s&&C(e),o[35](null),r=!1,ke(n)}}}function MD(o){let e,t;return e=new cr({props:{$$slots:{name:[UD],default:[FD]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&512|n[1]&33554432&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function RD(o){let e,t;return e=new cr({props:{$$slots:{name:[ND],default:[$D]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&1536|n[1]&33554432&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function FD(o){let e,t,r;function n(){return o[39](o[53])}return{c(){e=D("button"),e.textContent="Add to Vault",b(e,"class","mod-cta"),b(e,"aria-label","Add shared folder to vault")},m(s,a){T(s,e,a),t||(r=re(e,"click",function(){ut((0,mt.debounce)(n))&&(0,mt.debounce)(n).apply(this,arguments)}),t=!0)},p(s,a){o=s},d(s){s&&C(e),t=!1,r()}}}function OD(o){let e=o[53].name+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n[0]&512&&e!==(e=r[53].name+"")&&se(t,e)},d(r){r&&C(t)}}}function UD(o){let e,t;return e=new fo({props:{slot:"name",$$slots:{default:[OD]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&512|n[1]&33554432&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function $D(o){let e,t;function r(){return o[38](o[53])}return e=new On({}),e.$on("settings",function(){ut((0,mt.debounce)(r))&&(0,mt.debounce)(r).apply(this,arguments)}),{c(){V(e.$$.fragment)},m(n,s){N(e,n,s),t=!0},p(n,s){o=n},i(n){t||(I(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){H(e,n)}}}function BD(o){let e=o[53].name+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n[0]&512&&e!==(e=r[53].name+"")&&se(t,e)},d(r){r&&C(t)}}}function ND(o){let e,t;function r(...n){return o[36](o[53],...n)}return e=new fo({props:{folder:o[10].find(r),slot:"name",$$slots:{default:[BD]},$$scope:{ctx:o}}}),e.$on("manageSharedFolder",o[37]),{c(){V(e.$$.fragment)},m(n,s){N(e,n,s),t=!0},p(n,s){o=n;let a={};s[0]&1536&&(a.folder=o[10].find(r)),s[0]&512|s[1]&33554432&&(a.$$scope={dirty:s,ctx:o}),e.$set(a)},i(n){t||(I(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){H(e,n)}}}function zy(o){let e,t,r,n,s;function a(...u){return o[33](o[53],...u)}let i=[RD,MD],l=[];function c(u,d){return d[0]&1536&&(e=null),e==null&&(e=!!u[10].find(a)),e?0:1}return t=c(o,[-1,-1]),r=l[t]=i[t](o),{c(){r.c(),n=Ce()},m(u,d){l[t].m(u,d),T(u,n,d),s=!0},p(u,d){o=u;let m=t;t=c(o,d),t===m?l[t].p(o,d):(be(),P(l[m],1,1,()=>{l[m]=null}),we(),r=l[t],r?r.p(o,d):(r=l[t]=i[t](o),r.c()),I(r,1),r.m(n.parentNode,n))},i(u){s||(I(r),s=!0)},o(u){P(r),s=!1},d(u){u&&C(n),l[t].d(u)}}}function HD(o){let e,t,r;return{c(){e=D("button"),e.textContent="Share a folder",b(e,"class","mod-cta"),b(e,"aria-label","Select a folder to share it with this Relay Server")},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,mt.debounce)(o[40])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function VD(o){let e=o[11].values().length+"",t,r,n=o[7].userLimit+"",s;return{c(){t=K(e),r=K(" / "),s=K(n)},m(a,i){T(a,t,i),T(a,r,i),T(a,s,i)},p(a,i){i[0]&2048&&e!==(e=a[11].values().length+"")&&se(t,e),i[0]&128&&n!==(n=a[7].userLimit+"")&&se(s,n)},d(a){a&&(C(t),C(r),C(s))}}}function Ky(o){let e,t,r;function n(){return o[41](o[50])}return{c(){e=D("button"),e.textContent="Kick",b(e,"class","mod-destructive")},m(s,a){T(s,e,a),t||(r=re(e,"click",function(){ut((0,mt.debounce)(n))&&(0,mt.debounce)(n).apply(this,arguments)}),t=!0)},p(s,a){o=s},d(s){s&&C(e),t=!1,r()}}}function qD(o){let e,t=o[50].role==="Member"&&o[7].owner&&Ky(o);return{c(){t&&t.c(),e=B()},m(r,n){t&&t.m(r,n),T(r,e,n)},p(r,n){r[50].role==="Member"&&r[7].owner?t?t.p(r,n):(t=Ky(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(r){r&&C(e),t&&t.d(r)}}}function Gy(o){let e,t;return e=new He({props:{name:o[50].user.name,description:o[50].role,$$slots:{default:[qD]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&2048&&(s.name=r[50].user.name),n[0]&2048&&(s.description=r[50].role),n[0]&2176|n[1]&33554432&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function WD(o){let e,t,r;return{c(){e=D("input"),e.value=o[4],b(e,"type","text"),e.readOnly=!0,b(e,"id","system3InviteLink")},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,mt.debounce)(o[30])),t=!0)},p(n,s){s[0]&16&&e.value!==n[4]&&(e.value=n[4])},d(n){n&&C(e),t=!1,r()}}}function zD(o){let e,t,r,n;return e=new Je({props:{name:"Membership"}}),r=new He({props:{name:"Leave Relay Server",description:"Leave the Relay Server. Local data is preserved.",$$slots:{default:[GD]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment),t=B(),V(r.$$.fragment)},m(s,a){N(e,s,a),T(s,t,a),N(r,s,a),n=!0},p(s,a){let i={};a[1]&33554432&&(i.$$scope={dirty:a,ctx:s}),r.$set(i)},i(s){n||(I(e.$$.fragment,s),I(r.$$.fragment,s),n=!0)},o(s){P(e.$$.fragment,s),P(r.$$.fragment,s),n=!1},d(s){s&&C(t),H(e,s),H(r,s)}}}function KD(o){let e,t,r,n,s,a,i,l=[YD,jD],c=[];function u(d,m){return d[12]?0:1}return e=u(o,[-1,-1]),t=c[e]=l[e](o),n=new Je({props:{name:"Storage"}}),a=new He({props:{name:"Destroy Relay Server",description:"This will destroy the Relay Server (deleting all data on the server). Local data is preserved.",$$slots:{default:[nP]},$$scope:{ctx:o}}}),{c(){t.c(),r=B(),V(n.$$.fragment),s=B(),V(a.$$.fragment)},m(d,m){c[e].m(d,m),T(d,r,m),N(n,d,m),T(d,s,m),N(a,d,m),i=!0},p(d,m){let x=e;e=u(d,m),e===x?c[e].p(d,m):(be(),P(c[x],1,1,()=>{c[x]=null}),we(),t=c[e],t?t.p(d,m):(t=c[e]=l[e](d),t.c()),I(t,1),t.m(r.parentNode,r));let h={};m[0]&64|m[1]&33554432&&(h.$$scope={dirty:m,ctx:d}),a.$set(h)},i(d){i||(I(t),I(n.$$.fragment,d),I(a.$$.fragment,d),i=!0)},o(d){P(t),P(n.$$.fragment,d),P(a.$$.fragment,d),i=!1},d(d){d&&(C(r),C(s)),c[e].d(d),H(n,d),H(a,d)}}}function GD(o){let e,t,r;return{c(){e=D("button"),e.textContent="Leave",b(e,"class","mod-warning")},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,mt.debounce)(o[45])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function jD(o){let e,t;return e=new He({props:{name:`Plan: ${o[7].plan}`,description:"",$$slots:{description:[XD],default:[JD]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&128&&(s.name=`Plan: ${r[7].plan}`),n[0]&128|n[1]&33554432&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function YD(o){let e,t,r=!o[6].values()[0].active||o[6].values()[0].cancelAt,n,s;e=new He({props:{name:`Plan: ${o[7].plan}`,description:"",$$slots:{description:[ZD],default:[QD]},$$scope:{ctx:o}}});let a=r&&Yy(o);return{c(){V(e.$$.fragment),t=B(),a&&a.c(),n=Ce()},m(i,l){N(e,i,l),T(i,t,l),a&&a.m(i,l),T(i,n,l),s=!0},p(i,l){let c={};l[0]&128&&(c.name=`Plan: ${i[7].plan}`),l[0]&4288|l[1]&33554432&&(c.$$scope={dirty:l,ctx:i}),e.$set(c),l[0]&64&&(r=!i[6].values()[0].active||i[6].values()[0].cancelAt),r?a?(a.p(i,l),l[0]&64&&I(a,1)):(a=Yy(i),a.c(),I(a,1),a.m(n.parentNode,n)):a&&(be(),P(a,1,1,()=>{a=null}),we())},i(i){s||(I(e.$$.fragment,i),I(a),s=!0)},o(i){P(e.$$.fragment,i),P(a),s=!1},d(i){i&&(C(t),C(n)),H(e,i),a&&a.d(i)}}}function JD(o){let e,t,r;return{c(){e=D("button"),e.textContent="Upgrade",b(e,"class","mod-cta")},m(n,s){T(n,e,s),t||(r=re(e,"click",function(){ut((0,mt.debounce)(o[44]))&&(0,mt.debounce)(o[44]).apply(this,arguments)}),t=!0)},p(n,s){o=n},d(n){n&&C(e),t=!1,r()}}}function XD(o){let e,t=(o[7].cta||"Thanks for supporting Relay development <3")+"",r;return{c(){e=D("fragment"),r=K(t),b(e,"slot","description")},m(n,s){T(n,e,s),k(e,r)},p(n,s){s[0]&128&&t!==(t=(n[7].cta||"Thanks for supporting Relay development <3")+"")&&se(r,t)},d(n){n&&C(e)}}}function jy(o){let e,t,r;return{c(){e=D("button"),e.textContent="Cancel",b(e,"class","mod-destructive")},m(n,s){T(n,e,s),t||(r=re(e,"click",function(){ut((0,mt.debounce)(o[43]))&&(0,mt.debounce)(o[43]).apply(this,arguments)}),t=!0)},p(n,s){o=n},d(n){n&&C(e),t=!1,r()}}}function QD(o){let e,t,r=o[6].values()[0].active&&!o[6].values()[0].cancelAt,n,s,a,i=r&&jy(o);return{c(){e=D("button"),e.textContent="Manage",t=B(),i&&i.c(),n=Ce()},m(l,c){T(l,e,c),T(l,t,c),i&&i.m(l,c),T(l,n,c),s||(a=re(e,"click",function(){ut((0,mt.debounce)(o[42]))&&(0,mt.debounce)(o[42]).apply(this,arguments)}),s=!0)},p(l,c){o=l,c[0]&64&&(r=o[6].values()[0].active&&!o[6].values()[0].cancelAt),r?i?i.p(o,c):(i=jy(o),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(l){l&&(C(e),C(t),C(n)),i&&i.d(l),s=!1,a()}}}function ZD(o){let e,t=o[7].cta+"",r;return{c(){e=D("fragment"),r=K(t),b(e,"slot","description")},m(n,s){T(n,e,s),k(e,r)},p(n,s){s[0]&128&&t!==(t=n[7].cta+"")&&se(r,t)},d(n){n&&C(e)}}}function Yy(o){let e,t;return e=new He({props:{description:"",$$slots:{name:[tP],default:[eP]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&64|n[1]&33554432&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function eP(o){let e=o[14](o[6].values()[0].cancelAt)+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n[0]&64&&e!==(e=r[14](r[6].values()[0].cancelAt)+"")&&se(t,e)},d(r){r&&C(t)}}}function tP(o){let e;return{c(){e=D("span"),e.textContent="Status: Cancelled",b(e,"slot","name"),b(e,"class","mod-warning")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function rP(o){let e,t,r;return{c(){e=D("button"),e.textContent="Destroy",b(e,"class","mod-warning")},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,mt.debounce)(o[27])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function oP(o){let e,t;return{c(){e=D("button"),e.textContent="Destroy",e.disabled=t=!0,b(e,"class","mod-warning"),b(e,"aria-label","Cancel subscription to destroy Relay Server.")},m(r,n){T(r,e,n)},p:X,d(r){r&&C(e)}}}function nP(o){let e,t;function r(a,i){return i[0]&64&&(e=null),e==null&&(e=a[6].values().length>0&&!a[6].values()[0].cancelAt),e?oP:rP}let n=r(o,[-1,-1]),s=n(o);return{c(){s.c(),t=Ce()},m(a,i){s.m(a,i),T(a,t,i)},p(a,i){n===(n=r(a,i))&&s?s.p(a,i):(s.d(1),s=n(a),s&&(s.c(),s.m(t.parentNode,t)))},d(a){a&&C(t),s.d(a)}}}function sP(o){let e,t,r,n,s,a,i,l,c,u,d,m,x,h,v,w,_,A,U;e=new Nl({props:{category:fn,categoryText:"Relay Servers",$$slots:{default:[AD]},$$scope:{ctx:o}}}),e.$on("goBack",o[23]);let L=o[0].owner&&Wy(o);n=new Je({props:{name:"Folders on this Relay Server"}});let R=Re(o[9].values()),O=[];for(let W=0;W<R.length;W+=1)O[W]=zy(qy(o,R,W));let M=W=>P(O[W],1,1,()=>{O[W]=null});i=new He({props:{description:"",name:"",$$slots:{default:[HD]},$$scope:{ctx:o}}}),c=new Je({props:{name:"Users",$$slots:{default:[VD]},$$scope:{ctx:o}}});let E=Re(o[11].values().sort(Jy)),F=[];for(let W=0;W<E.length;W+=1)F[W]=Gy(Vy(o,E,W));let q=W=>P(F[W],1,1,()=>{F[W]=null});m=new Je({props:{name:"Sharing"}}),h=new He({props:{name:"Share Key",description:"Share this key with your collaborators.",$$slots:{default:[WD]},$$scope:{ctx:o}}});let J=[KD,zD],G=[];function z(W,oe){return W[7].owner?0:1}return w=z(o,[-1,-1]),_=G[w]=J[w](o),{c(){V(e.$$.fragment),t=B(),L&&L.c(),r=B(),V(n.$$.fragment),s=B();for(let W=0;W<O.length;W+=1)O[W].c();a=B(),V(i.$$.fragment),l=B(),V(c.$$.fragment),u=B();for(let W=0;W<F.length;W+=1)F[W].c();d=B(),V(m.$$.fragment),x=B(),V(h.$$.fragment),v=B(),_.c(),A=Ce()},m(W,oe){N(e,W,oe),T(W,t,oe),L&&L.m(W,oe),T(W,r,oe),N(n,W,oe),T(W,s,oe);for(let Ie=0;Ie<O.length;Ie+=1)O[Ie]&&O[Ie].m(W,oe);T(W,a,oe),N(i,W,oe),T(W,l,oe),N(c,W,oe),T(W,u,oe);for(let Ie=0;Ie<F.length;Ie+=1)F[Ie]&&F[Ie].m(W,oe);T(W,d,oe),N(m,W,oe),T(W,x,oe),N(h,W,oe),T(W,v,oe),G[w].m(W,oe),T(W,A,oe),U=!0},p(W,oe){let Ie={};if(oe[0]&1|oe[1]&33554432&&(Ie.$$scope={dirty:oe,ctx:W}),e.$set(Ie),W[0].owner?L?(L.p(W,oe),oe[0]&1&&I(L,1)):(L=Wy(W),L.c(),I(L,1),L.m(r.parentNode,r)):L&&(be(),P(L,1,1,()=>{L=null}),we()),oe[0]&570426880){R=Re(W[9].values());let de;for(de=0;de<R.length;de+=1){let fe=qy(W,R,de);O[de]?(O[de].p(fe,oe),I(O[de],1)):(O[de]=zy(fe),O[de].c(),I(O[de],1),O[de].m(a.parentNode,a))}for(be(),de=R.length;de<O.length;de+=1)M(de);we()}let Pe={};oe[1]&33554432&&(Pe.$$scope={dirty:oe,ctx:W}),i.$set(Pe);let Ee={};if(oe[0]&2176|oe[1]&33554432&&(Ee.$$scope={dirty:oe,ctx:W}),c.$set(Ee),oe[0]&268437632){E=Re(W[11].values().sort(Jy));let de;for(de=0;de<E.length;de+=1){let fe=Vy(W,E,de);F[de]?(F[de].p(fe,oe),I(F[de],1)):(F[de]=Gy(fe),F[de].c(),I(F[de],1),F[de].m(d.parentNode,d))}for(be(),de=E.length;de<F.length;de+=1)q(de);we()}let Ye={};oe[0]&16|oe[1]&33554432&&(Ye.$$scope={dirty:oe,ctx:W}),h.$set(Ye);let Fe=w;w=z(W,oe),w===Fe?G[w].p(W,oe):(be(),P(G[Fe],1,1,()=>{G[Fe]=null}),we(),_=G[w],_?_.p(W,oe):(_=G[w]=J[w](W),_.c()),I(_,1),_.m(A.parentNode,A))},i(W){if(!U){I(e.$$.fragment,W),I(L),I(n.$$.fragment,W);for(let oe=0;oe<R.length;oe+=1)I(O[oe]);I(i.$$.fragment,W),I(c.$$.fragment,W);for(let oe=0;oe<E.length;oe+=1)I(F[oe]);I(m.$$.fragment,W),I(h.$$.fragment,W),I(_),U=!0}},o(W){P(e.$$.fragment,W),P(L),P(n.$$.fragment,W),O=O.filter(Boolean);for(let oe=0;oe<O.length;oe+=1)P(O[oe]);P(i.$$.fragment,W),P(c.$$.fragment,W),F=F.filter(Boolean);for(let oe=0;oe<F.length;oe+=1)P(F[oe]);P(m.$$.fragment,W),P(h.$$.fragment,W),P(_),U=!1},d(W){W&&(C(t),C(r),C(s),C(a),C(l),C(u),C(d),C(x),C(v),C(A)),H(e,W),L&&L.d(W),H(n,W),it(O,W),H(i,W),H(c,W),it(F,W),H(m,W),H(h,W),G[w].d(W)}}}function Jy(o,e){return o.role==="Owner"&&e.role!=="Owner"?-1:o.role!=="Owner"&&e.role==="Owner"||o.user.name>e.user.name?1:-1}function aP(o){if(/[\\:*?"<>|]/.test(o))return!1;let t=o.split("/");for(let r of t)if(r===""||r==="."||r==="..")return!1;return!0}function iP(o,e,t){let r,n,s=X,a=()=>(s(),s=Qt(O,ne=>t(46,n=ne)),O),i,l,c=X,u=()=>(c(),c=Qt(A,ne=>t(7,l=ne)),A),d,m,x,h=X,v=()=>(h(),h=Qt(R,ne=>t(10,x=ne)),R),w,_;o.$$.on_destroy.push(()=>s()),o.$$.on_destroy.push(()=>c()),o.$$.on_destroy.push(()=>h());let{relay:A}=e;u();let U=A.folders;me(o,U,ne=>t(9,m=ne));let{plugin:L}=e,{sharedFolders:R}=e;v();let{relayRoles:O}=e;a();function M(ne){if(!ne)return"Active";let We=(0,ip.default)(),tt=(0,ip.default)(ne).diff(We,"days");return tt<=0?"Subscription has ended":tt===1?"Active for 1 more day":`Active for ${tt} more days`}let E=l.subscriptions;me(o,E,ne=>t(6,i=ne));let F=lo(i,ne=>{if(ne.values().length===0)return;let We=ne.values()[0];return We.token||L.relayManager.getSubscriptionToken(We).then(nt=>{We.token=nt}),We});me(o,F,ne=>t(12,_=ne));let q=n.filter(ne=>ne.relayId===A.id);me(o,q,ne=>t(11,w=ne));let J=_e(!0);me(o,J,ne=>t(5,r=ne));let G;er(()=>{G&&G.value===""&&G.focus()});let z=$t();function W(ne){return Ge(this,void 0,void 0,function*(){var We;if(!(!((We=L.loginManager)===null||We===void 0)&&We.user))return;let nt={relay:ne.id,quantity:10,user_email:L.loginManager.user.email},tt=btoa(JSON.stringify(nt)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");window.open(L.buildApiUrl(`/subscribe/${tt}`),"_blank")})}function oe(ne){return Ge(this,void 0,void 0,function*(){let We=ne.token,nt=ne.id;window.open(L.buildApiUrl(`/subscriptions/${nt}/manage?token=${We}`),"_blank")})}function Ie(ne){return Ge(this,void 0,void 0,function*(){let We=ne.token,nt=ne.id;window.open(L.buildApiUrl(`/subscriptions/${nt}/cancel?token=${We}`),"_blank")})}function Pe(){return Ge(this,void 0,void 0,function*(){L.relayManager.leaveRelay(A),z("goBack",{clear:!0})})}function Ee(){return Ge(this,void 0,void 0,function*(){z("goBack",{clear:!0})})}let Ye;L.relayManager.getRelayInvitationKey(A).then(ne=>{t(4,Ye=ne)});function Fe(ne,We,nt){return Ge(this,void 0,void 0,function*(){let tt=(0,mt.normalizePath)((0,Xy.join)(nt,We));L.vault.getFolderByPath(tt)===null&&(yield L.vault.createFolder(tt));let Ae=L.sharedFolders.new(tt,ne.guid,A.guid,!0);return Ae.remote=ne,L.sharedFolders.notifyListeners(),Ae})}let de=_e(!1);me(o,de,ne=>t(8,d=ne));let fe=L.timeProvider.debounce(()=>{L.relayManager.updateRelay(A).then(()=>{de.set(!1)})},500),te=ne=>{new Wl(L.app,R,ne,Fe).open()};function $e(){J.set(aP(G.value)),r&&G.value!==""&&(de.set(!0),fe())}function Lt(){L.relayManager.destroyRelay(A),z("goBack",{})}function Mt(ne){L.relayManager.kick(ne)}function Rt(ne,We){ne&&z("manageSharedFolder",{folder:ne,relay:We,mount:!1})}function ht(ne){let We=ne.target;We.focus(),We.select(),navigator.clipboard.writeText(We.value).then(()=>new mt.Notice("Invite link copied")).catch(nt=>{})}let gt=new Hl(L.app,R,ne=>Ge(void 0,void 0,void 0,function*(){let We=(0,mt.normalizePath)(ne),nt=R.find(Yr=>Yr.path==ne);if(nt){let Yr=yield L.relayManager.createRemoteFolder(nt,A);nt.remote=Yr,nt.connect(),L.sharedFolders.notifyListeners();return}L.vault.getFolderByPath(We)===null&&(yield L.vault.createFolder(We));let tt=Mi(),Ae=L.sharedFolders.new((0,mt.normalizePath)(ne),tt,A.guid,!0),jr=yield L.relayManager.createRemoteFolder(Ae,A);Ae.remote=jr,L.sharedFolders.notifyListeners()})),dt=(ne,We)=>We.remote===ne;function qt(){A.name=this.value,u(t(0,A))}function un(ne){Ar[ne?"unshift":"push"](()=>{G=ne,t(3,G)})}let Nn=(ne,We)=>We.remote===ne;function js(ne){zr.call(this,o,ne)}let Ys=ne=>{let We=x.find(nt=>nt.remote===ne);We&&Rt(We,ne.relay)},Hn=ne=>{te(ne)},Js=()=>{gt.open()},_r=ne=>{Mt(ne)},ot=()=>{oe(_)},Nt=()=>{Ie(_)},po=()=>{W(l)},dn=()=>{Pe()};return o.$$set=ne=>{"relay"in ne&&u(t(0,A=ne.relay)),"plugin"in ne&&t(32,L=ne.plugin),"sharedFolders"in ne&&v(t(1,R=ne.sharedFolders)),"relayRoles"in ne&&a(t(2,O=ne.relayRoles))},[A,R,O,G,Ye,r,i,l,d,m,x,w,_,U,M,E,F,q,J,W,oe,Ie,Pe,Ee,de,te,$e,Lt,Mt,Rt,ht,gt,L,dt,qt,un,Nn,js,Ys,Hn,Js,_r,ot,Nt,po,dn]}var lp=class extends Z{constructor(e){super(),ee(this,e,iP,sP,Q,{relay:0,plugin:32,sharedFolders:1,relayRoles:2},TD,[-1,-1])}},zs=lp;function lP(o){let e,t,r,n,s,a;return r=new Cu({}),{c(){e=D("div"),t=D("div"),V(r.$$.fragment),b(t,"class","clickable-icon"),b(t,"aria-label","Back"),b(t,"tabindex","0"),b(t,"role","button"),b(e,"class","modal-setting-nav-bar")},m(i,l){T(i,e,l),k(e,t),N(r,t,null),n=!0,s||(a=[re(t,"click",o[0]),re(t,"keypress",o[1])],s=!0)},p:X,i(i){n||(I(r.$$.fragment,i),n=!0)},o(i){P(r.$$.fragment,i),n=!1},d(i){i&&C(e),H(r),s=!1,ke(a)}}}function fP(o){let e=$t();function t(){e("goBack",{})}function r(n){n.key==="Escape"&&(e("goBack",{}),n.stopPropagation())}return[t,r]}var fp=class extends Z{constructor(e){super(),ee(this,e,fP,lP,Q,{})}},Qy=fp;var Ks=require("obsidian");function cP(o){let e=o[1].name+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n&2&&e!==(e=r[1].name+"")&&se(t,e)},d(r){r&&C(t)}}}function uP(o){let e,t,r;return{c(){e=D("button"),e.textContent="Delete local",b(e,"class","mod-warning")},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,Ks.debounce)(o[13])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function dP(o){let e,t,r,n,s,a,i;return{c(){e=D("button"),t=K("Delete metadata"),b(e,"class",r=o[4]?"mod-disabled":"mod-warning"),e.disabled=n=!!o[4],b(e,"aria-label",s=o[4]?"Metadata is required for sharing.":"")},m(l,c){T(l,e,c),k(e,t),a||(i=re(e,"click",(0,Ks.debounce)(o[14])),a=!0)},p(l,c){c&16&&r!==(r=l[4]?"mod-disabled":"mod-warning")&&b(e,"class",r),c&16&&n!==(n=!!l[4])&&(e.disabled=n),c&16&&s!==(s=l[4]?"Metadata is required for sharing.":"")&&b(e,"aria-label",s)},d(l){l&&C(e),a=!1,i()}}}function Zy(o){var n,s,a,i,l;let e,t,r=(((n=o[4])==null?void 0:n.owner)||((i=(a=(s=o[3])==null?void 0:s.remote)==null?void 0:a.creator)==null?void 0:i.id)===((l=o[0].relayManager.user)==null?void 0:l.id))&&eb(o);return{c(){r&&r.c(),e=Ce()},m(c,u){r&&r.m(c,u),T(c,e,u),t=!0},p(c,u){var d,m,x,h,v;(d=c[4])!=null&&d.owner||((h=(x=(m=c[3])==null?void 0:m.remote)==null?void 0:x.creator)==null?void 0:h.id)===((v=c[0].relayManager.user)==null?void 0:v.id)?r?(r.p(c,u),u&25&&I(r,1)):(r=eb(c),r.c(),I(r,1),r.m(e.parentNode,e)):r&&(be(),P(r,1,1,()=>{r=null}),we())},i(c){t||(I(r),t=!0)},o(c){P(r),t=!1},d(c){c&&C(e),r&&r.d(c)}}}function eb(o){let e,t,r,n;return e=new Je({props:{name:"Remote Folder"}}),r=new He({props:{name:"Remove from relay",description:"Deletes the remote folder from the relay. Local files will be preserved.",$$slots:{default:[pP]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment),t=B(),V(r.$$.fragment)},m(s,a){N(e,s,a),T(s,t,a),N(r,s,a),n=!0},p(s,a){let i={};a&1048576&&(i.$$scope={dirty:a,ctx:s}),r.$set(i)},i(s){n||(I(e.$$.fragment,s),I(r.$$.fragment,s),n=!0)},o(s){P(e.$$.fragment,s),P(r.$$.fragment,s),n=!1},d(s){s&&C(t),H(e,s),H(r,s)}}}function pP(o){let e,t,r;return{c(){e=D("button"),e.textContent="Delete remote",b(e,"class","mod-destructive")},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,Ks.debounce)(o[9])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function mP(o){let e,t;return e=new He({props:{description:"This folder is tracking edits, but is not connected to a Relay Server."}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p:X,i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function hP(o){let e,t;return e=new cr({props:{$$slots:{name:[yP],default:[gP]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&1048592&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function gP(o){let e,t;return e=new On({}),e.$on("settings",function(){ut((0,Ks.debounce)(o[16]))&&(0,Ks.debounce)(o[16]).apply(this,arguments)}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){o=r},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function xP(o){let e=o[4].name+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n&16&&e!==(e=r[4].name+"")&&se(t,e)},d(r){r&&C(t)}}}function yP(o){let e,t;return e=new fn({props:{slot:"name",relay:o[4],$$slots:{default:[xP]},$$scope:{ctx:o}}}),e.$on("manageRelay",o[15]),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&16&&(s.relay=r[4]),n&1048592&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function bP(o){let e,t,r,n,s,a,i,l,c,u,d,m,x,h,v;e=new Nl({props:{category:fo,categoryText:"Shared Folders",$$slots:{default:[cP]},$$scope:{ctx:o}}}),e.$on("goBack",o[7]),r=new Je({props:{name:"Local folder"}}),s=new He({props:{name:"Delete from vault",description:"Delete the local Shared Folder and all of its contents.",$$slots:{default:[uP]},$$scope:{ctx:o}}}),i=new He({props:{name:"Delete metadata",description:"Deletes edit history and disables change tracking.",$$slots:{default:[dP]},$$scope:{ctx:o}}});let w=o[4]&&Zy(o);u=new Je({props:{name:"Relay Server"}});let _=[hP,mP],A=[];function U(L,R){return L[4]?0:1}return m=U(o,-1),x=A[m]=_[m](o),{c(){V(e.$$.fragment),t=B(),V(r.$$.fragment),n=B(),V(s.$$.fragment),a=B(),V(i.$$.fragment),l=B(),w&&w.c(),c=B(),V(u.$$.fragment),d=B(),x.c(),h=Ce()},m(L,R){N(e,L,R),T(L,t,R),N(r,L,R),T(L,n,R),N(s,L,R),T(L,a,R),N(i,L,R),T(L,l,R),w&&w.m(L,R),T(L,c,R),N(u,L,R),T(L,d,R),A[m].m(L,R),T(L,h,R),v=!0},p(L,[R]){let O={};R&1048578&&(O.$$scope={dirty:R,ctx:L}),e.$set(O);let M={};R&1048576&&(M.$$scope={dirty:R,ctx:L}),s.$set(M);let E={};R&1048592&&(E.$$scope={dirty:R,ctx:L}),i.$set(E),L[4]?w?(w.p(L,R),R&16&&I(w,1)):(w=Zy(L),w.c(),I(w,1),w.m(c.parentNode,c)):w&&(be(),P(w,1,1,()=>{w=null}),we());let F=m;m=U(L,R),m===F?A[m].p(L,R):(be(),P(A[F],1,1,()=>{A[F]=null}),we(),x=A[m],x?x.p(L,R):(x=A[m]=_[m](L),x.c()),I(x,1),x.m(h.parentNode,h))},i(L){v||(I(e.$$.fragment,L),I(r.$$.fragment,L),I(s.$$.fragment,L),I(i.$$.fragment,L),I(w),I(u.$$.fragment,L),I(x),v=!0)},o(L){P(e.$$.fragment,L),P(r.$$.fragment,L),P(s.$$.fragment,L),P(i.$$.fragment,L),P(w),P(u.$$.fragment,L),P(x),v=!1},d(L){L&&(C(t),C(n),C(a),C(l),C(c),C(d),C(h)),H(e,L),H(r,L),H(s,L),H(i,L),w&&w.d(L),H(u,L),A[m].d(L)}}}function wP(o,e,t){let r,n,s=X,a=()=>(s(),s=Qt(u,F=>t(17,n=F)),u),i;o.$$.on_destroy.push(()=>s());let{plugin:l}=e,{sharedFolder:c}=e,{sharedFolders:u}=e;a();let{relayRoles:d}=e,m=lo(n,F=>F.find(q=>q===c));me(o,m,F=>t(3,r=F));let x=lo([m,d],([F,q])=>{var J;return(J=q.find(G=>{var z;return G.relay===((z=F==null?void 0:F.remote)===null||z===void 0?void 0:z.relay)}))===null||J===void 0?void 0:J.relay});me(o,x,F=>t(4,i=F));let h;er(()=>{!c&&h&&h.value===""&&h.focus()});let v=$t();function w(){return Ge(this,void 0,void 0,function*(){v("goBack",{clear:!0})})}function _(F){F&&v("manageRelay",{relay:F})}function A(){return Ge(this,void 0,void 0,function*(){yield l.relayManager.deleteRemote(c),l.sharedFolders.notifyListeners()})}function U(){return Ge(this,void 0,void 0,function*(){r&&l.sharedFolders.delete(r),v("goBack",{clear:!0})})}function L(){let F=l.vault.getFolderByPath(c.path);F&&l.app.vault.trash(F,!1),v("goBack",{})}let R=()=>{L()},O=()=>{U()};function M(F){zr.call(this,o,F)}let E=()=>{_(i)};return o.$$set=F=>{"plugin"in F&&t(0,l=F.plugin),"sharedFolder"in F&&t(1,c=F.sharedFolder),"sharedFolders"in F&&a(t(2,u=F.sharedFolders)),"relayRoles"in F&&t(12,d=F.relayRoles)},[l,c,u,r,i,m,x,w,_,A,U,L,d,R,O,M,E]}var cp=class extends Z{constructor(e){super(),ee(this,e,wP,bP,Q,{plugin:0,sharedFolder:1,sharedFolders:2,relayRoles:12})}},up=cp;function _P(o){let e=[],t="",r=0;for(;r<o.length;)o[r]==="*"&&r+1<o.length&&o[r+1]==="*"?(t&&(e.push({type:"TEXT",value:t}),t=""),e.push({type:"DOUBLE_STAR"}),r+=2):o[r]==="*"?(t&&(e.push({type:"TEXT",value:t}),t=""),e.push({type:"STAR"}),r++):(t+=o[r],r++);return t&&e.push({type:"TEXT",value:t}),e}function vP(o){let e="",t="NORMAL",r=0;for(;r<o.length;){let n=o[r];switch(t){case"NORMAL":n.type==="TEXT"?e+=n.value:n.type==="STAR"?(t="EMPHASIS",e+="<u>"):n.type==="DOUBLE_STAR"&&(t="BOLD",e+="<strong>");break;case"EMPHASIS":n.type==="TEXT"?e+=n.value:n.type==="STAR"?(t="NORMAL",e+="</u>"):n.type==="DOUBLE_STAR"&&(t="BOLD",e+="</u><strong>");break;case"BOLD":n.type==="TEXT"?e+=n.value:n.type==="STAR"?e+="*":n.type==="DOUBLE_STAR"&&(t="NORMAL",e+="</strong>");break}r++}return t==="EMPHASIS"?e+="</u>":t==="BOLD"&&(e+="</strong>"),e}function dp(o){let e=_P(o);return vP(e)}function SP(o){De(o,"svelte-d22j3",".relay-version.svelte-d22j3{user-select:auto;background:var(--color-base-10);color:var(--text-faint);position:absolute;bottom:0;right:0;font-size:xx-small;padding-right:1em;padding-top:0.3em;padding-left:1em;border-top-left-radius:1em}.vertical-tab-content.svelte-d22j3{max-height:var(--modal-max-height);position:relative}.system3-announcement-banner.svelte-d22j3{padding-left:48px !important}.system3-announcement.svelte-d22j3{color:var(--text-on-accent)}")}function kP(o){let e,t,r,n,s=o[0].networkStatus.status&&tb(o);return{c(){e=D("div"),t=D("span"),s&&s.c(),b(t,"class","system3-announcement svelte-d22j3"),ue(t,"color",o[0].networkStatus.status.color?o[0].networkStatus.status.color:"var(--text-on-accent)",1),b(e,"class","modal-setting-nav-bar system3-announcement-banner svelte-d22j3"),b(e,"role","button"),b(e,"tabindex","0"),ue(e,"background-color",o[0].networkStatus.status.backgroundColor?o[0].networkStatus.status.backgroundColor:"var(--color-accent)",1)},m(a,i){T(a,e,i),k(e,t),s&&s.m(t,null),r||(n=[re(e,"click",o[17]),re(e,"keypress",o[18])],r=!0)},p(a,i){a[0].networkStatus.status?s?s.p(a,i):(s=tb(a),s.c(),s.m(t,null)):s&&(s.d(1),s=null),i&1&&ue(t,"color",a[0].networkStatus.status.color?a[0].networkStatus.status.color:"var(--text-on-accent)",1),i&1&&ue(e,"background-color",a[0].networkStatus.status.backgroundColor?a[0].networkStatus.status.backgroundColor:"var(--color-accent)",1)},i:X,o:X,d(a){a&&C(e),s&&s.d(),r=!1,ke(n)}}}function LP(o){let e,t;return e=new Qy({}),e.$on("goBack",o[9]),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p:X,i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function tb(o){let e,t=dp(o[0].networkStatus.status.status)+"",r;return{c(){e=new As(!1),r=Ce(),e.a=r},m(n,s){e.m(t,n,s),T(n,r,s)},p(n,s){s&1&&t!==(t=dp(n[0].networkStatus.status.status)+"")&&e.p(t)},d(n){n&&(C(r),e.d())}}}function IP(o){let e,t;return e=new yy({props:{plugin:o[0],$$slots:{default:[DP]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&1&&(s.plugin=r[0]),n&8388609&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function CP(o){let e,t;return e=new zs({props:{plugin:o[0],relayRoles:o[3],relay:o[2],sharedFolders:o[5]}}),e.$on("goBack",o[9]),e.$on("close",o[10]),e.$on("manageSharedFolder",o[7]),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&1&&(s.plugin=r[0]),n&4&&(s.relay=r[2]),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function TP(o){let e,t;return e=new up({props:{plugin:o[0],relayRoles:o[3],sharedFolder:o[1],sharedFolders:o[5]}}),e.$on("goBack",o[9]),e.$on("close",o[10]),e.$on("manageRelay",o[6]),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&1&&(s.plugin=r[0]),n&2&&(s.sharedFolder=r[1]),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function DP(o){let e,t;return e=new co({props:{relays:o[4],plugin:o[0]}}),e.$on("manageRelay",o[6]),e.$on("manageSharedFolder",o[7]),e.$on("createRelay",o[8]),e.$on("joinRelay",o[11]),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&1&&(s.plugin=r[0]),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function rb(o){let e,t=o[0].version+"",r;return{c(){e=D("span"),r=K(t),b(e,"class","relay-version svelte-d22j3")},m(n,s){T(n,e,s),k(e,r)},p(n,s){s&1&&t!==(t=n[0].version+"")&&se(r,t)},d(n){n&&C(e)}}}function PP(o){let e,t,r,n,s,a,i,l,c,u=[LP,kP],d=[];function m(_,A){return _[2]||_[1]?0:_[0].networkStatus.status?1:-1}~(e=m(o,-1))&&(t=d[e]=u[e](o));let x=[TP,CP,IP],h=[];function v(_,A){return _[1]?0:_[2]?1:2}s=v(o,-1),a=h[s]=x[s](o);let w=o[0].manifest.version!==o[0].version&&rb(o);return{c(){t&&t.c(),r=B(),n=D("div"),a.c(),i=B(),w&&w.c(),l=Ce(),b(n,"class","vertical-tab-content svelte-d22j3")},m(_,A){~e&&d[e].m(_,A),T(_,r,A),T(_,n,A),h[s].m(n,null),T(_,i,A),w&&w.m(_,A),T(_,l,A),c=!0},p(_,[A]){let U=e;e=m(_,A),e===U?~e&&d[e].p(_,A):(t&&(be(),P(d[U],1,1,()=>{d[U]=null}),we()),~e?(t=d[e],t?t.p(_,A):(t=d[e]=u[e](_),t.c()),I(t,1),t.m(r.parentNode,r)):t=null);let L=s;s=v(_,A),s===L?h[s].p(_,A):(be(),P(h[L],1,1,()=>{h[L]=null}),we(),a=h[s],a?a.p(_,A):(a=h[s]=x[s](_),a.c()),I(a,1),a.m(n,null)),_[0].manifest.version!==_[0].version?w?w.p(_,A):(w=rb(_),w.c(),w.m(l.parentNode,l)):w&&(w.d(1),w=null)},i(_){c||(I(t),I(a),c=!0)},o(_){P(t),P(a),c=!1},d(_){_&&(C(r),C(n),C(i),C(l)),~e&&d[e].d(_),h[s].d(),w&&w.d(_)}}}function AP(o,e,t){let r,{plugin:n}=e,{path:s=void 0}=e,a=n.app,i=n.relayManager,l=i.relayRoles,c=i.relays;me(o,c,q=>t(16,r=q));let u=n.sharedFolders,d,m=co,x,h=[{component:co}],{close:v}=e;function w(q){if(t(2,x=void 0),t(1,d=void 0),q==="/"){t(15,m=co);return}let J=new URLSearchParams(q.split("?")[1]||""),G=J.get("id");if(q.startsWith("/relays")){G?(t(2,x=i.relays.find(z=>z.guid===G)),t(15,m=zs)):t(15,m=co);return}if(q.startsWith("/shared-folders")){if(G){t(1,d=u.find(W=>W.guid===G));let z=J.get("relay");z&&t(2,x=i.relays.get(z)),t(15,m=up)}return}}function _(q){h.push({currentRelay:x,sharedFolder:d,component:m}),t(2,x=q.detail.relay),t(1,d=void 0),t(15,m=zs)}function A(q){h.push({currentRelay:x,sharedFolder:d,component:m}),t(1,d=q.detail.folder),t(2,x=q.detail.relay)}function U(q){return Ge(this,void 0,void 0,function*(){h.push({currentRelay:x,sharedFolder:d,component:m}),t(2,x=yield n.relayManager.createRelay("")),t(15,m=zs)})}function L(q){if(q.detail.clear){h.length=0,t(2,x=void 0),t(1,d=void 0),t(15,m=co);return}let J=h.pop();if(J)for(;J;){if(!J.currentRelay&&!J.sharedFolder)t(2,x=J.currentRelay),t(1,d=J.sharedFolder),t(15,m=J.component);else if(J.sharedFolder&&u.has(J.sharedFolder)){t(2,x=J.currentRelay),t(1,d=J.sharedFolder),t(15,m=J.component);break}else if(J.currentRelay&&i.relays.get(J.currentRelay.id)){t(2,x=J.currentRelay),t(1,d=J.sharedFolder),t(15,m=J.component);break}J=h.pop()}else t(2,x=void 0),t(1,d=void 0),t(15,m=co)}function R(q){h.length=0,v()}function O(q){t(2,x=q.detail.relay),t(15,m=zs)}function M(){var q;!((q=n.networkStatus.status)===null||q===void 0)&&q.versions&&(n.releaseSettings.get().channel==="stable"?n.installVersion(n.networkStatus.status.versions.stable):n.releaseSettings.get().channel==="beta"&&n.installVersion(n.networkStatus.status.versions.beta))}let E=()=>{var q,J;(q=n.networkStatus.status)!=null&&q.versions?M():(J=n.networkStatus.status)!=null&&J.link&&window.open(n.networkStatus.status.link)},F=()=>{var q,J;(q=n.networkStatus.status)!=null&&q.versions?M():(J=n.networkStatus.status)!=null&&J.link&&window.open(n.networkStatus.status.link)};return o.$$set=q=>{"plugin"in q&&t(0,n=q.plugin),"path"in q&&t(13,s=q.path),"close"in q&&t(14,v=q.close)},o.$$.update=()=>{if(o.$$.dirty&8192){e:s&&w(s)}if(o.$$.dirty&65540){e:x&&!r.has(x.id)&&(t(2,x=void 0),t(15,m=co))}if(o.$$.dirty&2){e:d&&!u.has(d)&&(t(1,d=void 0),t(15,m=co))}if(o.$$.dirty&32774){e:(m||x||d)&&setTimeout(()=>{let q=document.querySelector(".vertical-tab-content");q&&(q.scrollTop=0)},0)}},[n,d,x,l,c,u,_,A,U,L,R,O,M,s,v,m,r,E,F]}var pp=class extends Z{constructor(e){super(),ee(this,e,AP,PP,Q,{plugin:0,path:13,close:14},SP)}},ob=pp;var zl=class extends nb.PluginSettingTab{constructor(t,r){super(t,r);this.plugin=r}display(){let{containerEl:t}=this;this.targetEl=t.parentElement,this.targetEl.empty(),this.plugin.relayManager.update(),this.component=new ob({target:this.targetEl,props:{plugin:this.plugin,close:()=>{this.setting.close()}}})}navigateTo(t){var r;(r=this.component)==null||r.$set({path:t})}hide(){var t;try{(t=this.component)==null||t.$destroy()}catch(r){console.warn(r)}}destroy(){this.hide(),this.plugin=null}};var ub=require("obsidian");var tr=class extends Error{constructor(e){var t,r,n,s;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,tr.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof tr||(this.originalError=e),typeof DOMException!="undefined"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(t=this.response)==null?void 0:t.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(s=(n=(r=this.originalError)==null?void 0:r.cause)==null?void 0:n.message)!=null&&s.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong while processing your request.")}get data(){return this.response}toJSON(){return{...this}}},Kl=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function EP(o,e){let t={};if(typeof o!="string")return t;let r=Object.assign({},e||{}).decode||MP,n=0;for(;n<o.length;){let s=o.indexOf("=",n);if(s===-1)break;let a=o.indexOf(";",n);if(a===-1)a=o.length;else if(a<s){n=o.lastIndexOf(";",s-1)+1;continue}let i=o.slice(n,s).trim();if(t[i]===void 0){let l=o.slice(s+1,a).trim();l.charCodeAt(0)===34&&(l=l.slice(1,-1));try{t[i]=r(l)}catch(c){t[i]=l}}n=a+1}return t}function sb(o,e,t){let r=Object.assign({},t||{}),n=r.encode||RP;if(!Kl.test(o))throw new TypeError("argument name is invalid");let s=n(e);if(s&&!Kl.test(s))throw new TypeError("argument val is invalid");let a=o+"="+s;if(r.maxAge!=null){let i=r.maxAge-0;if(isNaN(i)||!isFinite(i))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(i)}if(r.domain){if(!Kl.test(r.domain))throw new TypeError("option domain is invalid");a+="; Domain="+r.domain}if(r.path){if(!Kl.test(r.path))throw new TypeError("option path is invalid");a+="; Path="+r.path}if(r.expires){if(!function(l){return Object.prototype.toString.call(l)==="[object Date]"||l instanceof Date}(r.expires)||isNaN(r.expires.valueOf()))throw new TypeError("option expires is invalid");a+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(a+="; HttpOnly"),r.secure&&(a+="; Secure"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():r.priority){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return a}function MP(o){return o.indexOf("%")!==-1?decodeURIComponent(o):o}function RP(o){return encodeURIComponent(o)}var lb;function Gl(o){if(o)try{let e=decodeURIComponent(lb(o.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch(e){}return{}}function fb(o,e=0){let t=Gl(o);return!(Object.keys(t).length>0&&(!t.exp||t.exp-e>Date.now()/1e3))}lb=typeof atob=="function"?atob:o=>{let e=String(o).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,r,n=0,s=0,a="";r=e.charAt(s++);~r&&(t=n%4?64*t+r:r,n++%4)?a+=String.fromCharCode(255&t>>(-2*n&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return a};var ab="pb_auth",za=class{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get model(){return this.baseModel}get isValid(){return!fb(this.token)}get isAdmin(){return Gl(this.token).type==="admin"}get isAuthRecord(){return Gl(this.token).type==="authRecord"}save(e,t){this.baseToken=e||"",this.baseModel=t||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,t=ab){let r=EP(e||"")[t]||"",n={};try{n=JSON.parse(r),(typeof n===null||typeof n!="object"||Array.isArray(n))&&(n={})}catch(s){}this.save(n.token||"",n.model||null)}exportToCookie(e,t=ab){var l,c;let r={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},n=Gl(this.token);r.expires=n!=null&&n.exp?new Date(1e3*n.exp):new Date("1970-01-01"),e=Object.assign({},r,e);let s={token:this.token,model:this.model?JSON.parse(JSON.stringify(this.model)):null},a=sb(t,JSON.stringify(s),e),i=typeof Blob!="undefined"?new Blob([a]).size:a.length;if(s.model&&i>4096){s.model={id:(l=s==null?void 0:s.model)==null?void 0:l.id,email:(c=s==null?void 0:s.model)==null?void 0:c.email};let u=["collectionId","username","verified"];for(let d in this.model)u.includes(d)&&(s.model[d]=this.model[d]);a=sb(t,JSON.stringify(s),e)}return a}onChange(e,t=!1){return this._onChangeCallbacks.push(e),t&&e(this.token,this.model),()=>{for(let r=this._onChangeCallbacks.length-1;r>=0;r--)if(this._onChangeCallbacks[r]==e)return delete this._onChangeCallbacks[r],void this._onChangeCallbacks.splice(r,1)}}triggerChange(){for(let e of this._onChangeCallbacks)e&&e(this.token,this.model)}},hp=class extends za{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(e,t){this._storageSet(this.storageKey,{token:e,model:t}),super.save(e,t)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window!="undefined"&&(window!=null&&window.localStorage)){let t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch(r){return t}}return this.storageFallback[e]}_storageSet(e,t){if(typeof window!="undefined"&&(window!=null&&window.localStorage)){let r=t;typeof t!="string"&&(r=JSON.stringify(t)),window.localStorage.setItem(e,r)}else this.storageFallback[e]=t}_storageRemove(e){var t;typeof window!="undefined"&&(window!=null&&window.localStorage)&&((t=window.localStorage)==null||t.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window!="undefined"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;let t=this._storageGet(this.storageKey)||{};super.save(t.token||"",t.model||null)})}},$o=class{constructor(e){this.client=e}},gp=class extends $o{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,t){return t=Object.assign({method:"PATCH",body:e},t),this.client.send("/api/settings",t)}async testS3(e="storage",t){return t=Object.assign({method:"POST",body:{filesystem:e}},t),this.client.send("/api/settings/test/s3",t).then(()=>!0)}async testEmail(e,t,r){return r=Object.assign({method:"POST",body:{email:e,template:t}},r),this.client.send("/api/settings/test/email",r).then(()=>!0)}async generateAppleClientSecret(e,t,r,n,s,a){return a=Object.assign({method:"POST",body:{clientId:e,teamId:t,keyId:r,privateKey:n,duration:s}},a),this.client.send("/api/settings/apple/generate-client-secret",a)}},Ka=class extends $o{decode(e){return e}async getFullList(e,t){if(typeof e=="number")return this._getFullList(e,t);let r=500;return(t=Object.assign({},e,t)).batch&&(r=t.batch,delete t.batch),this._getFullList(r,t)}async getList(e=1,t=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:t},r.query),this.client.send(this.baseCrudPath,r).then(n=>{var s;return n.items=((s=n.items)==null?void 0:s.map(a=>this.decode(a)))||[],n})}async getFirstListItem(e,t){return(t=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},t)).query=Object.assign({filter:e,skipTotal:1},t.query),this.getList(1,1,t).then(r=>{var n;if(!((n=r==null?void 0:r.items)!=null&&n.length))throw new tr({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return r.items[0]})}async getOne(e,t){if(!e)throw new tr({url:this.client.buildUrl(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(r=>this.decode(r))}async create(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send(this.baseCrudPath,t).then(r=>this.decode(r))}async update(e,t,r){return r=Object.assign({method:"PATCH",body:t},r),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),r).then(n=>this.decode(n))}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),t).then(()=>!0)}_getFullList(e=500,t){(t=t||{}).query=Object.assign({skipTotal:1},t.query);let r=[],n=async s=>this.getList(s,e||500,t).then(a=>{let i=a.items;return r=r.concat(i),i.length==a.perPage?n(s+1):r});return n(1)}};function yr(o,e,t,r){let n=r!==void 0;return n||t!==void 0?n?(console.warn(o),e.body=Object.assign({},e.body,t),e.query=Object.assign({},e.query,r),e):Object.assign(e,t):e}function mp(o){var e;(e=o._resetAutoRefresh)==null||e.call(o)}var xp=class extends Ka{get baseCrudPath(){return"/api/admins"}async update(e,t,r){return super.update(e,t,r).then(n=>{var s,a;return((s=this.client.authStore.model)==null?void 0:s.id)===n.id&&((a=this.client.authStore.model)==null?void 0:a.collectionId)===void 0&&this.client.authStore.save(this.client.authStore.token,n),n})}async delete(e,t){return super.delete(e,t).then(r=>{var n,s;return r&&((n=this.client.authStore.model)==null?void 0:n.id)===e&&((s=this.client.authStore.model)==null?void 0:s.collectionId)===void 0&&this.client.authStore.clear(),r})}authResponse(e){let t=this.decode((e==null?void 0:e.admin)||{});return e!=null&&e.token&&(e!=null&&e.admin)&&this.client.authStore.save(e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",admin:t})}async authWithPassword(e,t,r,n){let s={method:"POST",body:{identity:e,password:t}};s=yr("This form of authWithPassword(email, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(email, pass, options?).",s,r,n);let a=s.autoRefreshThreshold;delete s.autoRefreshThreshold,s.autoRefresh||mp(this.client);let i=await this.client.send(this.baseCrudPath+"/auth-with-password",s);return i=this.authResponse(i),a&&function(c,u,d,m){mp(c);let x=c.beforeSend,h=c.authStore.model,v=c.authStore.onChange((w,_)=>{(!w||(_==null?void 0:_.id)!=(h==null?void 0:h.id)||(_!=null&&_.collectionId||h!=null&&h.collectionId)&&(_==null?void 0:_.collectionId)!=(h==null?void 0:h.collectionId))&&mp(c)});c._resetAutoRefresh=function(){v(),c.beforeSend=x,delete c._resetAutoRefresh},c.beforeSend=async(w,_)=>{var R;let A=c.authStore.token;if((R=_.query)!=null&&R.autoRefresh)return x?x(w,_):{url:w,sendOptions:_};let U=c.authStore.isValid;if(U&&fb(c.authStore.token,u))try{await d()}catch(O){U=!1}U||await m();let L=_.headers||{};for(let O in L)if(O.toLowerCase()=="authorization"&&A==L[O]&&c.authStore.token){L[O]=c.authStore.token;break}return _.headers=L,x?x(w,_):{url:w,sendOptions:_}}}(this.client,a,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,t,Object.assign({autoRefresh:!0},s))),i}async authRefresh(e,t){let r={method:"POST"};return r=yr("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",r,e,t),this.client.send(this.baseCrudPath+"/auth-refresh",r).then(this.authResponse.bind(this))}async requestPasswordReset(e,t,r){let n={method:"POST",body:{email:e}};return n=yr("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,t,r),this.client.send(this.baseCrudPath+"/request-password-reset",n).then(()=>!0)}async confirmPasswordReset(e,t,r,n,s){let a={method:"POST",body:{token:e,password:t,passwordConfirm:r}};return a=yr("This form of confirmPasswordReset(resetToken, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(resetToken, password, passwordConfirm, options?).",a,n,s),this.client.send(this.baseCrudPath+"/confirm-password-reset",a).then(()=>!0)}},FP=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function cb(o){if(o){o.query=o.query||{};for(let e in o)FP.includes(e)||(o.query[e]=o[e],delete o[e])}}var jl=class extends $o{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,t,r){var a;if(!e)throw new Error("topic must be set.");let n=e;if(r){cb(r);let i="options="+encodeURIComponent(JSON.stringify({query:r.query,headers:r.headers}));n+=(n.includes("?")?"&":"?")+i}let s=function(i){let l=i,c;try{c=JSON.parse(l==null?void 0:l.data)}catch(u){}t(c||{})};return this.subscriptions[n]||(this.subscriptions[n]=[]),this.subscriptions[n].push(s),this.isConnected?this.subscriptions[n].length===1?await this.submitSubscriptions():(a=this.eventSource)==null||a.addEventListener(n,s):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,s)}async unsubscribe(e){var r;let t=!1;if(e){let n=this.getSubscriptionsByTopic(e);for(let s in n)if(this.hasSubscriptionListeners(s)){for(let a of this.subscriptions[s])(r=this.eventSource)==null||r.removeEventListener(s,a);delete this.subscriptions[s],t||(t=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?t&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var r;let t=!1;for(let n in this.subscriptions)if((n+"?").startsWith(e)){t=!0;for(let s of this.subscriptions[n])(r=this.eventSource)==null||r.removeEventListener(n,s);delete this.subscriptions[n]}t&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,t){var s;let r=!1,n=this.getSubscriptionsByTopic(e);for(let a in n){if(!Array.isArray(this.subscriptions[a])||!this.subscriptions[a].length)continue;let i=!1;for(let l=this.subscriptions[a].length-1;l>=0;l--)this.subscriptions[a][l]===t&&(i=!0,delete this.subscriptions[a][l],this.subscriptions[a].splice(l,1),(s=this.eventSource)==null||s.removeEventListener(a,t));i&&(this.subscriptions[a].length||delete this.subscriptions[a],r||this.hasSubscriptionListeners(a)||(r=!0))}this.hasSubscriptionListeners()?r&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var t,r;if(this.subscriptions=this.subscriptions||{},e)return!!((t=this.subscriptions[e])!=null&&t.length);for(let n in this.subscriptions)if((r=this.subscriptions[n])!=null&&r.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){let t={};e=e.includes("?")?e:e+"?";for(let r in this.subscriptions)(r+"?").startsWith(e)&&(t[r]=this.subscriptions[r]);return t}getNonEmptySubscriptionKeys(){let e=[];for(let t in this.subscriptions)this.subscriptions[t].length&&e.push(t);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.addEventListener(e,t)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let t of this.subscriptions[e])this.eventSource.removeEventListener(e,t)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,t)=>{this.pendingConnects.push({resolve:e,reject:t}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{let t=e;this.clientId=t==null?void 0:t.lastEventId,this.submitSubscriptions().then(async()=>{let r=3;for(;this.hasUnsentSubscriptions()&&r>0;)r--,await this.submitSubscriptions()}).then(()=>{for(let n of this.pendingConnects)n.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);let r=this.getSubscriptionsByTopic("PB_CONNECT");for(let n in r)for(let s of r[n])s(e)}).catch(r=>{this.clientId="",this.connectErrorHandler(r)})})}hasUnsentSubscriptions(){let e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(let t of e)if(!this.lastSentSubscriptions.includes(t))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let r of this.pendingConnects)r.reject(new tr(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);let t=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},t)}disconnect(e=!1){var t;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(t=this.eventSource)==null||t.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let r of this.pendingConnects)r.resolve();this.pendingConnects=[]}}},yp=class extends Ka{constructor(e,t){super(e),this.collectionIdOrName=t}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}async subscribe(e,t,r){if(!e)throw new Error("Missing topic.");if(!t)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,t,r)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,t){if(typeof e=="number")return super.getFullList(e,t);let r=Object.assign({},e,t);return super.getFullList(r)}async getList(e=1,t=30,r){return super.getList(e,t,r)}async getFirstListItem(e,t){return super.getFirstListItem(e,t)}async getOne(e,t){return super.getOne(e,t)}async create(e,t){return super.create(e,t)}async update(e,t,r){return super.update(e,t,r).then(n=>{var s,a,i;return((s=this.client.authStore.model)==null?void 0:s.id)!==(n==null?void 0:n.id)||((a=this.client.authStore.model)==null?void 0:a.collectionId)!==this.collectionIdOrName&&((i=this.client.authStore.model)==null?void 0:i.collectionName)!==this.collectionIdOrName||this.client.authStore.save(this.client.authStore.token,n),n})}async delete(e,t){return super.delete(e,t).then(r=>{var n,s,a;return!r||((n=this.client.authStore.model)==null?void 0:n.id)!==e||((s=this.client.authStore.model)==null?void 0:s.collectionId)!==this.collectionIdOrName&&((a=this.client.authStore.model)==null?void 0:a.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),r})}authResponse(e){let t=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,t),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:t})}async listAuthMethods(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e).then(t=>Object.assign({},t,{usernamePassword:!!(t!=null&&t.usernamePassword),emailPassword:!!(t!=null&&t.emailPassword),authProviders:Array.isArray(t==null?void 0:t.authProviders)?t==null?void 0:t.authProviders:[]}))}async authWithPassword(e,t,r,n){let s={method:"POST",body:{identity:e,password:t}};return s=yr("This form of authWithPassword(usernameOrEmail, pass, body?, query?) is deprecated. Consider replacing it with authWithPassword(usernameOrEmail, pass, options?).",s,r,n),this.client.send(this.baseCollectionPath+"/auth-with-password",s).then(a=>this.authResponse(a))}async authWithOAuth2Code(e,t,r,n,s,a,i){let l={method:"POST",body:{provider:e,code:t,codeVerifier:r,redirectUrl:n,createData:s}};return l=yr("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectUrl, createData?, options?).",l,a,i),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",l).then(c=>this.authResponse(c))}async authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});let t=(e==null?void 0:e[0])||{},r=(await this.listAuthMethods()).authProviders.find(l=>l.name===t.provider);if(!r)throw new tr(new Error(`Missing or invalid provider "${t.provider}".`));let n=this.client.buildUrl("/api/oauth2-redirect"),s=new jl(this.client),a=null;function i(){a==null||a.close(),s.unsubscribe()}return t.urlCallback||(a=ib(void 0)),new Promise(async(l,c)=>{var u;try{await s.subscribe("@oauth2",async h=>{let v=s.clientId;try{if(!h.state||v!==h.state)throw new Error("State parameters don't match.");let w=Object.assign({},t);delete w.provider,delete w.scopes,delete w.createData,delete w.urlCallback;let _=await this.authWithOAuth2Code(r.name,h.code,r.codeVerifier,n,t.createData,w);l(_)}catch(w){c(new tr(w))}i()});let d={state:s.clientId};(u=t.scopes)!=null&&u.length&&(d.scope=t.scopes.join(" "));let m=this._replaceQueryParams(r.authUrl+n,d);await(t.urlCallback||function(h){a?a.location.href=h:a=ib(h)})(m)}catch(d){i(),c(new tr(d))}})}async authRefresh(e,t){let r={method:"POST"};return r=yr("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",r,e,t),this.client.send(this.baseCollectionPath+"/auth-refresh",r).then(n=>this.authResponse(n))}async requestPasswordReset(e,t,r){let n={method:"POST",body:{email:e}};return n=yr("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",n,t,r),this.client.send(this.baseCollectionPath+"/request-password-reset",n).then(()=>!0)}async confirmPasswordReset(e,t,r,n,s){let a={method:"POST",body:{token:e,password:t,passwordConfirm:r}};return a=yr("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",a,n,s),this.client.send(this.baseCollectionPath+"/confirm-password-reset",a).then(()=>!0)}async requestVerification(e,t,r){let n={method:"POST",body:{email:e}};return n=yr("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",n,t,r),this.client.send(this.baseCollectionPath+"/request-verification",n).then(()=>!0)}async confirmVerification(e,t,r){let n={method:"POST",body:{token:e}};return n=yr("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",n,t,r),this.client.send(this.baseCollectionPath+"/confirm-verification",n).then(()=>!0)}async requestEmailChange(e,t,r){let n={method:"POST",body:{newEmail:e}};return n=yr("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",n,t,r),this.client.send(this.baseCollectionPath+"/request-email-change",n).then(()=>!0)}async confirmEmailChange(e,t,r,n){let s={method:"POST",body:{token:e,password:t}};return s=yr("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",s,r,n),this.client.send(this.baseCollectionPath+"/confirm-email-change",s).then(()=>!0)}async listExternalAuths(e,t){return t=Object.assign({method:"GET"},t),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths",t)}async unlinkExternalAuth(e,t,r){return r=Object.assign({method:"DELETE"},r),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/external-auths/"+encodeURIComponent(t),r).then(()=>!0)}_replaceQueryParams(e,t={}){let r=e,n="";e.indexOf("?")>=0&&(r=e.substring(0,e.indexOf("?")),n=e.substring(e.indexOf("?")+1));let s={},a=n.split("&");for(let i of a){if(i=="")continue;let l=i.split("=");s[decodeURIComponent(l[0].replace(/\+/g," "))]=decodeURIComponent((l[1]||"").replace(/\+/g," "))}for(let i in t)t.hasOwnProperty(i)&&(t[i]==null?delete s[i]:s[i]=t[i]);n="";for(let i in s)s.hasOwnProperty(i)&&(n!=""&&(n+="&"),n+=encodeURIComponent(i.replace(/%20/g,"+"))+"="+encodeURIComponent(s[i].replace(/%20/g,"+")));return n!=""?r+"?"+n:r}};function ib(o){if(typeof window=="undefined"||!(window!=null&&window.open))throw new tr(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,t=768,r=window.innerWidth,n=window.innerHeight;e=e>r?r:e,t=t>n?n:t;let s=r/2-e/2,a=n/2-t/2;return window.open(o,"popup_window","width="+e+",height="+t+",top="+a+",left="+s+",resizable,menubar=no")}var bp=class extends Ka{get baseCrudPath(){return"/api/collections"}async import(e,t=!1,r){return r=Object.assign({method:"PUT",body:{collections:e,deleteMissing:t}},r),this.client.send(this.baseCrudPath+"/import",r).then(()=>!0)}},wp=class extends $o{async getList(e=1,t=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:t},r.query),this.client.send("/api/logs",r)}async getOne(e,t){if(!e)throw new tr({url:this.client.buildUrl("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return t=Object.assign({method:"GET"},t),this.client.send("/api/logs/"+encodeURIComponent(e),t)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}},_p=class extends $o{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}},vp=class extends $o{getUrl(e,t,r={}){if(!t||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";let n=[];n.push("api"),n.push("files"),n.push(encodeURIComponent(e.collectionId||e.collectionName)),n.push(encodeURIComponent(e.id)),n.push(encodeURIComponent(t));let s=this.client.buildUrl(n.join("/"));if(Object.keys(r).length){r.download===!1&&delete r.download;let a=new URLSearchParams(r);s+=(s.includes("?")?"&":"?")+a}return s}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(t=>(t==null?void 0:t.token)||"")}},Sp=class extends $o{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,t){return t=Object.assign({method:"POST",body:{name:e}},t),this.client.send("/api/backups",t).then(()=>!0)}async upload(e,t){return t=Object.assign({method:"POST",body:e},t),this.client.send("/api/backups/upload",t).then(()=>!0)}async delete(e,t){return t=Object.assign({method:"DELETE"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}`,t).then(()=>!0)}async restore(e,t){return t=Object.assign({method:"POST"},t),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,t).then(()=>!0)}getDownloadUrl(e,t){return this.client.buildUrl(`/api/backups/${encodeURIComponent(t)}?token=${encodeURIComponent(e)}`)}},Yl=class{constructor(e="/",t,r="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=e,this.lang=r,this.authStore=t||new hp,this.admins=new xp(this),this.collections=new bp(this),this.files=new vp(this),this.logs=new wp(this),this.settings=new gp(this),this.realtime=new jl(this),this.health=new _p(this),this.backups=new Sp(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new yp(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,t){if(!t)return e;for(let r in t){let n=t[r];switch(typeof n){case"boolean":case"number":n=""+n;break;case"string":n="'"+n.replace(/'/g,"\\'")+"'";break;default:n=n===null?"null":n instanceof Date?"'"+n.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(n).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+r+"}",n)}return e}getFileUrl(e,t,r={}){return this.files.getUrl(e,t,r)}buildUrl(e){var r;let t=this.baseUrl;return typeof window=="undefined"||!window.location||t.startsWith("https://")||t.startsWith("http://")||(t=(r=window.location.origin)!=null&&r.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseUrl.startsWith("/")||(t+=window.location.pathname||"/",t+=t.endsWith("/")?"":"/"),t+=this.baseUrl),e&&(t+=t.endsWith("/")?"":"/",t+=e.startsWith("/")?e.substring(1):e),t}async send(e,t){t=this.initSendOptions(e,t);let r=this.buildUrl(e);if(this.beforeSend){let n=Object.assign({},await this.beforeSend(r,t));n.url!==void 0||n.options!==void 0?(r=n.url||r,t=n.options||t):Object.keys(n).length&&(t=n,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(t.query!==void 0){let n=this.serializeQueryParams(t.query);n&&(r+=(r.includes("?")?"&":"?")+n),delete t.query}return this.getHeader(t.headers,"Content-Type")=="application/json"&&t.body&&typeof t.body!="string"&&(t.body=JSON.stringify(t.body)),(t.fetch||fetch)(r,t).then(async n=>{let s={};try{s=await n.json()}catch(a){}if(this.afterSend&&(s=await this.afterSend(n,s)),n.status>=400)throw new tr({url:n.url,status:n.status,data:s});return s}).catch(n=>{throw new tr(n)})}initSendOptions(e,t){if((t=Object.assign({method:"GET"},t)).body=this.convertToFormDataIfNeeded(t.body),cb(t),t.query=Object.assign({},t.params,t.query),t.requestKey===void 0&&(t.$autoCancel===!1||t.query.$autoCancel===!1?t.requestKey=null:(t.$cancelKey||t.query.$cancelKey)&&(t.requestKey=t.$cancelKey||t.query.$cancelKey)),delete t.$autoCancel,delete t.query.$autoCancel,delete t.$cancelKey,delete t.query.$cancelKey,this.getHeader(t.headers,"Content-Type")!==null||this.isFormData(t.body)||(t.headers=Object.assign({},t.headers,{"Content-Type":"application/json"})),this.getHeader(t.headers,"Accept-Language")===null&&(t.headers=Object.assign({},t.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(t.headers,"Authorization")===null&&(t.headers=Object.assign({},t.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&t.requestKey!==null){let r=t.requestKey||(t.method||"GET")+e;delete t.requestKey,this.cancelRequest(r);let n=new AbortController;this.cancelControllers[r]=n,t.signal=n.signal}return t}convertToFormDataIfNeeded(e){if(typeof FormData=="undefined"||e===void 0||typeof e!="object"||e===null||this.isFormData(e)||!this.hasBlobField(e))return e;let t=new FormData;for(let r in e){let n=this.normalizeFormDataValue(e[r]),s=Array.isArray(n)?n:[n];if(s.length)for(let a of s)t.append(r,a);else t.append(r,"")}return t}normalizeFormDataValue(e){return e===null||typeof e!="object"||e instanceof Date||this.hasBlobField({data:e})||Array.isArray(e)&&!e.filter(t=>typeof t!="string").length?e:JSON.stringify(e)}hasBlobField(e){for(let t in e){let r=Array.isArray(e[t])?e[t]:[e[t]];for(let n of r)if(typeof Blob!="undefined"&&n instanceof Blob||typeof File!="undefined"&&n instanceof File)return!0}return!1}getHeader(e,t){e=e||{},t=t.toLowerCase();for(let r in e)if(r.toLowerCase()==t)return e[r];return null}isFormData(e){return e&&(e.constructor.name==="FormData"||typeof FormData!="undefined"&&e instanceof FormData)}serializeQueryParams(e){let t=[];for(let r in e){if(e[r]===null)continue;let n=e[r],s=encodeURIComponent(r);if(Array.isArray(n))for(let a of n)t.push(s+"="+encodeURIComponent(a));else n instanceof Date?t.push(s+"="+encodeURIComponent(n.toISOString())):typeof n!==null&&typeof n=="object"?t.push(s+"="+encodeURIComponent(JSON.stringify(n))):t.push(s+"="+encodeURIComponent(n))}return t.join("&")}};var Jl=class extends za{constructor(t="pocketbase_auth"){super();this.storageFallback={};this._storageChangeHandler=t=>{if(t.key!=this.storageKey)return;let r=this._storageGet(this.storageKey)||{};super.save(r.token||"",r.model||null)};this.storageKey=t,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get model(){return(this._storageGet(this.storageKey)||{}).model||null}save(t,r){this._storageSet(this.storageKey,{token:t,model:r}),super.save(t,r)}clear(){this._storageRemove(this.storageKey),super.clear()}destroy(){this._unbindStorageEvent()}_storageGet(t){if(typeof window!="undefined"&&(window!=null&&window.localStorage)){let r=window.localStorage.getItem(t)||"";try{return JSON.parse(r)}catch(n){return r}}return this.storageFallback[t]}_storageSet(t,r){if(typeof window!="undefined"&&(window!=null&&window.localStorage)){let n=r;typeof r!="string"&&(n=JSON.stringify(r)),window.localStorage.setItem(t,n)}else this.storageFallback[t]=r}_storageRemove(t){var r;typeof window!="undefined"&&(window!=null&&window.localStorage)&&((r=window.localStorage)==null||r.removeItem(t)),delete this.storageFallback[t]}_bindStorageEvent(){if(typeof window=="undefined"||!(window!=null&&window.localStorage)||!window.addEventListener)return()=>{};window.addEventListener("storage",this._storageChangeHandler)}_unbindStorageEvent(){if(typeof window=="undefined"||!(window!=null&&window.localStorage)||!window.addEventListener)return()=>{};window.removeEventListener("storage",this._storageChangeHandler)}};var Xl=class extends Pt{constructor(t,r,n,s){var i;super();this.beforeLogin=s;let a=Le("[Pocketbase]","debug");this.authStore=new Jl(`pocketbase_auth_${t}`),this.pb=new Yl("https://auth.system3.md",this.authStore),this.pb.beforeSend=(l,c)=>(a(l,c),c.fetch=xr,c.headers=Object.assign({},c.headers,{"Relay-Version":"0.4.8"}),{url:l,options:c}),this.refreshToken(),n.setInterval(()=>this.refreshToken(),864e5),this.openSettings=r,this.pb.authStore.isValid||this.logout(),(i=this.pb.authStore.model)!=null&&i.id&&this.pb.collection("users").getOne(this.pb.authStore.model.id).catch(l=>{l.status===404&&this.logout()}),Dt.set(this,"loginManager")}refreshToken(){this.pb.authStore.isValid&&(this.user=this.makeUser(this.pb.authStore),this.pb.collection("users").authRefresh().then(t=>{let r=t.token,[,n]=r.split("."),s=JSON.parse(atob(n)),a=new Date(s.exp*1e3),i=new Date,l=Math.ceil((a.getTime()-i.getTime())/(1e3*60*60*24));this.log("Token Refreshed"),this.log("JWT Info:",{expiresAt:a.toLocaleString(),expiresIn:`${l} days`,userId:s.id,email:s.email})}))}setup(t){var r,n;return this.pb.authStore.isValid?(this.user=this.makeUser(this.pb.authStore,(r=t==null?void 0:t.meta)==null?void 0:r.rawUser),this.notifyListeners(),t&&this.pb.collection("oauth2_response").create({user:t.record.id,oauth_response:(n=t.meta)==null?void 0:n.rawUser}).then(()=>{this.notifyListeners()}).catch(s=>{this.log(s)}),!0):(this.notifyListeners(),!1)}whoami(){let t={Authorization:`Bearer ${this.pb.authStore.token}`};(0,ub.requestUrl)({url:"https://api.system3.md/whoami",method:"GET",headers:t}).then(r=>{this.log(r.json)}).catch(r=>{this.log(r)})}get loggedIn(){return this.user!==void 0}get hasUser(){return this.user!==void 0}makeUser(t,r){var n,s,a,i;return new $l((n=t.model)==null?void 0:n.id,((s=t.model)==null?void 0:s.name)||(r==null?void 0:r.name),(a=t.model)==null?void 0:a.email,((i=t.model)==null?void 0:i.picture)||(r==null?void 0:r.picture),t.token)}logout(){this.pb.cancelAllRequests(),this.pb.authStore.clear(),this.user=void 0,this.notifyListeners()}webviewIntercept(){let t=this.pb.buildUrl("/api/oauth2-redirect"),r="https:\\/\\/accounts\\.google\\.com\\/o\\/oauth2\\/auth";return new RegExp(`^${r}.*?[?&]redirect_uri=${encodeURIComponent(t)}`,"i")}async initiateManualOAuth2CodeFlow(t){this.beforeLogin();let n=(await this.pb.collection("users").listAuthMethods({fetch:t}).catch(a=>{throw a.originalError})).authProviders[0],s=this.pb.buildUrl("/api/oauth2-redirect");return[n.authUrl+s,n,async a=>this.pb.collection("users").authWithOAuth2Code(n.name,a,n.codeVerifier,s,{fetch:t}).then(i=>(this.setup(i),i))]}async poll(t,r){let n=0,s=1e3;return new Promise((a,i)=>{let l=setInterval(()=>{if(n+=1,n>=30)return clearInterval(l),i(new Error(`Auth timeout: Timed out after ${n*s/1e3} seconds`));this.pb.collection("code_exchange").getOne(t.state.slice(0,15)).then(c=>{if(c)return clearInterval(l),a(r(c.code))}).catch(c=>{})},s)})}async login(){this.beforeLogin();let t=await this.pb.collection("users").authWithOAuth2({provider:"google"});return this.setup(t)}async openLoginPage(){return await this.openSettings(),await new Promise((r,n)=>{let s=()=>{this.loggedIn&&(this.off(s),r(!0)),r(!1)};this.on(s)})}destroy(){this.pb.cancelAllRequests(),this.pb.realtime.unsubscribe(),this.pb=null,this.authStore.destroy(),this.authStore=null,this.user=void 0,this.openSettings=null,super.destroy()}};var Bt=crypto;var uo=new TextEncoder,br=new TextDecoder,J5=2**32;var db=o=>{let e=o;typeof e=="string"&&(e=uo.encode(e));let t=32768,r=[];for(let n=0;n<e.length;n+=t)r.push(String.fromCharCode.apply(null,e.subarray(n,n+t)));return btoa(r.join(""))},Kr=o=>db(o).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),pb=o=>{let e=atob(o),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t},Un=o=>{let e=o;e instanceof Uint8Array&&(e=br.decode(e)),e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return pb(e)}catch(t){throw new TypeError("The input to be decoded is not correctly encoded.")}};var kp={};Wf(kp,{JOSEAlgNotAllowed:()=>ja,JOSEError:()=>At,JOSENotSupported:()=>wt,JWEDecryptionFailed:()=>Ya,JWEInvalid:()=>wr,JWKInvalid:()=>Zl,JWKSInvalid:()=>ef,JWKSMultipleMatchingKeys:()=>tf,JWKSNoMatchingKey:()=>Ja,JWKSTimeout:()=>rf,JWSInvalid:()=>Bo,JWSSignatureVerificationFailed:()=>Xa,JWTClaimValidationFailed:()=>Ga,JWTExpired:()=>Ql,JWTInvalid:()=>rr});var At=class extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,(t=Error.captureStackTrace)==null||t.call(Error,this,this.constructor)}},Ga=class extends At{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}},Ql=class extends At{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}},ja=class extends At{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}},wt=class extends At{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}},Ya=class extends At{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}},wr=class extends At{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}},Bo=class extends At{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}},rr=class extends At{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}},Zl=class extends At{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}},ef=class extends At{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}},Ja=class extends At{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}},tf=class extends At{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}},rf=class extends At{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}},Xa=class extends At{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}};var of=Bt.getRandomValues.bind(Bt);function NP(o){return typeof o=="object"&&o!==null}function or(o){if(!NP(o)||Object.prototype.toString.call(o)!=="[object Object]")return!1;if(Object.getPrototypeOf(o)===null)return!0;let e=o;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(o)===e}var QP=Symbol();var lA,af,kb;(typeof navigator=="undefined"||!((kb=(af=navigator.userAgent)==null?void 0:af.startsWith)!=null&&kb.call(af,"Mozilla/5.0 ")))&&(lA="jose/v5.3.0");var Cp={};Wf(Cp,{decode:()=>lf,encode:()=>fA});var fA=Kr,lf=Un;function Tp(o){if(typeof o!="string")throw new rr("JWTs must use Compact JWS serialization, JWT must be a string");let{1:e,length:t}=o.split(".");if(t===5)throw new rr("Only JWTs using Compact JWS serialization can be decoded");if(t!==3)throw new rr("Invalid JWT");if(!e)throw new rr("JWTs must contain a payload");let r;try{r=lf(e)}catch(s){throw new rr("Failed to base64url decode the payload")}let n;try{n=JSON.parse(br.decode(r))}catch(s){throw new rr("Failed to parse the decoded payload as JSON")}if(!or(n))throw new rr("Invalid JWT Claims Set");return n}var $n=class extends Error{constructor(e){super(e),this.name="[System3] Relay Error"}};function Lb(o){return o<1e3?`${o}ms`:o<6e4?`${Math.round(o/1e3)}s`:o<36e5?`${Math.round(o/6e4)}m`:`${Math.round(o/36e5)}h`}function cA(o){let e=Tp(o.token);if(typeof e=="string")return 0;let t=e==null?void 0:e.exp;return t?t*1e3:0}var ff=class{constructor(e,t=5){this.expiryMargin=5*60*1e3;this.activeConnections=0;this._activePromises=new Map,e.getStorage?this.tokenMap=e.getStorage():this.tokenMap=new Map,this.callbacks=new Map,this.refreshQueue=new Set,this._log=e.log,this.refresh=e.refresh,this.timeProvider=e.getTimeProvider(),e.getJwtExpiry?this.getJwtExpiry=e.getJwtExpiry:this.getJwtExpiry=cA,this.maxConnections=t,this.refreshInterval=null,Dt.set(this,"TokenStore")}onRefresh(e){return new Promise((r,n)=>{let s=i=>{r(i)},a=i=>{this.removeFromRefreshQueue(e),n(i)};this.refresh(e,s,a)})}start(){this.log("starting"),this.report(),this.refreshInterval=this.timeProvider.setInterval(()=>this.checkAndRefreshTokens(),60*1e3),this.checkAndRefreshTokens()}stop(){this.log("stopping"),this.refreshInterval&&(this.timeProvider.clearInterval(this.refreshInterval),this.refreshInterval=null)}_cleanupInvalidTokens(){let e=[];for(let[t,r]of this.tokenMap.entries())this.isTokenValid(r)||e.push(t);for(let t of e)this.tokenMap.delete(t)}checkAndRefreshTokens(){this.log("check and refresh tokens"),this._cleanupInvalidTokens();for(let[e,t]of this.tokenMap.entries())this.callbacks.has(e)&&this.shouldRefresh(t)&&(this.log("adding to refresh queue"),this.addToRefreshQueue(e));this.log(this.report())}dequeue(){if(this.log("getting next item in queue"),this.refreshQueue.size>0){let e=this.refreshQueue.values().next().value;return this.refreshQueue.delete(e),e}return null}addToRefreshQueue(e){if(this.activeConnections<this.maxConnections){this.log(`immediate refresh of ${e}`),this.activeConnections++;let t=n=>{this.onTokenRefreshed(e,n),this.activeConnections--;let s=this.dequeue();s&&this.addToRefreshQueue(s)},r=()=>{this.onRefreshFailure(e),this.activeConnections--;let n=this.dequeue();n&&this.addToRefreshQueue(n)};this.refresh(e,t,r)}else this.log(`enqueued refresh of ${e}`),this.refreshQueue.add(e)}removeFromRefreshQueue(e){return this.log(`removing ${e} from refresh queue`),this.refreshQueue.has(e)?(this.refreshQueue.delete(e),!0):!1}log(e){this._log(e)}onTokenRefreshed(e,t){let r=this.getJwtExpiry(t);if(this.tokenMap.has(e)){let n=this.tokenMap.get(e),s=this.callbacks.get(e);this.log(`new expiry time is ${r}`),this.tokenMap.set(e,{...n,token:t,expiryTime:r}),s(t),this.log(`Token refreshed for ${n.friendlyName} (${e})`)}}onRefreshFailure(e){let t=this.tokenMap.get(e),r=(t==null?void 0:t.attempts)||0+1;r<=3?this.tokenMap.set(e,{...t,attempts:r}):this.tokenMap.delete(e)}isTokenValid(e){return this.timeProvider.getTime()<e.expiryTime}shouldRefresh(e){return this.timeProvider.getTime()+this.expiryMargin>e.expiryTime}getTokenSync(e){var t,r;return(r=(t=this.tokenMap)==null?void 0:t.get(e))==null?void 0:r.token}getTokenFromNetwork(e,t,r){let n=this._activePromises.get(e);if(n)return n;this.tokenMap.set(e,{token:null,friendlyName:t,expiryTime:0,attempts:0}),this.callbacks.set(e,r);let s=this.onRefresh(e).then(a=>(this.onTokenRefreshed(e,a),this._activePromises.delete(e),a)).catch(a=>{throw this.onRefreshFailure(e),this._activePromises.delete(e),a});return this._activePromises.set(e,s),s}async getToken(e,t,r){if(this.log(`getting token ${t}`),this.tokenMap||Promise.reject(new $n("attempted to get token after TokenStore was destroyed.")),this.tokenMap.has(e)){let n=this.tokenMap.get(e);if(n.token&&this.isTokenValid(n))return this.callbacks.set(e,r),n.friendlyName=t,r(n.token),this.log("token was valid, cache hit!"),this._activePromises.delete(e),Promise.resolve(n.token)}return this.getTokenFromNetwork(e,t,r)}_reportWithFilter(e){let t=[],r=this.timeProvider.getTime(),n=Array.from(this.tokenMap.entries()).sort((s,a)=>s[1].expiryTime-a[1].expiryTime);for(let[s,{friendlyName:a,expiryTime:i,attempts:l}]of n){if(!e(s))continue;let c=i-r,u="";c>0?u=`expires in ${Lb(c-this.expiryMargin)}`:u="expired",t.push(`${s} (${a}): ${l} attempts, (${u})`)}return t}report(){let e=[];return e.push("Token Store Report:"),e.push(`Expiry Margin: ${Lb(this.expiryMargin)}`),e.push("Active Tokens:"),e.push(...this._reportWithFilter(t=>this.callbacks.has(t))),e.push("Stale Tokens:"),e.push(...this._reportWithFilter(t=>!this.callbacks.has(t))),e.push(`Queue size: ${this.refreshQueue.size}`),e.join(`
`)}async waitForQueue(){return new Promise(e=>{setInterval(()=>{if(this.refreshQueue.size==0)return e()},100)})}clearState(){this.refreshQueue.clear();for(let[e,t]of this.tokenMap.entries())this.isTokenValid(t)?this.tokenMap.set(e,{...t,attempts:0}):this.tokenMap.delete(e)}clear(){this.tokenMap.clear(),this.refreshQueue.clear()}destroy(){this.clear(),this.timeProvider.destroy(),this.timeProvider=null,this.refresh=null,this.callbacks.clear(),this.callbacks=null,this._activePromises.clear(),this._activePromises=null,this.tokenMap=null}};function uA(o){return o.expiryTime||0}function dA(o,e){return(...t)=>e(o,...t)}async function pA(o,e,t,r){var c;let n=Le("[TokenStore][Refresh]","debug"),s=Le("[TokenStore][Refresh]","error");n(`${e}`);let a=Jt.decode(e),i;if(a instanceof qr)i=JSON.stringify({docId:a.documentId,relay:a.relayId,folder:a.folderId});else if(a instanceof Ao)i=JSON.stringify({docId:a.folderId,relay:a.relayId,folder:a.folderId});else{r(new Error("No remote to connect to"));return}if(!o.loggedIn){r(Error("Not logged in"));return}let l={Authorization:`Bearer ${(c=o.user)==null?void 0:c.token}`,"Relay-Version":"0.4.8"};try{let u=await xr("https://api.system3.md/token",{method:"POST",headers:l,body:i});if(!u.ok){n(u.status,await u.text()),r(Error(`Received status code ${u.status} from an API.`));return}let d=await u.json();t(d)}catch(u){s(u,i),r(u)}}var cf=class extends ff{constructor(e,t,r,n=5){super({log:Le("[LiveTokenStore]","debug"),refresh:dA(e,pA),getJwtExpiry:uA,getStorage:function(){return new Eo("TokenStore/"+r)},getTimeProvider:()=>t},n)}};var Ib=require("obsidian");var Dp=class{constructor(e,t,r=1e4){this.timeProvider=e;this.onOnline=[];this.onOffline=[];this.online=!0;this._log=Le("[NetworkStatus]"),this.url=t,this.interval=r,this._onceOnline=new Set}log(e,...t){this._log(e,...t)}start(){this.timer||(this.timer=this.checkStatusRepeatedly())}stop(){this.timer&&clearInterval(this.timer)}checkStatusRepeatedly(){return this.timeProvider.setInterval(this._checkStatus.bind(this),this.interval)}checkStatus(){return this.online?Promise.resolve(!0):new Promise(e=>{this._checkStatus().then(()=>{e(this.online)})})}async _checkStatus(){return(0,Ib.requestUrl)({url:this.url,method:"GET",headers:{"Relay-Version":"0.4.8"}}).then(e=>{if(e.status===200){if(e.json&&e.json.status&&(this.status=e.json),!this.online){this.log("back online"),this.online=!0,this.onOnline.forEach(t=>t(this.status)),this._onceOnline.forEach(t=>t(this.status)),this._onceOnline.clear();return}}else if(e.status!==200&&this.online)throw new Error("disconnected")}).catch(e=>{if(e.message.includes("ERR_NETWORK_CHANGED")){this._checkStatus();return}this.online=!1,this.onOffline.forEach(t=>t(this.status))})}onceOnline(e){this._onceOnline.add(e)}addEventListener(e,t){e==="online"?this.onOnline.push(t):e==="offline"&&this.onOffline.push(t)}destroy(){this._onceOnline.clear(),this._onceOnline=null,this.onOnline=null,this.onOffline=null,this.timeProvider=null}},Cb=Dp;function Pp(o){return typeof o.id=="string"}function mA(o){return typeof o.name=="string"}var Ap=class{constructor(e){this.collectionName="roles";this.roles=e}items(){return this.roles.values()}clear(){this.roles.clear()}get(e){return this.roles.get(e)}ingest(e){return this.roles.set(e.id,e),e}delete(e){this.roles.delete(e)}};function Tb(o){return typeof o.aggregate_root=="object"}function Db(o){return typeof o.acl=="object"}var Za=class{get aggregate_root(){}get acl(){}},uf=class extends Za{constructor(t){super();this.user=t}get id(){return this.user.id}get name(){return this.user.name}update(t){return this.user=t,this}},Ep=class extends Za{constructor(t,r,n){super();this.remoteFolder=t;this.relays=r;this.users=n}update(t){return this.remoteFolder=t,this}get id(){return this.remoteFolder.id}get guid(){return this.remoteFolder.guid}get name(){return this.remoteFolder.name}get private(){return this.remoteFolder.private}get creator(){let t=this.users.get(this.remoteFolder.creator);if(!t)throw new Error("invalid remote folder");return t}get relay(){let t=this.relays.get(this.remoteFolder.relay);if(!t)throw new Error("invalid remote folder");return t}get aggregate_root(){return["relays",this.remoteFolder.relay]}get acl(){return["relays",this.remoteFolder.relay]}},Mp=class{constructor(e,t,r){this.remoteFolders=e;this.relays=t;this.users=r;this.collectionName="shared_folders"}items(){return this.remoteFolders.values()}clear(){this.remoteFolders.clear()}get(e){return this.remoteFolders.get(e)}ingest(e){let t=this.remoteFolders.get(e.id);if(t)return t.update(e),this.remoteFolders.notifyListeners(),t;let r=new Ep(e,this.relays,this.users);return this.remoteFolders.set(e.id,r),r}delete(e){this.remoteFolders.delete(e)}},Rp=class{constructor(e,t,r,n,s,a,i){this.relays=e;this.roles=t;this.relayRoles=r;this.relayInvitations=n;this.remoteFolders=s;this.subscriptions=a;this.user=i;this.collectionName="relays"}items(){return this.relays.values()}clear(){this.relays.clear()}get(e){return this.relays.get(e)}ingest(e){let t=this.relays.get(e.id);if(t)return t.update(e),this.relays.notifyListeners(),t;let r=new df(e,this.relayRoles,this.relayInvitations,this.remoteFolders,this.subscriptions,this.user);return this.relays.set(r.id,r),r}delete(e){this.relays.delete(e)}},Fp=class{constructor(e,t,r,n){this.collectionName="relay_roles";this.relayRoles=e,this.relays=t,this.users=r,this.roles=n}items(){return this.relayRoles.values()}clear(){this.relayRoles.clear()}get(e){return this.relayRoles.get(e)}ingest(e){let t=this.relayRoles.get(e.id);if(t)return t.update(e),this.relayRoles.notifyListeners(),t;let r=new Np(e,this.relays,this.users,this.roles);return this.relayRoles.set(r.id,r),r}delete(e){this.relayRoles.get(e)&&this.relayRoles.delete(e)}},Op=class{constructor(e,t,r){this.collectionName="relay_invitations";this.relayInvitations=e,this.relays=t,this.roles=r}items(){return this.relayInvitations.values()}clear(){this.relayInvitations.clear()}get(e){return this.relayInvitations.get(e)}ingest(e){let t=this.relayInvitations.get(e.id);if(t)return t.update(e),this.relayInvitations.notifyListeners(),t;let r=new Hp(e,this.relays,this.roles);return this.relayInvitations.set(r.id,r),r}delete(e){this.relayInvitations.delete(e)}},Up=class{constructor(e){this.users=e;this.collectionName="users"}items(){return this.users.values()}clear(){this.users.clear()}get(e){return this.users.get(e)}ingest(e){let t=this.users.get(e.id);if(t)return t.update(e),this.users.notifyListeners(),t;let r=new uf(e);return this.users.set(e.id,r),r}delete(e){this.users.delete(e)}},$p=class{constructor(e,t,r){this.subscriptions=e;this.relays=t;this.users=r;this.collectionName="subscriptions"}items(){return this.subscriptions.values()}clear(){this.subscriptions.clear()}get(e){return this.subscriptions.get(e)}ingest(e){let t=this.subscriptions.get(e.id);if(t)return t.update(e),this.subscriptions.notifyListeners(),t;let r=new Vp(e,this.relays,this.users);return this.subscriptions.set(e.id,r),r}delete(e){this.subscriptions.delete(e)}},Bp=class extends Po{constructor(t){super();this.collections=new Map,this.relationships=new Map;for(let r of t)this.collections.set(r.collectionName,r);Dt.set(this,"Store")}getCollection(t){let r=this.collections.get(t);if(!r)throw this.error("No collection found for",t),new Error("No collection found for "+t);return r}clear(){let t=Dr.getInstance();t.beginTransaction(),this.collections.forEach(r=>{r.clear()}),this.collections.clear(),this.relationships.clear(),t.commitTransaction()}destroy(){this.clear(),this.collections=null,this.relationships=null}ingestPage(t){return this.ingestBatch(t==null?void 0:t.items)}ingestBatch(t){if(t)return t.map(r=>this.ingest(r))}ingest(t){let r=Dr.getInstance();r.beginTransaction();let n=this._ingest(t);return r.commitTransaction(),n}_ingest(t){if(!t)return;let r,n=this.collections.get(t.collectionName);if(n?r=n.ingest(t):this.error("No collection found for record",t),Tb(r)){let s=r.aggregate_root;if(s){let a=t.id,i=this.relationships.get(s.join(":"))||new Set;i.add([t.collectionName,a].join(":")),this.relationships.set(s.join(":"),i)}}if(Db(r)){let s=r.acl;if(s){let a=t.id,i=this.relationships.get(s.join(":"))||new Set;i.add([t.collectionName,a].join(":")),this.relationships.set(s.join(":"),i)}}if(t.expand)for(let[,s]of Object.entries(t.expand))Array.isArray(s)?this.ingestBatch(s):this.ingest(s);return r}delete(t){this.cascade(t.collectionName,t.id)}graphviz(){let t=`digraph G {
`;for(let[r,n]of this.collections)for(let s of n.items()){if(!Pp(s)){this.warn("record has no id",s);continue}let a=r+"_"+s.id;if(mA(s)&&(a=r+"_"+s.name),t+=`  ${r}_${s.id} [label="${a}"];
`,Pp(s)&&Tb(s)&&s.aggregate_root){let[i,l]=s.aggregate_root;t+=`  ${r}_${s.id} -> ${i}_${l};
`}if(Pp(s)&&Db(s)&&s.acl){let[i,l]=s.acl;t+=`  ${r}_${s.id} -> ${i}_${l} [style=dotted];
`}}return t+="}",t}cascade(t,r){let n=this.collections.get(t),s=this.relationships.get([t,r].join(":")),a=Dr.getInstance();a.beginTransaction(),n&&(this.warn("cascade delete parent",t,r),n.delete(r)),this.relationships.delete([t,r].join(":"));for(let i of s||[]){let[l,c]=i.split(":");this.warn("cascade delete child",l,c),this.getCollection(l)&&this.cascade(l,c)}a.commitTransaction()}},Np=class extends Za{constructor(t,r,n,s){super();this.users=n,this.roles=s,this.relays=r,this.relayRole=t}update(t){return this.relayRole=t,this}get id(){return this.relayRole.id}get userId(){return this.relayRole.user}get user(){let t=this.users.get(this.relayRole.user);if(!t)throw new Error(`Unable to find user: ${this.relayRole.user}`);return t}get role(){var t;return(t=this.roles.get(this.relayRole.role))==null?void 0:t.name}get relayId(){return this.relayRole.relay}get relay(){let t=this.relays.get(this.relayRole.relay);if(!t)throw new Error(`invalid role: unable to find relay ${this.relayRole.relay} on role ${this.relayRole.id}`);return t}get aggregate_root(){return["relays",this.relayRole.relay]}get acl(){return["users",this.relayRole.user]}},Hp=class{constructor(e,t,r){this.relayInvitation=e,this.roles=r,this.relays=t}update(e){return this.relayInvitation=e,this}get key(){return this.relayInvitation.key}get id(){return this.relayInvitation.id}get role(){var e;return(e=this.roles.get(this.relayInvitation.role))==null?void 0:e.name}get relayId(){return this.relayInvitation.relay}get relay(){let e=this.relays.get(this.relayInvitation.relay);if(!e)throw new Error("invalid invitation");return e}get aggregate_root(){return["relays",this.relayInvitation.relay]}},Vp=class extends Pt{constructor(t,r,n){super();this.subscription=t;this.relays=r;this.users=n}update(t){return this.subscription=t,this.notifyListeners(),this}get id(){return this.subscription.id}get token(){return this.subscription.token}get active(){return this.subscription.active}get user(){let t=this.users.get(this.subscription.user);if(!t)throw new Error("invalid subscription");return t}get relayId(){return this.subscription.relay}get relay(){let t=this.relays.get(this.subscription.relay);if(!t)throw new Error("invalid subscription");return t}get stripe_cancel_at(){return this.subscription.stripe_cancel_at}get cancelAt(){return this.subscription.stripe_cancel_at!==0?new Date(this.subscription.stripe_cancel_at*1e3):null}get quantity(){return this.subscription.stripe_quantity}get aggregate_root(){return["relays",this.subscription.relay]}get acl(){return["users",this.subscription.user]}},df=class extends Pt{constructor(t,r,n,s,a,i){super();this.relay=t;this.relayRoles=r;this.relayInvitations=n;this.remoteFolders=s;this._subscriptions=a;this.user=i}update(t){return this.relay=t,this.notifyListeners(),this}get cta(){return this.relay.cta}get plan(){return this.relay.plan}get id(){return this.relay.id}get guid(){return this.relay.guid}get name(){return this.relay.name}set name(t){this.relay.name=t}get userLimit(){return this.relay.user_limit}get role(){var n;let t=this.relay.creator===this.user.id,r=(n=this.relayRoles.find(s=>s.relayId===this.relay.id&&s.userId===this.user.id))==null?void 0:n.role;return r||(this.warn("couldn't find role",this.relay.id,this.user,t),t?"Owner":"Member")}get owner(){return this.role==="Owner"}get invitation(){return this.relayInvitations.find(t=>t.relay.id===this.relay.id)}get folders(){return this.remoteFolders.filter(t=>t.relay.id===this.id)}get subscriptions(){return this._subscriptions.filter(t=>t.relay.id===this.id)}get acl(){var r;let t=(r=this.relayRoles.find(n=>n.relayId===this.id&&n.userId===this.user.id))==null?void 0:r.id;if(t)return["relay_roles",t]}get provider(){return this.relay.provider}},pf=class extends Po{constructor(t){super();this.loginManager=t;this.destroyed=!1;this.pb=this.loginManager.pb,this.users=new gr("users"),this.relays=new gr("relays"),this.remoteFolders=new gr("remote folders"),this.relayInvitations=new gr("relay invitations"),this.relayRoles=new gr("relay roles"),this.roles=new gr("roles"),this.roles.set("2arnubkcv7jpce8",{name:"Owner",id:"2arnubkcv7jpce8"}),this.roles.set("x6lllh2qsf9lxk6",{name:"Member",id:"x6lllh2qsf9lxk6"}),this.subscriptions=new gr("subscriptions"),this._offLoginManager=this.loginManager.on(()=>{this.login()}),this.setUser(),this.user&&(Dt.set(this,"RelayManager"),this.buildGraph(),this.subscribe(),this.update())}buildGraph(){if(!this.user||this.store)return;let t=new Ap(this.roles),r=new Up(this.users),n=new Rp(this.relays,this.roles,this.relayRoles,this.relayInvitations,this.remoteFolders,this.subscriptions,this.user),s=new Fp(this.relayRoles,this.relays,this.users,this.roles),a=new Op(this.relayInvitations,this.relays,this.roles),i=new Mp(this.remoteFolders,this.relays,this.users),l=new $p(this.subscriptions,this.relays,this.users);this.store=new Bp([t,r,n,s,a,i,l])}setUser(){var t;this.authUser=(t=this.pb)==null?void 0:t.authStore.model,this.authUser&&(this.user=new uf(this.authUser),this.users.set(this.user.id,this.user))}login(){this.setUser(),this.buildGraph(),this.subscribe(),this.update()}logout(){var t;(t=this.store)==null||t.clear(),this.user=void 0,this.store=void 0}async getRelayInvitationKey(t){if(!this.pb)return"";let r=this.relayInvitations.find(n=>n.relay.id===t.id);return r!=null&&r.key?r.key:this.pb.collection("relay_invitations").getList(0,200).then(n=>{n.items.forEach(a=>{var i;(i=this.store)==null||i.ingest(a)});let s=this.relayInvitations.find(a=>a.relay.id===t.id);return s?s.key:""})}async getSubscriptionToken(t){if(!this.pb||!this.pb.authStore.isValid)throw new Error("Auth is not valid");let r=`/api/subscription/${t.id}/token`,n=await this.pb.send(r,{method:"POST"});if(n!==200)throw new Error("Token API failed");return n.json().token}async subscribe(){var n;if(!this.pb||!this.pb.authStore.isValid||((n=this.pb.authStore.model)==null?void 0:n.id)===void 0)return;let t=[{name:"relays",expand:["relay_invitations_via_relay","shared_folders_via_relay","shared_folders_via_relay.creator","subscriptions_via_relay","subscriptions_via_relay.relay","creator"]},{name:"relay_invitations",expand:["relay"]},{name:"relay_roles",expand:["user","relay"]},{name:"shared_folders",expand:["relay","creator"]},{name:"subscriptions",expand:["user","relay"]}],r=(s,a)=>{var i,l;this.debug(`[Event]: ${s}`,a.action,a.record),a.action==="delete"?(i=this.store)==null||i.delete(a.record):(l=this.store)==null||l.ingest(a.record)};for(let s of t)this.pb.collection(s.name).subscribe("*",a=>r(s.name,a),{expand:s.expand.join(","),fetch:xr})}collection(t){this.pb}async update(){let t=(n,s={})=>{var a;return!this.pb||!this.pb.authStore.isValid||((a=this.pb.authStore.model)==null?void 0:a.id)===void 0?Promise.resolve([]):(typeof s=="function"&&(s=s(this.pb.authStore.model.id)),this.pb.collection(n).getFullList(s))};[t("users",n=>({filter:`id="${n}"`,expand:"relay_roles_via_user,relay_roles_via_user.relay,relay_roles_via_user.role"})),t("relay_roles",{expand:"user"}),t("relay_invitations"),t("shared_folders",{expand:"relay,creator"}),t("subscriptions",{expand:"relay,user"})].forEach(async n=>{let s=await n;for(let a of s)!this.destroyed&&this.store&&this.store.ingest(a)})}async acceptInvitation(t){var s;if(!this.pb)throw new Error("Failed to accept invitation");let r=await this.pb.send("/api/accept-invitation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:t})});this.debug("[InviteAccept]",r);let n=(s=this.store)==null?void 0:s.ingest(r);if(!n)throw new Error("Failed to accept invitation");return n}async createRelay(t){var a;let r=Da(),n=await((a=this.pb)==null?void 0:a.collection("relays").create({guid:r,name:t,path:null}));if(!n)throw new Error("Failed to create Relay");if(!this.user)throw new Error("Not Logged In");let s=new df(n,this.relayRoles,this.relayInvitations,this.remoteFolders,this.subscriptions,this.user);return this.relays.set(s.id,s),s}async updateRelay(t){var s;if(!this.pb)throw new Error("Failed to update relay");let r=await this.pb.collection("relays").update(t.id,{name:t.name.trim()}),n=(s=this.store)==null?void 0:s.ingest(r);if(!n)throw new Error("Failed to update relay");return n}async deleteRemote(t){var n;t.remote=void 0;let r=this.remoteFolders.find(s=>s.guid===t.guid);return r?(await((n=this.pb)==null?void 0:n.collection("shared_folders").delete(r.id)),t.remote=void 0,!0):!1}async createRemoteFolder(t,r){var a,i;if(!this.pb)throw new Error("Failed to create folder");let n=await this.pb.collection("shared_folders").create({name:t.name,guid:t.guid,relay:r.id,creator:(a=this.user)==null?void 0:a.id,private:!1},{expand:"relay"}),s=(i=this.store)==null?void 0:i.ingest(n);if(!s)throw new Error("Failed to create folder");return s}async destroyRelay(t){var r,n;return(r=this.store)==null||r.cascade("relays",t.id),await((n=this.pb)==null?void 0:n.collection("relays").delete(t.id)),!0}async leaveRelay(t){var n,s;let r=this.relayRoles.find(a=>{var i;return a.userId===((i=this.user)==null?void 0:i.id)&&a.relayId===t.id});r?await((n=this.pb)==null?void 0:n.collection("relay_roles").delete(r.id)):this.warn("No role found to leave relay"),(s=this.store)==null||s.cascade("relay",t.id)}async kick(t){var r;return(r=this.pb)==null?void 0:r.collection("relay_roles").delete(t.id)}destroy(){var t,r;this.destroyed=!0,this._offLoginManager&&this._offLoginManager(),(t=this.pb)==null||t.cancelAllRequests(),this.loginManager=null,this.pb=null,(r=this.store)==null||r.destroy(),this.authUser=null,this.store=null}};var n_=require("obsidian");var Rb=require("obsidian");var Eb=require("obsidian");function hA(o){De(o,"svelte-4kkvmr",".feature-flag-toggle-modal.svelte-4kkvmr{padding:1rem}.feature-flag-item.svelte-4kkvmr{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0;border-top:1px solid var(--background-modifier-border)}.checkbox-container.svelte-4kkvmr{cursor:pointer}")}function Pb(o,e,t){let r=o.slice();return r[8]=e[t][0],r[9]=e[t][1],r}function Ab(o){let e,t,r,n=o[8]+"",s,a,i,l,c=o[8]+"",u,d,m,x,h,v,w,_,A,U,L,R;function O(){return o[6](o[8])}function M(){return o[7](o[8])}return{c(){e=D("div"),t=D("div"),r=D("div"),s=K(n),a=B(),i=D("div"),l=K("Toggle "),u=K(c),d=K(" on or off"),m=B(),x=D("div"),h=D("div"),v=D("input"),_=B(),A=D("div"),b(r,"class","setting-item-name"),b(i,"class","setting-item-description"),b(t,"class","setting-item-info"),b(v,"type","checkbox"),b(v,"tabindex","-1"),v.checked=w=o[9],b(A,"class","checkbox-toggle"),b(h,"role","checkbox"),b(h,"aria-checked",U=o[9]),b(h,"tabindex","0"),b(h,"class","checkbox-container svelte-4kkvmr"),ze(h,"is-enabled",o[9]),b(x,"class","setting-item-control"),b(e,"class","feature-flag-item setting-item svelte-4kkvmr")},m(E,F){T(E,e,F),k(e,t),k(t,r),k(r,s),k(t,a),k(t,i),k(i,l),k(i,u),k(i,d),k(e,m),k(e,x),k(x,h),k(h,v),k(h,_),k(h,A),L||(R=[re(h,"keypress",O),re(h,"click",M)],L=!0)},p(E,F){o=E,F&2&&n!==(n=o[8]+"")&&se(s,n),F&2&&c!==(c=o[8]+"")&&se(u,c),F&2&&w!==(w=o[9])&&(v.checked=w),F&2&&U!==(U=o[9])&&b(h,"aria-checked",U),F&2&&ze(h,"is-enabled",o[9])},d(E){E&&C(e),L=!1,ke(R)}}}function gA(o){let e,t,r,n,s,a,i,l,c,u=Re(Object.entries(o[1])),d=[];for(let m=0;m<u.length;m+=1)d[m]=Ab(Pb(o,u,m));return{c(){e=D("div"),t=D("h2"),t.textContent="Feature Flags",r=B();for(let m=0;m<d.length;m+=1)d[m].c();n=B(),s=D("div"),a=D("div"),i=D("button"),i.textContent="Apply",b(i,"aria-label","apply flag settings"),b(i,"tabindex","0"),b(a,"class","setting-item-control"),b(s,"class","setting-item"),b(e,"class","feature-flag-toggle-modal svelte-4kkvmr")},m(m,x){T(m,e,x),k(e,t),k(e,r);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(e,null);k(e,n),k(e,s),k(s,a),k(a,i),l||(c=[re(i,"click",function(){ut(o[0])&&o[0].apply(this,arguments)}),re(i,"keypress",function(){ut(o[0])&&o[0].apply(this,arguments)})],l=!0)},p(m,[x]){if(o=m,x&26){u=Re(Object.entries(o[1]));let h;for(h=0;h<u.length;h+=1){let v=Pb(o,u,h);d[h]?d[h].p(v,x):(d[h]=Ab(v),d[h].c(),d[h].m(e,n))}for(;h<d.length;h+=1)d[h].d(1);d.length=u.length}},i:X,o:X,d(m){m&&C(e),it(d,m),l=!1,ke(c)}}}function xA(o,e,t){let r,n,{reload:s}=e,a=Vt.getInstance();me(o,a,d=>t(5,n=d));function i(d){let m=!r[d];t(1,r[d]=m,r),a.setFlag(d,r[d])}function l(d){return d in r}er(()=>{Object.keys(r).forEach(d=>{let m=document.getElementById(`toggle-${d}`);m&&(0,Eb.setIcon)(m,"check")})});let c=d=>{if(!l(d))throw new Error("Unexpected feature flag!");i(d)},u=d=>{if(!l(d))throw new Error("Unexpected feature flag!");i(d)};return o.$$set=d=>{"reload"in d&&t(0,s=d.reload)},o.$$.update=()=>{if(o.$$.dirty&32){e:t(1,r=Object.assign({},n.flags))}},[s,r,a,i,l,n,c,u]}var qp=class extends Z{constructor(e){super(),ee(this,e,xA,gA,Q,{reload:0},hA)}},Mb=qp;var mf=class extends Rb.Modal{constructor(t,r){super(t);this.reload=r}onOpen(){let{contentEl:t}=this;this.component=new Mb({target:t,props:{reload:this.reload}})}onClose(){var r;let{contentEl:t}=this;t.empty(),(r=this.component)==null||r.$destroy()}};var Wb=require("obsidian");var Vb=require("obsidian");function Fb(o,e,t){let r=o.slice();return r[13]=e[t],r}function Ob(o,e,t){let r=o.slice();return r[16]=e[t],r}function yA(o){let e,t,r;return{c(){e=D("button"),e.textContent="Refresh"},m(n,s){T(n,e,s),t||(r=re(e,"click",(0,Vb.debounce)(o[12])),t=!0)},p:X,d(n){n&&C(e),t=!1,r()}}}function bA(o){let e=navigator.userAgent+"",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p:X,d(r){r&&C(t)}}}function wA(o){let e;return{c(){e=K(o[1])},m(t,r){T(t,e,r)},p(t,r){r&2&&se(e,t[1])},d(t){t&&C(e)}}}function _A(o){let e;return{c(){e=K(o[2])},m(t,r){T(t,e,r)},p(t,r){r&4&&se(e,t[2])},d(t){t&&C(e)}}}function vA(o){let e;return{c(){e=K(o[3])},m(t,r){T(t,e,r)},p(t,r){r&8&&se(e,t[3])},d(t){t&&C(e)}}}function SA(o){let e=o[0].loadTime?`${o[0].loadTime}ms`:"unknown",t;return{c(){t=K(e)},m(r,n){T(r,t,n)},p(r,n){n&1&&e!==(e=r[0].loadTime?`${r[0].loadTime}ms`:"unknown")&&se(t,e)},d(r){r&&C(t)}}}function Ub(o){let e,t=`${o[16]}`,r,n;return{c(){e=D("div"),r=K(t),n=B()},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&16&&t!==(t=`${s[16]}`)&&se(r,t)},d(s){s&&C(e)}}}function kA(o){let e,t=Re(Object.keys(o[4].cancelControllers)),r=[];for(let n=0;n<t.length;n+=1)r[n]=Ub(Ob(o,t,n));return{c(){e=D("div");for(let n=0;n<r.length;n+=1)r[n].c();b(e,"slot","description")},m(n,s){T(n,e,s);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null)},p(n,s){if(s&16){t=Re(Object.keys(n[4].cancelControllers));let a;for(a=0;a<t.length;a+=1){let i=Ob(n,t,a);r[a]?r[a].p(i,s):(r[a]=Ub(i),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=t.length}},d(n){n&&C(e),it(r,n)}}}function $b(o){let e,t=`${o[13]}`,r,n;return{c(){e=D("div"),r=K(t),n=B()},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&32&&t!==(t=`${s[13]}`)&&se(r,t)},d(s){s&&C(e)}}}function LA(o){let e,t=Re(o[5]),r=[];for(let n=0;n<t.length;n+=1)r[n]=$b(Fb(o,t,n));return{c(){e=D("div");for(let n=0;n<r.length;n+=1)r[n].c();b(e,"slot","description")},m(n,s){T(n,e,s);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null)},p(n,s){if(s&32){t=Re(n[5]);let a;for(a=0;a<t.length;a+=1){let i=Fb(n,t,a);r[a]?r[a].p(i,s):(r[a]=$b(i),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=t.length}},d(n){n&&C(e),it(r,n)}}}function IA(o){let e,t,r,n,s,a,i,l,c,u,d,m,x,h,v,w,_,A,U,L,R,O,M;return n=new Je({props:{name:"Environment",$$slots:{default:[yA]},$$scope:{ctx:o}}}),a=new He({props:{name:"User Agent",description:"",$$slots:{default:[bA]},$$scope:{ctx:o}}}),l=new He({props:{name:"Fetch",description:"",$$slots:{default:[wA]},$$scope:{ctx:o}}}),u=new He({props:{name:"Response",description:"",$$slots:{default:[_A]},$$scope:{ctx:o}}}),m=new He({props:{name:"Blink Fetch",description:"",$$slots:{default:[vA]},$$scope:{ctx:o}}}),h=new He({props:{name:"Startup Time",description:"",$$slots:{default:[SA]},$$scope:{ctx:o}}}),w=new Je({props:{name:"Connections"}}),A=new He({props:{name:"",description:"",$$slots:{description:[kA]},$$scope:{ctx:o}}}),L=new Je({props:{name:"Log Files"}}),O=new He({props:{name:"",description:"",$$slots:{description:[LA]},$$scope:{ctx:o}}}),{c(){e=D("div"),e.textContent="Debug Info",t=B(),r=D("div"),V(n.$$.fragment),s=B(),V(a.$$.fragment),i=B(),V(l.$$.fragment),c=B(),V(u.$$.fragment),d=B(),V(m.$$.fragment),x=B(),V(h.$$.fragment),v=B(),V(w.$$.fragment),_=B(),V(A.$$.fragment),U=B(),V(L.$$.fragment),R=B(),V(O.$$.fragment),b(e,"class","modal-title"),b(r,"class","modal-content")},m(E,F){T(E,e,F),T(E,t,F),T(E,r,F),N(n,r,null),k(r,s),N(a,r,null),k(r,i),N(l,r,null),k(r,c),N(u,r,null),k(r,d),N(m,r,null),k(r,x),N(h,r,null),k(r,v),N(w,r,null),k(r,_),N(A,r,null),k(r,U),N(L,r,null),k(r,R),N(O,r,null),M=!0},p(E,[F]){let q={};F&524288&&(q.$$scope={dirty:F,ctx:E}),n.$set(q);let J={};F&524288&&(J.$$scope={dirty:F,ctx:E}),a.$set(J);let G={};F&524290&&(G.$$scope={dirty:F,ctx:E}),l.$set(G);let z={};F&524292&&(z.$$scope={dirty:F,ctx:E}),u.$set(z);let W={};F&524296&&(W.$$scope={dirty:F,ctx:E}),m.$set(W);let oe={};F&524289&&(oe.$$scope={dirty:F,ctx:E}),h.$set(oe);let Ie={};F&524304&&(Ie.$$scope={dirty:F,ctx:E}),A.$set(Ie);let Pe={};F&524320&&(Pe.$$scope={dirty:F,ctx:E}),O.$set(Pe)},i(E){M||(I(n.$$.fragment,E),I(a.$$.fragment,E),I(l.$$.fragment,E),I(u.$$.fragment,E),I(m.$$.fragment,E),I(h.$$.fragment,E),I(w.$$.fragment,E),I(A.$$.fragment,E),I(L.$$.fragment,E),I(O.$$.fragment,E),M=!0)},o(E){P(n.$$.fragment,E),P(a.$$.fragment,E),P(l.$$.fragment,E),P(u.$$.fragment,E),P(m.$$.fragment,E),P(h.$$.fragment,E),P(w.$$.fragment,E),P(A.$$.fragment,E),P(L.$$.fragment,E),P(O.$$.fragment,E),M=!1},d(E){E&&(C(e),C(t),C(r)),H(n),H(a),H(l),H(u),H(m),H(h),H(w),H(A),H(L),H(O)}}}function Bb(){try{return Response.toString()}catch(o){return"undefined"}}function Nb(){try{return fetch.toString()}catch(o){return"undefined"}}function Hb(){try{return(globalThis==null?void 0:globalThis.blinkfetch)!==void 0?"Yes":"No"}catch(o){return"No"}}function CA(o,e,t){let r,n,s,a,i,{plugin:l}=e,c=_e(Bb());me(o,c,w=>t(2,n=w));let u=_e(Nb());me(o,u,w=>t(1,r=w));let d=_e(Hb());me(o,d,w=>t(3,s=w));let m=_e(l.loginManager.pb);me(o,m,w=>t(4,a=w));let x=_e([]);me(o,x,w=>t(5,i=w)),cl().then(w=>{x.set(w)});function h(){c.set(Bb()),u.set(Nb()),d.set(Hb()),m.set(l.loginManager.pb)}let v=()=>{h()};return o.$$set=w=>{"plugin"in w&&t(0,l=w.plugin)},[l,r,n,s,a,i,c,u,d,m,x,h,v]}var Wp=class extends Z{constructor(e){super(),ee(this,e,CA,IA,Q,{plugin:0})}},qb=Wp;var hf=class extends Wb.Modal{constructor(t,r){super(t);this.plugin=r}onOpen(){let{contentEl:t}=this;this.component=new qb({target:t,props:{plugin:this.plugin}})}onClose(){var r;let{contentEl:t}=this;t.empty(),(r=this.component)==null||r.$destroy()}};var ur=class extends Error{constructor(t,r){super(t);this.path=r;this.name="SettingsError"}};var gf=class extends Pt{constructor(t,r){super();this.storage=t;this.defaults=r;this._loaded=!1;this.data={...r}}async load(){let t=await this.storage.loadData();this.data={...this.defaults,...t||{}},this._loaded=!0,this.log("Loaded settings from disk:",this.data)}async save(){if(!this._loaded){this.warn("Attempted to save before loading settings from disk");return}this.warn("Saving settings to disk:",this.data),await this.storage.saveData(this.data)}get(){return this.data}async update(t){if(!this._loaded){this.warn("Attempted to update before loading settings from disk");return}let r=t(this.data),n=await this.storage.loadData();if(JSON.stringify(r)===JSON.stringify(n)){this.debug("updated matches disk, no change");return}this.data=r,await this.save(),this.notifyListeners()}notifyListeners(){for(let t of this._listeners)t(this.data)}},Gr=class extends Pt{constructor(t,r){super();this.settings=t;this.patterns=[];this.validatePath(r),[this.path,this.basePath,this.patterns]=this.processPath(r),this.lastKnown=this.getNestedValue(this.settings.get()),this.setupSubscription()}isWildcardPattern(t){return t.type==="wildcard"}validatePath(t){if(!t)throw new ur("Path cannot be empty");if(t.startsWith("/")||t.endsWith("/"))throw new ur(`Invalid path format: ${t}`)}createPatternRegex(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace("\\*",".*")}setupSubscription(){this.unsub=this.settings.subscribe(()=>{let t=this.getNestedValue(this.settings.get());this.lastKnown===void 0&&t===void 0||JSON.stringify(this.lastKnown)!==JSON.stringify(t)&&(this.lastKnown=t,this.notifyListeners())})}hasArrayPatterns(){return this.patterns.some(t=>t.type==="arrayMatch")}destroy(){this.destroyed||(this.unsub&&(this.unsub(),this.unsub=void 0),this._listeners.clear(),this.destroyed=!0)}get(){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());let t=this.settings.get();if(!t)return{};let r=this.patterns.find(this.isWildcardPattern);if(r&&this.path.length===1){let s=new RegExp(`^${r.wildcardPattern}$`);return Object.entries(t).filter(([i])=>s.test(i)).reduce((i,[l,c])=>(i[l]=c,i),{})}let n=this.getNestedValue(t);return n===void 0?{}:n}async set(t){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());if(t===void 0)throw new ur("Cannot set undefined value",this.getPath());try{await this.settings.update(r=>{let n=this.patterns.find(this.isWildcardPattern);if(n){if(this.path.length===1){let l=new RegExp(`^${n.wildcardPattern}$`),c={...r};return Object.entries(t).forEach(([u,d])=>{l.test(u)&&(c[u]=d)}),c}let s={...r},a=s;this.path.forEach(l=>{a[l]=a[l]||{},a=a[l]});let i=new RegExp(`^${n.wildcardPattern}$`);return Object.entries(t).forEach(([l,c])=>{i.test(l)&&(a[l]=c)}),s}return this.setNestedValue(r,t)})}catch(r){let n=r instanceof Error?r.message:"Unknown error";throw new ur(`Failed to set value at path ${this.getPath()}: ${n}`,this.getPath())}}async update(t,r=!1){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());let n=this.get(),s=t(n);!r&&JSON.stringify(n)===JSON.stringify(s)||await this.set(s)}async flush(){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());await this.update(t=>t,!0)}processPath(t){let r=t.split("/").filter(i=>i),n=[],s=[],a=[];return r.forEach((i,l)=>{let c=i.match(/^\[(\w+)=(.+)\]$/),u=i.match(/^\((.+?)\)$/);if(c){let[,d,m]=c,x=l>0?s[l-1]:i.split("[")[0];a.push({type:"arrayMatch",key:d,value:m,level:l}),n.push(i),s.push(x)}else if(u){let[,d]=u;a.push({type:"wildcard",wildcardPattern:this.createPatternRegex(d),level:l}),n.push(i),s.push(i)}else n.push(i),s.push(i)}),[n,s,a]}getNestedValue(t){let r=t,n=this.patterns.find(this.isWildcardPattern);if(n&&this.path.length===1){let a=new RegExp(`^${n.wildcardPattern}$`);return Object.entries(r).filter(([l])=>a.test(l)).reduce((l,[c,u])=>(l[c]=u,l),{})}let s=this.patterns[0];if((s==null?void 0:s.type)==="arrayMatch"){let a=this.basePath[0];if(!Array.isArray(r[a]))return;let i=r[a].find(c=>c[s.key]===s.value);if(!i)return;let l=this.basePath.slice(s.level+1);if(l.length>0){let c=i;for(let u of l){if(!c||typeof c!="object")return;c=c[u]}return c}return i}for(let a=0;a<this.basePath.length;a++){if(!r)return;r=r[this.basePath[a]]}return r}setNestedValue(t,r){let n={...t},s=this.patterns.find(l=>l.type==="arrayMatch");if(s){let l=this.basePath[0];n[l]||(n[l]=[]);let c=n[l].findIndex(d=>d[s.key]===s.value),u=this.basePath.slice(s.level+1);if(c>=0)if(u.length>0){let d=n[l][c];for(let x=0;x<u.length-1;x++){let h=u[x];d[h]=d[h]||{},d=d[h]}let m=u[u.length-1];d[m]=r}else n[l][c]={...n[l][c],...r,[s.key]:s.value};else if(u.length>0){let d={[s.key]:s.value},m=d;for(let h=0;h<u.length-1;h++){let v=u[h];m[v]={},m=m[v]}let x=u[u.length-1];m[x]=r,n[l].push(d)}else n[l].push({...r,[s.key]:s.value});return n}let a=n;for(let l=0;l<this.basePath.length-1;l++){let c=this.basePath[l];a[c]=a[c]||{},a=a[c]}let i=this.basePath[this.basePath.length-1];return a[i]=r,n}getParent(){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());let t=this.path.slice(0,-1).join("/");return new Gr(this.settings,t)}getChild(t,r){let n=[...this.path,t].join("/");return r?r(this.settings,n):(this.log("getChild",this.path,t,n,this.patterns),new Gr(this.settings,n))}getPath(){return this.path.join("/")}exists(){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());let t=this.settings.get();return this.getNestedValue(t)!==void 0}async delete(){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());await this.settings.update(t=>{let r={...t},n=this.patterns.find(l=>l.type==="arrayMatch");if(n){let l=this.basePath[0];return Array.isArray(r[l])&&(r[l]=r[l].filter(c=>c[n.key]!==n.value),r[l].length===0&&delete r[l]),r}let s=r,a=this.basePath.slice(0,-1);for(let l of a){if(!s[l])return r;s=s[l]}let i=this.basePath[this.basePath.length-1];return delete s[i],r})}subscribe(t){if(this.destroyed)throw new ur("Cannot use destroyed settings",this.getPath());return this._listeners.add(t),t(this.get()),()=>{this._listeners.delete(t)}}notifyListeners(){if(this.destroyed)return;let t=this.get();for(let r of this._listeners)r(t)}};var zb=require("obsidian"),xf=class{notify(e){new zb.Notice(e)}},yf=class{constructor(e){this.vault=e}async append(e,t){return this.vault.adapter.append(e,t)}async stat(e){return this.vault.adapter.stat(e)}async exists(e){return this.vault.adapter.exists(e)}async remove(e){return this.vault.adapter.remove(e)}async rename(e,t){return this.vault.adapter.rename(e,t)}async write(e,t){return this.vault.adapter.write(e,t)}async read(e){return this.vault.adapter.read(e)}};var ew=require("obsidian");var Qb=require("obsidian");function TA(o){De(o,"svelte-jmqfac",".system3-bug-report.svelte-jmqfac{display:flex;flex-direction:column;height:100%;min-height:30em}.report-container.svelte-jmqfac{display:flex;flex-direction:column;flex:1}.form-content.svelte-jmqfac{flex:1;overflow-y:auto}textarea.svelte-jmqfac{width:100%;height:300px;resize:vertical}.centered-message.svelte-jmqfac{display:flex;flex:1;align-items:center;justify-content:center;padding-bottom:5em}")}function Kb(o,e,t){let r=o.slice();return r[21]=e[t],r}function DA(o){let e,t,r,n,s,a,i,l,c,u,d,m,x;r=new He({props:{name:"Description",description:"Please describe what went wrong and what you were trying to do."}}),i=new He({props:{name:"Include Logs",description:"Send logs to the Relay developers to help them debug the issue.",$$slots:{default:[EA]},$$scope:{ctx:o}}});let h=o[4]&&Gb(o);return u=new He({props:{name:"",description:"",$$slots:{default:[RA]},$$scope:{ctx:o}}}),{c(){e=D("div"),t=D("div"),V(r.$$.fragment),n=B(),s=D("textarea"),a=B(),V(i.$$.fragment),l=B(),h&&h.c(),c=B(),V(u.$$.fragment),b(s,"placeholder","Describe the issue here..."),b(s,"class","svelte-jmqfac"),b(t,"class","form-content svelte-jmqfac"),b(e,"class","report-container svelte-jmqfac")},m(v,w){T(v,e,w),k(e,t),N(r,t,null),k(t,n),k(t,s),Zt(s,o[3]),k(t,a),N(i,t,null),k(t,l),h&&h.m(t,null),k(e,c),N(u,e,null),d=!0,m||(x=re(s,"input",o[13]),m=!0)},p(v,w){w&8&&Zt(s,v[3]);let _={};w&16777232&&(_.$$scope={dirty:w,ctx:v}),i.$set(_),v[4]?h?(h.p(v,w),w&16&&I(h,1)):(h=Gb(v),h.c(),I(h,1),h.m(t,null)):h&&(be(),P(h,1,1,()=>{h=null}),we());let A={};w&16777293&&(A.$$scope={dirty:w,ctx:v}),u.$set(A)},i(v){d||(I(r.$$.fragment,v),I(i.$$.fragment,v),I(h),I(u.$$.fragment,v),d=!0)},o(v){P(r.$$.fragment,v),P(i.$$.fragment,v),P(h),P(u.$$.fragment,v),d=!1},d(v){v&&C(e),H(r),H(i),h&&h.d(),H(u),m=!1,x()}}}function PA(o){let e;return{c(){e=D("div"),e.innerHTML='<div id="spinner" class="d-flex align-items-center"><strong>Sending Bug Report...</strong> <div class="spinner-border ms-auto" role="status" aria-hidden="true"></div></div>',b(e,"class","centered-message svelte-jmqfac")},m(t,r){T(t,e,r)},p:X,i:X,o:X,d(t){t&&C(e)}}}function AA(o){let e,t,r;return t=new He({props:{name:"Thank you!",description:"Your bug report will help us improve Relay."}}),{c(){e=D("div"),V(t.$$.fragment),b(e,"class","centered-message svelte-jmqfac")},m(n,s){T(n,e,s),N(t,e,null),r=!0},p:X,i(n){r||(I(t.$$.fragment,n),r=!0)},o(n){P(t.$$.fragment,n),r=!1},d(n){n&&C(e),H(t)}}}function EA(o){let e,t,r,n,s,a;return{c(){e=D("div"),t=D("input"),r=B(),n=D("div"),b(t,"type","checkbox"),b(t,"tabindex","-1"),t.checked=o[4],b(n,"class","checkbox-toggle"),b(e,"role","checkbox"),b(e,"aria-checked",o[4]),b(e,"tabindex","0"),b(e,"class","checkbox-container"),ze(e,"is-enabled",o[4])},m(i,l){T(i,e,l),k(e,t),k(e,r),k(e,n),s||(a=[re(e,"keypress",OA),re(e,"click",o[14])],s=!0)},p(i,l){l&16&&(t.checked=i[4]),l&16&&b(e,"aria-checked",i[4]),l&16&&ze(e,"is-enabled",i[4])},d(i){i&&C(e),s=!1,ke(a)}}}function Gb(o){let e,t;return e=new He({props:{name:"Logs",description:"",$$slots:{description:[MA]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&16777248&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function jb(o){let e,t=`${o[21]}
`,r,n;return{c(){e=D("div"),r=K(t),n=B()},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&32&&t!==(t=`${s[21]}
`)&&se(r,t)},d(s){s&&C(e)}}}function MA(o){let e,t=Re(o[5]),r=[];for(let n=0;n<t.length;n+=1)r[n]=jb(Kb(o,t,n));return{c(){e=D("div");for(let n=0;n<r.length;n+=1)r[n].c();b(e,"slot","description")},m(n,s){T(n,e,s);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null)},p(n,s){if(s&32){t=Re(n[5]);let a;for(a=0;a<t.length;a+=1){let i=Kb(n,t,a);r[a]?r[a].p(i,s):(r[a]=jb(i),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=t.length}},d(n){n&&C(e),it(r,n)}}}function RA(o){let e,t,r,n;return{c(){e=D("button"),t=K("Send"),e.disabled=o[2]},m(s,a){T(s,e,a),k(e,t),r||(n=re(e,"click",o[15]),r=!0)},p(s,a){a&4&&(e.disabled=s[2])},d(s){s&&C(e),r=!1,n()}}}function FA(o){let e,t,r,n,s,a,i=[AA,PA,DA],l=[];function c(u,d){return u[1]?0:u[2]&&!u[1]?1:2}return n=c(o,-1),s=l[n]=i[n](o),{c(){e=D("div"),e.textContent="Send Bug Report",t=B(),r=D("div"),s.c(),b(e,"class","modal-title"),b(r,"class","modal-content system3-bug-report svelte-jmqfac")},m(u,d){T(u,e,d),T(u,t,d),T(u,r,d),l[n].m(r,null),a=!0},p(u,[d]){let m=n;n=c(u,d),n===m?l[n].p(u,d):(be(),P(l[m],1,1,()=>{l[m]=null}),we(),s=l[n],s?s.p(u,d):(s=l[n]=i[n](u),s.c()),I(s,1),s.m(r,null))},i(u){a||(I(s),a=!0)},o(u){P(s),a=!1},d(u){u&&(C(e),C(t),C(r)),l[n].d()}}}function Yb(){try{return Response.toString()}catch(o){return"undefined"}}function Jb(){try{return fetch.toString()}catch(o){return"undefined"}}function Xb(){try{return(globalThis==null?void 0:globalThis.blinkfetch)!==void 0?"Yes":"No"}catch(o){return"No"}}var OA=()=>{};function UA(o,e,t){let r,n,s,a,i,l,{plugin:c}=e,u=_e(Yb()),d=_e(Jb()),m=_e(Xb()),x=_e("");me(o,x,E=>t(3,s=E));let h=_e(!1);me(o,h,E=>t(4,a=E));let v=_e(!1),w=_e(!1);me(o,w,E=>t(2,n=E));let _=_e(!1);me(o,_,E=>t(1,r=E));let A=_e(c.loginManager.pb);me(o,A,E=>t(6,l=E));let U=_e([]);me(o,U,E=>t(5,i=E)),cl().then(E=>{U.set(E)});function L(){u.set(Yb()),d.set(Jb()),m.set(Xb()),A.set(c.loginManager.pb)}function R(){s=this.value,x.set(s)}let O=()=>{let E=!a;h.set(E)},M=async()=>{var F;let E=`Bug Report

`;if(E+=JSON.stringify({userAgent:navigator.userAgent,manifest:c.manifest,user:(F=l==null?void 0:l.authStore.model)==null?void 0:F.id,loadTime:c.loadTime,description:s},null,2),E+=`

`,h){let q=await tx();E+=q}(0,Qb.requestUrl)({url:"https://bug-reports.system3.dev",method:"PUT",body:E,headers:{"Content-Type":"text/plain"}}).then(()=>{_.set(!0)}),w.set(!0)};return o.$$set=E=>{"plugin"in E&&t(0,c=E.plugin)},[c,r,n,s,a,i,l,x,h,w,_,A,U,R,O,M]}var zp=class extends Z{constructor(e){super(),ee(this,e,UA,FA,Q,{plugin:0},TA)}},Zb=zp;var bf=class extends ew.Modal{constructor(t,r){super(t);this.plugin=r}onOpen(){let{contentEl:t}=this;this.component=new Zb({target:t,props:{plugin:this.plugin}})}onClose(){var r;let{contentEl:t}=this;t.empty(),(r=this.component)==null||r.$destroy()}};var fw=require("obsidian");async function tw(o){let{appId:e,filterByAppId:t,onProgress:r}=o,n=await window.indexedDB.databases(),s=n.length,a=[],i=0,l=0,c=0,u=0;for(let d of n)if(d.name){try{let m=await new Promise((x,h)=>{let v=indexedDB.open(d.name);v.onerror=()=>h(v.error),v.onsuccess=w=>x(w.target.result)});try{let x=Array.from(m.objectStoreNames);if(!x.includes("updates")||!x.includes("custom"))continue;let h=m.transaction(["updates","custom"],"readonly"),v=h.objectStore("updates"),w=h.objectStore("custom"),_=await new Promise(U=>{let L=w.get("appId");L.onsuccess=()=>U(L.result||"")});i++;let A=await new Promise((U,L)=>{let R=v.count();R.onsuccess=()=>U(R.result),R.onerror=()=>L(R.error)});if(l+=A,A>0){let U=0;if(await new Promise((L,R)=>{let O=v.openCursor();O.onsuccess=M=>{let E=M.target.result;if(E){let F=E.value instanceof Uint8Array?E.value.byteLength:JSON.stringify(E.value).length;U+=F,E.continue()}else L()},O.onerror=()=>R(O.error)}),c+=U,U>1024*1024&&(!t||_===e)){let L=await new Promise(M=>{let E=w.get("path");E.onsuccess=()=>M(E.result||"")}),R=await new Promise(M=>{let E=w.get("relay");E.onsuccess=()=>M(E.result||"")}),O=!d.name.startsWith(`${e}-relay`);a.push({slug:`${d.name}/${v.name}`,path:L,relay:R,appId:_||"unknown",count:A,estimatedSizeMB:Math.round(U/(1024*1024)*100)/100,isLegacy:O})}}}finally{m.close()}}catch(m){console.error(`Error processing database ${d.name}:`,m);continue}u++,r&&r(u/n.length*100)}return{totalStores:i,totalItems:l,totalSizeMB:Math.round(c/(1024*1024)*100)/100,databaseCount:s,largeStores:a.sort((d,m)=>m.estimatedSizeMB-d.estimatedSizeMB)}}async function rw(o){let[e,t]=o.split("/"),r=await new Promise((n,s)=>{let a=indexedDB.open(e);a.onerror=()=>s(a.error),a.onsuccess=()=>n(a.result)});try{let s=r.transaction(t,"readwrite").objectStore(t);await new Promise((a,i)=>{let l=s.clear();l.onsuccess=()=>a(),l.onerror=()=>i(l.error)})}catch(n){console.error(`Error deleting store: ${o}`,n)}finally{r.close()}}var lK=require("obsidian");function $A(o){De(o,"svelte-1n3w4sk",".system3-dangerous.svelte-1n3w4sk:enabled{background-color:var(--background-modifier-error)}.system3-indexeddb-analysis.svelte-1n3w4sk{padding:1rem;max-height:500px;overflow-y:auto}.system3-loading-container.svelte-1n3w4sk{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:1rem}.system3-loading-spinner.svelte-1n3w4sk{border:4px solid var(--background-modifier-border);border-top:4px solid var(--interactive-accent);border-radius:50%;width:40px;height:40px;animation:svelte-1n3w4sk-spin 1s linear infinite}.system3-progress-bar.svelte-1n3w4sk{width:80%;height:8px;border-radius:4px;background-color:var(--background-secondary);overflow:hidden;margin:0 auto}.system3-progress-fill.svelte-1n3w4sk{height:100%;background-color:var(--color-accent);border-radius:4px;transition:width 0.3s ease;min-width:0%;max-width:100%}.system3-error-message.svelte-1n3w4sk{color:var(--text-error);padding:1rem;background-color:var(--mod-error);border-radius:4px}.system3-actions.svelte-1n3w4sk{display:flex;gap:0.5rem}.system3-summary-stats.svelte-1n3w4sk{display:grid;grid-template-columns:repeat(3, 1fr);gap:1rem;margin-bottom:2rem;padding:1rem;background-color:var(--background-secondary);border-radius:4px}.system3-stat-item.svelte-1n3w4sk{text-align:center}.system3-global-count.svelte-1n3w4sk{grid-column:1 / -1;padding-top:0.5rem;margin-top:0.5rem;border-bottom:1px solid var(--background-modifier-border)}.system3-warning.svelte-1n3w4sk{color:var(--text-warning)}.system3-critical.svelte-1n3w4sk{color:var(--text-error)}.system3-warning-text.svelte-1n3w4sk{font-size:0.8em;margin-top:0.5rem;color:var(--text-warning);line-height:1.4}.system3-warning-text.system3-critical.svelte-1n3w4sk{color:var(--text-error);font-weight:bold}.system3-stat-label.svelte-1n3w4sk{font-size:0.9em;color:var(--text-muted);margin-bottom:0.5rem}.system3-stat-value.svelte-1n3w4sk{font-size:1.2em;font-weight:bold}@keyframes svelte-1n3w4sk-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}")}function ow(o,e,t){let r=o.slice();return r[18]=e[t][0],r[19]=e[t][1],r}function nw(o,e,t){let r=o.slice();return r[22]=e[t],r}function BA(o){let e,t,r,n,s,a=o[0].databaseCount.toLocaleString()+"",i,l,c,u,d,m,x,h,v=o[0].totalStores+"",w,_,A,U,L,R,O=o[0].totalItems.toLocaleString()+"",M,E,F,q,J,G,z=o[0].totalSizeMB.toFixed(2)+"",W,oe,Ie,Pe,Ee;function Ye(te,$e){if(te[0].databaseCount>45e3)return qA;if(te[0].databaseCount>4e4)return VA}let Fe=Ye(o,-1),de=Fe&&Fe(o),fe=o[0].largeStores.length>0&&sw(o);return{c(){e=D("div"),t=D("div"),r=D("div"),r.textContent="Global Database Limit",n=B(),s=D("div"),i=K(a),l=K(" / 50,000"),c=B(),de&&de.c(),u=B(),d=D("div"),m=D("div"),m.textContent="Relay Databases",x=B(),h=D("div"),w=K(v),_=B(),A=D("div"),U=D("div"),U.textContent="Document Updates",L=B(),R=D("div"),M=K(O),E=B(),F=D("div"),q=D("div"),q.textContent="Total Size",J=B(),G=D("div"),W=K(z),oe=K(" MB"),Ie=B(),fe&&fe.c(),Pe=Ce(),b(r,"class","system3-stat-label svelte-1n3w4sk"),b(s,"class","system3-stat-value svelte-1n3w4sk"),ze(s,"system3-warning",o[0].databaseCount>4e4),ze(s,"system3-critical",o[0].databaseCount>45e3),b(t,"class","system3-stat-item system3-global-count svelte-1n3w4sk"),b(m,"class","system3-stat-label svelte-1n3w4sk"),b(h,"class","system3-stat-value svelte-1n3w4sk"),b(d,"class","system3-stat-item svelte-1n3w4sk"),b(U,"class","system3-stat-label svelte-1n3w4sk"),b(R,"class","system3-stat-value svelte-1n3w4sk"),b(A,"class","system3-stat-item svelte-1n3w4sk"),b(q,"class","system3-stat-label svelte-1n3w4sk"),b(G,"class","system3-stat-value svelte-1n3w4sk"),b(F,"class","system3-stat-item svelte-1n3w4sk"),b(e,"class","system3-summary-stats svelte-1n3w4sk")},m(te,$e){T(te,e,$e),k(e,t),k(t,r),k(t,n),k(t,s),k(s,i),k(s,l),k(t,c),de&&de.m(t,null),k(e,u),k(e,d),k(d,m),k(d,x),k(d,h),k(h,w),k(e,_),k(e,A),k(A,U),k(A,L),k(A,R),k(R,M),k(e,E),k(e,F),k(F,q),k(F,J),k(F,G),k(G,W),k(G,oe),T(te,Ie,$e),fe&&fe.m(te,$e),T(te,Pe,$e),Ee=!0},p(te,$e){(!Ee||$e&1)&&a!==(a=te[0].databaseCount.toLocaleString()+"")&&se(i,a),(!Ee||$e&1)&&ze(s,"system3-warning",te[0].databaseCount>4e4),(!Ee||$e&1)&&ze(s,"system3-critical",te[0].databaseCount>45e3),Fe!==(Fe=Ye(te,$e))&&(de&&de.d(1),de=Fe&&Fe(te),de&&(de.c(),de.m(t,null))),(!Ee||$e&1)&&v!==(v=te[0].totalStores+"")&&se(w,v),(!Ee||$e&1)&&O!==(O=te[0].totalItems.toLocaleString()+"")&&se(M,O),(!Ee||$e&1)&&z!==(z=te[0].totalSizeMB.toFixed(2)+"")&&se(W,z),te[0].largeStores.length>0?fe?(fe.p(te,$e),$e&1&&I(fe,1)):(fe=sw(te),fe.c(),I(fe,1),fe.m(Pe.parentNode,Pe)):fe&&(be(),P(fe,1,1,()=>{fe=null}),we())},i(te){Ee||(I(fe),Ee=!0)},o(te){P(fe),Ee=!1},d(te){te&&(C(e),C(Ie),C(Pe)),de&&de.d(),fe&&fe.d(te)}}}function NA(o){let e,t;return{c(){e=D("div"),t=K(o[5]),b(e,"class","system3-error-message svelte-1n3w4sk")},m(r,n){T(r,e,n),k(e,t)},p(r,n){n&32&&se(t,r[5])},i:X,o:X,d(r){r&&C(e)}}}function HA(o){let e,t,r,n,s,a,i;return{c(){e=D("div"),t=D("div"),r=B(),n=D("div"),n.textContent="Analyzing Databases...",s=B(),a=D("div"),i=D("div"),b(t,"class","system3-loading-spinner svelte-1n3w4sk"),b(n,"class","loading-text"),b(i,"class","system3-progress-fill svelte-1n3w4sk"),ue(i,"width",o[4]+"%"),b(a,"class","system3-progress-bar svelte-1n3w4sk"),b(e,"class","system3-loading-container svelte-1n3w4sk")},m(l,c){T(l,e,c),k(e,t),k(e,r),k(e,n),k(e,s),k(e,a),k(a,i)},p(l,c){c&16&&ue(i,"width",l[4]+"%")},i:X,o:X,d(l){l&&C(e)}}}function VA(o){let e;return{c(){e=D("div"),e.innerHTML=`Warning: high number of databases.<br/>
						Consider cleaning up unused databases.`,b(e,"class","system3-warning-text svelte-1n3w4sk")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function qA(o){let e;return{c(){e=D("div"),e.innerHTML=`Critical: approaching IndexedDB database limit!<br/>
						Your browser may start deleting old databases soon.`,b(e,"class","system3-warning-text system3-critical svelte-1n3w4sk")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function sw(o){let e,t,r,n;e=new Je({props:{name:"Large Stores (>1MB)"}});let s=Re(o[2]),a=[];for(let l=0;l<s.length;l+=1)a[l]=iw(ow(o,s,l));let i=l=>P(a[l],1,1,()=>{a[l]=null});return{c(){V(e.$$.fragment),t=B();for(let l=0;l<a.length;l+=1)a[l].c();r=Ce()},m(l,c){N(e,l,c),T(l,t,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(l,c);T(l,r,c),n=!0},p(l,c){if(c&2052){s=Re(l[2]);let u;for(u=0;u<s.length;u+=1){let d=ow(l,s,u);a[u]?(a[u].p(d,c),I(a[u],1)):(a[u]=iw(d),a[u].c(),I(a[u],1),a[u].m(r.parentNode,r))}for(be(),u=s.length;u<a.length;u+=1)i(u);we()}},i(l){if(!n){I(e.$$.fragment,l);for(let c=0;c<s.length;c+=1)I(a[c]);n=!0}},o(l){P(e.$$.fragment,l),a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)P(a[c]);n=!1},d(l){l&&(C(t),C(r)),H(e,l),it(a,l)}}}function WA(o){let e,t,r,n,s;function a(){return o[17](o[22])}return{c(){e=D("div"),t=D("button"),t.textContent="Delete",r=B(),b(t,"class","mod-warning"),b(t,"title","Delete all data in this store"),b(e,"class","system3-actions svelte-1n3w4sk")},m(i,l){T(i,e,l),k(e,t),T(i,r,l),n||(s=re(t,"click",a),n=!0)},p(i,l){o=i},d(i){i&&(C(e),C(r)),n=!1,s()}}}function aw(o){let e,t;return e=new He({props:{name:o[22].path||o[22].slug,description:"Size: "+o[22].estimatedSizeMB+"MB, Items: "+o[22].count,$$slots:{default:[WA]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&4&&(s.name=r[22].path||r[22].slug),n&4&&(s.description="Size: "+r[22].estimatedSizeMB+"MB, Items: "+r[22].count),n&33554436&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function iw(o){let e,t,r,n;e=new Je({props:{name:o[18]==="local"?"Tracked Documents":`Relay: ${o[18]}`}});let s=Re(o[19]),a=[];for(let l=0;l<s.length;l+=1)a[l]=aw(nw(o,s,l));let i=l=>P(a[l],1,1,()=>{a[l]=null});return{c(){V(e.$$.fragment),t=B();for(let l=0;l<a.length;l+=1)a[l].c();r=Ce()},m(l,c){N(e,l,c),T(l,t,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(l,c);T(l,r,c),n=!0},p(l,c){let u={};if(c&4&&(u.name=l[18]==="local"?"Tracked Documents":`Relay: ${l[18]}`),e.$set(u),c&2052){s=Re(l[19]);let d;for(d=0;d<s.length;d+=1){let m=nw(l,s,d);a[d]?(a[d].p(m,c),I(a[d],1)):(a[d]=aw(m),a[d].c(),I(a[d],1),a[d].m(r.parentNode,r))}for(be(),d=s.length;d<a.length;d+=1)i(d);we()}},i(l){if(!n){I(e.$$.fragment,l);for(let c=0;c<s.length;c+=1)I(a[c]);n=!0}},o(l){P(e.$$.fragment,l),a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)P(a[c]);n=!1},d(l){l&&(C(t),C(r)),H(e,l),it(a,l)}}}function zA(o){let e,t,r,n,s,a,i,l,c,u,d,m,x,h,v,w,_,A=[HA,NA,BA],U=[];function L(R,O){return R[3]?0:R[5]?1:R[0]?2:-1}return~(x=L(o,-1))&&(h=U[x]=A[x](o)),{c(){e=D("div"),e.textContent="Relay database analysis",t=B(),r=D("div"),n=D("div"),s=D("div"),s.innerHTML=`<div class="setting-item-name">Search across vaults</div> <div class="setting-item-description"><div class="mod-warning">Warning: This is a dangerous setting. It allows you to delete relay
					databases from other vaults.</div></div>`,a=B(),i=D("div"),l=D("div"),c=D("input"),u=B(),d=D("div"),m=B(),h&&h.c(),b(e,"class","modal-title"),b(s,"class","setting-item-info"),b(c,"type","checkbox"),b(c,"tabindex","-1"),c.checked=o[1],b(d,"class","checkbox-toggle"),b(l,"role","checkbox"),b(l,"aria-checked",o[1]),b(l,"tabindex","0"),b(l,"class","checkbox-container system3-dangerous svelte-1n3w4sk"),ze(l,"is-enabled",o[1]),b(i,"class","setting-item-control"),b(n,"class","setting-item"),b(r,"class","system3-indexeddb-analysis svelte-1n3w4sk")},m(R,O){T(R,e,O),T(R,t,O),T(R,r,O),k(r,n),k(n,s),k(n,a),k(n,i),k(i,l),k(l,c),k(l,u),k(l,d),k(r,m),~x&&U[x].m(r,null),v=!0,w||(_=[re(l,"keypress",o[15]),re(l,"click",o[16])],w=!0)},p(R,[O]){(!v||O&2)&&(c.checked=R[1]),(!v||O&2)&&b(l,"aria-checked",R[1]),(!v||O&2)&&ze(l,"is-enabled",R[1]);let M=x;x=L(R,O),x===M?~x&&U[x].p(R,O):(h&&(be(),P(U[M],1,1,()=>{U[M]=null}),we()),~x?(h=U[x],h?h.p(R,O):(h=U[x]=A[x](R),h.c()),I(h,1),h.m(r,null)):h=null)},i(R){v||(I(h),v=!0)},o(R){P(h),v=!1},d(R){R&&(C(e),C(t),C(r)),~x&&U[x].d(),w=!1,ke(_)}}}function KA(o,e,t){let r,n,s,a,i,l;var c;let{plugin:u}=e,d=_e(!0);me(o,d,R=>t(3,a=R));let m=_e(0);me(o,m,R=>t(4,i=R));let x=_e(null);me(o,x,R=>t(0,s=R));let h=_e(null);me(o,h,R=>t(5,l=R));let v=!1;function w(){return Ge(this,void 0,void 0,function*(){d.set(!0),h.set(null);try{let R=yield tw({appId:u.appId,filterByAppId:!v,onProgress:O=>m.set(O)});x.set(R)}catch(R){h.set(`Analysis failed: ${R.message}`)}finally{d.set(!1)}})}function _(R){return Ge(this,void 0,void 0,function*(){try{yield rw(R),s&&dx(x,s.largeStores=s.largeStores.filter(O=>O.slug!==R),s)}catch(O){h.set(`Failed to delete ${R}: ${O.message}`)}})}er(()=>{w()});let A=()=>{t(1,v=!v),w()},U=()=>{t(1,v=!v),w()},L=R=>_(R.slug);return o.$$set=R=>{"plugin"in R&&t(12,u=R.plugin)},o.$$.update=()=>{if(o.$$.dirty&8193){e:t(14,r=t(13,c=s==null?void 0:s.largeStores.reduce((R,O)=>{let M=O.relay||"local";return R[M]||(R[M]=[]),R[M].push(O),R},{}))!==null&&c!==void 0?c:{})}if(o.$$.dirty&16384){e:t(2,n=Object.entries(r).sort(([R],[O])=>R==="local"?-1:O==="local"?1:R.localeCompare(O)))}},[s,v,n,a,i,l,d,m,x,h,w,_,u,c,r,A,U,L]}var Kp=class extends Z{constructor(e){super(),ee(this,e,KA,zA,Q,{plugin:12},$A)}},lw=Kp;var wf=class extends fw.Modal{constructor(t,r){super(t);this.plugin=r}onOpen(){let{contentEl:t}=this;this.component=new lw({target:t,props:{plugin:this.plugin}})}onClose(){var r;let{contentEl:t}=this;t.empty(),(r=this.component)==null||r.$destroy()}};var Uw=require("obsidian");var{Boolean:_w}=En;function GA(o){De(o,"svelte-18bqwhy",".file-name.svelte-18bqwhy{display:flex;align-items:center;gap:6px;font-size:0.9rem;flex:1;min-width:0}.details-container.svelte-18bqwhy{margin-left:auto;text-align:right;padding-left:8px;padding-right:8px}.details.svelte-18bqwhy{font-size:0.75rem;color:var(--text-muted)}.error-message.svelte-18bqwhy{color:var(--text-error);margin-top:2px;text-align:right}.more-files.svelte-18bqwhy{font-size:0.8rem;color:var(--text-muted);text-align:center}button.mod-warning.svelte-18bqwhy{display:flex;align-items:center;gap:4px;background-color:var(--background-modifier-error);color:var(--text-error)}.mod-primary{color:var(--interactive-accent)}.mod-success{color:var(--interactive-success)}.mod-warning{color:var(--text-warning)}.show-more-link.svelte-18bqwhy{color:var(--text-accent);cursor:pointer;font-size:0.8rem}.show-more-link.svelte-18bqwhy:hover{text-decoration:underline}")}function cw(o,e,t){let r=o.slice();return r[20]=e[t],r}function uw(o,e,t){let r=o.slice();return r[23]=e[t],r}function jA(o){return{c:X,m:X,p:X,i:X,o:X,d:X}}function YA(o){let e,t,r=Re(ww(o[19].documents)),n=[];for(let a=0;a<r.length;a+=1)n[a]=xw(cw(o,r,a));let s=a=>P(n[a],1,1,()=>{n[a]=null});return{c(){for(let a=0;a<n.length;a+=1)n[a].c();e=Ce()},m(a,i){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(a,i);T(a,e,i),t=!0},p(a,i){if(i&8311){r=Re(ww(a[19].documents));let l;for(l=0;l<r.length;l+=1){let c=cw(a,r,l);n[l]?(n[l].p(c,i),I(n[l],1)):(n[l]=xw(c),n[l].c(),I(n[l],1),n[l].m(e.parentNode,e))}for(be(),l=r.length;l<n.length;l+=1)s(l);we()}},i(a){if(!t){for(let i=0;i<r.length;i+=1)I(n[i]);t=!0}},o(a){n=n.filter(_w);for(let i=0;i<n.length;i+=1)P(n[i]);t=!1},d(a){a&&C(e),it(n,a)}}}function dw(o){let e,t=bw(o[23].queueState.timestamp)+"",r;return{c(){e=K("\u2022 "),r=K(t)},m(n,s){T(n,e,s),T(n,r,s)},p(n,s){s&3&&t!==(t=bw(n[23].queueState.timestamp)+"")&&se(r,t)},d(n){n&&(C(e),C(r))}}}function pw(o){let e,t=o[23].queueState.error+"",r;return{c(){e=D("div"),r=K(t),b(e,"class","error-message svelte-18bqwhy")},m(n,s){T(n,e,s),k(e,r)},p(n,s){s&3&&t!==(t=n[23].queueState.error+"")&&se(r,t)},d(n){n&&C(e)}}}function mw(o){let e,t,r,n,s,a;t=new ju({props:{size:14,class:"svg-icon lucide-refresh-cw"}});function i(){return o[10](o[23])}return{c(){e=D("button"),V(t.$$.fragment),r=K(`
							Retry`),b(e,"class","mod-warning svelte-18bqwhy")},m(l,c){T(l,e,c),N(t,e,null),k(e,r),n=!0,s||(a=re(e,"click",i),s=!0)},p(l,c){o=l},i(l){n||(I(t.$$.fragment,l),n=!0)},o(l){P(t.$$.fragment,l),n=!1},d(l){l&&C(e),H(t),s=!1,a()}}}function JA(o){var x,h,v;let e,t,r=o[5](o[23]).text+"",n,s,a,i,l,c,u=((x=o[23].queueState)==null?void 0:x.timestamp)&&dw(o),d=((h=o[23].queueState)==null?void 0:h.error)&&pw(o),m=((v=o[23].queueState)==null?void 0:v.status)==="failed"&&mw(o);return{c(){e=D("div"),t=D("span"),n=K(r),s=B(),u&&u.c(),a=B(),d&&d.c(),i=B(),m&&m.c(),l=Ce(),b(t,"class","details svelte-18bqwhy"),b(e,"class","details-container svelte-18bqwhy")},m(w,_){T(w,e,_),k(e,t),k(t,n),k(t,s),u&&u.m(t,null),k(t,a),d&&d.m(t,null),T(w,i,_),m&&m.m(w,_),T(w,l,_),c=!0},p(w,_){var A,U,L;(!c||_&3)&&r!==(r=w[5](w[23]).text+"")&&se(n,r),(A=w[23].queueState)!=null&&A.timestamp?u?u.p(w,_):(u=dw(w),u.c(),u.m(t,a)):u&&(u.d(1),u=null),(U=w[23].queueState)!=null&&U.error?d?d.p(w,_):(d=pw(w),d.c(),d.m(t,null)):d&&(d.d(1),d=null),((L=w[23].queueState)==null?void 0:L.status)==="failed"?m?(m.p(w,_),_&3&&I(m,1)):(m=mw(w),m.c(),I(m,1),m.m(l.parentNode,l)):m&&(be(),P(m,1,1,()=>{m=null}),we())},i(w){c||(I(m),c=!0)},o(w){P(m),c=!1},d(w){w&&(C(e),C(i),C(l)),u&&u.d(),d&&d.d(),m&&m.d(w)}}}function XA(o){let e,t=o[9].default,r=he(t,o,o[13],null),n=r||JA(o);return{c(){n&&n.c()},m(s,a){n&&n.m(s,a),e=!0},p(s,a){r?r.p&&(!e||a&8192)&&xe(r,t,s,s[13],e?ge(t,s[13],a,null):ye(s[13]),null):n&&n.p&&(!e||a&3)&&n.p(s,e?a:-1)},i(s){e||(I(n,s),e=!0)},o(s){P(n,s),e=!1},d(s){n&&n.d(s)}}}function QA(o){let e,t,r,n,s=o[23].path.split("/").pop()+"",a,i;var l=o[5](o[23]).icon;function c(u,d){return{props:{size:16,class:"svg-icon "+u[5](u[23]).iconClass}}}return l&&(t=Es(l,c(o))),{c(){e=D("span"),t&&V(t.$$.fragment),r=B(),n=D("span"),a=K(s),b(e,"slot","name"),b(e,"class","file-name svelte-18bqwhy")},m(u,d){T(u,e,d),t&&N(t,e,null),k(e,r),k(e,n),k(n,a),i=!0},p(u,d){if(d&3&&l!==(l=u[5](u[23]).icon)){if(t){be();let m=t;P(m.$$.fragment,1,0,()=>{H(m,1)}),we()}l?(t=Es(l,c(u,d)),V(t.$$.fragment),I(t.$$.fragment,1),N(t,e,r)):t=null}else if(l){let m={};d&3&&(m.class="svg-icon "+u[5](u[23]).iconClass),t.$set(m)}(!i||d&3)&&s!==(s=u[23].path.split("/").pop()+"")&&se(a,s)},i(u){i||(t&&I(t.$$.fragment,u),i=!0)},o(u){t&&P(t.$$.fragment,u),i=!1},d(u){u&&C(e),t&&H(t)}}}function hw(o){let e,t;return e=new cr({props:{$$slots:{name:[QA],default:[XA]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&8195&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function gw(o){let e,t;return e=new cr({props:{$$slots:{name:[ZA]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&8195&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function ZA(o){let e,t,r=yw(o[1](o[20]).remainingCount)+"",n,s,a=o[20].title.toLowerCase()+"",i,l,c,u,d,m,x,h;function v(){return o[11](o[20])}function w(..._){return o[12](o[20],..._)}return{c(){var _;e=D("span"),t=K("...and "),n=K(r),s=K(` more
					`),i=K(a),l=B(),c=D("span"),u=K("(show more)"),m=B(),b(c,"class","show-more-link svelte-18bqwhy"),b(c,"role","button"),b(c,"tabindex","0"),b(c,"aria-label",d=`Show ${((_=o[2][o[20].title])==null?void 0:_.incrementCount)||o[2].default.incrementCount} more ${o[20].title.toLowerCase()}`),b(e,"slot","name"),b(e,"class","more-files svelte-18bqwhy")},m(_,A){T(_,e,A),k(e,t),k(e,n),k(e,s),k(e,i),k(e,l),k(e,c),k(c,u),k(e,m),x||(h=[re(c,"click",v),re(c,"keydown",w)],x=!0)},p(_,A){var U;o=_,A&3&&r!==(r=yw(o[1](o[20]).remainingCount)+"")&&se(n,r),A&1&&a!==(a=o[20].title.toLowerCase()+"")&&se(i,a),A&1&&d!==(d=`Show ${((U=o[2][o[20].title])==null?void 0:U.incrementCount)||o[2].default.incrementCount} more ${o[20].title.toLowerCase()}`)&&b(c,"aria-label",d)},d(_){_&&C(e),x=!1,ke(h)}}}function xw(o){let e,t,r,n=o[1](o[20]).remainingCount>0,s,a;e=new Je({props:{name:o[20].title}});let i=Re(o[1](o[20]).visibleDocs),l=[];for(let d=0;d<i.length;d+=1)l[d]=hw(uw(o,i,d));let c=d=>P(l[d],1,1,()=>{l[d]=null}),u=n&&gw(o);return{c(){V(e.$$.fragment),t=B();for(let d=0;d<l.length;d+=1)l[d].c();r=B(),u&&u.c(),s=Ce()},m(d,m){N(e,d,m),T(d,t,m);for(let x=0;x<l.length;x+=1)l[x]&&l[x].m(d,m);T(d,r,m),u&&u.m(d,m),T(d,s,m),a=!0},p(d,m){let x={};if(m&1&&(x.name=d[20].title),e.$set(x),m&8291){i=Re(d[1](d[20]).visibleDocs);let h;for(h=0;h<i.length;h+=1){let v=uw(d,i,h);l[h]?(l[h].p(v,m),I(l[h],1)):(l[h]=hw(v),l[h].c(),I(l[h],1),l[h].m(r.parentNode,r))}for(be(),h=i.length;h<l.length;h+=1)c(h);we()}m&3&&(n=d[1](d[20]).remainingCount>0),n?u?(u.p(d,m),m&3&&I(u,1)):(u=gw(d),u.c(),I(u,1),u.m(s.parentNode,s)):u&&(be(),P(u,1,1,()=>{u=null}),we())},i(d){if(!a){I(e.$$.fragment,d);for(let m=0;m<i.length;m+=1)I(l[m]);I(u),a=!0}},o(d){P(e.$$.fragment,d),l=l.filter(_w);for(let m=0;m<l.length;m+=1)P(l[m]);P(u),a=!1},d(d){d&&(C(t),C(r),C(s)),H(e,d),it(l,d),u&&u.d(d)}}}function eE(o){let e;return{c(){e=D("div"),e.textContent="Loading...",b(e,"class","loading")},m(t,r){T(t,e,r)},p:X,i:X,o:X,d(t){t&&C(e)}}}function tE(o){let e,t,r,n={ctx:o,current:null,token:null,hasCatch:!1,pending:eE,then:YA,catch:jA,value:19,blocks:[,,,]};return Fs(t=o[0],n),{c(){e=Ce(),n.block.c()},m(s,a){T(s,e,a),n.block.m(s,n.anchor=a),n.mount=()=>e.parentNode,n.anchor=e,r=!0},p(s,[a]){o=s,n.ctx=o,a&1&&t!==(t=o[0])&&Fs(t,n)||wl(n,o,a)},i(s){r||(I(n.block),r=!0)},o(s){for(let a=0;a<3;a+=1){let i=n.blocks[a];P(i)}r=!1},d(s){s&&C(e),n.block.d(s),n.token=null,n=null}}}function yw(o){return new Intl.NumberFormat().format(o)}function bw(o){let e=new Date(o),r=new Date().getTime()-e.getTime(),n=Math.floor(r/(1e3*60));if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;let s=Math.floor(n/60);if(s===1)return"1 hour ago";if(s<24)return`${s} hours ago`;let a=Math.floor(s/24);return a===1?"yesterday":`${a} days ago`}function ww(o){let e=o.filter(s=>{var a;return((a=s.queueState)===null||a===void 0?void 0:a.status)==="running"}),t=o.filter(s=>{var a;return((a=s.queueState)===null||a===void 0?void 0:a.status)==="failed"}),r=o.filter(s=>{var a;return((a=s.queueState)===null||a===void 0?void 0:a.status)==="pending"}),n=o.filter(s=>{var a;return((a=s.queueState)===null||a===void 0?void 0:a.status)==="completed"});return[e.length>0&&{title:"Active Files",documents:e},t.length>0&&{title:"Stuck Files",documents:t},r.length>0&&{title:"Queued Files",documents:r},n.length>0&&{title:"Completed Files",documents:n}].filter(Boolean)}function rE(o,e,t){let r,n,s,a,i,{$$slots:l={},$$scope:c}=e,{folder:u}=e,{backgroundSync:d}=e,m={"Active Files":{initialCount:1/0,incrementCount:100},"Stuck Files":{initialCount:1/0,incrementCount:100},"Queued Files":{initialCount:10,incrementCount:100},"Completed Files":{initialCount:5,incrementCount:100},default:{initialCount:1/0,incrementCount:100}},x=_e({}),h=lo(x,O=>M=>{let E=m[M.title]||m.default,F=O[M.title]||E.initialCount,q=M.documents.slice(0,F),J=M.documents.length-F;return{visibleCount:F,visibleDocs:q,remainingCount:J}});me(o,h,O=>t(1,i=O));function v(O){let M=m[O]||m.default;x.update(E=>Object.assign(Object.assign({},E),{[O]:(E[O]||M.initialCount)+M.incrementCount}))}function w(O){return Ge(this,void 0,void 0,function*(){var M;let E=[],F=Array.from(O.docs.values());for(let q of F){let J=yield q.getOrigin(),G=yield q.getServerSynced(),z={guid:q.guid,path:O.getPath(q.path),doc:q,origin:J||"unknown",serverSynced:G},W=Array.from(r).find(Pe=>Pe.guid===q.guid),oe=Array.from(n).find(Pe=>Pe.guid===q.guid),Ie=s.find(Pe=>Pe.guid===q.guid);if(W||oe||Ie){let Pe=W||oe||Ie;z.queueState={status:Pe.status,type:"type"in Pe?Pe.type:"sync",error:"error"in Pe?Pe.error:void 0,timestamp:"timestamp"in Pe?Pe.timestamp:Date.now()}}else J==="local"&&!G?z.queueState={status:"pending",type:"sync",timestamp:Date.now()}:G?z.queueState={status:"completed",type:"sync",timestamp:Date.now()}:z.queueState={status:"pending",type:"sync",timestamp:Date.now()};E.push(z)}return{folder:O,documents:E,progress:((M=d.getGroupProgress(O))===null||M===void 0?void 0:M.percent)||0}})}function _(O){let{origin:M,serverSynced:E,queueState:F}=O,q=(F==null?void 0:F.status)||"completed",J=(F==null?void 0:F.type)||"sync";return M==="remote"&&!E&&q==="running"&&J==="download"?{text:"Downloading",description:"Initial acquisition",icon:Fu,iconClass:"mod-primary"}:M==="remote"&&!E&&q==="pending"&&J==="download"?{text:"Queued for Download",description:"Waiting to download",icon:Ua,iconClass:""}:M==="remote"&&!E&&q==="failed"&&J==="download"?{text:"Download stuck",description:"Needs retry",icon:$a,iconClass:"mod-warning"}:M==="local"&&!E&&q==="running"&&J==="sync"?{text:"Uploading",description:"First-time upload",icon:ed,iconClass:"mod-primary"}:M==="local"&&!E&&q==="pending"&&J==="sync"?{text:"Queued for Upload",description:"Waiting to upload",icon:Ua,iconClass:""}:M==="local"&&!E&&q==="failed"&&J==="sync"?{text:"Upload stuck",description:"Needs retry",icon:$a,iconClass:"mod-warning"}:E&&q==="running"&&J==="sync"?{text:"Syncing",description:"Collaborative update",icon:Lu,iconClass:"mod-primary"}:E&&q==="pending"&&J==="sync"?{text:"Queued for Sync",description:"Waiting to sync",icon:Ua,iconClass:""}:E&&q==="failed"&&J==="sync"?{text:"Sync stuck",description:"Needs retry",icon:$a,iconClass:"mod-warning"}:E&&q==="completed"?{text:"Complete",description:"Fully synchronized",icon:Au,iconClass:"mod-success"}:{text:"Unknown",description:"Status unknown",icon:Bu,iconClass:""}}function A(O){return Ge(this,void 0,void 0,function*(){var M,E;let F={id:O.guid,guid:O.guid,path:O.path,timestamp:((M=O.queueState)===null||M===void 0?void 0:M.timestamp)||Date.now(),type:((E=O.queueState)===null||E===void 0?void 0:E.type)||"sync",status:"failed",sharedFolderGuid:O.doc.sharedFolder.guid};yield d.retryLogItem(F)})}let U=O=>A(O),L=O=>{v(O.title)},R=(O,M)=>M.key==="Enter"&&v(O.title);return o.$$set=O=>{"folder"in O&&t(7,u=O.folder),"backgroundSync"in O&&t(8,d=O.backgroundSync),"$$scope"in O&&t(13,c=O.$$scope)},o.$$.update=()=>{if(o.$$.dirty&256){e:r=new Set(d.activeSync.items())}if(o.$$.dirty&256){e:n=new Set(d.activeDownloads.items())}if(o.$$.dirty&256){e:s=d.getSyncLog()}if(o.$$.dirty&128){e:t(0,a=w(u))}},[a,i,m,h,v,_,A,u,d,l,U,L,R,c]}var Gp=class extends Z{constructor(e){super(),ee(this,e,rE,tE,Q,{folder:7,backgroundSync:8},GA)}},jp=Gp;var{Map:oE}=En;function nE(o){De(o,"svelte-ztgdsf",".folder-header.svelte-ztgdsf{display:flex;align-items:center;cursor:pointer;background:none;border:none;padding:0;width:100%;text-align:left;color:inherit;font:inherit}.arrow.svelte-ztgdsf{margin-right:8px;font-size:0.8em;transition:transform 0.15s ease}.arrow.is-expanded.svelte-ztgdsf{transform:rotate(90deg)}.sync-stats.svelte-ztgdsf{margin-left:8px;display:flex;gap:4px}.tag.svelte-ztgdsf{font-size:0.7em;padding:2px 6px;border-radius:4px;background-color:var(--background-modifier-border);color:var(--text-muted)}.tag.mod-success.svelte-ztgdsf{background-color:var(--interactive-success);color:var(--text-on-accent)}.tag.mod-warning.svelte-ztgdsf{background-color:var(--text-warning);color:var(--text-on-accent)}.progress-container.svelte-ztgdsf{display:flex;align-items:center;margin-top:4px;width:100%}.progress-bar.svelte-ztgdsf{flex:1;height:6px;background-color:var(--background-modifier-border);border-radius:3px;overflow:hidden;margin-right:8px}.progress-value.svelte-ztgdsf{height:100%;background-color:var(--interactive-accent);border-radius:3px}.progress-text.svelte-ztgdsf{font-size:0.75rem;color:var(--text-muted)}")}function vw(o,e,t){let r=o.slice();r[25]=e[t];let n=r[4].get(r[25].guid);return r[26]=n,r}function Sw(o){let e,t;return e=new Je({props:{name:"Sync Status"}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function kw(o){let e,t;return e=new He({props:{name:o[11]?"Sync in Progress":o[10]?"Queued Files":"Sync Complete",description:`${o[2]} active \u2022 ${o[7]} stuck \u2022 ${o[3]} queued \u2022 ${o[8]} complete`,$$slots:{default:[iE]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&3072&&(s.name=r[11]?"Sync in Progress":r[10]?"Queued Files":"Sync Complete"),n&396&&(s.description=`${r[2]} active \u2022 ${r[7]} stuck \u2022 ${r[3]} queued \u2022 ${r[8]} complete`),n&536874496&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function Lw(o){let e,t,r,n,s,a,i=[aE,sE],l=[];function c(u,d){return u[9]?0:1}return t=c(o,-1),r=l[t]=i[t](o),{c(){e=D("button"),r.c(),b(e,"class","mod-cta")},m(u,d){T(u,e,d),l[t].m(e,null),n=!0,s||(a=re(e,"click",o[16]),s=!0)},p(u,d){let m=t;t=c(u,d),t!==m&&(be(),P(l[m],1,1,()=>{l[m]=null}),we(),r=l[t],r||(r=l[t]=i[t](u),r.c()),I(r,1),r.m(e,null))},i(u){n||(I(r),n=!0)},o(u){P(r),n=!1},d(u){u&&C(e),l[t].d(),s=!1,a()}}}function sE(o){let e,t,r;return e=new Wu({props:{size:16,class:"svg-icon lucide-pause",style:"margin-right: 8px;"}}),{c(){V(e.$$.fragment),t=K(`
						Pause`)},m(n,s){N(e,n,s),T(n,t,s),r=!0},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){n&&C(t),H(e,n)}}}function aE(o){let e,t,r;return e=new Ku({props:{size:16,class:"svg-icon lucide-play",style:"margin-right: 8px;"}}),{c(){V(e.$$.fragment),t=K(`
						Resume`)},m(n,s){N(e,n,s),T(n,t,s),r=!0},i(n){r||(I(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){n&&C(t),H(e,n)}}}function iE(o){let e,t,r=(o[11]||o[10])&&Lw(o);return{c(){r&&r.c(),e=Ce()},m(n,s){r&&r.m(n,s),T(n,e,s),t=!0},p(n,s){n[11]||n[10]?r?(r.p(n,s),s&3072&&I(r,1)):(r=Lw(n),r.c(),I(r,1),r.m(e.parentNode,e)):r&&(be(),P(r,1,1,()=>{r=null}),we())},i(n){t||(I(r),t=!0)},o(n){P(r),t=!1},d(n){n&&C(e),r&&r.d(n)}}}function lE(o){let e=[],t=new oE,r,n,s=Re(o[6]),a=i=>i[25].guid;for(let i=0;i<s.length;i+=1){let l=vw(o,s,i),c=a(l);t.set(c,e[i]=Aw(c,l))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();r=Ce()},m(i,l){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(i,l);T(i,r,l),n=!0},p(i,l){l&32851&&(s=Re(i[6]),be(),e=Lx(e,l,a,1,i,s,t,r.parentNode,kx,Aw,r,vw),we())},i(i){if(!n){for(let l=0;l<s.length;l+=1)I(e[l]);n=!0}},o(i){for(let l=0;l<e.length;l+=1)P(e[l]);n=!1},d(i){i&&C(r);for(let l=0;l<e.length;l+=1)e[l].d(i)}}}function fE(o){let e,t,r,n;return e=new Je({props:{$$slots:{name:[hE],default:[pE]},$$scope:{ctx:o}}}),r=new jp({props:{folder:o[5],backgroundSync:o[0]}}),{c(){V(e.$$.fragment),t=B(),V(r.$$.fragment)},m(s,a){N(e,s,a),T(s,t,a),N(r,s,a),n=!0},p(s,a){let i={};a&536875040&&(i.$$scope={dirty:a,ctx:s}),e.$set(i);let l={};a&32&&(l.folder=s[5]),a&1&&(l.backgroundSync=s[0]),r.$set(l)},i(s){n||(I(e.$$.fragment,s),I(r.$$.fragment,s),n=!0)},o(s){P(e.$$.fragment,s),P(r.$$.fragment,s),n=!1},d(s){s&&C(t),H(e,s),H(r,s)}}}function Iw(o){let e,t,r,n,s,a=o[26].progress+"",i,l;return{c(){e=D("div"),t=D("div"),r=D("div"),n=B(),s=D("span"),i=K(a),l=K("%"),b(r,"class","progress-value svelte-ztgdsf"),ue(r,"width",o[26].progress+"%"),b(t,"class","progress-bar svelte-ztgdsf"),b(s,"class","progress-text svelte-ztgdsf"),b(e,"class","progress-container svelte-ztgdsf")},m(c,u){T(c,e,u),k(e,t),k(t,r),k(e,n),k(e,s),k(s,i),k(s,l)},p(c,u){u&80&&ue(r,"width",c[26].progress+"%"),u&80&&a!==(a=c[26].progress+"")&&se(i,a)},d(c){c&&C(e)}}}function cE(o){let e,t=o[26]&&(o[26].running>0||o[26].failed>0)&&Iw(o);return{c(){t&&t.c(),e=Ce()},m(r,n){t&&t.m(r,n),T(r,e,n)},p(r,n){r[26]&&(r[26].running>0||r[26].failed>0)?t?t.p(r,n):(t=Iw(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(r){r&&C(e),t&&t.d(r)}}}function Cw(o){let e,t=o[26].running+"",r,n;return{c(){e=D("span"),r=K(t),n=K(" active"),b(e,"class","tag mod-success svelte-ztgdsf")},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&80&&t!==(t=s[26].running+"")&&se(r,t)},d(s){s&&C(e)}}}function Tw(o){let e,t=o[26].failed+"",r,n;return{c(){e=D("span"),r=K(t),n=K(" stuck"),b(e,"class","tag mod-warning svelte-ztgdsf")},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&80&&t!==(t=s[26].failed+"")&&se(r,t)},d(s){s&&C(e)}}}function Dw(o){let e,t=o[26].pending+"",r,n;return{c(){e=D("span"),r=K(t),n=K(" queued"),b(e,"class","tag svelte-ztgdsf")},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&80&&t!==(t=s[26].pending+"")&&se(r,t)},d(s){s&&C(e)}}}function uE(o){var L,R,O;let e,t,r,n,s,a=o[25].name+"",i,l,c,u,d,m,x,h,v=((L=o[26])==null?void 0:L.running)>0&&Cw(o),w=((R=o[26])==null?void 0:R.failed)>0&&Tw(o),_=((O=o[26])==null?void 0:O.pending)>0&&Dw(o);function A(){return o[22](o[25])}function U(...M){return o[23](o[25],...M)}return{c(){e=D("div"),t=D("span"),r=K("\u25B6"),s=B(),i=K(a),l=B(),c=D("span"),v&&v.c(),u=B(),w&&w.c(),d=B(),_&&_.c(),b(t,"class",n="arrow "+(o[1][o[25].guid]?"is-expanded":"")+" svelte-ztgdsf"),b(c,"class","sync-stats svelte-ztgdsf"),b(e,"class","folder-header svelte-ztgdsf"),b(e,"role","button"),b(e,"tabindex","0"),b(e,"aria-expanded",m=!!o[1][o[25].guid])},m(M,E){T(M,e,E),k(e,t),k(t,r),k(e,s),k(e,i),k(e,l),k(e,c),v&&v.m(c,null),k(c,u),w&&w.m(c,null),k(c,d),_&&_.m(c,null),x||(h=[re(e,"click",A),re(e,"keydown",U)],x=!0)},p(M,E){var F,q,J;o=M,E&66&&n!==(n="arrow "+(o[1][o[25].guid]?"is-expanded":"")+" svelte-ztgdsf")&&b(t,"class",n),E&64&&a!==(a=o[25].name+"")&&se(i,a),((F=o[26])==null?void 0:F.running)>0?v?v.p(o,E):(v=Cw(o),v.c(),v.m(c,u)):v&&(v.d(1),v=null),((q=o[26])==null?void 0:q.failed)>0?w?w.p(o,E):(w=Tw(o),w.c(),w.m(c,d)):w&&(w.d(1),w=null),((J=o[26])==null?void 0:J.pending)>0?_?_.p(o,E):(_=Dw(o),_.c(),_.m(c,null)):_&&(_.d(1),_=null),E&66&&m!==(m=!!o[1][o[25].guid])&&b(e,"aria-expanded",m)},d(M){M&&C(e),v&&v.d(),w&&w.d(),_&&_.d(),x=!1,ke(h)}}}function dE(o){let e,t;return e=new fo({props:{folder:o[25],$$slots:{default:[uE]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&64&&(s.folder=r[25]),n&536870994&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function Pw(o){let e,t;return e=new jp({props:{folder:o[25],backgroundSync:o[0]}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&64&&(s.folder=r[25]),n&1&&(s.backgroundSync=r[0]),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function Aw(o,e){let t,r,n,s,a;r=new Je({props:{$$slots:{name:[dE],default:[cE]},$$scope:{ctx:e}}});let i=e[1][e[25].guid]&&Pw(e);return{key:o,first:null,c(){t=Ce(),V(r.$$.fragment),n=B(),i&&i.c(),s=Ce(),this.first=t},m(l,c){T(l,t,c),N(r,l,c),T(l,n,c),i&&i.m(l,c),T(l,s,c),a=!0},p(l,c){e=l;let u={};c&536870994&&(u.$$scope={dirty:c,ctx:e}),r.$set(u),e[1][e[25].guid]?i?(i.p(e,c),c&66&&I(i,1)):(i=Pw(e),i.c(),I(i,1),i.m(s.parentNode,s)):i&&(be(),P(i,1,1,()=>{i=null}),we())},i(l){a||(I(r.$$.fragment,l),I(i),a=!0)},o(l){P(r.$$.fragment,l),P(i),a=!1},d(l){l&&(C(t),C(n),C(s)),H(r,l),i&&i.d(l)}}}function Ew(o){let e,t,r,n,s,a=o[12].progress+"",i,l;return{c(){e=D("div"),t=D("div"),r=D("div"),n=B(),s=D("span"),i=K(a),l=K("%"),b(r,"class","progress-value svelte-ztgdsf"),ue(r,"width",o[12].progress+"%"),b(t,"class","progress-bar svelte-ztgdsf"),b(s,"class","progress-text svelte-ztgdsf"),b(e,"class","progress-container svelte-ztgdsf")},m(c,u){T(c,e,u),k(e,t),k(t,r),k(e,n),k(e,s),k(s,i),k(s,l)},p(c,u){u&4096&&ue(r,"width",c[12].progress+"%"),u&4096&&a!==(a=c[12].progress+"")&&se(i,a)},d(c){c&&C(e)}}}function pE(o){let e,t=(o[12].running>0||o[12].failed>0)&&Ew(o);return{c(){t&&t.c(),e=Ce()},m(r,n){t&&t.m(r,n),T(r,e,n)},p(r,n){r[12].running>0||r[12].failed>0?t?t.p(r,n):(t=Ew(r),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(r){r&&C(e),t&&t.d(r)}}}function Mw(o){let e,t=o[12].running+"",r,n;return{c(){e=D("span"),r=K(t),n=K(" active"),b(e,"class","tag mod-success svelte-ztgdsf")},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&4096&&t!==(t=s[12].running+"")&&se(r,t)},d(s){s&&C(e)}}}function Rw(o){let e,t=o[12].failed+"",r,n;return{c(){e=D("span"),r=K(t),n=K(" stuck"),b(e,"class","tag mod-warning svelte-ztgdsf")},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&4096&&t!==(t=s[12].failed+"")&&se(r,t)},d(s){s&&C(e)}}}function Fw(o){let e,t=o[12].pending+"",r,n;return{c(){e=D("span"),r=K(t),n=K(" queued"),b(e,"class","tag svelte-ztgdsf")},m(s,a){T(s,e,a),k(e,r),k(e,n)},p(s,a){a&4096&&t!==(t=s[12].pending+"")&&se(r,t)},d(s){s&&C(e)}}}function mE(o){let e,t=o[5].name+"",r,n,s,a,i,l=o[12].running>0&&Mw(o),c=o[12].failed>0&&Rw(o),u=o[12].pending>0&&Fw(o);return{c(){e=D("div"),r=K(t),n=B(),s=D("span"),l&&l.c(),a=B(),c&&c.c(),i=B(),u&&u.c(),b(s,"class","sync-stats svelte-ztgdsf"),b(e,"class","folder-header svelte-ztgdsf")},m(d,m){T(d,e,m),k(e,r),k(e,n),k(e,s),l&&l.m(s,null),k(s,a),c&&c.m(s,null),k(s,i),u&&u.m(s,null)},p(d,m){m&32&&t!==(t=d[5].name+"")&&se(r,t),d[12].running>0?l?l.p(d,m):(l=Mw(d),l.c(),l.m(s,a)):l&&(l.d(1),l=null),d[12].failed>0?c?c.p(d,m):(c=Rw(d),c.c(),c.m(s,i)):c&&(c.d(1),c=null),d[12].pending>0?u?u.p(d,m):(u=Fw(d),u.c(),u.m(s,null)):u&&(u.d(1),u=null)},d(d){d&&C(e),l&&l.d(),c&&c.d(),u&&u.d()}}}function hE(o){let e,t;return e=new fo({props:{folder:o[5],$$slots:{default:[mE]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n&32&&(s.folder=r[5]),n&536875040&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function gE(o){let e,t,r,n,s,a,i=!o[5]&&Sw(o),l=!o[5]&&kw(o),c=[fE,lE],u=[];function d(m,x){return m[5]&&m[12]?0:1}return n=d(o,-1),s=u[n]=c[n](o),{c(){e=D("div"),i&&i.c(),t=B(),l&&l.c(),r=B(),s.c(),b(e,"class","setting-item-container")},m(m,x){T(m,e,x),i&&i.m(e,null),k(e,t),l&&l.m(e,null),k(e,r),u[n].m(e,null),a=!0},p(m,[x]){m[5]?i&&(be(),P(i,1,1,()=>{i=null}),we()):i?x&32&&I(i,1):(i=Sw(m),i.c(),I(i,1),i.m(e,t)),m[5]?l&&(be(),P(l,1,1,()=>{l=null}),we()):l?(l.p(m,x),x&32&&I(l,1)):(l=kw(m),l.c(),I(l,1),l.m(e,r));let h=n;n=d(m,x),n===h?u[n].p(m,x):(be(),P(u[h],1,1,()=>{u[h]=null}),we(),s=u[n],s?s.p(m,x):(s=u[n]=c[n](m),s.c()),I(s,1),s.m(e,null))},i(m){a||(I(i),I(l),I(s),a=!0)},o(m){P(i),P(l),P(s),a=!1},d(m){m&&C(e),i&&i.d(),l&&l.d(),u[n].d()}}}function xE(o,e,t){let r,n,s,a,i,l,c,u,d,m,x,{backgroundSync:h}=e,{sharedFolders:v}=e,{focusedFolderGuid:w}=e,_={},A=0,U=0,L=0,R=0,{activeSync:O,activeDownloads:M}=h;me(o,O,G=>t(21,x=G)),me(o,M,G=>t(20,m=G));function E(G){t(1,_[G]=!_[G],_),t(1,_),t(6,r),t(17,v)}function F(){l?h.resume():h.pause()}let q=G=>E(G.guid),J=(G,z)=>z.key==="Enter"&&E(G.guid);return o.$$set=G=>{"backgroundSync"in G&&t(0,h=G.backgroundSync),"sharedFolders"in G&&t(17,v=G.sharedFolders),"focusedFolderGuid"in G&&t(18,w=G.focusedFolderGuid)},o.$$.update=()=>{if(o.$$.dirty&131072){e:t(6,r=v.items().sort((G,z)=>G.name.localeCompare(z.name)))}if(o.$$.dirty&66){e:r.forEach(G=>{G.guid in _||t(1,_[G.guid]=!0,_)}),t(1,_),t(6,r),t(17,v)}if(o.$$.dirty&393216){e:t(5,n=w?v.items().find(G=>G.guid===w):void 0)}if(o.$$.dirty&3145793){e:t(4,s=new Map(r.map(G=>{var z,W;return[G.guid,{progress:((z=h.getGroupProgress(G))===null||z===void 0?void 0:z.percent)||0,running:[...x.items(),...m.items()].filter(oe=>oe.sharedFolder.guid===G.guid).length,failed:((W=h.syncGroups.get(G))===null||W===void 0?void 0:W.status)==="failed"?1:0,pending:[...h.pendingSyncs,...h.pendingDownloads].filter(oe=>oe.sharedFolder.guid===G.guid).length,completed:(()=>{let oe=h.syncGroups.get(G);return((oe==null?void 0:oe.completedSyncs)||0)+((oe==null?void 0:oe.completedDownloads)||0)})(),sharedFolder:G}]})))}if(o.$$.dirty&48){e:t(12,a=n?s.get(n.guid):void 0)}if(o.$$.dirty&1){e:t(19,i=h.getQueueStatus())}if(o.$$.dirty&524288){e:t(9,l=i.isPaused)}if(o.$$.dirty&524288){e:c=i.syncsActive>0||i.downloadsActive>0}if(o.$$.dirty&16){e:{let G=0,z=0,W=0,oe=0;for(let Ie of s.values())G+=Ie.running,z+=Ie.failed,W+=Ie.pending,oe+=Ie.completed;t(2,A=G),t(7,U=z),t(3,L=W),t(8,R=oe)}}if(o.$$.dirty&4){e:t(11,u=A>0)}if(o.$$.dirty&8){e:t(10,d=L>0)}},[h,_,A,L,s,n,r,U,R,l,d,u,a,O,M,E,F,v,w,i,m,x,q,J]}var Yp=class extends Z{constructor(e){super(),ee(this,e,xE,gE,Q,{backgroundSync:0,sharedFolders:17,focusedFolderGuid:18},nE)}},Ow=Yp;var ei=class extends Uw.Modal{constructor(t,r,n,s){super(t);this.backgroundSync=r;this.sharedFolders=n;this.focusedFolderGuid=s}onOpen(){let{contentEl:t}=this;t.empty(),this.component=new Ow({target:t,props:{backgroundSync:this.backgroundSync,sharedFolders:this.sharedFolders,focusedFolderGuid:this.focusedFolderGuid,closeModal:()=>this.close()}})}onClose(){var r;let{contentEl:t}=this;t.empty(),(r=this.component)==null||r.$destroy()}};function Jp(o){return o.startsWith("v")?o.slice(1):o}function yE(o,e){return o.map((t,r)=>[t,e[r]])}function bE(o,e){try{let t=Jp(o).split(".").map(parseInt),r=Jp(e).split(".").map(parseInt);for(let[n,s]of yE(t,r))if(n>s)return!0}catch(t){}return!1}var _f=class extends Pt{constructor(t,r,n){super("UpdateManager");this.plugin=t;this.timeProvider=r;this.releaseSettings=n;this.updateCheckInterval=null;this.lastReleaseCheck=0;this.lastChannelCheck=0;this.CHECK_INTERVAL=1e3*60*60*24;this.githubReleases=new Eo("system3-relay/releases"),this.releaseChannels=new Eo("system3-relay/releaseChannels")}get releases(){return[...this.githubReleases.values()].sort((t,r)=>r.tag_name.localeCompare(t.tag_name,void 0,{numeric:!0,sensitivity:"base"}))}get beta(){return this.releaseChannels.get("beta")}get stable(){return this.releaseChannels.get("stable")}async fetchReleases(){let r=await xr("https://api.github.com/repos/No-Instructions/Relay/releases",{headers:{Accept:"application/vnd.github.v3+json","User-Agent":"Relay-Obsidian-Plugin"}});if(!r.ok)throw new Error(`GitHub API error: ${r.status}`);let n=await r.json();return this.debug("GitHub releases fetched:",n),n}async fetchLatestRelease(){try{let n="https://api.github.com/repos/No-Instructions/Relay/releases/latest";this.debug(`Fetching latest release from: ${n}`);let s=await xr(n,{headers:{"User-Agent":"Relay-Obsidian-Plugin"}});if(!s.ok)throw new Error(`GitHub API error: ${s.status}`);return await s.json()}catch(t){return this.error("Failed to fetch latest release:",t),null}}async fetchLatestTagFromChannel(t){try{let r={beta:"manifest-beta.json",stable:"manifest.json"}[t],n=r?await this.fetchRepoManifest(r):null;return n?(console.warn("repo manifest",n),n.version):null}catch(r){this.error("Failed to check for updates:",r)}return null}async getReleases(){try{let t=Date.now();if(t-this.lastReleaseCheck<5*60*1e3&&this.githubReleases.size>0)return[...this.githubReleases.values()];this.lastReleaseCheck=t,(await this.fetchReleases()).forEach(s=>{this.githubReleases.set(s.tag_name,s)});let n=await this.fetchLatestRelease();n&&(n.latest=!0,this.githubReleases.set(n.tag_name,n)),this.notifyListeners()}catch(t){this.error("Failed to fetch GitHub releases:",t)}return[...this.githubReleases.values()]}async getChannelRelease(){let t=Date.now(),r=this.releaseChannels.get(this.releaseSettings.get().channel);if(t-this.lastChannelCheck<5*60*1e3&&r)return r;this.lastReleaseCheck=t;let n=await this.getReleases();if(n.length===0)return this.debug("No releases found"),null;let s=this.releaseSettings.get().channel;if(!s)return null;let a=await this.fetchLatestTagFromChannel(s);if(!a)return null;let i=n.find(l=>Jp(l.tag_name)===a);return i?(this.releaseChannels.set(s,i),this.notifyListeners(),i):null}async update(){await this.getReleases(),await this.getChannelRelease()}start(){this.update(),this.updateCheckInterval=this.timeProvider.setInterval(()=>this.update(),this.CHECK_INTERVAL)}stop(){this.updateCheckInterval!==null&&(this.timeProvider.clearInterval(this.updateCheckInterval),this.updateCheckInterval=null)}async fetchRepoManifest(t,r="main"){try{let a=`https://raw.githubusercontent.com/No-Instructions/Relay/${r}/${t}`;this.debug(`Fetching ${a}`);let i=await xr(a);if(!i.ok)throw new Error("unable to fetch manifest");return await i.json()}catch(n){return this.error("Failed to fetch:",n),null}}async fetchReleaseManifest(t){try{let r=t.assets.find(a=>a.name==="manifest.json");if(!r)return this.debug("No manifest found in release assets"),null;this.debug("Fetching manifest from release asset:",r.browser_download_url);let n=await xr(r.browser_download_url,{headers:{Accept:"application/octet-stream","User-Agent":"Relay-Obsidian-Plugin"}});if(!n.ok)throw new Error(`Failed to fetch manifest asset: ${n.status}`);let s=await n.json();return this.debug("manifest fetched:",s),s}catch(r){return this.error("Failed to fetch manifest for release:",t,r),null}}getNewRelease(){let t=this.releaseChannels.get(this.releaseSettings.get().channel);if(t&&bE(t.tag_name,this.plugin.version))return t}async installUpdate(t){let r=await this.fetchReleaseManifest(t);try{this.debug(`Installing update from v${this.plugin.version} to v${r.version}...`,r),await this.plugin.app.plugins.installPlugin("No-Instructions/Relay",r.version,r),this.notifyListeners(),this.debug("Update complete. Reloading plugin...");let n="system3-relay",s=this.plugin.app.plugins;return await s.disablePlugin(n),await s.enablePlugin(n),!0}catch(n){return this.error("Failed to install update:",n),!1}}applyAutomaticUpdates(){if(this.releaseSettings.get().automaticUpdates){let t=this.getNewRelease();t&&this.installUpdate(t)}}destroy(){this.stop(),this.githubReleases=null,this.releaseChannels=null,super.destroy()}};var t_=require("obsidian");var Zw=require("obsidian");function wE(o){De(o,"svelte-12doke6",'.modal-content.svelte-12doke6.svelte-12doke6{padding:0;display:flex;flex-direction:column;height:100%}.settings-container.svelte-12doke6.svelte-12doke6{margin:0 1rem;border-bottom:1px solid var(--background-modifier-border);margin-bottom:1rem}.settings-spacer.svelte-12doke6.svelte-12doke6{height:0.5rem}.checkbox-container.svelte-12doke6.svelte-12doke6{cursor:pointer}.loading-text.svelte-12doke6.svelte-12doke6,.no-releases-text.svelte-12doke6.svelte-12doke6{padding:12px;text-align:center;color:var(--text-muted);font-style:italic}.release-tags-container.svelte-12doke6.svelte-12doke6{display:flex;flex-wrap:wrap;column-gap:8px;row-gap:4px;padding:0 1rem 1rem;max-height:160px;overflow-y:auto}.release-tag-item.svelte-12doke6.svelte-12doke6{display:flex;justify-content:center;align-items:center;background-color:var(--background-secondary);border:1px solid var(--background-modifier-border);border-radius:4px;padding:4px 8px;height:24px;cursor:pointer;opacity:0.7;position:relative}.release-tag-item.svelte-12doke6.svelte-12doke6:hover{background-color:var(--background-modifier-hover);opacity:0.9}.release-tag-item[aria-selected="true"].svelte-12doke6.svelte-12doke6{background-color:var(--color-accent);border-color:var(--background-modifier-border);border-bottom-width:2px;opacity:1}.release-tag-item.current-version.svelte-12doke6.svelte-12doke6{border-width:1px}.release-tag-item.development-version.svelte-12doke6.svelte-12doke6{border-width:1px}.release-tag-item.main-branch-version.svelte-12doke6.svelte-12doke6{border-width:1px}.release-tag-item.beta-version.svelte-12doke6.svelte-12doke6{font-weight:bold}.release-tag-item.stable-version.svelte-12doke6.svelte-12doke6{font-weight:bold}.prerelease-badge.svelte-12doke6.svelte-12doke6{font-size:0.7em;color:var(--text-on-accent);border-radius:4px;padding:2px 6px;margin-left:8px;vertical-align:middle;text-transform:uppercase}.channel-badge.svelte-12doke6.svelte-12doke6{font-size:0.7em;border-radius:4px;padding:2px 6px;margin-left:8px;vertical-align:middle;text-transform:uppercase}.beta-badge.svelte-12doke6.svelte-12doke6{background-color:var(--background-modifier-hover);color:var(--text-normal)}.stable-badge.svelte-12doke6.svelte-12doke6{background-color:var(--background-modifier-hover);color:var(--text-normal)}.tag-name.svelte-12doke6.svelte-12doke6{font-weight:bold;font-size:0.8em;display:flex;align-items:center}.manifest-container.svelte-12doke6.svelte-12doke6{flex:1;display:flex;flex-direction:column;border:1px solid var(--background-modifier-border);border-radius:8px;background-color:var(--background-secondary);margin:0 1rem 1rem;overflow:hidden}.manifest-header.svelte-12doke6.svelte-12doke6{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background-color:var(--background-secondary-alt);border-bottom:1px solid var(--background-modifier-border)}.manifest-header.svelte-12doke6 h3.svelte-12doke6{margin:0;font-size:1.1em;color:var(--text-normal);display:flex;align-items:center}.manifest-header-actions.svelte-12doke6.svelte-12doke6{display:flex;align-items:center;gap:10px}.manifest-close-btn.svelte-12doke6.svelte-12doke6{cursor:pointer;font-size:1.2em;background:transparent;border:none;color:var(--text-normal)}.manifest-content.svelte-12doke6.svelte-12doke6{padding:16px;border-top:1px solid var(--background-modifier-border)}.manifest-field.svelte-12doke6.svelte-12doke6{margin-bottom:8px;display:flex;align-items:flex-start}.manifest-label.svelte-12doke6.svelte-12doke6{font-weight:bold;min-width:120px;color:var(--text-normal)}.manifest-value.svelte-12doke6.svelte-12doke6{flex:1}.manifest-version-mismatch.svelte-12doke6.svelte-12doke6{margin-left:10px;color:var(--text-error);font-size:0.85em;display:flex;align-items:center;gap:4px}.manifest-version-mismatch-icon.svelte-12doke6.svelte-12doke6{font-size:1.2em}.release-changelog.svelte-12doke6.svelte-12doke6{padding:16px;overflow:hidden;display:flex;flex-direction:column;height:320px}.release-changelog-content.svelte-12doke6.svelte-12doke6{overflow-x:auto;margin:0;font-size:0.85em;flex:1;overflow-y:auto;line-height:1.4}.currently-installed.svelte-12doke6.svelte-12doke6{color:var(--interactive-accent);font-weight:bold;padding:4px 8px;border-radius:4px}.install-version-btn.svelte-12doke6.svelte-12doke6{font-size:0.9em;padding:4px 12px;cursor:pointer}.manifest-error.svelte-12doke6.svelte-12doke6{padding:16px;text-align:center;background-color:var(--background-modifier-error);border-radius:6px;color:var(--text-on-accent);margin:0 1rem 1rem}.manifest-error-message.svelte-12doke6.svelte-12doke6{margin-bottom:12px}')}function $w(o,e,t){let r=o.slice();return r[71]=e[t],r}function _E(o){let e,t;return e=new cr({props:{name:"Automatically install updates",$$slots:{default:[vE]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&128|n[2]&4096&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function vE(o){let e,t,r,n,s,a;return{c(){e=D("div"),t=D("input"),r=B(),n=D("div"),b(t,"type","checkbox"),t.checked=o[7],b(n,"class","checkbox-toggle"),b(e,"class","checkbox-container svelte-12doke6"),b(e,"role","checkbox"),b(e,"aria-checked",o[7]),b(e,"tabindex","0"),ze(e,"is-enabled",o[7])},m(i,l){T(i,e,l),k(e,t),k(e,r),k(e,n),s||(a=[re(e,"click",o[44]),re(e,"keydown",o[45])],s=!0)},p(i,l){l[0]&128&&(t.checked=i[7]),l[0]&128&&b(e,"aria-checked",i[7]),l[0]&128&&ze(e,"is-enabled",i[7])},d(i){i&&C(e),s=!1,ke(a)}}}function Bw(o){let e,t;return e=new cr({props:{name:"Show all releases",$$slots:{default:[SE]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment)},m(r,n){N(e,r,n),t=!0},p(r,n){let s={};n[0]&64|n[2]&4096&&(s.$$scope={dirty:n,ctx:r}),e.$set(s)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function SE(o){let e,t,r,n,s,a;return{c(){e=D("div"),t=D("input"),r=B(),n=D("div"),b(t,"type","checkbox"),t.checked=o[6],b(n,"class","checkbox-toggle"),b(e,"class","checkbox-container svelte-12doke6"),b(e,"role","checkbox"),b(e,"aria-checked",o[6]),b(e,"tabindex","0"),ze(e,"is-enabled",o[6])},m(i,l){T(i,e,l),k(e,t),k(e,r),k(e,n),s||(a=[re(e,"click",o[46]),re(e,"keydown",o[47])],s=!0)},p(i,l){l[0]&64&&(t.checked=i[6]),l[0]&64&&b(e,"aria-checked",i[6]),l[0]&64&&ze(e,"is-enabled",i[6])},d(i){i&&C(e),s=!1,ke(a)}}}function kE(o){let e,t,r=(!o[1]||o[7])&&Nw(o);function n(i,l){if(i[12])return DE;if(i[17])return TE}let s=n(o,[-1,-1,-1]),a=s&&s(o);return{c(){r&&r.c(),e=B(),a&&a.c(),t=Ce()},m(i,l){r&&r.m(i,l),T(i,e,l),a&&a.m(i,l),T(i,t,l)},p(i,l){!i[1]||i[7]?r?r.p(i,l):(r=Nw(i),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),s===(s=n(i,l))&&a?a.p(i,l):(a&&a.d(1),a=s&&s(i),a&&(a.c(),a.m(t.parentNode,t)))},d(i){i&&(C(e),C(t)),r&&r.d(i),a&&a.d(i)}}}function LE(o){let e;return{c(){e=D("div"),e.textContent="No matching releases found with the current filter",b(e,"class","no-releases-text svelte-12doke6")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function IE(o){let e;return{c(){e=D("div"),e.textContent="No GitHub releases found",b(e,"class","no-releases-text svelte-12doke6")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function CE(o){let e;return{c(){e=D("div"),e.textContent="Loading GitHub releases...",b(e,"class","loading-text svelte-12doke6")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function Nw(o){let e,t,r,n=!o[7]&&!o[9].some(o[43]),s,a=o[5]&&Hw(o),i=o[4]&&Vw(o),l=n&&qw(o),c=!o[7]&&!o[1]&&Ww(o);return{c(){e=D("div"),a&&a.c(),t=B(),i&&i.c(),r=B(),l&&l.c(),s=B(),c&&c.c(),b(e,"class","release-tags-container svelte-12doke6")},m(u,d){T(u,e,d),a&&a.m(e,null),k(e,t),i&&i.m(e,null),k(e,r),l&&l.m(e,null),k(e,s),c&&c.m(e,null)},p(u,d){u[5]?a?a.p(u,d):(a=Hw(u),a.c(),a.m(e,t)):a&&(a.d(1),a=null),u[4]?i?i.p(u,d):(i=Vw(u),i.c(),i.m(e,r)):i&&(i.d(1),i=null),d[0]&640&&(n=!u[7]&&!u[9].some(u[43])),n?l?l.p(u,d):(l=qw(u),l.c(),l.m(e,s)):l&&(l.d(1),l=null),!u[7]&&!u[1]?c?c.p(u,d):(c=Ww(u),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(u){u&&C(e),a&&a.d(),i&&i.d(),l&&l.d(),c&&c.d()}}}function Hw(o){let e,t,r,n,s;return{c(){e=D("div"),t=D("div"),t.textContent="Stable",b(t,"class","tag-name svelte-12doke6"),b(e,"class","release-tag-item main-branch-version stable-version svelte-12doke6"),b(e,"role","tab"),b(e,"aria-selected",r=o[10]==="stable"),b(e,"tabindex","0")},m(a,i){T(a,e,i),k(e,t),n||(s=[re(e,"click",o[48]),re(e,"keydown",o[49])],n=!0)},p(a,i){i[0]&1024&&r!==(r=a[10]==="stable")&&b(e,"aria-selected",r)},d(a){a&&C(e),n=!1,ke(s)}}}function Vw(o){let e,t,r,n,s;return{c(){e=D("div"),t=D("div"),t.textContent="Beta",b(t,"class","tag-name svelte-12doke6"),b(e,"class","release-tag-item main-branch-version beta-version svelte-12doke6"),b(e,"role","tab"),b(e,"aria-selected",r=o[10]==="beta"),b(e,"tabindex","0")},m(a,i){T(a,e,i),k(e,t),n||(s=[re(e,"click",o[50]),re(e,"keydown",o[51])],n=!0)},p(a,i){i[0]&1024&&r!==(r=a[10]==="beta")&&b(e,"aria-selected",r)},d(a){a&&C(e),n=!1,ke(s)}}}function qw(o){let e,t,r,n,s;return{c(){e=D("div"),t=D("div"),t.textContent="Dev",b(t,"class","tag-name svelte-12doke6"),b(e,"class","release-tag-item development-version svelte-12doke6"),b(e,"role","tab"),b(e,"aria-selected",r=o[11]===o[0].version),b(e,"tabindex","0")},m(a,i){T(a,e,i),k(e,t),n||(s=[re(e,"click",o[52]),re(e,"keydown",o[53])],n=!0)},p(a,i){i[0]&2049&&r!==(r=a[11]===a[0].version)&&b(e,"aria-selected",r)},d(a){a&&C(e),n=!1,ke(s)}}}function Ww(o){let e,t=Re(o[9]),r=[];for(let n=0;n<t.length;n+=1)r[n]=zw($w(o,t,n));return{c(){for(let n=0;n<r.length;n+=1)r[n].c();e=Ce()},m(n,s){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(n,s);T(n,e,s)},p(n,s){if(s[0]&536873472|s[1]&130){t=Re(n[9]);let a;for(a=0;a<t.length;a+=1){let i=$w(n,t,a);r[a]?r[a].p(i,s):(r[a]=zw(i),r[a].c(),r[a].m(e.parentNode,e))}for(;a<r.length;a+=1)r[a].d(1);r.length=t.length}},d(n){n&&C(e),it(r,n)}}}function zw(o){let e,t,r=o[71].tag_name+"",n,s,a,i,l,c;function u(){return o[54](o[71])}function d(...m){return o[55](o[71],...m)}return{c(){e=D("div"),t=D("div"),n=K(r),s=B(),b(t,"class","tag-name svelte-12doke6"),b(e,"class",a="release-tag-item "+(o[29](o[71].tag_name)?"current-version":"")+" "+(Qw(o[71])?"pre-release":"")+" svelte-12doke6"),b(e,"role","tab"),b(e,"aria-selected",i=o[11]===o[71].tag_name),b(e,"tabindex","0")},m(m,x){T(m,e,x),k(e,t),k(t,n),k(e,s),l||(c=[re(e,"click",u),re(e,"keydown",d)],l=!0)},p(m,x){o=m,x[0]&512&&r!==(r=o[71].tag_name+"")&&se(n,r),x[0]&512&&a!==(a="release-tag-item "+(o[29](o[71].tag_name)?"current-version":"")+" "+(Qw(o[71])?"pre-release":"")+" svelte-12doke6")&&b(e,"class",a),x[0]&2560&&i!==(i=o[11]===o[71].tag_name)&&b(e,"aria-selected",i)},d(m){m&&C(e),l=!1,ke(c)}}}function TE(o){let e,t,r,n,s,a,i;return{c(){e=D("div"),t=D("div"),r=K(o[17]),n=B(),s=D("button"),s.textContent="Close",b(t,"class","manifest-error-message svelte-12doke6"),b(s,"class","manifest-close-btn svelte-12doke6"),b(e,"class","manifest-error svelte-12doke6")},m(l,c){T(l,e,c),k(e,t),k(t,r),k(e,n),k(e,s),a||(i=re(s,"click",o[40]),a=!0)},p(l,c){c[0]&131072&&se(r,l[17])},d(l){l&&C(e),a=!1,i()}}}function DE(o){var G;let e,t,r,n,s,a,i=(G=o[41](o[11]))==null?void 0:G.prerelease,l,c,u,d,m,x,h,v,w,_,A=i&&Kw(o),U=o[13][o[11]]==="beta-alias"&&Gw(o),L=o[13][o[11]]==="stable-alias"&&jw(o);function R(z,W){if(W[0]&18432&&(m=null),W[0]&2048&&(x=null),m==null&&(m=!!((z[41](z[11])||z[14][z[11]]==="stable-alias"||z[14][z[11]]==="beta-alias")&&!z[29](z[11]))),m)return AE;if(x==null&&(x=!!z[29](z[11])),x)return PE}let O=R(o,[-1,-1,-1]),M=O&&O(o);function E(z,W){return z[14][z[11]]==="stable-alias"||z[14][z[11]]==="beta-alias"||z[10]==="development"?OE:z[11]?FE:RE}let F=E(o,[-1,-1,-1]),q=F(o),J=o[16]&&Yw(o);return{c(){e=D("div"),t=D("div"),r=D("h3"),n=K("Release Details: "),s=K(o[11]),a=B(),A&&A.c(),l=B(),U&&U.c(),c=B(),L&&L.c(),u=B(),d=D("div"),M&&M.c(),h=B(),v=D("div"),w=D("div"),q.c(),_=B(),J&&J.c(),b(r,"class","svelte-12doke6"),b(d,"class","manifest-header-actions svelte-12doke6"),b(t,"class","manifest-header svelte-12doke6"),b(w,"class","release-changelog-content svelte-12doke6"),b(v,"class","release-changelog svelte-12doke6"),b(e,"class","manifest-container svelte-12doke6")},m(z,W){T(z,e,W),k(e,t),k(t,r),k(r,n),k(r,s),k(r,a),A&&A.m(r,null),k(r,l),U&&U.m(r,null),k(r,c),L&&L.m(r,null),k(t,u),k(t,d),M&&M.m(d,null),k(e,h),k(e,v),k(v,w),q.m(w,null),k(e,_),J&&J.m(e,null)},p(z,W){var oe;W[0]&2048&&se(s,z[11]),W[0]&2048&&(i=(oe=z[41](z[11]))==null?void 0:oe.prerelease),i?A||(A=Kw(z),A.c(),A.m(r,l)):A&&(A.d(1),A=null),z[13][z[11]]==="beta-alias"?U||(U=Gw(z),U.c(),U.m(r,c)):U&&(U.d(1),U=null),z[13][z[11]]==="stable-alias"?L||(L=jw(z),L.c(),L.m(r,null)):L&&(L.d(1),L=null),O===(O=R(z,W))&&M?M.p(z,W):(M&&M.d(1),M=O&&O(z),M&&(M.c(),M.m(d,null))),F===(F=E(z,W))&&q?q.p(z,W):(q.d(1),q=F(z),q&&(q.c(),q.m(w,null))),z[16]?J?J.p(z,W):(J=Yw(z),J.c(),J.m(e,null)):J&&(J.d(1),J=null)},d(z){z&&C(e),A&&A.d(),U&&U.d(),L&&L.d(),M&&M.d(),q.d(),J&&J.d()}}}function Kw(o){let e;return{c(){e=D("span"),e.textContent="Pre-release",b(e,"class","prerelease-badge svelte-12doke6")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function Gw(o){let e;return{c(){e=D("span"),e.textContent="Beta",b(e,"class","channel-badge beta-badge svelte-12doke6")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function jw(o){let e;return{c(){e=D("span"),e.textContent="Stable",b(e,"class","channel-badge stable-badge svelte-12doke6")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function PE(o){let e;return{c(){e=D("span"),e.textContent="Installed",b(e,"class","currently-installed svelte-12doke6")},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function AE(o){let e,t,r,n;function s(l,c){return l[15]===l[11]?ME:EE}let a=s(o,[-1,-1,-1]),i=a(o);return{c(){e=D("button"),i.c(),b(e,"class","install-version-btn mod-cta svelte-12doke6"),e.disabled=t=o[15]===o[11]||o[2]},m(l,c){T(l,e,c),i.m(e,null),r||(n=re(e,"click",o[56]),r=!0)},p(l,c){a!==(a=s(l,c))&&(i.d(1),i=a(l),i&&(i.c(),i.m(e,null))),c[0]&34820&&t!==(t=l[15]===l[11]||l[2])&&(e.disabled=t)},d(l){l&&C(e),i.d(),r=!1,n()}}}function EE(o){let e;return{c(){e=K("Install")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function ME(o){let e;return{c(){e=K("Installing...")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function RE(o){let e;return{c(){e=K('"No changelog available"')},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function FE(o){var n;let e,t,r={ctx:o,current:null,token:null,hasCatch:!1,pending:BE,then:$E,catch:UE,value:70};return Fs(t=o[37](((n=o[41](o[11]))==null?void 0:n.body)||"No changelog available"),r),{c(){e=Ce(),r.block.c()},m(s,a){T(s,e,a),r.block.m(s,r.anchor=a),r.mount=()=>e.parentNode,r.anchor=e},p(s,a){var i;o=s,r.ctx=o,a[0]&2048&&t!==(t=o[37](((i=o[41](o[11]))==null?void 0:i.body)||"No changelog available"))&&Fs(t,r)||wl(r,o,a)},d(s){s&&C(e),r.block.d(s),r.token=null,r=null}}}function OE(o){let e;function t(s,a){if(s[14][s[11]]==="stable-alias")return VE;if(s[14][s[11]]==="beta-alias")return HE;if(s[11]===s[0].version)return NE}let r=t(o,[-1,-1,-1]),n=r&&r(o);return{c(){n&&n.c(),e=Ce()},m(s,a){n&&n.m(s,a),T(s,e,a)},p(s,a){r!==(r=t(s,a))&&(n&&n.d(1),n=r&&r(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&C(e),n&&n.d(s)}}}function UE(o){return{c:X,m:X,p:X,d:X}}function $E(o){let e,t=o[70]+"",r;return{c(){e=new As(!1),r=Ce(),e.a=r},m(n,s){e.m(t,n,s),T(n,r,s)},p(n,s){s[0]&2048&&t!==(t=n[70]+"")&&e.p(t)},d(n){n&&(C(r),e.d())}}}function BE(o){let e;return{c(){e=K('"loading..."')},m(t,r){T(t,e,r)},p:X,d(t){t&&C(e)}}}function NE(o){let e;return{c(){e=D("p"),e.textContent="Current development version"},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function HE(o){let e;return{c(){e=D("p"),e.textContent="Current beta release from main branch manifest-beta.json"},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function VE(o){let e;return{c(){e=D("p"),e.textContent="Current stable release from main branch manifest.json"},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function Yw(o){let e,t,r,n,s,a=o[12].version+"",i,l,c=o[11]!==o[12].version&&!o[11].startsWith("v"+o[12].version),u,d,m,x,h,v=o[12].name+"",w,_,A,U,L,R,O=o[12].author+"",M,E,F,q,J,G,z=o[12].description+"",W,oe,Ie,Pe,Ee,Ye,Fe=o[12].isDesktopOnly?"Yes":"No",de,fe,te,$e,Lt,Mt,Rt=o[12].minAppVersion+"",ht,gt=c&&Jw(o);return{c(){e=D("div"),t=D("div"),r=D("span"),r.textContent="Version:",n=B(),s=D("span"),i=K(a),l=B(),gt&&gt.c(),u=B(),d=D("div"),m=D("span"),m.textContent="Name:",x=B(),h=D("span"),w=K(v),_=B(),A=D("div"),U=D("span"),U.textContent="Author:",L=B(),R=D("span"),M=K(O),E=B(),F=D("div"),q=D("span"),q.textContent="Description:",J=B(),G=D("span"),W=K(z),oe=B(),Ie=D("div"),Pe=D("span"),Pe.textContent="isDesktopOnly:",Ee=B(),Ye=D("span"),de=K(Fe),fe=B(),te=D("div"),$e=D("span"),$e.textContent="minAppVersion:",Lt=B(),Mt=D("span"),ht=K(Rt),b(r,"class","manifest-label svelte-12doke6"),b(s,"class","manifest-value svelte-12doke6"),b(t,"class","manifest-field svelte-12doke6"),b(m,"class","manifest-label svelte-12doke6"),b(h,"class","manifest-value svelte-12doke6"),b(d,"class","manifest-field svelte-12doke6"),b(U,"class","manifest-label svelte-12doke6"),b(R,"class","manifest-value svelte-12doke6"),b(A,"class","manifest-field svelte-12doke6"),b(q,"class","manifest-label svelte-12doke6"),b(G,"class","manifest-value svelte-12doke6"),b(F,"class","manifest-field svelte-12doke6"),b(Pe,"class","manifest-label svelte-12doke6"),b(Ye,"class","manifest-value svelte-12doke6"),b(Ie,"class","manifest-field svelte-12doke6"),b($e,"class","manifest-label svelte-12doke6"),b(Mt,"class","manifest-value svelte-12doke6"),b(te,"class","manifest-field svelte-12doke6"),b(e,"class","manifest-content svelte-12doke6")},m(dt,qt){T(dt,e,qt),k(e,t),k(t,r),k(t,n),k(t,s),k(s,i),k(t,l),gt&&gt.m(t,null),k(e,u),k(e,d),k(d,m),k(d,x),k(d,h),k(h,w),k(e,_),k(e,A),k(A,U),k(A,L),k(A,R),k(R,M),k(e,E),k(e,F),k(F,q),k(F,J),k(F,G),k(G,W),k(e,oe),k(e,Ie),k(Ie,Pe),k(Ie,Ee),k(Ie,Ye),k(Ye,de),k(e,fe),k(e,te),k(te,$e),k(te,Lt),k(te,Mt),k(Mt,ht)},p(dt,qt){qt[0]&4096&&a!==(a=dt[12].version+"")&&se(i,a),qt[0]&6144&&(c=dt[11]!==dt[12].version&&!dt[11].startsWith("v"+dt[12].version)),c?gt||(gt=Jw(dt),gt.c(),gt.m(t,null)):gt&&(gt.d(1),gt=null),qt[0]&4096&&v!==(v=dt[12].name+"")&&se(w,v),qt[0]&4096&&O!==(O=dt[12].author+"")&&se(M,O),qt[0]&4096&&z!==(z=dt[12].description+"")&&se(W,z),qt[0]&4096&&Fe!==(Fe=dt[12].isDesktopOnly?"Yes":"No")&&se(de,Fe),qt[0]&4096&&Rt!==(Rt=dt[12].minAppVersion+"")&&se(ht,Rt)},d(dt){dt&&C(e),gt&&gt.d()}}}function Jw(o){let e;return{c(){e=D("span"),e.innerHTML=`<span class="manifest-version-mismatch-icon svelte-12doke6">\u26A0\uFE0F</span>
									Version mismatch`,b(e,"class","manifest-version-mismatch svelte-12doke6")},m(t,r){T(t,e,r)},d(t){t&&C(e)}}}function qE(o){let e,t=o[1]?"Relay installer":"Relay releases",r,n,s,a,i,l,c=Xt().enableAutomaticUpdatesOption,u,d,m,x=c&&_E(o),h=!o[7]&&!o[1]&&Bw(o);function v(A,U){return A[8]?CE:A[3].length===0?IE:A[9].length===0?LE:kE}let w=v(o,[-1,-1,-1]),_=w(o);return{c(){e=D("div"),r=K(t),n=B(),s=D("div"),a=D("div"),i=B(),l=D("div"),x&&x.c(),u=B(),h&&h.c(),d=B(),_.c(),b(e,"class","modal-title"),b(a,"class","settings-spacer svelte-12doke6"),b(l,"class","settings-container svelte-12doke6"),b(s,"class","modal-content svelte-12doke6")},m(A,U){T(A,e,U),k(e,r),T(A,n,U),T(A,s,U),k(s,a),k(s,i),k(s,l),x&&x.m(l,null),k(l,u),h&&h.m(l,null),k(s,d),_.m(s,null),m=!0},p(A,U){(!m||U[0]&2)&&t!==(t=A[1]?"Relay installer":"Relay releases")&&se(r,t),c&&x.p(A,U),!A[7]&&!A[1]?h?(h.p(A,U),U[0]&130&&I(h,1)):(h=Bw(A),h.c(),I(h,1),h.m(l,null)):h&&(be(),P(h,1,1,()=>{h=null}),we()),w===(w=v(A,U))&&_?_.p(A,U):(_.d(1),_=w(A),_&&(_.c(),_.m(s,null)))},i(A){m||(I(x),I(h),m=!0)},o(A){P(x),P(h),m=!1},d(A){A&&(C(e),C(n),C(s)),x&&x.d(),h&&h.d(),_.d()}}}var Xw="system3-relay";function Bn(o){return o.startsWith("v")?o.substring(1):o}function Qw(o){return(o==null?void 0:o.prerelease)===!0}function WE(o,e,t){let r,n,s,a,i,l,c,u,d,m,x,h,v,w,_,A,U,{plugin:L}=e,{version:R}=e,O=_e(L.manifest.version),M=_e(!1),E=_e(""),F=_e(""),q=_e(!1);me(o,q,Y=>t(8,u=Y));let J=_e(!1);me(o,J,Y=>t(6,l=Y));let G=_e(null);me(o,G,Y=>t(12,h=Y));let z=_e("");me(o,z,Y=>t(11,x=Y));let W=_e(null),oe=_e(null);me(o,oe,Y=>t(17,U=Y));let Ie=_e(!1);me(o,Ie,Y=>t(16,A=Y));let Pe=_e(null);me(o,Pe,Y=>t(5,s=Y));let Ee=_e(null);me(o,Ee,Y=>t(4,n=Y));let Ye=_e(null);me(o,Ye,Y=>t(58,i=Y));let Fe=_e(null);me(o,Fe,Y=>t(57,a=Y));let de=_e(!1),fe=!1,te=_e(null);me(o,te,Y=>t(15,_=Y));let $e=L.app;function Lt(Y){let ce=Bn(Y),st=Bn(L.version);return ce===st}let Mt=_e({});me(o,Mt,Y=>t(14,w=Y));let Rt=_e({});me(o,Rt,Y=>t(13,v=Y));let ht=_e(L.releaseSettings.get().channel);me(o,ht,Y=>t(10,m=Y));let gt=_e(!1);me(o,gt,Y=>t(7,c=Y));function dt(Y){return Ge(this,void 0,void 0,function*(){gt.set(Y);let ce=L.releaseSettings.get().channel;ht.set(ce),L.releaseSettings.update(st=>Object.assign(Object.assign({},st),{automaticUpdates:Y})),ot(ce)})}er(()=>{js(),qt(),!R&&!r.some(Y=>{Y.tag_name,L.version})?(L.releaseSettings.update(Y=>Object.assign(Object.assign({},Y),{automaticUpdates:!1})),ht.set(null)):ht.set(L.releaseSettings.get().channel),G.set({version:R||L.version,name:L.manifest.name,author:L.manifest.author,description:L.manifest.description,isDesktopOnly:L.manifest.isDesktopOnly,minAppVersion:L.manifest.minAppVersion}),z.set(R||L.version)});function qt(){return Ge(this,void 0,void 0,function*(){de.set(!0);try{let Y=yield L.updateManager.fetchRepoManifest("manifest.json");Y&&(Pe.set(Y),Ye.set(Y.version));let ce=yield L.updateManager.fetchRepoManifest("manifest-beta.json");ce&&(Ee.set(ce),Fe.set(ce.version))}catch(Y){L.error("Error fetching main branch manifests:",Y)}finally{de.set(!1)}})}let un=lo(L.updateManager,()=>L.updateManager.releases);me(o,un,Y=>t(3,r=Y));let Nn=lo([un,J],()=>r&&r.length>0?Hn(l).sort():[]);me(o,Nn,Y=>t(9,d=Y)),r.forEach(Y=>Ge(void 0,void 0,void 0,function*(){try{let ce=yield L.updateManager.fetchReleaseManifest(Y);ce&&Mt.update(st=>Object.assign(Object.assign({},st),{[Y.tag_name]:ce.version}))}catch(ce){}}));function js(){return Ge(this,void 0,void 0,function*(){q.set(!0);try{yield L.updateManager.getReleases(),Hn(l)}catch(Y){L.error("Error refreshing GitHub releases:",Y)}finally{q.set(!1)}})}function Ys(Y){return Ge(this,void 0,void 0,function*(){let ce=document.createElement("div");return yield Zw.MarkdownRenderer.render(L.app,Y,ce,"",L),ce.innerHTML})}function Hn(Y){return Y?r:R?r.filter(ce=>R===Bn(ce.tag_name)):r.filter(ce=>{let st=ce.tag_name;return Js(ce)})}function Js(Y){if(Y.prerelease||Y.draft)return!1;if(Y.latest||Bn(Y.tag_name)===i||Bn(Y.tag_name)===a)return!0;let ce=new Date(Y.created_at),st=new Date;return st.setMonth(st.getMonth()-3),ce>st}function _r(Y){return Ge(this,void 0,void 0,function*(){oe.set(null),W.set(Y);try{let ce=po(Y);if(!ce){oe.set(`Could not find release for ${Y}`);return}let st=yield L.updateManager.fetchReleaseManifest(ce);st?(G.set(st),z.set(Y),Ie.set(!1),Mt.update(mo=>Object.assign(Object.assign({},mo),{[Y]:st.version}))):oe.set(`Could not find manifest for ${Y}`)}catch(ce){L.error("Error fetching manifest:",ce),oe.set(`Error fetching manifest: ${ce.message||"Unknown error"}`)}finally{W.set(null)}})}function ot(Y){let ce=Y==="stable"?s:n;if(ce){let st=ce.version;ht.set(Y);let mo=[...r.values()].find(nr=>Bn(nr.tag_name)===Bn(st));mo?(Y==="stable"?Rt.update(nr=>Object.assign(Object.assign({},nr),{[mo.tag_name]:"stable-alias"})):Rt.update(nr=>Object.assign(Object.assign({},nr),{[mo.tag_name]:"beta-alias"})),_r(mo.tag_name)):(G.set(ce),z.set(st),Y==="stable"?Rt.update(nr=>Object.assign(Object.assign({},nr),{[st]:"stable-alias"})):Rt.update(nr=>Object.assign(Object.assign({},nr),{[st]:"beta-alias"})),Ie.set(!1))}else oe.set(`Could not find ${Y} manifest`)}function Nt(){G.set(null),z.set(""),oe.set(null)}function po(Y){return[...r.values()].find(ce=>ce.tag_name===Y)}function dn(Y){return Ge(this,void 0,void 0,function*(){try{te.set(Y);let ce=po(Y);if(!ce)throw new Error(`Could not find release for ${Y}`);let st=yield L.updateManager.fetchReleaseManifest(ce);if(!st)throw new Error(`Could not find manifest for ${Y}`);t(2,fe=!0),yield $e.plugins.installPlugin(L.repo,Y,st),yield $e.plugins.disablePlugin(Xw),yield $e.plugins.enablePlugin(Xw)}catch(ce){console.error(`Error installing version ${Y}:`,ce),L&&L.error(`Error installing version ${Y}:`,ce)}finally{L&&(t(2,fe=!1),te.set(null))}})}let ne=Y=>Lt(Y.tag_name),We=()=>{dt(!c)},nt=Y=>{(Y.key==="Enter"||Y.key===" ")&&dt(!c)},tt=()=>{J.update(Y=>!Y)},Ae=Y=>{(Y.key==="Enter"||Y.key===" ")&&J.update(ce=>!ce)},jr=()=>{L.releaseSettings.update(Y=>({...Y,channel:"stable"})),ht.set("stable"),ot("stable")},Yr=Y=>{(Y.key==="Enter"||Y.key===" ")&&(L.releaseSettings.update(ce=>({...ce,channel:"stable"})),ht.set("stable"),ot("stable"))},ri=()=>{L.releaseSettings.update(Y=>({...Y,channel:"beta"})),ht.set("beta"),ot("beta")},Sf=Y=>{(Y.key==="Enter"||Y.key===" ")&&(L.releaseSettings.update(ce=>({...ce,channel:"beta"})),ht.set("beta"),ot("beta"))},kf=()=>{ht.set(null),G.set({version:L.manifest.version,name:L.manifest.name,author:L.manifest.author,description:L.manifest.description,isDesktopOnly:L.manifest.isDesktopOnly,minAppVersion:L.manifest.minAppVersion}),z.set(L.version),Ie.set(!1)},oi=Y=>{(Y.key==="Enter"||Y.key===" ")&&(ht.set(null),G.set({version:L.manifest.version,name:L.manifest.name,author:L.manifest.author,description:L.manifest.description,isDesktopOnly:L.manifest.isDesktopOnly,minAppVersion:L.manifest.minAppVersion}),z.set(L.version),Ie.set(!1))},Wt=Y=>{ht.set(null),_r(Y.tag_name)},ni=(Y,ce)=>{(ce.key==="Enter"||ce.key===" ")&&(ht.set(null),_r(Y.tag_name))},Xs=async()=>{dn(x)};return o.$$set=Y=>{"plugin"in Y&&t(0,L=Y.plugin),"version"in Y&&t(1,R=Y.version)},[L,R,fe,r,n,s,l,c,u,d,m,x,h,v,w,_,A,U,q,J,G,z,oe,Ie,Pe,Ee,Ye,Fe,te,Lt,Mt,Rt,ht,gt,dt,un,Nn,Ys,_r,ot,Nt,po,dn,ne,We,nt,tt,Ae,jr,Yr,ri,Sf,kf,oi,Wt,ni,Xs]}var Xp=class extends Z{constructor(e){super(),ee(this,e,WE,qE,Q,{plugin:0,version:1},wE,[-1,-1,-1])}},e_=Xp;var ti=class extends t_.Modal{constructor(t,r,n){super(t);this.plugin=r;this.version=n}onOpen(){let{contentEl:t}=this;this.component=new e_({target:t,props:{plugin:this.plugin,version:this.version}})}onClose(){var r;let{contentEl:t}=this;t.empty(),(r=this.component)==null||r.$destroy()}};var zE={debugging:!1},KE={release:{channel:"stable",automaticUpdates:!1},sharedFolders:[],...ul,...zE},vf=class extends n_.Plugin{constructor(){super(...arguments);this.webviewerPatched=!1;this.openModals=[];this.interceptedUrls=[];this.fileDiffMergeWarningKey="file-diff-merge-warning";this.version="0.4.8";this.repo="No-Instructions/Relay"}enableDebugging(t){fl(!0),console.warn("RelayInstances",Dt),t&&this.debugSettings.update(r=>({...r,debugging:!0}))}disableDebugging(t){fl(!1),t&&this.debugSettings.update(r=>({...r,debugging:!1}))}toggleDebugging(t){let r=!this.debugSettings.get().debugging;return fl(r),t&&this.debugSettings.update(n=>({...n,debugging:r})),r}buildApiUrl(t){return"https://api.system3.md"+t}async onload(){this.appId=this.app.appId;let t=Et.moment.now();Dt.set(this,"plugin"),this.timeProvider=new Cs,this.register(()=>{this.timeProvider.destroy()}),Zg(new yf(this.app.vault),this.timeProvider,".obsidian/plugins/system3-relay/relay.log",{maxFileSize:5*1024*1024,maxBackups:3,disableConsole:!1}),this.notifier=new xf,this.toast=rx(this.notifier),this.debug=Le("[System 3][Relay]","debug"),this.log=Le("[System 3][Relay]","log"),this.warn=Le("[System 3][Relay]","warn"),this.error=Le("[System 3][Relay]","error"),this.settings=new gf(this,KE),await this.settings.load(),this.featureSettings=new Gr(this.settings,"(enable*)"),this.debugSettings=new Gr(this.settings,"(debugging)"),this.folderSettings=new Gr(this.settings,"sharedFolders"),this.releaseSettings=new Gr(this.settings,"release"),Vt.getInstance().setSettings(this.featureSettings),this.settingsTab=new zl(this.app,this),this.addRibbonIcon("satellite","Relay",()=>{this.openSettings()}),this.updateManager=new _f(this,this.timeProvider,this.releaseSettings),Xt().enableAutomaticUpdatesOption&&this.updateManager.applyAutomaticUpdates(),this.debugSettings.subscribe(s=>{s.debugging?(this.enableDebugging(),this.removeCommand("enable-debugging"),this.addCommand({id:"toggle-feature-flags",name:"Show feature flags",callback:()=>{let a=new mf(this.app,()=>{this.reload()});this.openModals.push(a),a.open()}}),this.addCommand({id:"send-bug-report",name:"Send bug report",callback:()=>{let a=new bf(this.app,this);this.openModals.push(a),a.open()}}),this.addCommand({id:"show-debug-info",name:"Show debug info",callback:()=>{let a=new hf(this.app,this);this.openModals.push(a),a.open()}}),this.addCommand({id:"show-release-manager",name:"Show releases",callback:()=>{let a=new ti(this.app,this);this.openModals.push(a),a.open()}}),this.addCommand({id:"analyze-indexeddb",name:"Analyze database",callback:()=>{let a=new wf(this.app,this);this.openModals.push(a),a.open()}}),this.addCommand({id:"disable-debugging",name:"Disable debugging",callback:()=>{this.disableDebugging(!0)}}),this.addCommand({id:"show-sync-status",name:"Sync status",callback:()=>{let a=new ei(this.app,this.backgroundSync,this.sharedFolders);this.openModals.push(a),a.open()}})):(this.removeCommand("toggle-feature-flags"),this.removeCommand("send-bug-report"),this.removeCommand("show-debug-info"),this.removeCommand("show-sync-status"),this.removeCommand("show-release-manager"),this.removeCommand("disable-debugging"),this.addCommand({id:"enable-debugging",name:"Enable debugging",callback:()=>{this.enableDebugging(!0)}}))}),this.addCommand({id:"reload",name:"Reload Relay",callback:()=>{this.reload()}}),this.updateManager.subscribe(()=>{let s=this.updateManager.getNewRelease();s?(this.removeCommand("update-plugin"),this.addCommand({id:"update-plugin",name:`Update Plugin (${this.version} \u2192 ${s.tag_name})`,callback:async()=>{await this.updateManager.installUpdate(s)}}),this.log(`Update available: v${this.version} \u2192 ${s.tag_name}`)):this.removeCommand("update-plugin")}),this.vault=this.app.vault;let n=this.vault.getName();this.fileManager=this.app.fileManager,this.loginManager=new Xl(this.vault.getName(),this.openSettings.bind(this),this.timeProvider,this.patchWebviewer.bind(this)),this.relayManager=new pf(this.loginManager),this.sharedFolders=new hl(this.relayManager,this.vault,this._createSharedFolder.bind(this),this.folderSettings),this.tokenStore=new cf(this.loginManager,this.timeProvider,n,3),this.networkStatus=new Cb(this.timeProvider,"https://api.system3.md/health?version=0.4.8"),this.backgroundSync=new Cl(this.loginManager,this.timeProvider,this.sharedFolders),this.loginManager.setup()||new Et.Notice("Please sign in to use relay"),this.app.workspace.onLayoutReady(()=>{this.sharedFolders.load(),this._liveViews=new Pl(this.app,this.sharedFolders,this.loginManager,this.networkStatus),this.registerEditorExtension(this._liveViews.extensions),this.register(this.loginManager.on(()=>{this.loginManager.loggedIn?this._onLogin():this._onLogout()})),this.tokenStore.start(),r_.Platform.isIosApp||(this.networkStatus.addEventListener("offline",()=>{this.tokenStore.stop(),this.sharedFolders.forEach(s=>s.disconnect()),this._liveViews.goOffline()}),this.networkStatus.addEventListener("online",()=>{this.tokenStore.start(),this.relayManager.subscribe(),this.relayManager.update(),this._liveViews.goOnline()}),this.networkStatus.start()),this.registerView(Bs,s=>new Dl(s)),this.registerEvent(this.app.workspace.on("file-menu",(s,a)=>{if(a instanceof Et.TFolder){let i=this.sharedFolders.find(l=>l.path===a.path);if(!i)return;i.relayId&&s.addItem(l=>{l.setTitle(i.connected?"Disconnect":"Connect").setIcon("satellite").onClick(()=>{i.connected?(i.shouldConnect=!1,i.disconnect()):(i.shouldConnect=!0,i.connect()),this._liveViews.refresh("folder connection toggle")})}),s.addItem(l=>{l.setTitle("Folder settings").setIcon("gear").onClick(()=>{this.openSettings(`/shared-folders?id=${i.guid}&relay=${i.relayId}`)})}),i.relayId&&Xt().enableSyncModal&&s.addItem(l=>{l.setTitle("Sync Status").setIcon("list-checks").onClick(()=>{let c=new ei(this.app,this.backgroundSync,this.sharedFolders,i.guid);this.openModals.push(c),c.open()})}),Xt().enableSyncMenu&&i.relayId&&i.connected&&s.addItem(l=>{l.setTitle("Sync").setIcon("folder-sync").onClick(()=>{i.netSync()})})}})),this.setup(),this._liveViews.refresh("init"),this.loadTime=Et.moment.now()-t})}async reload(){let t=this.manifest.id,r=this.app.plugins;await r.disablePlugin(t),await r.enablePlugin(t)}_createSharedFolder(t,r,n,s){let a=new Gr(this.settings,`sharedFolders/[guid=${r}]`);return a.flush(),new ml(this.appId,r,t,this.loginManager,this.vault,this.fileManager,this.tokenStore,this.relayManager,this.backgroundSync,a,n,s)}_onLogout(){var t,r;(t=this.tokenStore)==null||t.clear(),(r=this.relayManager)==null||r.logout(),this._liveViews.refresh("logout")}_onLogin(){var t;this.sharedFolders.load(),(t=this.relayManager)==null||t.login(),this._liveViews.refresh("login")}async openSettings(t="/"){let r=this.app.setting;await r.open(),await r.openTabById("system3-relay"),this.settingsTab.navigateTo(t)}patchWebviewer(){var r,n,s;let t=this;try{if(this.webviewerPatched)return;let a=(n=(r=this.app.internalPlugins)==null?void 0:r.plugins)==null?void 0:n.webviewer;if(!((s=a==null?void 0:a.instance)!=null&&s.options)||!a.enabled){this.warn("Webviewer plugin not found or not initialized");return}let i=a.instance.options,l=Object.getOwnPropertyDescriptor(i,"openExternalURLs");if(!l){this.warn("Could not find openExternalURLs property");return}Object.defineProperty(i,"openExternalURLs",{get(){var m;let d=window.event;if((d==null?void 0:d.type)==="open-url"&&((m=d==null?void 0:d.detail)!=null&&m.url)){let x=d.detail.url;for(let h of t.interceptedUrls)if(typeof h=="string"&&x.startsWith(h)||h instanceof RegExp&&h.test(x))return t.log("Intercepted webviewer, opening in default browser",d.detail.url),!1}return l.value},set(d){l.value=d},configurable:!0}),this.register(()=>{Object.defineProperty(i,"openExternalURLs",l)});let c=this.loginManager.webviewIntercept();this.debug("Intercepting Webviewer for URL pattern",c.source),this.interceptedUrls.push(c);let u=new RegExp("https://api.system3.md".replace("/","\\/")+".*");this.debug("Intercepting Webviewer for URL pattern",u.source),this.interceptedUrls.push(u),this.webviewerPatched=!0,this.debug("patched webviewer options")}catch(a){this.error("Failed to patch webviewer:",a)}}setup(){this.folderNavDecorations=new Rl(this.vault,this.app.workspace,this.sharedFolders,this.backgroundSync),this.folderNavDecorations.refresh(),this.addSettingTab(this.settingsTab);let t=Le("[Live][Workspace]","log");this.registerEvent(this.app.workspace.on("file-open",c=>{t("file-open"),i._liveViews.refresh("file-open")})),this.registerEvent(this.app.workspace.on("layout-change",()=>{t("layout-change"),this._liveViews.refresh("layout-change")}));let r=Le("[System 3][Relay][Vault]","log"),n=c=>{let u=c.error;u&&u instanceof $n&&this.toast(u)};window.addEventListener("error",n,!0),this.register(()=>window.removeEventListener("error",n,!0));let s=c=>{c.reason instanceof $n&&this.toast(c.reason)},a=c=>s(c);window.addEventListener("unhandledrejection",a,!0),this.register(()=>window.removeEventListener("unhandledrejection",a,!0)),this.registerEvent(this.app.vault.on("create",c=>{if(c instanceof Et.TFolder)return;let u=this.sharedFolders.lookup(c.path);if(u){let d=u.getVirtualPath(c.path);if(!ct.checkExtension(d))return;u.placeHold([d]).length>0?u.uploadDoc(d):u.whenReady().then(x=>{x.proxy.getDoc(c.path)})}})),this.registerEvent(this.app.vault.on("delete",c=>{if(c instanceof Et.TFolder){let d=this.sharedFolders.find(m=>m.path===c.path);d&&this.sharedFolders.delete(d);return}let u=this.sharedFolders.lookup(c.path);u&&(r("Delete",c.path),u.whenReady().then(d=>{d.proxy.deleteDoc(c.path)}))})),this.registerEvent(this.app.vault.on("rename",(c,u)=>{if(c instanceof Et.TFolder){let h=this.sharedFolders.find(v=>v.path==u);h&&(h.move(c.path),this.sharedFolders.update());return}let d=this.sharedFolders.lookup(u),m=this.sharedFolders.lookup(c.path),x=d||m;d&&m?(r("Rename",c.path,u),d.renameFile(c.path,u),m.renameFile(c.path,u),this._liveViews.refresh("rename"),this.folderNavDecorations.quickRefresh()):x&&(r("Rename",c.path,u),x.renameFile(c.path,u),this._liveViews.refresh("rename"),this.folderNavDecorations.quickRefresh())})),this.registerEvent(this.app.vault.on("modify",c=>{this.sharedFolders.lookup(c.path)&&(r("Modify",c.path),Xt().enableDesyncPill&&this.folderNavDecorations.quickRefresh(),this.app.metadataCache.trigger("resolve",c))}));let i=this,l=Ba(Et.MarkdownView.prototype,{onUnloadFile(c){return function(u){return i._liveViews.wipe(),c.call(this,u)}}});this.register(l),this.patchWebviewer(),ao(Tr.enableNewLinkFormat,()=>{let c=Ba(Et.MetadataCache.prototype,{fileToLinktext(u){return function(d,m,x){if(i.sharedFolders.lookup(d.path)){x===void 0&&(x=!0);let v=d.extension==="md"&&x?d.basename:d.name,w=(0,Et.normalizePath)(d.name),_=i.app.metadataCache.uniqueFileLookup.get(w.toLowerCase());if(_&&_.length===1&&_[0]===d)return v;{let A=d.extension==="md"&&x?d.path.slice(0,d.path.length-3):d.path,U=(0,o_.relative)(m,A);return U==="../"+v?"./"+v:U}}return u.call(this,d,m,x)}}});this.register(c)}),this.registerObsidianProtocolHandler("relay/settings/relays",async c=>{let u=c,d=new URLSearchParams({...u}).toString(),m=`/${u.action.split("/").slice(-1)}?${d}`;this.openSettings(m)}),this.registerObsidianProtocolHandler("relay/settings/shared-folders",async c=>{let u=c,d=new URLSearchParams({...u}).toString(),m=`/${u.action.split("/").slice(-1)}?${d}`;this.openSettings(m)}),this.registerObsidianProtocolHandler("relay/upgrade",async c=>{var m;let d=(m=c.version)==null?void 0:m.trim();this.installVersion(d)}),this.backgroundSync.start(),this.updateManager.start()}installVersion(t){let r=new ti(this.app,this,t);this.openModals.push(r),r.open()}removeCommand(t){if((0,Et.requireApiVersion)("1.7.2"))super.removeCommand(t);else{let r=this.app,n=r.commands,s=`system3-relay:${t}`;(n.commands.hasOwnProperty(s)||r.hotkeyManager.removeDefaultHotkeys(s))&&(delete n.commands[s],delete n.editorCommands[s])}}onunload(){var t,r,n,s,a,i,l,c,u,d,m,x,h,v;(t=this.timeProvider)==null||t.destroy(),(r=this.folderNavDecorations)==null||r.destroy(),this.app.workspace.detachLeavesOfType(Bs),this.updateManager&&(this.updateManager.destroy(),this.updateManager=null),(n=this._liveViews)==null||n.destroy(),this._liveViews=null,(s=this.relayManager)==null||s.destroy(),this.relayManager=null,(a=this.tokenStore)==null||a.stop(),(i=this.tokenStore)==null||i.clearState(),(l=this.tokenStore)==null||l.destroy(),this.tokenStore=null,(c=this.networkStatus)==null||c.stop(),(u=this.networkStatus)==null||u.destroy(),this.networkStatus=null,this.openModals.forEach(w=>{w.close()}),this.openModals.length=0,(d=this.sharedFolders)==null||d.destroy(),this.sharedFolders=null,(m=this.settingsTab)==null||m.destroy(),this.settingsTab=null,(x=this.loginManager)==null||x.destroy(),this.loginManager=null,(h=this.backgroundSync)==null||h.destroy(),this.backgroundSync=null,(v=this.app)==null||v.workspace.updateOptions(),this.app=null,this.fileManager=null,this.manifest=null,this.vault=null,this.debugSettings.destroy(),this.debugSettings=null,this.folderSettings.destroy(),this.folderSettings=null,this.featureSettings.destroy(),this.featureSettings=null,this.releaseSettings.destroy(),this.releaseSettings=null,this.interceptedUrls.length=0,Vt.destroy(),Dr.destroy(),this.notifier=null,this.toast=null,nx(),au()}async loadSettings(){this.settings.load()}async saveSettings(){await this.settings.save()}};
/*! Bundled license information:

moment/moment.js:
  (*! moment.js *)
  (*! version : 2.29.4 *)
  (*! authors : Tim Wood, Iskren Chernev, Moment.js contributors *)
  (*! license : MIT *)
  (*! momentjs.com *)

lucide-svelte/dist/defaultAttributes.js:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/arrow-right-left.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/arrow-up-down.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/chevron-left.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/chevron-right.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/circle-check-big.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/circle-help.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/clock.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/download.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/folder.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/info.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/layers.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/message-square-heart.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/pause.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/play.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/refresh-cw.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/satellite.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/settings.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/triangle-alert.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/upload.svelte:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/icons/index.js:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-svelte/dist/aliases.js:
  (**
   * @license lucide-svelte v0.377.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)
*/

/* nosourcemap */